<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Elasticsearch å¾é ­é–‹å§‹å­¸ç¿’(ELK &amp; Elastic Stack) - Ich bin yiwen.</title><meta name="Description" content="An ordinary space for storing and groups pieces of articles."><meta property="og:title" content="Elasticsearch å¾é ­é–‹å§‹å­¸ç¿’(ELK &amp; Elastic Stack)" />
<meta property="og:description" content="2023-07-11 çš„ç­†è¨˜å¤ªç°¡ç•¥ç²—ç³™ï¼Œé‡æ–°æ•´ç†
Elastic Search åˆ°åº•æ˜¯ä»€éº¼ ElasticSearch æ˜¯ä¸€å€‹é–‹æºåˆ†æå·¥å…· (Opensource analytics) å’Œå…¨æ–‡æœå°‹å¼•æ“ (full-text search engine)
é€šå¸¸ç”¨æ–¼å•Ÿç”¨applicationçš„æœç´¢åŠŸèƒ½ï¼Œæœ‰ä»¥ä¸‹ç‰¹æ€§
å¦‚æœç”¢å“æœ‰è©•åƒ¹ç­‰ç´šï¼Œè€Œé–‹ç™¼æƒ³è¦æé«˜é«˜è©•åƒ¹ç”¢å“çš„é—œè¯æ€§ é–‹ç™¼è¦å…è¨±ç”¨æˆ¶éæ¿¾çµæœï¼Œä¾‹å¦‚æŒ‰ç…§åƒ¹æ ¼ç¯„åœã€å“ç‰Œã€å°ºå¯¸ã€é¡è‰²ï¼Œä¸¦ä¾ç…§é—œè¯æ€§æ’åº ElasticSearché™¤äº†å…¨æ–‡æœå°‹ä¹‹å¤–ï¼Œé‚„å¯ä»¥æŸ¥è©¢çµæ§‹åŒ–æ•¸æ“šï¼ˆe.g. numbers, aggregated dataï¼‰ä¸¦ä¸”ä½¿ç”¨ElasticSearchä½œç‚ºåˆ†æå¹³å°
å¯ä»¥ç·¨å¯«query of aggregated dataï¼Œä¸¦ä½¿ç”¨çµæœè£½ä½œåœ“é¤…åœ–ã€æŠ˜ç·šåœ–etc. ä¾‹å­ï¼š
Analyze application logs and system metrics: å­˜å„²ä¾†è‡ªappçš„logæª”ä»¥åŠå„ç¨®æœå‹™å™¨ç³»çµ±æŒ‡æ¨™ï¼Œåˆ†æä¸¦è¨­ç½®å‘Šè­¦ (e.g. error and CPU memory usage) Application Performance Management (APM) : æ‡‰ç”¨ç¨‹å¼æ€§èƒ½ç®¡ç† Send events to ElasticSearch: ç™¼é€äº‹ä»¶è‡³ElasticSearch (e.g. å°‡å¯¦é«”åº—éŠ·å”®æ¥­ç¸¾å­˜åˆ°ElasticSearch ) Excellent at analyzing lots of data: åˆ†æå¤§é‡æ•¸æ“š ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’æ ¹æ“šæ­·å²è³‡æ–™ï¼Œä¾†é æ¸¬æœªä¾†éŠ·å”®é¡) Anomality Detection åµæ¸¬ç•°å¸¸ Data is stored as documents, which is just a unit of information" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://wysiwyz.github.io/posts/elasticsearch/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-22T17:00:05+08:00" />
<meta property="article:modified_time" content="2024-01-22T17:00:05+08:00" /><meta property="og:site_name" content="Ich bin yiwen." />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Elasticsearch å¾é ­é–‹å§‹å­¸ç¿’(ELK &amp; Elastic Stack)"/>
<meta name="twitter:description" content="2023-07-11 çš„ç­†è¨˜å¤ªç°¡ç•¥ç²—ç³™ï¼Œé‡æ–°æ•´ç†
Elastic Search åˆ°åº•æ˜¯ä»€éº¼ ElasticSearch æ˜¯ä¸€å€‹é–‹æºåˆ†æå·¥å…· (Opensource analytics) å’Œå…¨æ–‡æœå°‹å¼•æ“ (full-text search engine)
é€šå¸¸ç”¨æ–¼å•Ÿç”¨applicationçš„æœç´¢åŠŸèƒ½ï¼Œæœ‰ä»¥ä¸‹ç‰¹æ€§
å¦‚æœç”¢å“æœ‰è©•åƒ¹ç­‰ç´šï¼Œè€Œé–‹ç™¼æƒ³è¦æé«˜é«˜è©•åƒ¹ç”¢å“çš„é—œè¯æ€§ é–‹ç™¼è¦å…è¨±ç”¨æˆ¶éæ¿¾çµæœï¼Œä¾‹å¦‚æŒ‰ç…§åƒ¹æ ¼ç¯„åœã€å“ç‰Œã€å°ºå¯¸ã€é¡è‰²ï¼Œä¸¦ä¾ç…§é—œè¯æ€§æ’åº ElasticSearché™¤äº†å…¨æ–‡æœå°‹ä¹‹å¤–ï¼Œé‚„å¯ä»¥æŸ¥è©¢çµæ§‹åŒ–æ•¸æ“šï¼ˆe.g. numbers, aggregated dataï¼‰ä¸¦ä¸”ä½¿ç”¨ElasticSearchä½œç‚ºåˆ†æå¹³å°
å¯ä»¥ç·¨å¯«query of aggregated dataï¼Œä¸¦ä½¿ç”¨çµæœè£½ä½œåœ“é¤…åœ–ã€æŠ˜ç·šåœ–etc. ä¾‹å­ï¼š
Analyze application logs and system metrics: å­˜å„²ä¾†è‡ªappçš„logæª”ä»¥åŠå„ç¨®æœå‹™å™¨ç³»çµ±æŒ‡æ¨™ï¼Œåˆ†æä¸¦è¨­ç½®å‘Šè­¦ (e.g. error and CPU memory usage) Application Performance Management (APM) : æ‡‰ç”¨ç¨‹å¼æ€§èƒ½ç®¡ç† Send events to ElasticSearch: ç™¼é€äº‹ä»¶è‡³ElasticSearch (e.g. å°‡å¯¦é«”åº—éŠ·å”®æ¥­ç¸¾å­˜åˆ°ElasticSearch ) Excellent at analyzing lots of data: åˆ†æå¤§é‡æ•¸æ“š ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’æ ¹æ“šæ­·å²è³‡æ–™ï¼Œä¾†é æ¸¬æœªä¾†éŠ·å”®é¡) Anomality Detection åµæ¸¬ç•°å¸¸ Data is stored as documents, which is just a unit of information"/>
<meta name="application-name" content="Ich bin yiwen.">
<meta name="apple-mobile-web-app-title" content="Ich bin yiwen."><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/moon_icon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://wysiwyz.github.io/posts/elasticsearch/" /><link rel="prev" href="http://wysiwyz.github.io/posts/owasp_/" /><link rel="next" href="http://wysiwyz.github.io/posts/elasticcloud_onuploaddataset/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Elasticsearch å¾é ­é–‹å§‹å­¸ç¿’(ELK \u0026 Elastic Stack)",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/wysiwyz.github.io\/posts\/elasticsearch\/"
        },"genre": "posts","keywords": "ElasticSearch, Kibana","wordcount":  2651 ,
        "url": "http:\/\/wysiwyz.github.io\/posts\/elasticsearch\/","datePublished": "2024-01-22T17:00:05+08:00","dateModified": "2024-01-22T17:00:05+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "celine"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Ich bin yiwen.">Ich bin yiwen.</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Ich bin yiwen.">Ich bin yiwen.</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Elasticsearch å¾é ­é–‹å§‹å­¸ç¿’(ELK & Elastic Stack)</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>celine</a></span>&nbsp;<span class="post-category">included in <a href="/categories/studynote/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>StudyNote</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-01-22">2024-01-22</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2651 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;13 minutes&nbsp;<span id="/posts/elasticsearch/" class="leancloud_visitors" data-flag-title="Elasticsearch å¾é ­é–‹å§‹å­¸ç¿’(ELK &amp; Elastic Stack)">
                        <i class="far fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#elastic-search-åˆ°åº•æ˜¯ä»€éº¼">Elastic Search åˆ°åº•æ˜¯ä»€éº¼</a></li>
    <li><a href="#overview-of-the-elastic-stack">Overview of the Elastic Stack</a>
      <ul>
        <li><a href="#kibana">Kibana</a></li>
        <li><a href="#logstash">Logstash</a></li>
        <li><a href="#x-pack">X-Pack</a></li>
        <li><a href="#beats">Beats</a></li>
        <li><a href="#å°çµ">å°çµ</a></li>
      </ul>
    </li>
    <li><a href="#å¸¸è¦‹æ¶æ§‹">å¸¸è¦‹æ¶æ§‹</a></li>
    <li><a href="#å®‰è£æ–¹å¼">å®‰è£æ–¹å¼</a>
      <ul>
        <li><a href="#elastic-cloud">Elastic Cloud</a></li>
        <li><a href="#åœ¨macosä¸Šå®‰è£elasticsearch">åœ¨MacOSä¸Šå®‰è£ElasticSearch</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#part-16-kibana--elasticsearch">Part 1/6 Kibana &amp; ElasticSearch</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#part-26-æœå°‹çš„é—œè¯æ€§">Part 2/6 æœå°‹çš„é—œè¯æ€§</a>
      <ul>
        <li><a href="#syntax">Syntax</a></li>
      </ul>
    </li>
    <li><a href="#part-36--å…¨æ–‡æª¢ç´¢">Part 3/6  å…¨æ–‡æª¢ç´¢</a></li>
    <li><a href="#part-46-aggregations">Part 4/6 Aggregations</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><blockquote>
<p>2023-07-11 çš„ç­†è¨˜å¤ªç°¡ç•¥ç²—ç³™ï¼Œé‡æ–°æ•´ç†</p>
</blockquote>
<h2 id="elastic-search-åˆ°åº•æ˜¯ä»€éº¼">Elastic Search åˆ°åº•æ˜¯ä»€éº¼</h2>
<ul>
<li>
<p>ElasticSearch æ˜¯ä¸€å€‹é–‹æºåˆ†æå·¥å…· (Opensource analytics) å’Œå…¨æ–‡æœå°‹å¼•æ“ (full-text search engine)</p>
</li>
<li>
<p>é€šå¸¸ç”¨æ–¼å•Ÿç”¨applicationçš„æœç´¢åŠŸèƒ½ï¼Œæœ‰ä»¥ä¸‹ç‰¹æ€§</p>
<ul>
<li>å¦‚æœç”¢å“æœ‰è©•åƒ¹ç­‰ç´šï¼Œè€Œé–‹ç™¼æƒ³è¦æé«˜é«˜è©•åƒ¹ç”¢å“çš„é—œè¯æ€§</li>
<li>é–‹ç™¼è¦å…è¨±ç”¨æˆ¶éæ¿¾çµæœï¼Œä¾‹å¦‚æŒ‰ç…§åƒ¹æ ¼ç¯„åœã€å“ç‰Œã€å°ºå¯¸ã€é¡è‰²ï¼Œä¸¦ä¾ç…§é—œè¯æ€§æ’åº</li>
</ul>
</li>
<li>
<p>ElasticSearché™¤äº†å…¨æ–‡æœå°‹ä¹‹å¤–ï¼Œé‚„å¯ä»¥æŸ¥è©¢çµæ§‹åŒ–æ•¸æ“šï¼ˆe.g. numbers, aggregated dataï¼‰ä¸¦ä¸”ä½¿ç”¨ElasticSearchä½œç‚ºåˆ†æå¹³å°</p>
<ul>
<li>å¯ä»¥ç·¨å¯«query of aggregated dataï¼Œä¸¦ä½¿ç”¨çµæœè£½ä½œåœ“é¤…åœ–ã€æŠ˜ç·šåœ–etc.</li>
</ul>
</li>
<li>
<p>ä¾‹å­ï¼š</p>
<ul>
<li>Analyze application logs and system metrics: å­˜å„²ä¾†è‡ªappçš„logæª”ä»¥åŠå„ç¨®æœå‹™å™¨ç³»çµ±æŒ‡æ¨™ï¼Œåˆ†æä¸¦è¨­ç½®å‘Šè­¦ (e.g. error and CPU memory usage)</li>
<li>Application Performance Management (APM) : æ‡‰ç”¨ç¨‹å¼æ€§èƒ½ç®¡ç†</li>
<li>Send events to ElasticSearch: ç™¼é€äº‹ä»¶è‡³ElasticSearch (e.g. å°‡å¯¦é«”åº—éŠ·å”®æ¥­ç¸¾å­˜åˆ°ElasticSearch )</li>
<li>Excellent at analyzing lots of data: åˆ†æå¤§é‡æ•¸æ“š
<ul>
<li>ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’æ ¹æ“šæ­·å²è³‡æ–™ï¼Œä¾†é æ¸¬æœªä¾†éŠ·å”®é¡)</li>
<li>Anomality Detection åµæ¸¬ç•°å¸¸</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Data is stored as documents, which is just a unit of information</p>
<p><em>FIELD_NAMES</em> : <em>FIELD_VALUES</em></p>
<pre tabindex="0"><code>{
    &#34;firstName&#34;: &#34;Angela&#34;,
    &#34;lastName&#34;: &#34;Joji&#34;,
    &#34;interests&#34;: [&#34;ElasticSearch&#34;, &#34;Logstash&#34;, &#34;Kibana&#34;, &#34;ElasticStack&#34;]
}
</code></pre></li>
<li>
<p>æ•¸æ“šå­˜æˆæ–‡ä»¶(documents)ï¼Œå†é€éRESTful APIæŸ¥è©¢è³‡æ–™</p>
</li>
<li>
<p>ç™¼é€åˆ°ElasticSearchçš„æŸ¥è©¢ä¹Ÿæ˜¯ç”¨JSONç·¨å¯«çš„</p>
</li>
<li>
<p>ElasticSearchæ˜¯ç”¨Javaç·¨å¯«ï¼Œä¸¦å»ºæ§‹æ–¼Apache Lucene</p>
</li>
<li>
<p>å› ç‚ºä½¿ç”¨èµ·ä¾†å¾ˆæ–¹ä¾¿è€Œä¸”æ“´å……æ€§å¾ˆå‘Šï¼ŒElasticSearchçš„æ™®åŠç‡å¾ˆé«˜</p>
</li>
</ul>
<h2 id="overview-of-the-elastic-stack">Overview of the Elastic Stack</h2>
<ul>
<li>ç”±Elasticsearch BVé–‹ç™¼ç¶­è­·</li>
<li>Elastic Stack ä»¥ Elastic Search ç‚ºæ ¸å¿ƒï¼ŒåŠ ä¸Š X-Packã€KIBANAã€BEATSã€LOGSTASH</li>
</ul>
<h3 id="kibana">Kibana</h3>
<ul>
<li>An analytics and visualization platform åˆ†æå’Œå¯è¦–åŒ– å¹³å°</li>
<li>å¯ä»¥æƒ³æˆæ˜¯ElasticSearchçš„å„€è¡¨æ¿ï¼Œå¯ä»¥åœ¨å…¶ä¸­å»ºç«‹è³‡æ–™è¦–è¦ºåŒ–ï¼Œåƒæ˜¯åœ“é¤…åœ–ã€æŠ˜ç·šåœ–</li>
<li>Data Detection &amp; Predictionçš„é…ç½®ä¹Ÿæ˜¯åœ¨Kibanaåšæ›´æ”¹</li>
<li>Kibanaä¹Ÿæä¾›äº†ä¸€å€‹ä»‹é¢ä¾†ç®¡ç†ElasticSearchçš„æŸäº›éƒ¨ä»½ï¼Œä¾‹å¦‚AuthZ &amp; AuthN</li>
<li>Kibana: å­˜åœ¨ElasticSearchè£¡é¢è³‡æ–™çš„web interface</li>
</ul>
<h3 id="logstash">Logstash</h3>
<ul>
<li>å‚³çµ±ä¸Šï¼Œlogstashç”¨ä¾†è™•ç†ä¾†è‡ªappçš„æ—¥èªŒlogï¼Œä¸¦å°‡å®ƒç™¼é€åˆ°ElasticSearch</li>
<li>ä½†ç¾åœ¨Logstashæ¼”è®Šæˆæ›´é€šç”¨çš„å·¥å…·ï¼Œä½œç‚ºæ•¸æ“šè™•ç†ç®¡é“  data processing pipeline</li>
<li>Logstashæ”¶åˆ°çš„æ•¸æ“šæœƒä»¥äº‹ä»¶çš„å½¢å¼è¢«è™•ç†
<ul>
<li>log file entries</li>
<li>e-commerce orders</li>
<li>customers</li>
<li>chat messages</li>
</ul>
</li>
<li>ä»¥ä¸Šäº‹ä»¶æœƒç”±Logstashè™•ç†ï¼Œæ¥è‘—é€å¾€å…¶å®ƒç›®çš„åœ°(ä¾‹å¦‚â¬‡ï¸)
<ul>
<li>ElasticSearch</li>
<li>Kafka queue</li>
<li>Email message</li>
<li>HTTP endpoints</li>
</ul>
</li>
<li>Logstash ç®¡é“ç”±ä¸‰å€‹éƒ¨åˆ†/ä¸‰å€‹éšæ®µçµ„æˆï¼š  inputs, filters, outputs</li>
<li>æ¯å€‹éšæ®µéƒ½èƒ½ä½¿ç”¨æ’ä»¶(plug-ins)</li>
</ul>
<h4 id="plugins">Plugins</h4>
<ul>
<li>
<p>input plugins</p>
<ul>
<li>Logstashæ¥æ”¶äº‹ä»¶çš„æ–¹å¼ï¼Œå¯ä»¥æ˜¯ä¸€å€‹ document</li>
<li>logstash æœƒå¾çµ¦å®šçš„æ–‡ä»¶è®€å–äº‹ä»¶</li>
<li>ä¹Ÿå¯ä»¥æ˜¯é€éHTTPç™¼é€äº‹ä»¶åˆ°Logstashï¼Œå¾RDSè®€å–è³‡æ–™ï¼Œæˆ–è€…ç›£è½Kafkaè²¯åˆ—</li>
</ul>
</li>
<li>
<p>filter plugins</p>
<ul>
<li>Logstashè™•ç†äº‹ä»¶çš„æ–¹å¼</li>
<li>Parse Data: å¯ä»¥è§£æCSVã€XMLæˆ–JSON</li>
<li>Data Enrichment: ä¾‹å¦‚æŸ¥è©¢ä¸€å€‹ipä½å€ï¼Œä¸¦è§£æå…¶åœ°ç†ä½ç½®</li>
</ul>
</li>
<li>
<p>Output plugins</p>
<ul>
<li>å°‡è™•ç†éå¾Œçš„äº‹ä»¶ç™¼é€åˆ°å“ªè£¡ï¼Œç›®çš„åœ°æ­£å¼åç¨±ç‚ºSTASHES</li>
</ul>
</li>
</ul>
<blockquote>
<p>ç°¡è¨€ä¹‹ï¼ŒLogstashå¾ä¸€åˆ°å¤šå€‹ç®¡é“æ¥æ”¶äº‹ä»¶ï¼Œè™•ç†äº‹ä»¶ä¸¦ä¸”ç™¼é€äº‹ä»¶åˆ°ä¸€è‡³å¤šå€‹STASHES</p>
</blockquote>
<ul>
<li>ä¸€å€‹Logstash instanceä¸­ï¼Œå¯ä»¥é‹è¡Œå¤šå€‹ pipelines</li>
<li>Logstashå¯ä»¥æ°´å¹³æ“´å±•</li>
</ul>
<h4 id="logstash-é…ç½®">Logstash é…ç½®</h4>
<ul>
<li>
<p>é¡ä¼¼JSONæ ¼å¼çš„markup formatï¼Œä½†åˆä¸åƒ…æ˜¯markup languageï¼Œå› ç‚ºå®ƒé‚„å¯ä»¥æ·»åŠ æ¢ä»¶èªå¥ï¼Œè®“ç®¡é“å‹•æ…‹åŒ–</p>
</li>
<li>
<p>ä»¥ä¸‹ç¯„ä¾‹é…ç½®æ–‡æœ¬ï¼š</p>
<ul>
<li>
<p>è§£æå­—ä¸²ï¼ˆå°‡éçµæ§‹åŒ–çš„æ•¸æ“šçµæ§‹åŒ–ï¼‰ï¼šä½¿ç”¨Grok pattern</p>
<blockquote>
<p>Grok Patterné¡ä¼¼æ­£å‰‡è¡¨é”å¼</p>
<p>ç”¨é€”ï¼što match pieces of text and store them within fields</p>
</blockquote>
</li>
</ul>
<pre tabindex="0"><code class="language-Treetop" data-lang="Treetop">input {
  file {
    patch =&gt; &#34;/path/to/apache_access.log&#34;
  }
}

filter {
  if [request] in [&#34;/robots.txt&#34;, &#34;/favicon.ico&#34;] {
    drop {}
  }
}

output {
  file {
    patch =&gt; &#34;%{type}_%{+yyyy_MM_dd}.log&#34;
  }
}
</code></pre><h3 id="x-pack">X-Pack</h3>
<p>çµ¦ElasticSearch å’Œ Kibana æ·»åŠ åŠŸèƒ½</p>
<ol>
<li>Security: X-Packçµ¦Kibanaå’ŒElasticSearchæ·»åŠ äº†AuthN èˆ‡ AuthZåŠŸèƒ½
<ul>
<li>Kibanaå¯ä»¥æ•´åˆ(é›†æˆintegrate) å…¶å®ƒAuthN providersï¼Œä¾‹å¦‚LDAPã€Active Directory</li>
<li>å¦å¤–ä¹Ÿå¯ä»¥åœ¨é…ç½®æª”åŠ å…¥users &amp; rolesï¼Œä¸¦é…ç½®å…è¨±ç‰¹å®šè§’è‰²/ç”¨æˆ¶è¨ªå•çš„å…§å®¹</li>
</ul>
</li>
<li>Monitoring
<ul>
<li>X-Packå¯ä»¥å”åŠ©ç›£æ§Elastic Stack (ElasticSearch, Logstash, Kibana) çš„æ€§èƒ½</li>
<li>ä¾‹: CPU &amp; memory usage CPUå’Œå…§å­˜çš„ä½¿ç”¨æƒ…æ³, disk spaceç£ç¢Ÿç©ºé–“ ç­‰æœ‰æ•ˆæŒ‡æ¨™</li>
</ul>
</li>
<li>Alertingè­¦å ±
<ul>
<li>ä¾‹: ç•¶web serverçš„CPUåˆ©ç”¨ç‡è¶…é90%ï¼Œæˆ–è€…application erroré”åˆ°é–€æª»</li>
<li>é€éé›»å­éƒµä»¶,  æˆ–Slackç­‰å…¶å®ƒæ–¹å¼å‘ŠçŸ¥</li>
</ul>
</li>
<li>Reporting
<ul>
<li>å°‡Kibanaè¦–è¦ºåŒ–çš„æ•¸æ“šå°å‡ºæˆPDFæ–‡ä»¶</li>
<li>å¯ä»¥æ¥æ”¶éœ€æ±‚å¾Œæ‰è¼¸å‡ºå ±å‘Šï¼Œä¹Ÿå¯ä»¥å®šæœŸè¼¸å‡ºå ±å‘Šä¸¦ç™¼é€è‡³e-mail</li>
<li>å¦å¤–ä¹Ÿå¯ä»¥æŒ‡å®šè§¸ç™¼è¼¸å‡ºå ±å‘Šçš„æ¢ä»¶ï¼ˆé¡ä¼¼alerting)</li>
</ul>
</li>
<li>Machine Learning
<ul>
<li>åŠŸèƒ½æ€§(functionality)ç”±X-Packæä¾›ï¼Œæ¥å£(interface)ç”±Kibanaæä¾›</li>
<li>å¯ä»¥åšç•°å¸¸æª¢æ¸¬ã€é æ¸¬æœªä¾†æ•¸æ“š</li>
</ul>
</li>
<li>Graph
<ul>
<li>æŒ‡çš„æ˜¯è³‡æ–™ä¹‹é–“çš„é—œä¿‚</li>
<li>ä¾‹: åœ¨å•†å“æ˜ç´°é é¢é¡¯ç¤ºèˆ‡ç›¸é—œå•†å“å€‘ï¼Œæˆ–è€…Spotifyçš„ä¸‹ä¸€é¦–æ¨è–¦æ­Œå–®</li>
<li>éœ€è¦å€åˆ†popularityèˆ‡relevanceï¼Œä¸ç„¶å¯èƒ½ç”¢ç”Ÿèª¤å°
<ul>
<li>å–œæ­¡è½LinkinParkçš„æ¨‚è¿·å¯èƒ½ä¹Ÿå¶çˆ¾æœƒè½å¤å…¸æ¨‚</li>
</ul>
</li>
<li>æä¾›ä¸€å€‹å…¬é–‹APIï¼Œå¯ä»¥ç”¨ä¾†å°‡Graphæ•´åˆé€²æ‡‰ç”¨ç¨‹å¼</li>
<li>æä¾›ä¸€å€‹pluginsï¼Œå¯ä»¥ç”¨ä¾†å¯è¦–åŒ–Kibanaè£¡é¢è³‡æ–™ä¹‹é–“çš„é—œä¿‚</li>
</ul>
</li>
<li>ElasticSearch SQL
<ul>
<li>ä½¿ç”¨SQLæŸ¥è©¢SQL</li>
<li>ä½¿ç”¨Query DSLæ’°å¯«æŸ¥è©¢ï¼ˆflexible but verbose at times)</li>
<li>é€éHTTPæˆ–JDBC driverç™¼é€SQL</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="beats">Beats</h3>
<ul>
<li>
<p>Collections of data receiver</p>
</li>
<li>
<p>Light-weight agent è¼•é‡ç´šä»£ç†, åœ¨Serverä¸­ï¼Œå°‡æ•¸æ“šç™¼é€åˆ°Logstashæˆ–è€…ElasticSearch</p>
<ul>
<li>Beats: data shipper, æ”¶é›†ä¸åŒé¡å‹çš„æ•¸æ“š</li>
</ul>
</li>
<li>
<p>å¸¸è¦‹beats</p>
<ol>
<li>FileBeat
<ul>
<li>æ”¶é›†logæª”æ¡ˆ</li>
<li>åŒ…å«å¸¸è¦‹logç¨®é¡çš„æ¨¡çµ„ (ä¾‹å¦‚: nginx, MySQL)</li>
</ul>
</li>
<li>MetricBeat
<ul>
<li>æ”¶é›†ç³»çµ±èˆ‡æœå‹™çš„åº¦é‡æŒ‡æ¨™, ä¾‹å¦‚: memory and CPU usage</li>
<li>åŒ…å«å¸¸è¦‹logç¨®é¡çš„æ¨¡çµ„ (ä¾‹å¦‚: nginx, MySQL)</li>
</ul>
</li>
<li>PacketBeat:
<ul>
<li>Collects network data æ”¶é›†ç¶²è·¯æ•¸æ“š</li>
<li>ä¾‹å¦‚: HTTP requests or database transaction HTTPè«‹æ±‚æˆ–è³‡æ–™åº«äº¤æ˜“</li>
</ul>
</li>
<li>WinLogBeat: Collects Windows Events Logs</li>
<li>AuditBit: Collects audit data from Linux æ”¶é›†Linuxå¯©è¨ˆæ•¸æ“š</li>
<li>HeartBeat: monitor service uptime ç›£æ§æœå‹™ä¸Šç·šæ™‚é–“</li>
</ol>
</li>
</ul>
<h3 id="å°çµ">å°çµ</h3>
<ul>
<li>X-Pack: Add features to the elastic stack</li>
<li>Logstash and Beats: In charge of data ingestion</li>
<li>ElasticSearch: Search, analyze and store data</li>
<li>Kibana: Visualize your data</li>
</ul>
<hr>
<h2 id="å¸¸è¦‹æ¶æ§‹">å¸¸è¦‹æ¶æ§‹</h2>
<p>ç¾åœ¨æœ‰å€‹é›»å•†ç¶²ç«™ï¼Œè³‡æ–™å­˜åœ¨è³‡æ–™åº«ï¼Œç•¶clientè«‹æ±‚è³‡æ–™æ™‚æ˜¯å¾è³‡æ–™åº«æ‹¿ï¼Œå†é€éå¾Œç«¯æ‡‰ç”¨ç¨‹å¼å‚³å›å‰ç«¯ç€è¦½å™¨ï¼Œä½†ç¾åœ¨æƒ³è¦å°‡ElasticSearchæ•´åˆé€²ç¾æœ‰æ¶æ§‹ï¼Œæ€éº¼åšï¼Ÿ</p>
<p>é€šå¸¸å»ºè­°ä½¿ç”¨client librariesï¼ŒåŒæ™‚è¦ä¿æŒè³‡æ–™åº«èˆ‡ElasticSearchåŒæ­¥æ›´æ–°ï¼Œæ•¸æ“šåœ¨databaseèˆ‡ElasticSearchæœƒé‡è¤‡ã€‚</p>
<p>å¦‚æœè³‡æ–™åº«å·²ç¶“æœ‰10è¬ç­†å•†å“ï¼Œè¦æ€éº¼åŒæ­¥åˆ°ElasticSearchï¼Ÿ</p>
<ul>
<li>å¦‚æœè³‡æ–™æ²’æœ‰é‚£éº¼å¤šï¼Œå¯ä»¥å¯«scriptè®“å®ƒä¸€å£æ°£å®Œæˆè¼¸å…¥</li>
<li>å¦‚æœè³‡æ–™æ›´å¤šå°±éœ€è¦paginatingæˆ–scroll</li>
<li>è³‡æ–™è¼¸å…¥å¾Œï¼Œå°±éœ€è¦æ‡‰ç”¨ç¨‹å¼è² è²¬ç¶­è­·å…©é‚Šçš„è³‡æ–™åŒæ­¥æ›´æ–°</li>
</ul>
<p>éš¨è‘—æ¥­å‹™æˆé•·ï¼Œè¦ç¢ºä¿ç›®å‰çš„æ¶æ§‹è¶³ä»¥æ‡‰ä»˜æœªä¾†å¢é•·ï¼ˆè™•ç†æµé‡é«˜å³°ï¼Œäº†è§£ä½•æ™‚æ‡‰è©²å¢åŠ ä¸€å°web server)  ï¼Œå¯ä»¥ä½¿ç”¨metricbeatç›£æ§ç³»çµ±ç´šåˆ¥æŒ‡æ¨™ï¼ˆsystem level metricsï¼‰ï¼Œä¾‹å¦‚CPUä½¿ç”¨ç‡å’Œå…§å­˜memoryä½¿ç”¨ç‡ã€‚æ‰€ä»¥åœ¨Web Serverå•Ÿå‹•MetricBeatï¼Œä½†æ•¸æ“šå¦‚ä½•çµæŸæ–¼ElasticSearchï¼Ÿ</p>
<ul>
<li>Beatsæ”¯æŒå‘Logstashä»¥åŠElasticSearchç™¼é€æ•¸æ“šï¼Œå¾Œè€…ç›¸å°ç°¡å–®</li>
<li>é…ç½®Metricbeatï¼Œä½¿å®ƒèƒ½å°‡è³‡æ–™é€é€² ElasticSearch çš„ ingest node</li>
<li>æŒ‡ç¤ºMetricbeatï¼Œåœ¨Kibanaä¸­é…ç½®å„€è¡¨æ¿</li>
<li>Kibanaçš„é…ç½®å‰‡å­˜åœ¨ElasticSearchè£¡é¢</li>
</ul>
<p>é…ç½®æ›´å¤šçš„æ±è¥¿ï¼šWeb Server çš„ access logs, error logsã€‚é›–ç„¶å¯ä»¥åˆ©ç”¨Google Analyticsï¼Œä½†access logæ›´å¯ä»¥æä¾›ä¸€äº›æœ‰ç”¨è¨Šæ¯ï¼Œåƒæ˜¯</p>
<ul>
<li>web serverè™•ç†æ¯å€‹è«‹æ±‚èŠ±äº†å¤šé•·æ™‚é–“</li>
<li>ç›£æ§éŸ¿æ‡‰æ™‚é–“ (respone time) ä¸¦èšåˆæ¯å€‹ç«¯é»çš„è«‹æ±‚</li>
<li>è­˜åˆ¥bad deploymentsï¼ˆä¾‹å¦‚ï¼šå¤ªé•·çš„éŸ¿æ‡‰æ™‚é–“ã€æˆ–4xx/5xxçš„HTTPç‹€æ…‹ç¢¼ï¼‰</li>
<li>ä¸Šè¿°é€™äº›éƒ½å¯ä»¥é€éFilebeaté”æˆï¼ŒFilebeatå¯ä»¥
<ul>
<li>è§£ææ—¥èªŒ(parse logs)</li>
<li>è™•ç†å¤šè¡Œäº‹ä»¶(multi-line events)ï¼Œä¾‹å¦‚stack trace, etc.</li>
</ul>
</li>
</ul>
<p>æ›´é«˜ç´šçš„äº‹ä»¶è™•ç†ï¼Œåƒæ˜¯data enrichmentæ•¸æ“šè±å¯ŒåŒ–ï¼Œå¯ä»¥åœ¨web applicationä¸­åŸ·è¡Œé€™é¡æ“ä½œï¼Œä½†å¯èƒ½æœƒå°è‡´ä¸€äº›ç¼ºé»ï¼š</p>
<ol>
<li>é¦–å…ˆæ¥­å‹™é‚è¼¯ç¨‹å¼ç¢¼æœƒå……æ»¿é›œäº‚ç„¡ç« çš„äº‹ä»¶è™•ç†ï¼Œå¢åŠ æœå‹™å™¨éŸ¿æ‡‰æ™‚é–“ï¼ˆé™¤éç”¨ç•°æ­¥åŸ·è¡Œï¼‰</li>
<li>å»ä¸­å¿ƒåŒ–çš„äº‹ä»¶è™•ç†ï¼šäº‹ä»¶è™•ç†æœƒç™¼ç”Ÿåœ¨å¾ˆå¤šåœ°æ–¹ï¼Œ å¯ä»¥é€éLogstashå¯¦ç¾é›†ä¸­åŒ–ï¼Œå°‡äº‹ä»¶è™•ç†æ”¾åœ¨åŒä¸€å€‹åœ°æ–¹å®Œæˆ
<ul>
<li>WebServerç™¼é€äº‹ä»¶ï¼Œé€éHTTPåˆ°Logstashï¼ŒLogstashä¾ç…§æŒ‡ç¤ºçš„æ–¹å¼è™•ç†äº‹ä»¶ï¼Œæ¥è‘—ç™¼é€åˆ°ElasticSearch</li>
<li>é‚£ä¾†è‡ªMetricBeatå’ŒFileBeatçš„dataè¦æ€éº¼è™•ç†ï¼Ÿå¯ä»¥é€éLogstashç™¼é€åˆ°elasticsearchï¼ˆæœ€ç†æƒ³ç‹€æ³ï¼‰ï¼Œæˆ–ç›´æ¥é€åˆ°ElasticSearch</li>
<li>ElasticSearch only handles query from web-app, not modifying data</li>
</ul>
</li>
</ol>
<hr>
<h2 id="å®‰è£æ–¹å¼">å®‰è£æ–¹å¼</h2>
<ol>
<li>å®‰è£Kibana - å®ƒæœ‰Consoleæ–¹ä¾¿é–‹ç™¼ï¼Œå¯ä»¥è¼•æ˜“çš„ç™¼é€æŸ¥è©¢åˆ°ElasticSearch</li>
<li>å¦‚æœä½¿ç”¨ <a href="https://www.elastic.co/cloud/cloud-trial-overview" target="_blank" rel="noopener noreffer ">Elastic Cloud</a> å°±éƒ½ä¸ç”¨å®‰è£äº†ğŸ˜…ä»–æ˜¯æœ‰14å¤©æœŸé™çš„è©¦ç”¨ç‰ˆ
<ul>
<li>è©¦ç”¨æœŸæ˜¯å¾ä½ å»ºç«‹ç¬¬ä¸€å€‹clusteré–‹å§‹ç®—ï¼Œè€Œä¸æ˜¯å»ºç«‹å¸³æˆ¶é–‹å§‹ç®—</li>
</ul>
</li>
</ol>
<h3 id="elastic-cloud">Elastic Cloud</h3>
<ul>
<li>
<p>é›†ç¾¤(cluster)ï¼šelastic cloud æŠŠä»–ç¨±ç‚º deployment (less technical term for  cluster)</p>
</li>
<li>
<p>å‰µå»ºéƒ¨ç½² create deployment</p>
<ol>
<li>
<p>å‘½å, é¸æ“‡cloud platform, é¸æ“‡template</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/kMGTeno.jpg"
        data-srcset="https://i.imgur.com/kMGTeno.jpg, https://i.imgur.com/kMGTeno.jpg 1.5x, https://i.imgur.com/kMGTeno.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/kMGTeno.jpg"
        title="Naming" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/sSQ4Gii.jpg"
        data-srcset="https://i.imgur.com/sSQ4Gii.jpg, https://i.imgur.com/sSQ4Gii.jpg 1.5x, https://i.imgur.com/sSQ4Gii.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/sSQ4Gii.jpg"
        title="Choose_Platform" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/nmKK5Hw.png"
        data-srcset="https://i.imgur.com/nmKK5Hw.png, https://i.imgur.com/nmKK5Hw.png 1.5x, https://i.imgur.com/nmKK5Hw.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/nmKK5Hw.png"
        title="Save_Credentials" /></p>
</li>
<li>
<p>éƒ¨ç½²å®Œæˆå¾Œï¼Œé»æ“ŠActionsâ¡ï¸Manageå°±å¯ä»¥çœ‹åˆ°ç›¸é—œçš„åŸºæœ¬ä¿¡æ¯</p>
<ul>
<li>health status</li>
<li>actions we can perform</li>
<li>memory and disk usage</li>
<li>Cloud ID: ç•¶ä½ è¦å¾ElasticStackç›¸é—œç”¢å“ (Beats or Logstash) ç™¼é€æ•¸æ“šåˆ°ElasticSearchæ™‚ï¼Œæœƒéœ€è¦ç”¨åˆ°é€™å€‹ID</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="åœ¨macosä¸Šå®‰è£elasticsearch">åœ¨MacOSä¸Šå®‰è£ElasticSearch</h3>
<ul>
<li>ElasticSearchæ˜¯ä¸€å †jaræª” (java archive)</li>
<li>ElasticSearché™„å¸¶ä¸€å€‹ç‰ˆæœ¬çš„OpenJDK
<ul>
<li>å¦‚æœå·²ç¶“æœ‰å®‰è£ï¼Œå‰‡æœƒä½¿ç”¨JAVA_HOMEç’°å¢ƒè®Šæ•¸æŒ‡å‘çš„JVM</li>
<li>é‚„æ²’å®‰è£çš„è©±å°±æœƒä½¿ç”¨ bundled JDKï¼Œä¸ç”¨é¡å¤–å®‰è£</li>
</ul>
</li>
<li><a href="https://www.elastic.co/downloads/elasticsearch" target="_blank" rel="noopener noreffer ">ä¸‹è¼‰é€£çµ</a></li>
</ul>
<hr>
<h1 id="beginners-crash-course">Beginner&rsquo;s Crash Course</h1>
<h2 id="part-16-kibana--elasticsearch">Part 1/6 Kibana &amp; ElasticSearch</h2>
<h5 id="what-is-sharing">What is sharing?</h5>
<p>Index is just a virtual thing that keeps track of where documents are stored.</p>
<p>When you create an index, one shard is created by default, and the shard is assigned to a node. Remember, shard is where documents are stored, and number of documents a shark could hold depends on the capacity of the node.</p>
<p>Let&rsquo;s say you want to index 600_000 documents(60è¬) in your produce index, but the node where the shard is assigned to could only hold 200_000 documents, which is not gonna work, but we do have two more nodes which could hold 200_000 documents each.</p>
<p>å› æ­¤ï¼Œä¸€å€‹cluster è£¡é¢æœ‰ä¸‰å€‹nodeï¼Œæ¯å€‹nodeå„æœ‰ä¸€å€‹produce indexçš„shardï¼Œä½†æ˜¯produce indexè£¡é¢çš„è³‡æ–™é‚„æœƒä¸€ç›´å¢åŠ ï¼Œé€™æ™‚å€™ shardingå°±æ´¾ä¸Šç”¨å ´äº†ã€‚</p>
<h5 id="the-beauty-of-sharding">The beauty of sharding</h5>
<p>You could add more shards and nodes as the need rises, so you could horizontally scale and adapt to increasing data, but that&rsquo;s not the only superpower that comes with sharding.</p>
<p>Shard is where you store documents, and it&rsquo;s also where you run search queries. Let&rsquo;s talk about a scenario where the client is sending a search request for gingery read bean tang-yuan. In this scenario, you have one chart in a node that could hold the entire produce index.</p>
<h5 id="sharding-speedings-up-your-search">Sharding speedings up your search</h5>
<p>You could run a search on all 10 of these shards at the same time in parallel</p>
<p>æ‰€ä»¥å¦‚æœæœ‰ä¸€å€‹Produce Index å…·æœ‰500_000è³‡æ–™ï¼Œå…¨éƒ¨éƒ½æ”¾åœ¨<code>P0</code>ä¸€å€‹shardè£¡é¢ï¼Œé‚£éº½è¦å®Œæˆæœå°‹éœ€è¦è€—è²»10ç§’é˜ï¼ˆsequentiallyï¼‰ã€‚</p>
<p>ä½†å¦‚æœæœ‰Produce Indexæœ‰10å€‹shardsï¼Œåˆ†åˆ¥ä½ˆåœ¨10å€‹nodesä¸Šé¢ï¼Œè€Œä¸€å€‹shardå­˜æœ‰50_000ç­†æ–‡ä»¶ï¼Œåœ¨é€™è£è¦å®Œæˆæœå°‹åªè¦èŠ±1ç§’é˜ã€‚</p>
<h5 id="what-are-replica-shards">What are replica shards?</h5>
<p>Let&rsquo;s say everything is going well with our online grocery shop, but all of a sudden one of our nodes go down and we lose our data. To avoid this, we could make copies of the original shards and store it&rsquo;s copies across different nodes.</p>
<p>Node 1&amp;2: contain original shards (<code>P0</code>, <code>P1</code>), also known as primary shards.</p>
<p>Node 3&amp;2: make copies of original shards and store these in different nodes(<code>R0</code>, <code>R1</code>), also known as replica shards.</p>
<p>é™¤äº†èƒ½å¤ é¿å…æŸå€‹ç¯€é»æœ‰å•é¡Œï¼Œé‚„å¯ä»¥å¢é€²æœå°‹æ•ˆèƒ½</p>
<h5 id="replica-shards-can-improve-the-performance-of-your-search">Replica shards can improve the performance of your search</h5>
<p>2000 search queries per second â¡ï¸ 8000 search queries per second</p>
<p>Because the replicas are identical copies of the primary shards, now these replica shards can pick up the slack and your cluster could better handle increased demands on search.</p>
<p>Note:</p>
<ul>
<li>
<p>å¦‚æœæœ‰ElasticSearchå¯†ç¢¼ï¼Œå•Ÿå‹•è…³æœ¬<code>bin/elasticsearch</code>ä¹‹å¾Œçš„curl cmdå¦‚ä¸‹</p>
<p><code>curl -k -u elastic:{password_for_the_elastic_user} https://localhost:9200</code>ï¼ˆ<a href="https://discuss.elastic.co/t/curl-x-get-http-localhost-9200-curl-52-empty-reply-from-server/329211" target="_blank" rel="noopener noreffer ">åƒ</a>ï¼‰</p>
<ul>
<li>åªæœ‰<code>curl http://localhost:9200</code>åªæœƒæ”¶åˆ°Empty reply from Server</li>
<li>password_for_the_elastic_user: é€™æ˜¯é¦–æ¬¡å•Ÿå‹• <code>bin/elasticsearch</code> scriptæœƒç”¢ç”Ÿçš„å¯†ç¢¼ï¼Œä¹Ÿå¯ä»¥ç”¨<code>bin/elasticsearch-reset-password -u elastic</code>é‡æ–°ç”¢ç”Ÿä¸€çµ„å¯†ç¢¼</li>
</ul>
</li>
<li>
<p>åœ¨$ES_HOME(å³è§£å£“ç¸®å¾Œçš„elastic tar.gzæª”æ¡ˆ) è·¯å¾‘é–‹å•Ÿçµ‚ç«¯æ©Ÿï¼Œè¼¸å…¥ <code>code .</code> æ‰“é–‹ vsCode</p>
</li>
<li>
<p>ç•¶ä½ å•Ÿå‹•äº†ä¸€å€‹nodeï¼Œé è¨­æœƒè‡ªå‹•å½¢æˆä¸€å€‹clusterï¼Œæœ€å¥½çµ¦ä»–å€‘æœ‰æ„ç¾©çš„å‘½åï¼Œä»¥åˆ©çˆ¾å¾Œåœ¨å¤šå€‹clusters/å¤šå€‹nodesè­˜åˆ¥ä¸åŒçš„ä»»å‹™/è² è²¬é …ç›®</p>
<ul>
<li>ä¿®æ”¹ elastic search.yml æª”æ¡ˆä»¥ä¸‹å…©è¡Œï¼Œå­˜æª”ä¹‹å¾Œè¦åœæ­¢ elasticsearch script &amp; kibana scripï¼Œå†é‡æ–°å•Ÿå‹•</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/JJGsyYk.jpg"
        data-srcset="https://i.imgur.com/JJGsyYk.jpg, https://i.imgur.com/JJGsyYk.jpg 1.5x, https://i.imgur.com/JJGsyYk.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/JJGsyYk.jpg"
        title="cluster_node" /></p>
</li>
<li>
<p>GET å¯ä»¥æŸ¥çœ‹clusterå¥åº·ã€nodesç‹€æ…‹</p>
</li>
<li>
<p>PUT å¯ä»¥å»ºç«‹ä¸€ç­†ç´¢å¼•ï¼Œå¦‚æœresponse JSON çš„ &ldquo;acknowledged&rdquo; ç‚º trueï¼Œå°±è¡¨ç¤ºå»ºç«‹æˆåŠŸ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/T7e1qpT.jpg"
        data-srcset="https://i.imgur.com/T7e1qpT.jpg, https://i.imgur.com/T7e1qpT.jpg 1.5x, https://i.imgur.com/T7e1qpT.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/T7e1qpT.jpg"
        title="PUT_FAVORITE_CURRY" /></p>
</li>
<li>
<p>INDEX as verb åœ¨æŸç­†ç´¢å¼•è£¡é¢å„²æ”¾/åŠ å…¥documentsï¼Œå¯ä»¥ç”¨ POST æˆ– PUT</p>
<ul>
<li>
<p>POST: è«‹ElasticSearchè‡ªå‹•å¹«ä½ å»ºç«‹ä¸€å€‹ document ID</p>
<pre tabindex="0"><code>POST {ç´¢å¼•çš„åç¨±}/_doc
{
    &#34;field&#34;: &#34;value&#34;
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/KS1VhHj.jpg"
        data-srcset="https://i.imgur.com/KS1VhHj.jpg, https://i.imgur.com/KS1VhHj.jpg 1.5x, https://i.imgur.com/KS1VhHj.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/KS1VhHj.jpg"
        title="SyntaxExample" /></p>
</li>
<li>
<p>PUT: å‰‡é©ç”¨æ–¼è¦çµ¦è©²æ–‡ä»¶æŒ‡å®šä¸€ç­†IDè™Ÿç¢¼ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨ natural identifier çµ¦è³‡æ–™ç·¨ç´¢å¼•æ™‚æœƒä½¿ç”¨</p>
<pre tabindex="0"><code>PUT {ç´¢å¼•çš„åç¨±}/_doc/{é€™ä»½æ–‡ä»¶è¦åˆ†é…åˆ°çš„æŒ‡å®šID}
{
    &#34;field&#34;: &#34;value&#34;
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/ehieOWZ.jpg"
        data-srcset="https://i.imgur.com/ehieOWZ.jpg, https://i.imgur.com/ehieOWZ.jpg 1.5x, https://i.imgur.com/ehieOWZ.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/ehieOWZ.jpg"
        title="PUT_fav_curry" /></p>
</li>
</ul>
</li>
<li>
<p>READ è®€å–document</p>
<pre tabindex="0"><code>GET {ç´¢å¼•åç¨±}/_doc/{è¦æŸ¥æ‰¾çš„DocumentID}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/0Y54vkD.jpg"
        data-srcset="https://i.imgur.com/0Y54vkD.jpg, https://i.imgur.com/0Y54vkD.jpg 1.5x, https://i.imgur.com/0Y54vkD.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/0Y54vkD.jpg"
        title="Get" /></p>
</li>
<li>
<p>å¦‚æœç”¨æ—¢æœ‰çš„ ID put ä¸€ç­†æ–‡ä»¶ï¼Œæœƒç™¼ç¾åŸæœ¬çš„Joshuaè¢«Jupytorè¦†å¯«äº†</p>
<p><code>result:updated</code> ä»¥åŠ <code>_version:2</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/6hQCuSc.jpg"
        data-srcset="https://i.imgur.com/6hQCuSc.jpg, https://i.imgur.com/6hQCuSc.jpg 1.5x, https://i.imgur.com/6hQCuSc.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/6hQCuSc.jpg"
        title="Step1" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/WZwvlkT.jpg"
        data-srcset="https://i.imgur.com/WZwvlkT.jpg, https://i.imgur.com/WZwvlkT.jpg 1.5x, https://i.imgur.com/WZwvlkT.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/WZwvlkT.jpg"
        title="step2" /></p>
</li>
<li>
<p>å¦‚æœè¦é¿å…æ–‡ä»¶è¢«è¦†è“‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>_create_entpoint</code> ï¼Œé€™æ¨£å¦‚æœæŒ‡å®šçš„æ˜¯å·²ç¶“å­˜åœ¨çš„IDï¼Œå°±æœƒæ‹‹å‡ºéŒ¯èª¤ï¼Œä»¥å…ä¸å°å¿ƒè¦†è“‹æ‰æ—¢æœ‰çš„doc</p>
<pre tabindex="0"><code>PUT {ç´¢å¼•åç¨±}/_create/{æŒ‡å®šçš„DocId}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/b9YfqK2.jpg"
        data-srcset="https://i.imgur.com/b9YfqK2.jpg, https://i.imgur.com/b9YfqK2.jpg 1.5x, https://i.imgur.com/b9YfqK2.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/b9YfqK2.jpg"
        title="Error409" /></p>
</li>
<li>
<p>Update æ›´æ–°æ–‡ä»¶</p>
<ul>
<li>æ³¨æ„é€™è£¡çš„JSON ä¸€å®šè¦å¸¶ field <code>doc</code>ï¼Œæ¬„ä½ä¸ç”¨å…¨éƒ¨éƒ½çµ¦</li>
</ul>
<pre tabindex="0"><code>POST {ç´¢å¼•åç¨±}/_update/{å¾…æ›´æ–°çš„Docçš„Id}
{
    &#34;doc&#34;: {
        &#34;field1&#34;: &#34;value&#34;,
        &#34;field2&#34;: &#34;value&#34;
    }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/PDKgGKG.jpg"
        data-srcset="https://i.imgur.com/PDKgGKG.jpg, https://i.imgur.com/PDKgGKG.jpg 1.5x, https://i.imgur.com/PDKgGKG.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/PDKgGKG.jpg"
        title="Update_only partial fields" /></p>
</li>
<li>
<p>Delete åˆªé™¤æ–‡ä»¶</p>
<pre tabindex="0"><code>DELETE {ç´¢å¼•åç¨±}/_doc/{æŒ‡å®šè¦åˆªé™¤çš„DocId}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/wrLIgT5.jpg"
        data-srcset="https://i.imgur.com/wrLIgT5.jpg, https://i.imgur.com/wrLIgT5.jpg 1.5x, https://i.imgur.com/wrLIgT5.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/wrLIgT5.jpg"
        title="Delete Demo" /></p>
</li>
</ul>
<h5 id="q-and-a">Q and A</h5>
<ol>
<li>RDBMSèˆ‡ElasticSearchæ¯”è¼ƒ
<ul>
<li>ElasticSearchä¸æ˜¯è³‡æ–™åº«ï¼Œå®ƒæ˜¯æœå°‹åˆ†æå¼•æ“</li>
<li>æ²’æœ‰schemaï¼Œå»ºæ§‹æ–¼Luceneï¼Œæ“…æ–¼å…¨æ–‡æœç´¢</li>
<li>å¯ä»¥å¾®èª¿æœå°‹çµæœçš„é—œè¯æ€§ï¼ˆprecision, ranking, recall)</li>
</ul>
</li>
<li><code>node</code>ç›¸ç•¶æ–¼SQL Serverçš„tableï¼Œè€Œ<code>cluster</code>ç›¸ç•¶æ–¼SQL Serverçš„serversï¼Œé€™ç¨®èªªæ³•å°å—ï¼Ÿ
<ul>
<li>è˜‹æœä¸èƒ½è·Ÿæ©˜å­ç›¸æ¯”</li>
</ul>
</li>
<li>Nodesæœƒç”¨cacheæ‰¾è¢«ä¹‹å‰ æœå°‹çš„æ•¸æ“šå—ï¼Ÿ
<ul>
<li>Yes, node use cache at the level of ElasticSearch and operating system, so that you could retrieve information faster.</li>
</ul>
</li>
<li>å¦‚ä½•åœ¨ä¸€å€‹nodeè£¡é¢åšshardingåˆ†ç‰‡åŒ–ï¼Ÿ
<ul>
<li>ä¸å»ºè­°ä½¿ç”¨ï¼Œå› ç‚ºå¦‚æœé€™å€‹nodeæœ‰å•é¡Œï¼Œé‚£dataå°±æ°¸é æ¶ˆå¤±äº†ï¼Œè€Œä¸”æŠŠè³‡æ–™shardingåœ¨ä¸åŒçš„nodesæ‰æœ‰åŠ©æ–¼å¹³è¡ŒåŒ–æœå°‹è³‡æ–™</li>
</ul>
</li>
<li>ä½¿ç”¨ElasticSearchçš„ç¼ºé»
<ul>
<li>ä¸æ”¯æŒjoinsã€transactions</li>
</ul>
</li>
<li>å…¶å®ƒå•é¡Œï¼Œ<a href="https://discuss.elastic.co/" target="_blank" rel="noopener noreffer ">discuss_elastic_co</a> æ‡‰è©²éƒ½æ‰¾å¾—åˆ°è§£ç­”</li>
<li><code>:9200</code>(ElasticSearch) ä»¥åŠ <code>:5601</code>(Kibana)ï¼Œæœ‰æ”¯æ´Authentication/ tokens å—ï¼Ÿ
<ul>
<li>æœ‰ï½ï½ï½å®˜æ–¹æœ‰ç›¸é—œguideï¼Œè«‹æœå°‹ä»¥ä¸‹é—œéµå­—
<ul>
<li>secure-cluster, encrypting-communications, setting-up-authentication</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="part-26-æœå°‹çš„é—œè¯æ€§">Part 2/6 æœå°‹çš„é—œè¯æ€§</h2>
<ul>
<li>
<p>å¦‚ä½•é‡æ¸¬é—œè¯æ€§ï¼ŸPrecision + Recall</p>
</li>
<li>
<p>ç•¶ä½ å‚³é€search queryè‡³ElasticSearchï¼Œå®ƒæœƒå›å‚³å®ƒèªç‚ºæœ‰é—œè¯æ€§çš„documents</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/MviYIa2.png"
        data-srcset="https://i.imgur.com/MviYIa2.png, https://i.imgur.com/MviYIa2.png 1.5x, https://i.imgur.com/MviYIa2.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/MviYIa2.png"
        title="image-20240128115200212" /></p>
<ul>
<li>green dots: true positives
<ul>
<li>relevant documents that are returned to the user</li>
</ul>
</li>
<li>red dots: false positives
<ul>
<li>irrelevant documents that are returned to the user</li>
</ul>
</li>
<li>gray dots: true negatives
<ul>
<li>irrelevant documents that are NOT returned to the user</li>
</ul>
</li>
<li>magenta dots: false negatives
<ul>
<li>relevant documents that were not returned to the user</li>
</ul>
</li>
<li>Precisionå…¬å¼</li>
</ul>
<p>$$
Precision = \frac{True:positives}{True:positives + \textcolor{orange}{False:positives}}
$$</p>
<ul>
<li>Recallå…¬å¼</li>
</ul>
<p>$$
Recall = \frac{True:positives}{True:positives + \textcolor{magenta}{False:negatives}}
$$</p>
<ul>
<li>
<p>Precision èˆ‡ Recall æ˜¯è² ç›¸é—œçš„</p>
<ul>
<li>Precision: å›å‚³çš„å€¼éƒ½å¿…é ˆå®Œç¾åŒ¹é…æ–¼æœå°‹æ¢ä»¶ï¼Œå³ä½¿å›å‚³çš„documentæ•¸é‡è¼ƒå°‘</li>
<li>Recall: è¦å–å¾—æ¯”è¼ƒå¤šçš„å›å‚³å€¼ï¼Œå³ä½¿å›å‚³çš„documentsä¸ä¸€å®šæ˜¯å®Œç¾åŒ¹é…</li>
</ul>
</li>
<li>
<p>Precision and recall determine which documents are included in the search results.</p>
</li>
<li>
<p>Precision and recall do not determine which of the returned documents are more relevant compared to the others.</p>
</li>
</ul>
</li>
<li>
<p>å›å‚³æ–‡ä»¶é›†ä¹‹é–“çš„é—œè¯æ€§æ’åºï¼šRanking</p>
<ul>
<li>Ranking refers to ordering of the results (from  most relevant result at the top, to least relevant at the bottom)</li>
</ul>
</li>
<li>
<p>Scoreåˆæ˜¯ä»€éº¼</p>
<ul>
<li>ä»£è¡¨è©²æ–‡ä»¶å°æ­¤æŸ¥è©¢æ¢ä»¶ç›¸é—œæ€§å¤šé«˜çš„å€¼</li>
<li>A score is computed for each document that is a <code>hit</code></li>
<li><code>hit</code>:å‚³é€è‡³userçš„æœå°‹çµæœ</li>
</ul>
</li>
<li>
<p>è¨ˆç®—document scoreçš„å› å­</p>
<ul>
<li>Term Frequency (TF)</li>
<li>Inverse Document Frequency (IDF)</li>
</ul>
</li>
<li>
<p>Term Frequency (TF) determines how many times each search term appears in a document</p>
<ul>
<li>If search terms are found in high frequency in a document, the document is considered more relevant to this search query.</li>
<li>å‡è¨­ä¸€å€‹Search Query æ˜¯ <code>How to train dragons</code>ï¼Œå°±æœƒæœ‰å››å€‹Search Termsã€‚ElasticSearchæœƒæŸ¥çœ‹æ•´ä»½documentï¼Œè¨ˆç®—Search Termsåœ¨documentså‡ºç¾çš„æ¬¡æ•¸</li>
</ul>
</li>
<li>
<p>Inverse Document Frequency diminishes the weight of terms that occur very frequently in the document set and increases the weight of terms that occur rarely!</p>
<ul>
<li>æœå°‹çµæœ Hits å¯èƒ½æœƒå¾—åˆ°å¾ˆå¤š<code>How to train puppy</code>, <code>How to train machine</code>, <code>How to train students</code>, &hellip; etc. ä¹‹é¡çš„çµæœï¼Œä½†é€™äº›éƒ½è·Ÿ <code>How to train dragons</code>æ²’æœ‰é—œä¿‚</li>
</ul>
</li>
<li>
<p>Find datasets to work with:</p>
<p><a href="https://www.kaggle.com/datasets" target="_blank" rel="noopener noreffer ">https://www.kaggle.com/datasets</a></p>
</li>
</ul>
<h3 id="syntax">Syntax</h3>
<ol>
<li>
<p>Retrieve all document from an index</p>
<ul>
<li>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_the_index_here}/_search
</code></pre></li>
<li>
<p>Example</p>
<pre tabindex="0"><code>GET anime_tv_shows/_search
</code></pre></li>
<li>
<p>å¦‚æœdatasetéå¸¸å¤§ï¼Œelasticsearchæœƒé™åˆ¶total valueç‚º10,000ç­†</p>
</li>
<li>
<p>å¦‚ä½•çŸ¥é“total valueæ˜¯å¦ç‚ºå¯¦éš›å€¼ï¼Ÿè¦çœ‹total relation</p>
<ul>
<li><code>&quot;relation&quot;: &quot;gte&quot;</code> greater than or equal to 10,000</li>
<li><code>&quot;relation&quot;: &quot;eq&quot;</code> the value is equal to the total number of hits</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/vax8q8T.png"
        data-srcset="https://i.imgur.com/vax8q8T.png, https://i.imgur.com/vax8q8T.png 1.5x, https://i.imgur.com/vax8q8T.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/vax8q8T.png"
        title="image-20240128162436889" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/mJI1JAP.png"
        data-srcset="https://i.imgur.com/mJI1JAP.png, https://i.imgur.com/mJI1JAP.png 1.5x, https://i.imgur.com/mJI1JAP.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/mJI1JAP.png"
        title="image-20240128164036840" /></p>
<ul>
<li><code>&quot;hits&quot;</code>: [] é è¨­æä¾›åç­†sample search results</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Get total hits</p>
<ul>
<li>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_the_index_here}/_search
{
    &#34;track_total_hits&#34;: true
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/F2HqONx.png"
        data-srcset="https://i.imgur.com/F2HqONx.png, https://i.imgur.com/F2HqONx.png 1.5x, https://i.imgur.com/F2HqONx.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/F2HqONx.png"
        title="image-20240128163222326" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/w2TMTzk.png"
        data-srcset="https://i.imgur.com/w2TMTzk.png, https://i.imgur.com/w2TMTzk.png 1.5x, https://i.imgur.com/w2TMTzk.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/w2TMTzk.png"
        title="image-20240128164110733" /></p>
</li>
</ul>
</li>
<li>
<p>Search for data within specific time range</p>
<ul>
<li>
<p>ElasticSearchæœå°‹æœ‰å…©ç¨®ä¸»è¦æ–¹å¼ï¼šquery &amp; aggregation</p>
<ul>
<li>Query: å–å¾—ç¬¦åˆcriteriaçš„documents</li>
<li>Aggregation:</li>
</ul>
</li>
<li>
<p>Syntax &hellip; Query</p>
<pre tabindex="0"><code>GET {enter_name_of_the_intex_here}/_search
{
  &#34;query&#34;: {
    &#34;Specify the type of query here&#34;: {
      &#34;Enter name of the field here&#34;: {
        &#34;gte&#34;: &#34;Enter lowest value of the range here&#34;,
        &#34;lte&#34;: &#34;Enter highest value of the range here&#34;
      }
    }
  }
}
</code></pre></li>
<li>
<p>Example &hellip; Query</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/B8mW4TS.png"
        data-srcset="https://i.imgur.com/B8mW4TS.png, https://i.imgur.com/B8mW4TS.png 1.5x, https://i.imgur.com/B8mW4TS.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/B8mW4TS.png"
        title="image-20240128165927972" /></p>
</li>
<li>
<p>Syntax &hellip; Aggregations</p>
<pre tabindex="0"><code>GET {enter_name_of_the_index_here}/_search
{
  &#34;aggs&#34;: {
    &#34;name your aggregation here&#34;: {
      &#34;specify aggregation type here&#34;: {
        &#34;field&#34;: &#34;name the field you want to aggregate&#34;,
        &#34;size&#34;: &#34;state how many buckets you want to retrieve&#34;
      }
    }
  }
}
</code></pre></li>
<li>
<p>Example &hellip; Aggregations</p>
<ol>
<li>
<p>æ”¶åˆ<code>&quot;hits&quot;: [...]</code> ä¹‹å¾Œå°±èƒ½çœ‹åˆ°èšåˆæœå°‹çµæœ</p>
<pre tabindex="0"><code>GET news_headlines/_search
{
  &#34;aggs&#34;: {
    &#34;by_category&#34;: {
      &#34;terms&#34;: {
        &#34;field&#34;: &#34;category&#34;,
        &#34;size&#34;: 100
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/AIbcw1y.png"
        data-srcset="https://i.imgur.com/AIbcw1y.png, https://i.imgur.com/AIbcw1y.png 1.5x, https://i.imgur.com/AIbcw1y.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/AIbcw1y.png"
        title="image-20240128172158732" /></p>
<p><code>aggs</code> or <code>aggregations</code></p>
<pre tabindex="0"><code>GET news_headlines/_search
{
  &#34;aggregations&#34;: {
    &#34;by_category&#34;: {
      &#34;terms&#34;: {
        &#34;field&#34;: &#34;category&#34;,
        &#34;size&#34;: 100
      }
    }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/sSLZaMB.png"
        data-srcset="https://i.imgur.com/sSLZaMB.png, https://i.imgur.com/sSLZaMB.png 1.5x, https://i.imgur.com/sSLZaMB.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/sSLZaMB.png"
        title="image-20240129103745319" /></p>
</li>
<li>
<p>æ‰¾å‡ºentertainmenté¡åˆ¥ä¸­ï¼Œæœ€ç†±é–€çš„topics</p>
<pre tabindex="0"><code>GET news_headlines/_search
{
  &#34;query&#34;: {
    &#34;match&#34;: { &#34;category&#34;: &#34;ENTERTAINMENT&#34; }
  },
  &#34;aggregations&#34;: {
    &#34;popular_in_entertainment&#34;: {
      &#34;significant_text&#34;: { &#34;field&#34;: &#34;headline&#34; }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/jvYYGQq.png"
        data-srcset="https://i.imgur.com/jvYYGQq.png, https://i.imgur.com/jvYYGQq.png 1.5x, https://i.imgur.com/jvYYGQq.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/jvYYGQq.png"
        title="image-20240128172755896" /></p>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p>Precision and Recall</p>
<ul>
<li>
<p>Increasing Recall</p>
<ul>
<li>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_the_index_here}/_search
{
  &#34;query&#34;: {
    &#34;match&#34;: {
      &#34;Specify the field you want to search&#34;: {
        &#34;query&#34;: &#34;Enter search terms&#34;
      }
    }
  }
}
</code></pre></li>
<li>
<p>Example</p>
<ul>
<li>Note: ä»¥ä¸‹é€™å››å€‹ search terms é è¨­æ˜¯ä½¿ç”¨<code>OR</code>é‚è¼¯ï¼Œæ‰€ä»¥å¦‚æœä¸€ä»½documentåªåŒ…å«å…¶ä¸­ä¸€å€‹ search termï¼Œä¹Ÿæœƒè¢«ç®—åœ¨hitæ¸…å–®ä¸­</li>
<li>OR logicå…·æœ‰ high recall ç‰¹æ€§ï¼šé—œè¯æ€§è¼ƒä½çš„hitså¢åŠ </li>
</ul>
<pre tabindex="0"><code>GET news_headlines/_search
{
  &#34;query&#34;: {
    &#34;match&#34;: {
      &#34;headline&#34;: {
        &#34;query&#34;: &#34;Khloe Kardashian Kendall Jenner&#34;
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/v1wOHI2.png"
        data-srcset="https://i.imgur.com/v1wOHI2.png, https://i.imgur.com/v1wOHI2.png 1.5x, https://i.imgur.com/v1wOHI2.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/v1wOHI2.png"
        title="image-20240128181334483" /></p>
</li>
</ul>
</li>
<li>
<p>Increasing Precision</p>
<ul>
<li>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;query&#34;: {
    &#34;match&#34;: {
      &#34;Specify the field you want to search&#34;: {
        &#34;query&#34;: &#34;Enter search terms&#34;,
        &#34;operator&#34;: &#34;and&#34;
      }
    }
  }
}
</code></pre></li>
<li>
<p>Example</p>
<pre tabindex="0"><code>GET news_headlines/_search
{
  &#34;query&#34;: {
    &#34;match&#34;: {
      &#34;headline&#34;: {
        &#34;query&#34;: &#34;Khloe Kardashian Kendall Jenner&#34;,
        &#34;operator&#34;: &#34;and&#34;
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/Ra8qKjP.png"
        data-srcset="https://i.imgur.com/Ra8qKjP.png, https://i.imgur.com/Ra8qKjP.png 1.5x, https://i.imgur.com/Ra8qKjP.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/Ra8qKjP.png"
        title="And_Operator" /></p>
</li>
</ul>
</li>
<li>
<p>minimum_should_match</p>
<ul>
<li>Specifying the minimum number of terms a document should have to be included in the search results</li>
<li>Giving you more control over fine tuning precision and recall off your search</li>
</ul>
<p>Syntax:</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;query&#34;: {
    &#34;match&#34;: {
      &#34;Specify the field you want to search&#34;: {
        &#34;query&#34;: &#34;Enter search terms&#34;,
        &#34;minimum_should_match&#34;: Enter a number here
      }
    }
  }
}
</code></pre></li>
</ul>
</li>
<li>
<p>Combine several different queries to sort the results:</p>
<ul>
<li>
<p>Syntax of <strong>Bool query</strong></p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;query&#34;: {
    &#34;must&#34;: [
      {}
    ],
    &#34;must_not&#34;: [
      {}
    ],
    &#34;should&#34;: [
      {}
    ],
    &#34;filter&#34;: [
      {}
    ]
  }
}
</code></pre></li>
</ul>
</li>
<li>
<p>åˆªé™¤å·²ç¶“åŠ å…¥çš„ index dataset</p>
<ol>
<li>
<p>é¦–å…ˆè¦ <code>DELETE {enter_name_of_index_here}</code>ï¼Œæœƒå›å‚³true</p>
</li>
<li>
<p>æ¥è‘—é©—è­‰ï¼Œè¼¸å…¥<code>GET {enter_name_of_index_here}/_search</code>ï¼Œå¦‚æœä¸Šå€‹æ­¥é©Ÿæœ‰åˆªé™¤æˆåŠŸï¼Œæ‡‰è©²æœƒçœ‹åˆ° &ldquo;index_not_found_exception&rdquo;</p>
</li>
<li>
<p>åˆªé™¤å…ˆå‰å­˜åœ¨çš„ index pattern</p>
<p><code>â‰¡</code> â¡ï¸ HOME â¡ï¸ Stack Management â¡ï¸ Index Management</p>
</li>
<li>
<p>å¦å¤–ä¹Ÿè¦åˆªé™¤ existed data viewï¼Œä¸ç„¶åœ¨ä¸Šå‚³æ™‚æœƒæ‹‹å‡º<code>DuplicateDataViewError</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/O3cF8lB.png"
        data-srcset="https://i.imgur.com/O3cF8lB.png, https://i.imgur.com/O3cF8lB.png 1.5x, https://i.imgur.com/O3cF8lB.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/O3cF8lB.png"
        title="image-20240129174657679" /></p>
</li>
</ol>
</li>
</ol>
<h2 id="part-36--å…¨æ–‡æª¢ç´¢">Part 3/6  å…¨æ–‡æª¢ç´¢</h2>
<ol>
<li>
<p>åŒ¹é…ç‰‡èªæœå°‹ - <code>match_phrase query</code></p>
<p>Syntax</p>
<pre tabindex="0"><code>GET Enter_the_name_of_the_index_here/_search
{
  &#34;query&#34;: {
    &#34;match_phrase&#34;: {
      &#34;Specify the field u want to search over&#34;: &#34;Enter the phrase u are searching for&#34;
    }
  }
}
</code></pre><p>Example</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/KtbxfZU.png"
        data-srcset="https://i.imgur.com/KtbxfZU.png, https://i.imgur.com/KtbxfZU.png 1.5x, https://i.imgur.com/KtbxfZU.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/KtbxfZU.png"
        title="image-20240129103013654" /></p>
<ul>
<li>&ldquo;match&rdquo;  shape of you   â¡ï¸  è¶…éä¸€è¬ç­†ï¼Œåªè¦åŒ…å« shape æˆ– of æˆ– you çš†åˆ—å…¥</li>
<li>&ldquo;match&rdquo; shape of you + &ldquo;operator&rdquo;: &ldquo;and&rdquo; â¡ï¸ 3ç­† + å…©ç­†&quot;shape of you<strong>r</strong> &hellip;&quot;</li>
<li>&ldquo;match_phrase&rdquo;: 3ç­†</li>
</ul>
</li>
<li>
<p>å¤šå€‹åŒ¹é…æ¢ä»¶</p>
<ul>
<li>userå¯èƒ½æœƒæŸ¥è©¢ç”±Michelle Obamaæ’°å¯«çš„æ–‡ç« ã€æˆ–è€…é—œæ–¼Michelle Obamaçš„æ–‡ç« ï¼Œå¯ä»¥é€éå¾å¤šå€‹ fields æŸ¥è©¢ä¾†å®Œæˆ</li>
<li>é€™é¡queryæœƒå†æ¯å€‹fieldæœå°‹ç¬¦åˆæ¢ä»¶çš„documentï¼Œçµ¦æ¯å€‹fieldè¨ˆç®—score</li>
</ul>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;query&#34;: {
    &#34;multi_match&#34;: {
      &#34;query&#34;: &#34;Enter search terms here&#34;,
      &#34;fields&#34;: [
        &#34;List the field u want to search over&#34;,
        &#34;List the field u want to search over&#34;,
        &#34;List the field u want to search over&#34;
      ]
    }
  }
}
</code></pre><p>Example</p>
<pre tabindex="0"><code>GET news_headlines/_search
{
  &#34;query&#34;: {
    &#34;multi_match&#34;: {
      &#34;query&#34;: &#34;Michelle Obama&#34;,
      &#34;fields&#34;: [
        &#34;headline&#34;,
        &#34;short_description&#34;,
        &#34;authors&#34;
      ]
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/ITHsrrv.png"
        data-srcset="https://i.imgur.com/ITHsrrv.png, https://i.imgur.com/ITHsrrv.png 1.5x, https://i.imgur.com/ITHsrrv.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/ITHsrrv.png"
        title="image-20240129112821717" /></p>
</li>
<li>
<p>å¤šå€‹åŒ¹é…æ¢ä»¶_çµ¦ç‰¹å®šfieldåŠ æ¬Š</p>
<p>Syntax:</p>
<ul>
<li><code>^number</code> ä½¿ç”¨ carat ç¬¦è™ŸåŠ å¼·æ¬Šé‡ï¼Œå¢é€²ç²¾ç¢ºåº¦</li>
</ul>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;query&#34;: {
    &#34;multi_match&#34;: {
      &#34;query&#34;: &#34;Enter search terms here&#34;,
      &#34;fields&#34;: [
        &#34;List the field u want to search over^2&#34;,
        &#34;List the field u want to search over&#34;,
        &#34;List the field u want to search over&#34;
      ]
    }
  }
}
</code></pre><p>Example:</p>
<ul>
<li>å¯ä»¥çœ‹åˆ°æœå°‹çµæœæ¯”æ•¸é‚„æ˜¯ä¸€æ¨£ï¼Œä½†rankingæ”¹è®Šäº†</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/JK4pUHT.png"
        data-srcset="https://i.imgur.com/JK4pUHT.png, https://i.imgur.com/JK4pUHT.png 1.5x, https://i.imgur.com/JK4pUHT.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/JK4pUHT.png"
        title="image-20240129113252327" /></p>
</li>
<li>
<p>å¤šå€‹åŒ¹é…æ¢ä»¶ - æŸ¥è©¢ç‰‡èªä¸¦æ”¹å–„å…¶ç²¾æº–åº¦</p>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;query&#34;: {
    &#34;multi_match&#34;: {
      &#34;query&#34;: &#34;Enter search phrase&#34;,
      &#34;fields&#34;: [
        &#34;List the field u want to boost^2&#34;,
        &#34;List the field u want to search over&#34;,
        &#34;List the field u want to search over&#34;
      ],
      &#34;type&#34;: &#34;phrase&#34;
    }
  }
}
</code></pre><p>Example</p>
<pre tabindex="0"><code>GET news_headlines/_search
{
  &#34;query&#34;: {
    &#34;multi_match&#34;: {
      &#34;query&#34;: &#34;party planning&#34;,
      &#34;fields&#34;: [
        &#34;headline^2&#34;,
        &#34;short_description&#34;
      ],
      &#34;type&#34;: &#34;phrase&#34;
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/NRVzKZE.png"
        data-srcset="https://i.imgur.com/NRVzKZE.png, https://i.imgur.com/NRVzKZE.png 1.5x, https://i.imgur.com/NRVzKZE.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/NRVzKZE.png"
        title="image-20240129113956270" /></p>
</li>
<li>
<p>åˆä½µ Queries</p>
<ul>
<li>userå¯èƒ½æœƒè©¢å•å¤šé¢å‘å•é¡Œ (multi-faceted question)ï¼Œéœ€è¦multiple queries</li>
<li>ä¾‹ï¼šæŸ¥è©¢é—œæ–¼Michelle Obamaæ”¿æ²»æ–¹é¢çš„ã€2016å¹´ä»¥å‰ç™¼ä½ˆçš„æ–‡ç« </li>
</ul>
<p><strong>Bool query</strong></p>
<ul>
<li>
<p>SYNTAX</p>
<p>must: æ‡‰å¾µè€…<strong>å¿…å‚™</strong>æ¢ä»¶  (e.g. æœ‰å…©å¹´é‡‘èç§‘æŠ€ç›¸é—œå·¥ä½œç¶“é©—)</p>
<p>must not: ç¬¦åˆæ­¤æ¬„æ‰€è¿°æ¢ä»¶çš„æ‡‰å¾µè€…æœƒè¢«ç¯©é™¤ (e.g. éè³‡è¨Šç›¸é—œç§‘ç³»)</p>
<p>should: æ‡‰å¾µè€…<strong>åŠ åˆ†</strong>æ¢ä»¶ (e.g. å°é«˜ä½µç™¼ã€å¾®æœå‹™ã€åˆ†ä½ˆå¼æ¶æ§‹æœ‰æ˜ç¢ºç†è§£)</p>
<p>filter: <strong>æ˜¯å¦</strong>ç¬¦åˆæŸç‰¹å®šæ¢ä»¶ (e.g. ä½åœ¨èˆ‡å…¬å¸åœ°å€åŒç¸£å¸‚å€åŸŸ)</p>
<pre tabindex="0"><code>GET {name_of_index}/_search
{
  &#34;query&#34;: {
    &#34;bool&#34;: {
      &#34;must&#34;: [
        {One or more queries can be specified here...}
      ],
      &#34;must_not&#34;: [
        {A document must NOT match any of the quereies ...}
      ],
      &#34;should&#34;: [
        {A document does not have to match any queries ...}
      ],
      &#34;filter&#34;: [
        {These filters(queries) place documents in element}
      ]
    }
  }
}
</code></pre></li>
<li>
<p>Example</p>
<ul>
<li>
<p>Must + Must Not</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/WpaAwJQ.png"
        data-srcset="https://i.imgur.com/WpaAwJQ.png, https://i.imgur.com/WpaAwJQ.png 1.5x, https://i.imgur.com/WpaAwJQ.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/WpaAwJQ.png"
        title="image-20240129120518694" /></p>
</li>
<li>
<p>Must + Should</p>
<p>äºŒæœˆæ˜¯BlackHistoryMonthï¼Œuseræ›´æƒ³çœ‹åˆ°black voicesç›¸é—œçš„documentsã€‚é€™æ¨£çš„é…ç½®æœƒçµ¦ç¬¦åˆ should æ¢ä»¶çš„ documents æ¯”è¼ƒé«˜çš„ scoreï¼Œdocument é¡¯ç¤ºä¸Šçš„æ’åºä¹Ÿæ¯”è¼ƒé å‰ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/UIvEF10.png"
        data-srcset="https://i.imgur.com/UIvEF10.png, https://i.imgur.com/UIvEF10.png 1.5x, https://i.imgur.com/UIvEF10.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/UIvEF10.png"
        title="image-20240129120634990" /></p>
</li>
<li>
<p>Must + Filter</p>
<p>å°‡documentsäºŒåˆ†æ³•ï¼Œä¾‹å¦‚ç¬¦åˆæŸæ®µæ™‚é–“å…§çš„ç‚ºtrueï¼Œå…¶é¤˜ç‚ºfalseã€‚filter å­å¥çš„æœå°‹çµæœåªåŒ…å« yes category çš„ documentsã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/9Hxr8nD.png"
        data-srcset="https://i.imgur.com/9Hxr8nD.png, https://i.imgur.com/9Hxr8nD.png 1.5x, https://i.imgur.com/9Hxr8nD.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/9Hxr8nD.png"
        title="image-20240129121331309" /></p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="part-46-aggregations">Part 4/6 Aggregations</h2>
<ol>
<li>Metric aggregations</li>
<li>Bucket aggregations</li>
<li>Combined aggregations</li>
</ol>
<p>å°‡ä½ çš„è³‡æ–™æ¦‚æ‹¬æˆmetrics, statistics, æˆ–å…¶å®ƒ analytics</p>
<h4 id="aggregations-request">Aggregations Request</h4>
<ul>
<li>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;aggs&#34;: {
    &#34;Name your aggregations here&#34;: {
      &#34;Specify the aggregation type here&#34;: {
        &#34;field&#34;: &#34;Name the field u want to aggregate on&#34;
      }
    }
  }
}
</code></pre></li>
<li>
<p>Metrics Aggregation: æ ¹æ“šè³‡æ–™é›†è¨ˆç®—å‡ºæ•¸å€¼ï¼Œé‹ç”¨<code>sum</code>, <code>min</code>, <code>max</code>, <code>avg</code>, unique count(<code>cardinality</code>) ç­‰ç­‰</p>
<p>Syntax &mdash; SUM</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;aggs&#34;: {
    &#34;Name your aggregations here&#34;: {
      &#34;sum&#34;: {
        &#34;field&#34;: &#34;name the field you want to aggregate on&#34;
      }
    }
  }
}
</code></pre><p>Example &mdash; æŸ¥çœ‹ <code>aggregations</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/DrSIWYI.png"
        data-srcset="https://i.imgur.com/DrSIWYI.png, https://i.imgur.com/DrSIWYI.png 1.5x, https://i.imgur.com/DrSIWYI.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/DrSIWYI.png"
        title="image-20240129153518448" /></p>
</li>
<li>
<p>Metrics Aggregation &mdash; SUM + ä½¿ç”¨sizeåƒæ•¸</p>
<p>Syntax</p>
<ul>
<li><code>&quot;size&quot;: 0</code> å‘Šè¨´ELSä¸ç”¨å–å¾—å‰10å¤§hitsçµæœäº† (åƒä¸Šåœ–å³å´ line 16 ~ line 157)</li>
</ul>
<pre tabindex="0"><code>GET ecommerce_data/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;sum_unit_price&#34;: {
      &#34;sum&#34;: {
        &#34;field&#34;: &#34;UnitPrice&#34;
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/834SeCa.png"
        data-srcset="https://i.imgur.com/834SeCa.png, https://i.imgur.com/834SeCa.png 1.5x, https://i.imgur.com/834SeCa.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/834SeCa.png"
        title="image-20240129154045784" /></p>
</li>
<li>
<p>Metrics Aggregationï¼šè¨ˆç®—æœ€ä½unit price <code>min</code></p>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;Name your aggregations here&#34;: {
      &#34;min&#34;: {
        &#34;field&#34;: &#34;Name the field u want to aggregate on&#34;
      }
    }
  }
}
</code></pre><p>Example</p>
<pre tabindex="0"><code>GET ecommerce_data/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;lowest_unit_price&#34;: {
      &#34;min&#34;: {
        &#34;field&#34;: &#34;UnitPrice&#34;
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/Vr5ORAz.png"
        data-srcset="https://i.imgur.com/Vr5ORAz.png, https://i.imgur.com/Vr5ORAz.png 1.5x, https://i.imgur.com/Vr5ORAz.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/Vr5ORAz.png"
        title="image-20240129154428170" /></p>
</li>
<li>
<p>Metrics Aggregationï¼šè¨ˆç®—æœ€é«˜unit price <code>max</code></p>
<p>ç›´æ¥ä¸Š Example</p>
<pre tabindex="0"><code>GET ecommerce_data/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;highest_unit_price&#34;: {
      &#34;max&#34;: {
        &#34;field&#34;: &#34;UnitPrice&#34;
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/bptBN8N.png"
        data-srcset="https://i.imgur.com/bptBN8N.png, https://i.imgur.com/bptBN8N.png 1.5x, https://i.imgur.com/bptBN8N.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/bptBN8N.png"
        title="image-20240129154613476" /></p>
</li>
<li>
<p>ä¸€æ¬¡å¾—åˆ°ä¸Šé¢æ‰€åˆ—çš„metrics aggs &mdash; <strong>Stats Aggregation</strong></p>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;Name your aggregations here&#34;: {
      &#34;stats&#34;: {
        &#34;field&#34;: &#34;Name the field u want to aggregate on&#34;
      }
    }
  }
}
</code></pre><p>Example</p>
<pre tabindex="0"><code>GET ecommerce_data/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;all_stats_unit_price&#34;: {
      &#34;stats&#34;: {
        &#34;field&#34;: &#34;UnitPrice&#34;
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/KNzZIFV.png"
        data-srcset="https://i.imgur.com/KNzZIFV.png, https://i.imgur.com/KNzZIFV.png 1.5x, https://i.imgur.com/KNzZIFV.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/KNzZIFV.png"
        title="image-20240129154925916" /></p>
<ul>
<li><code>count</code>: aggregationåŸ·è¡Œçš„è³‡æ–™ç­†æ•¸</li>
<li>æœ€ä½å–®åƒ¹ã€æœ€é«˜å–®åƒ¹ã€å¹³å‡å–®åƒ¹ã€å–®åƒ¹åŠ ç¸½</li>
</ul>
</li>
<li>
<p><strong>Cardinality Aggregations</strong></p>
<ul>
<li>
<p>æ‡‰ç”¨å ´æ™¯ï¼šyou want the number of unique customers who bough from our app</p>
</li>
<li>
<p>the cardinality aggregation computes the count of unique values for a given field</p>
<p>ç”¨é€”ï¼šç”¨ä¾†è¨ˆç®—æŸä¸€å€‹æ¬„ä½çš„å”¯ä¸€å€¼æ•¸é‡</p>
</li>
<li>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;name ur aggregations here&#34;: {
      &#34;cardinality&#34;: {
        &#34;field&#34;: &#34;name the field u want to aggregate on&#34;
      }
    }
  }
}
</code></pre></li>
<li>
<p>Example</p>
<pre tabindex="0"><code>GET ecommerce_data/_search
{
  &#34;aggs&#34;: {
    &#34;number_unique_country&#34;: {
      &#34;cardinality&#34;: {
        &#34;field&#34;: &#34;Country&#34;
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/D75I861.png"
        data-srcset="https://i.imgur.com/D75I861.png, https://i.imgur.com/D75I861.png 1.5x, https://i.imgur.com/D75I861.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/D75I861.png"
        title="image-20240129160641480" /></p>
</li>
</ul>
</li>
<li>
<p>é™åˆ¶aggregationçš„ä½œç”¨åŸŸ</p>
<ul>
<li>
<p>Syntax (æ•´åˆqueryèˆ‡aggregation)</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;size&#34;: 0,
  &#34;query&#34;: {
    &#34;Enter match or match_phrase here&#34;: {
      &#34;Enter the name of the field&#34;: &#34;Enter the value you are limiting&#34;
    }
  },
  &#34;aggregations&#34;: {
    &#34;Name ur aggregations here&#34;: {
      &#34;Specify aggregations type here&#34;: {
        &#34;field&#34;: &#34;Name the field u want to aggregate here&#34;
      }
    }
  }
}
</code></pre></li>
<li>
<p>Example</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/MwbtyK1.png"
        data-srcset="https://i.imgur.com/MwbtyK1.png, https://i.imgur.com/MwbtyK1.png 1.5x, https://i.imgur.com/MwbtyK1.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/MwbtyK1.png"
        title="image-20240129161534706" /></p>
</li>
</ul>
</li>
</ul>
<h4 id="bucket-aggregation">Bucket Aggregation</h4>
<p>ä¸Šè¿°çš„ä¾‹å­æ˜¯ aggregate on ONE subject of documents (å³åªå°æ–‡ä»¶ä¸€å€‹å­é›†åšèšåˆæ•¸æ“šè™•ç†)ï¼Œå¦‚æœè¦å°æ–‡ä»¶çš„å¤šå€‹å­é›†åšè™•ç†ï¼Œå°±ä½¿ç”¨ bucket aggregation</p>
<p>ä¾‹å¦‚èªª Transactions index å¯èƒ½å°±æœƒä¾ç…§æœˆä»½ä»½æˆä¸åŒçš„ bucketsï¼Œé‚„æœ‰å…¶ä»–ä¸åŒ<code>bucket aggs</code></p>
<ol>
<li>Date Histogram Aggregation</li>
<li>Histogram Aggregation</li>
<li>Range Aggregation</li>
<li>Terms Aggregation</li>
</ol>
<h5 id="date-histogram-aggregation">Date Histogram Aggregation</h5>
<ul>
<li>
<p>æ ¹æ“šæ—¥æœŸå€é–“åšåˆ†çµ„</p>
</li>
<li>
<p>æœ‰å…©ç¨®å®šç¾©æ—¥æœŸå€é–“çš„æ–¹å¼</p>
<ol>
<li>
<p><code>Fixed_interval</code>ï¼šå€é–“å€¼æ˜¯å›ºå®šçš„å¸¸æ•¸</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;Name ur aggregations here&#34;: {
      &#34;date_histogram&#34;: {
        &#34;field&#34;: &#34;Name the field u want to aggregate on here&#34;,
        &#34;fixed_interval&#34;: &#34;Specify the interval here&#34;
      }
    }
  }
}
</code></pre><p>Example</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/II3xdia.png"
        data-srcset="https://i.imgur.com/II3xdia.png, https://i.imgur.com/II3xdia.png 1.5x, https://i.imgur.com/II3xdia.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/II3xdia.png"
        title="image-20240129175237148" /></p>
</li>
<li>
<p><code>Calendar_interval</code>ï¼š</p>
<ul>
<li>
<p>å€é–“æœƒæœ‰äº›å¾®è®ŠåŒ–ï¼Œåƒæ˜¯æ—¥å…‰ç¯€ç´„æ™‚é–“ã€å¤§å°æœˆã€leap seconds(é–ç§’)</p>
</li>
<li>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;name ur aggregations here&#34;: {
      &#34;date_histogram&#34;: {
        &#34;field&#34;: &#34;Name the field u want to aggregate on here&#34;,
        &#34;calendar_interval&#34;: &#34;Specify the interval here&#34;
      }
    }
  }
}
</code></pre><p>Example</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/WlQBgIU.png"
        data-srcset="https://i.imgur.com/WlQBgIU.png, https://i.imgur.com/WlQBgIU.png 1.5x, https://i.imgur.com/WlQBgIU.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/WlQBgIU.png"
        title="image-20240129175142547" /></p>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p>Bucket sorting for data histogram aggregation</p>
<ul>
<li>
<p>æ—¥æœŸbucketsé è¨­æ˜¯ä»¥å‡å†ªæ–¹å¼æ’åºï¼ŒåŠ å…¥<code>order</code>åƒæ•¸å¯ä»¥ä¿®æ”¹æ’åº</p>
</li>
<li>
<p>ç›´æ¥ä¸ŠExample</p>
<pre tabindex="0"><code>GET ecommerce_data/_search
{
  &#34;aggs&#34;: {
    &#34;name ur aggregations here&#34;: {
      &#34;date_histogram&#34;: {
        &#34;field&#34;: &#34;@timestamp&#34;,
        &#34;calendar_interval&#34;: &#34;1M&#34;,
        &#34;order&#34;: {
          &#34;_key&#34;: &#34;desc&#34;
        }
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/rubRPRN.png"
        data-srcset="https://i.imgur.com/rubRPRN.png, https://i.imgur.com/rubRPRN.png 1.5x, https://i.imgur.com/rubRPRN.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/rubRPRN.png"
        title="image-20240129175634473" /></p>
</li>
</ul>
</li>
</ul>
<h5 id="histogram-aggregation">Histogram Aggregation</h5>
<ul>
<li>
<p>å¯ä»¥æ ¹æ“šä»»ä½•æ•¸å€¼å€é–“ï¼ˆnumerical intervalï¼‰åˆ†æˆå¤šå€‹buckets</p>
</li>
<li>
<p>Syntax</p>
<pre tabindex="0"><code>GET {enter_name_of_index_here}/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;name your aggregrations here&#34;: {
      &#34;histogram&#34;: {
        &#34;field&#34;: &#34;name the field u want to aggregate on here&#34;,
        &#34;interval&#34;: Specify the interval here
      }
    }
  }
}
</code></pre></li>
<li>
<p>Example</p>
<pre tabindex="0"><code>GET ecommerce_data/_search
{
  &#34;size&#34;: 0,
  &#34;aggs&#34;: {
    &#34;price_interval_descending&#34;: {
      &#34;histogram&#34;: {
        &#34;field&#34;: &#34;UnitPrice&#34;,
        &#34;interval&#34;: 10
      }
    }
  }
}
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/XanOYs9.png"
        data-srcset="https://i.imgur.com/XanOYs9.png, https://i.imgur.com/XanOYs9.png 1.5x, https://i.imgur.com/XanOYs9.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/XanOYs9.png"
        title="image-20240129180547945" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/xHxpYLf.png"
        data-srcset="https://i.imgur.com/xHxpYLf.png, https://i.imgur.com/xHxpYLf.png 1.5x, https://i.imgur.com/xHxpYLf.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/xHxpYLf.png"
        title="image-20240129180349104" /></p>
</li>
</ul>
<p>Part 5/6 Mapping</p>
<p>Part 6/6 Troubleshooting errors</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-01-22</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://wysiwyz.github.io/posts/elasticsearch/" data-hashtag="ElasticSearch"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://wysiwyz.github.io/posts/elasticsearch/" data-title="Elasticsearch å¾é ­é–‹å§‹å­¸ç¿’(ELK &amp; Elastic Stack)"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/elasticsearch/">ElasticSearch</a>,&nbsp;<a href="/tags/kibana/">Kibana</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/owasp_/" class="prev" rel="prev" title="[ç­†è¨˜] OWASP API Security Top 10"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>[ç­†è¨˜] OWASP API Security Top 10</a>
            <a href="/posts/elasticcloud_onuploaddataset/" class="next" rel="next" title="[éŒ¯èª¤æ’é™¤] ElasticCloud ä¸Šå‚³typeç‚ºdateçš„csvæª”æ¡ˆ">[éŒ¯èª¤æ’é™¤] ElasticCloud ä¸Šå‚³typeç‚ºdateçš„csvæª”æ¡ˆ<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">strict with yourself; lenient with others.</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><script type="text/javascript" src="https://.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.5.0/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{"valine":{"appId":"","appKey":"","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"en","pageSize":10,"placeholder":"Your comment ...","recordIP":true,"visitor":true}},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-CCS3QPVY5N', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-CCS3QPVY5N" async></script></body>
</html>
