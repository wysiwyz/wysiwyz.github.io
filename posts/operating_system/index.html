<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta name="google-adsense-account" content="ca-pub-6504473922193740">
        <title>Operating_system - Ich bin yiwen.</title><meta name="Description" content="An ordinary space for storing and groups pieces of articles."><meta property="og:title" content="Operating_system" />
<meta property="og:description" content="01. Multiprogramming System (ä¸€ï¼‰å®šç¾©ï¼šç³»çµ±å…è¨±å¤šå€‹ jobs (processes) åŒæ™‚åŸ·è¡Œï¼Œå³æ˜¯
ä¸»è¦ç›®çš„ï¼šæé«˜CPU utilization
ä½œæ³•ï¼šé€éJob scheduling (or CPU scheduling å·¥ä½œçš„æ’ç­æˆ–è€…CPUçš„æ’ç­) æŠ€è¡“é”æˆ
e.g. ç•¶åŸ·è¡Œä¸­çš„processåœ¨waiting for I/O completedï¼Œå‰‡ OS å¯ä»¥å°‡ CPU åˆ‡æ›çµ¦å¦å¤–ä¸€å€‹ process åŸ·è¡Œï¼Œé¿å… CPU idle
å³åªè¦ç³»çµ±å…§æœ‰å¤ å¤šçš„ Jobs å­˜åœ¨ï¼Œå‰‡ CPU idle æ©Ÿæœƒä¸‹é™
(äºŒï¼‰Multiprogramming Degree
ç›¸ç•¶æ–¼ç³»çµ±å…§ä¹‹ processes æ•¸ç›®
ä¸€èˆ¬è€Œè¨€ï¼Œå¦‚æœ Degree è¶Šé«˜ï¼Œå‰‡ cpu utilization è¶Šé«˜
Note: Chapter 8 virtual memory Thrashing ä¾‹å¤–ç‹€æ³é™¤å¤–
(ä¸‰ï¼‰å¤šå€‹ processes åŒæ™‚åŸ·è¡Œä¹‹æ–¹å¼æœ‰å…©å€‹ï¼š
Concurrent execution ä¸¦è¡Œ
ä¸€é¡†CPUï¼Œå¤§å®¶è¼ªæµäº¤éŒ¯ä½¿ç”¨ï¼Œæ™šä¸Š7-8é»çµ¦P1ï¼Œåšä¸ä¸‹å»åˆ‡çµ¦å…¶ä»–çš„
Parallel execution å¹³è¡Œ
å¤šé¡†CPUæˆ–è€…å¤šæ ¸ (core) ï¼Œæ¯ä¸€å€‹å·¥ä½œéƒ½åœ¨ä¸åŒçš„cpuå¹³è¡ŒåŸ·è¡Œ
Multiprogramming è·Ÿä¸€é¡†cpuæˆ–è€…å¤šé¡†cpuç„¡é—œï¼Œå–®ä¸€ user ä¹Ÿå¯ä»¥ multiprogrammingï¼Œä¸é™å®šå¤šå€‹ usersã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://wysiwyz.github.io/posts/operating_system/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="1993-01-26T14:30:01+08:00" />
<meta property="article:modified_time" content="1993-01-26T14:30:01+08:00" /><meta property="og:site_name" content="Ich bin yiwen." />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Operating_system"/>
<meta name="twitter:description" content="01. Multiprogramming System (ä¸€ï¼‰å®šç¾©ï¼šç³»çµ±å…è¨±å¤šå€‹ jobs (processes) åŒæ™‚åŸ·è¡Œï¼Œå³æ˜¯
ä¸»è¦ç›®çš„ï¼šæé«˜CPU utilization
ä½œæ³•ï¼šé€éJob scheduling (or CPU scheduling å·¥ä½œçš„æ’ç­æˆ–è€…CPUçš„æ’ç­) æŠ€è¡“é”æˆ
e.g. ç•¶åŸ·è¡Œä¸­çš„processåœ¨waiting for I/O completedï¼Œå‰‡ OS å¯ä»¥å°‡ CPU åˆ‡æ›çµ¦å¦å¤–ä¸€å€‹ process åŸ·è¡Œï¼Œé¿å… CPU idle
å³åªè¦ç³»çµ±å…§æœ‰å¤ å¤šçš„ Jobs å­˜åœ¨ï¼Œå‰‡ CPU idle æ©Ÿæœƒä¸‹é™
(äºŒï¼‰Multiprogramming Degree
ç›¸ç•¶æ–¼ç³»çµ±å…§ä¹‹ processes æ•¸ç›®
ä¸€èˆ¬è€Œè¨€ï¼Œå¦‚æœ Degree è¶Šé«˜ï¼Œå‰‡ cpu utilization è¶Šé«˜
Note: Chapter 8 virtual memory Thrashing ä¾‹å¤–ç‹€æ³é™¤å¤–
(ä¸‰ï¼‰å¤šå€‹ processes åŒæ™‚åŸ·è¡Œä¹‹æ–¹å¼æœ‰å…©å€‹ï¼š
Concurrent execution ä¸¦è¡Œ
ä¸€é¡†CPUï¼Œå¤§å®¶è¼ªæµäº¤éŒ¯ä½¿ç”¨ï¼Œæ™šä¸Š7-8é»çµ¦P1ï¼Œåšä¸ä¸‹å»åˆ‡çµ¦å…¶ä»–çš„
Parallel execution å¹³è¡Œ
å¤šé¡†CPUæˆ–è€…å¤šæ ¸ (core) ï¼Œæ¯ä¸€å€‹å·¥ä½œéƒ½åœ¨ä¸åŒçš„cpuå¹³è¡ŒåŸ·è¡Œ
Multiprogramming è·Ÿä¸€é¡†cpuæˆ–è€…å¤šé¡†cpuç„¡é—œï¼Œå–®ä¸€ user ä¹Ÿå¯ä»¥ multiprogrammingï¼Œä¸é™å®šå¤šå€‹ usersã€‚"/>
<meta name="application-name" content="Ich bin yiwen.">
<meta name="apple-mobile-web-app-title" content="Ich bin yiwen."><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/moon_icon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://wysiwyz.github.io/posts/operating_system/" /><link rel="prev" href="http://wysiwyz.github.io/posts/direct-style/" /><link rel="next" href="http://wysiwyz.github.io/posts/algorithm/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Operating_system",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/wysiwyz.github.io\/posts\/operating_system\/"
        },"genre": "posts","keywords": "OperatingSystem","wordcount":  2841 ,
        "url": "http:\/\/wysiwyz.github.io\/posts\/operating_system\/","datePublished": "1993-01-26T14:30:01+08:00","dateModified": "1993-01-26T14:30:01+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "celine"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Ich bin yiwen.">Ich bin yiwen.</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Ich bin yiwen.">Ich bin yiwen.</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Operating_system</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>celine</a></span>&nbsp;<span class="post-category">included in <a href="/categories/studynote/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>StudyNote</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="1993-01-26">1993-01-26</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2841 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;14 minutes&nbsp;<span id="/posts/operating_system/" class="leancloud_visitors" data-flag-title="Operating_system">
                        <i class="far fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#io-é‹ä½œæ–¹å¼">I/O é‹ä½œæ–¹å¼</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#ch3-osä¹‹development">Ch3. OSä¹‹Development</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#ch4-process-management-èˆ‡-thread-management">Ch4: Process Management èˆ‡ Thread Management</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="01-multiprogramming-system">01. Multiprogramming System</h1>
<p>(ä¸€ï¼‰å®šç¾©ï¼šç³»çµ±å…è¨±å¤šå€‹ jobs (processes) åŒæ™‚åŸ·è¡Œï¼Œå³æ˜¯</p>
<p>ä¸»è¦ç›®çš„ï¼šæé«˜CPU utilization</p>
<p>ä½œæ³•ï¼šé€éJob scheduling (or CPU scheduling å·¥ä½œçš„æ’ç­æˆ–è€…CPUçš„æ’ç­) æŠ€è¡“é”æˆ</p>
<p>e.g. ç•¶åŸ·è¡Œä¸­çš„processåœ¨waiting for I/O completedï¼Œå‰‡ OS å¯ä»¥å°‡ CPU åˆ‡æ›çµ¦å¦å¤–ä¸€å€‹ process åŸ·è¡Œï¼Œé¿å… CPU idle</p>
<p>å³åªè¦ç³»çµ±å…§æœ‰å¤ å¤šçš„ Jobs å­˜åœ¨ï¼Œå‰‡ CPU idle æ©Ÿæœƒä¸‹é™</p>
<p>(äºŒï¼‰Multiprogramming Degree</p>
<p>ç›¸ç•¶æ–¼<!-- raw HTML omitted -->ç³»çµ±å…§ä¹‹ processes æ•¸ç›®<!-- raw HTML omitted --></p>
<p>ä¸€èˆ¬è€Œè¨€ï¼Œå¦‚æœ Degree è¶Šé«˜ï¼Œå‰‡ cpu utilization è¶Šé«˜</p>
<p>Note: Chapter 8 virtual memory Thrashing ä¾‹å¤–ç‹€æ³é™¤å¤–</p>
<p>(ä¸‰ï¼‰å¤šå€‹ processes åŒæ™‚åŸ·è¡Œä¹‹æ–¹å¼æœ‰å…©å€‹ï¼š</p>
<ol>
<li>
<p>Concurrent execution ä¸¦è¡Œ</p>
<p>ä¸€é¡†CPUï¼Œå¤§å®¶è¼ªæµäº¤éŒ¯ä½¿ç”¨ï¼Œæ™šä¸Š7-8é»çµ¦P1ï¼Œåšä¸ä¸‹å»åˆ‡çµ¦å…¶ä»–çš„</p>
</li>
<li>
<p>Parallel execution å¹³è¡Œ</p>
<p>å¤šé¡†CPUæˆ–è€…å¤šæ ¸ (core) ï¼Œæ¯ä¸€å€‹å·¥ä½œéƒ½åœ¨ä¸åŒçš„cpuå¹³è¡ŒåŸ·è¡Œ</p>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/JTe4SFh.png"
        data-srcset="https://i.imgur.com/JTe4SFh.png, https://i.imgur.com/JTe4SFh.png 1.5x, https://i.imgur.com/JTe4SFh.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/JTe4SFh.png"
        title="image-20240126144825311" /></p>
<blockquote>
<p>Multiprogramming è·Ÿä¸€é¡†cpuæˆ–è€…å¤šé¡†cpuç„¡é—œï¼Œå–®ä¸€ user ä¹Ÿå¯ä»¥ multiprogrammingï¼Œä¸é™å®šå¤šå€‹ usersã€‚</p>
<p>å…è¨±å¤šå€‹å·¥ä½œåŒæ™‚é€²è¡Œå°±ç¨±ç‚º multi-programmingã€‚</p>
</blockquote>
<h1 id="02-time-sharing-system-åˆ†æ™‚ç³»çµ±">02. Time-Sharing System åˆ†æ™‚ç³»çµ±</h1>
<blockquote>
<p>Time-Sharingé¨™å±€ - è®“æ¯å€‹useréƒ½ä»¥ç‚ºæœ‰ä¸€å° dedicated to myself çš„ computer</p>
</blockquote>
<p>(ä¸€ï¼‰Def: æé¾æœ¬åˆç¨±ç‚ºMultitasking</p>
<p>â€œIt&rsquo;s a logical extension of multiprogramming system.â€</p>
<p>èˆ‡Multiprogrammingçš„æœ€å¤§å·®ç•°ï¼š<strong>CPUçš„åˆ‡æ›é »ç‡æ¥µé«˜</strong> (CPU switching highly frequently)</p>
<p>Time-sharing system features é‚„æœ‰ï¼š</p>
<ol>
<li>
<p>å¼·èª¿å°userçš„response timeè¦çŸ­ï¼ˆe.g. &lt; ä¸€ç§’ï¼‰</p>
</li>
<li>
<p>é©ç”¨æ–¼ â€œuser interactiveâ€ computing/environment (ä¸€ä¾†ä¸€å¾€çš„ä½¿ç”¨è€…äº’å‹•)</p>
</li>
<li>
<p>CPU schedulingï¼ˆCPUæ’ç­ï¼‰æ¡ç”¨ RR æ’ç­æ³•å‰‡ (ch4)</p>
</li>
<li>
<p>Memoryæœ‰é™ï¼Œå¦‚ä½•è®“userè¦ºå¾—é›»è…¦éƒ½æ˜¯ä»–å€‘å°ˆå±¬ä½¿ç”¨å‘¢ï¼Ÿ</p>
<p>ä½¿ç”¨virtual memoryæŠ€è¡“ï¼Œæ“´å±• â€œlogical memory spaceâ€</p>
</li>
<li>
<p>ä½¿ç”¨â€œspoolingâ€æŠ€è¡“å¯¦ç¾I/O Devicesçš„å…±ç”¨ï¼Œ</p>
</li>
</ol>
<p><strong>Mainframe</strong>ï¼ˆä¸»æ©Ÿ, ä¾‹å¦‚IBMçš„vex360ã€vex370ï¼‰</p>
<p>éŠ€è¡Œçš„å¤–åŒ¯äº¤æ˜“ã€è²¨å¹£æº–å‚™é‡‘ã€é ç¨‹å¤–åŒ¯äº¤å‰²éƒ½åœ¨é€™ä¸Šé¢å¯¦æ–½ï¼Œå› ç‚ºé€ åƒ¹å¾ˆè²´ï¼Œæ‰€ä»¥å¸¸æœƒå¾ä¸»æ©Ÿæ‹‰çµ‚ç«¯æ©Ÿ (terminal) å‡ºä¾†ï¼Œé€šå¸¸æ˜¯terminal+keyboardå¾ˆå¤šå°</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/DdzGIP1.png"
        data-srcset="https://i.imgur.com/DdzGIP1.png, https://i.imgur.com/DdzGIP1.png 1.5x, https://i.imgur.com/DdzGIP1.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/DdzGIP1.png"
        title="image-20240126150020729" /></p>
<p>æƒæ¯’è»Ÿé«”ã€ä¸‹è¼‰éƒ½ä¸æ˜¯å±¬æ–¼ user interactive çš„æƒ…æ³</p>
<p>å› ç‚ºäº¤æ˜“è¦ç¶“éä¸€é€£ä¸²çš„äº’å‹•æ‰æœƒå®Œæˆï¼Œæ‰€ä»¥è¦æ±‚ response time çŸ­</p>
<p>RRæ’ç­å¯ä»¥è®“ cpu ä½¿ç”¨å°ä¸åŒçš„ user ä¿éšœå…¬å¹³ï¼Œä¹Ÿé€ å°±åˆ‡æ›é »ç‡é«˜</p>
<p>ä¸ç®¡ä½ ç¨‹å¼å¯«å¤šå¤§ï¼Œæˆ‘éƒ½è®“ä½ åŸ·è¡Œï¼Œé‚è¼¯çš„è¨˜æ†¶é«”ç„¡çª®å¯¬å»£</p>
<p><strong>Physical Memory</strong> (e.g. RAM) v.s. <strong>Logical Memory</strong></p>
<p>* Logical é€šå¸¸æ˜¯æŒ‡ä½¿ç”¨è€…é€™ä¸€ç«¯</p>
<p>userçœ‹è¨˜æ†¶é«” - logical memory</p>
<p>userçœ‹æª”æ¡ˆç›®éŒ„ - logical directory é‚è¼¯çš„ç›®éŒ„</p>
<p>ä½œæ¥­ç³»çµ±åœ¨ç®¡ç†æª”æ¡ˆé…ç½®çš„ç›®éŒ„ï¼Œé‚£å€‹å°±å«åšå¯¦é«”ç›®éŒ„ &hellip; (memory diskè©³è«‡)</p>
<p>Spooling - æŠŠç£ç¢Ÿç•¶æˆæ¥µå¤§çš„ç·©è¡å€ï¼Œé¡ä¼¼æ–¼ç¾åœ¨çš„ buffer æŠ€è¡“ï¼ˆå·¥ä½œåŸç†å¤§åŒå°ç•°ï¼‰</p>
<p>Spoolingç¤ºä¾‹ï¼š</p>
<ol>
<li>
<ol>
<li>userä¸‹é”åˆ—å°xxxæª”æ¡ˆçš„å‘½ä»¤</li>
</ol>
</li>
<li>
<ol start="2">
<li>æŠŠé€™å€‹æª”æ¡ˆé€åˆ°ç£ç¢Ÿdisk</li>
</ol>
</li>
<li>
<ol start="3">
<li>ç³»çµ±å‘Šè¨´ä½ åˆ—å°å®Œæˆï¼ˆäº‹å¯¦ä¸Šé‚„æ²’é–‹å§‹å°ï¼Œç³»çµ±ä¸æœƒé€šçŸ¥ä½ åœ¨queueçš„ç¬¬å¹¾é †ä½ï¼‰</li>
</ol>
</li>
<li>
<ol start="4">
<li>æ¥ä¸‹ä¾†printeræ‰ä¸€å€‹ä¸€å€‹é–‹å§‹å°</li>
</ol>
</li>
</ol>
<p>åœ¨é€™ç¨®ç’°å¢ƒè£¡é ­ï¼Œuseræœ€careçš„å°±æ˜¯å›æ‡‰æ™‚é–“ (response time)</p>
<p>å‡ä½¿ä¸€å€‹ä¸­ç¹¼çµæœä¸éœ€è¦userçš„åé¥‹ï¼Œæœ€å¥½ä¹Ÿæ˜¯è¦å›è¦†çµ¦user</p>
<p>éæœ¬ç§‘ç³»å­¸ç”Ÿç­‰å¾…æ™‚é–“å¹³å‡ä¸ƒç§’ &hellip; enter/esc/ctrl+c/ctrl+break â€¦</p>
<p>è€Œæœ¬ç§‘ç³»æ¯”è¼ƒé•·ï¼Œæœƒçµ¦ä»–è§£é‡‹çš„æ™‚é–“ &hellip; ç¶²è·¯æ“å¡ã€ä¸»æ©Ÿä»Šå¤©äº¤æ˜“å¤š &hellip;</p>
<blockquote>
<p>éŠ€è¡Œç³»çµ±å¦‚æœæ­£å¸¸è¦4ç§’é˜å›ä¾†çš„è©±</p>
<p>è¶…éä¸€èˆ¬çš„æ¨™æº–æ™‚é–“ä¹‹å¾Œå°±è¦æŠ½ä¸€å¼µè©</p>
<p>ã€ç³»çµ±æ­£åœ¨è™•ç†ä¸­ï¼Œä»Šæ—¥æ¥­å‹™ç¨å¤šï¼Œè«‹ä¸è¦ä¸­æ–· &hellip;ã€</p>
<p>ã€ä»Šæ—¥ç³»çµ±äº¤æ˜“ç•°å¸¸ç¹å¿™ï¼Œæ‚¨å¯ä»¥è€ƒæ…®å–æ¶ˆæˆ–è€…å†ç­‰å¾…ä¸€ä¸‹ï¼Œå³å°‡æœ‰çµæœ &hellip;ã€</p>
<p>ã€ä»Šæ—¥é›»ä¿¡ç¶²è·¯æ•…éšœ &hellip;ã€</p>
</blockquote>
<h1 id="03-multiprocessors-system">03. Multiprocessors system</h1>
<p>(ä¸€ï¼‰Def: åˆå« Multiprocessing system or Parallel system or Tightly-Coupled system (ç·Šå¯†è€¦åˆçš„ç³»çµ±)</p>
<p>ä¸»è¦ç‰¹å¾µ (features) å¦‚ä¸‹ï¼š</p>
<p>(1) ä¸€å€‹æ©Ÿå™¨ (or Motherboard) å…§æœ‰å¤šé¡† processors (or CPUs)</p>
<p>(2) é€™äº› CPUs å½¼æ­¤å…±äº«æ­¤æ©Ÿå™¨çš„ Memoryã€Busã€I/O-Devicesã€power-supplier, etc.</p>
<p>(3) é€šå¸¸å—åŒä¸€å€‹ clock ä¹‹æ™‚è„ˆæ§åˆ¶</p>
<p>(4) ç”± åŒä¸€å€‹ OS ç®¡ç†</p>
<p>(5) processors ä¹‹é–“çš„æºé€šå¤§éƒ½æ¡ â€œshared memoryâ€ æ–¹å¼ (ch6è©³è«‡)</p>
<p>ã€åœ–ç¤ºã€‘</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/TYVtMJa.png"
        data-srcset="https://i.imgur.com/TYVtMJa.png, https://i.imgur.com/TYVtMJa.png 1.5x, https://i.imgur.com/TYVtMJa.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/TYVtMJa.png"
        title="image-20240126150547935" /></p>
<p>(äºŒï¼‰Benefitsï¼ˆå¥½è™•ï¼‰:</p>
<p>(1) Increased Throughput ç”¢èƒ½å¢åŠ </p>
<p>(2) Increased Reliability å¯é åº¦æå‡</p>
<p>(3) Economy of Scale é‹ç®—èƒ½åŠ›æ“´å……æ™‚ç¬¦åˆç¶“æ¿Ÿæ•ˆç›Š</p>
<p><strong>ç”¢èƒ½å¢åŠ </strong>ï¼Œå¯ä»¥æ”¯æŒå¤šå€‹å·¥ä½œåœ¨ä¸åŒCPUsä¸Šå¹³è¡ŒåŸ·è¡Œ (parallel computing)</p>
<p>Note: é›–ç„¶å¯ä»¥å¢åŠ ç”¢èƒ½ï¼Œä½†Né¡†CPUsçš„ç”¢èƒ½çµ•å°å°æ–¼åŸä¾†ä¸€é¡†CPUç”¢èƒ½*Nå€</p>
<p>â€‹    åŸå› æœ‰äºŒï¼š&lt;1&gt; Resource competitionè³‡æºç«¶çˆ­ï¼Œå…©é¡†CPUç­‰ä¸€å€‹bus</p>
<p>â€‹            &lt;2&gt; Processorsä¹‹é–“çš„CommunicationæœƒæŠµéŠ·ç”¢èƒ½</p>
<p><strong>å¯é åº¦æå‡</strong>ï¼Œè¬ä¸€è‹¥æŸå€‹CPUå£äº†ï¼Œå‰‡systemä¸æœƒå› è€Œåœé “ï¼Œå› ç‚ºé‚„æœ‰å…¶å®ƒCPUsä»å¯ä»¥é‹è¡Œ</p>
<p>Note: åè©è§£é‡‹ &lt;1&gt; Graceful degradation æ¼¸é€²å¼æ»…äº¡</p>
<p>â€‹              ç³»çµ±ä¸æœƒå› ç‚ºæŸäº›HW/SWå…ƒä»¶æ•…éšœè€Œåœé “ï¼Œä»ç„¶ä¿æœ‰æŒçºŒé‹ä½œä¹‹èƒ½åŠ›ï¼Œ</p>
<p>â€‹              æ­¤æ€§è³ªç¨±ç‚º graceful degradationï¼Œåˆç¨±ç‚º Fail-Soft è»Ÿå¤±æ•—</p>
<p>â€‹           &lt;2&gt; Fault-Tolerant system å®¹éŒ¯ç³»çµ±</p>
<p>â€‹              å…·æœ‰graceful degradationæ€§è³ªçš„ç³»çµ±ï¼Œç¨±ç‚ºfault-tolerant system</p>
<p>é”æˆå®¹éŒ¯æŠ€è¡“è¦ç¬¦åˆå…©æ¢ä»¶: Backup systemç¨ç«‹ç³»çµ±&gt;=2ï½œSwitching smoothlyç„¡ç¸«å¹³ç©©åˆ‡æ›</p>
<p><strong>é‹ç®—èƒ½åŠ›ä¹‹æ“´å……ï¼Œç¬¦åˆç¶“æ¿Ÿæ•ˆç›Š</strong></p>
<p>æ¯”è¼ƒåŸºæº–ï¼šNé¡†CPUsåœ¨ä¸€éƒ¨æ©Ÿå™¨å…§ï¼Œèˆ‡Néƒ¨æ©Ÿå™¨ç›¸æ¯”ï¼Œæˆæœ¬è¼ƒç‚ºä¾¿å®œã€‚å› çˆ²é€™äº›CPUå…±äº«åŒä¸€å€‹æ©Ÿå™¨è£¡é ­çš„ Memory, Bus, I/O-Devices, etc.</p>
<p>(ä¸‰ï¼‰Multiprocessors system å¯ä»¥å†ç´°åˆ†ç‚ºå…©ç¨® subtypes</p>
<p>(1) SMP (Symmetric MultiProcessors) å°ç¨±</p>
<ul>
<li>
<p>å®šç¾©ï¼šæ¯ä¸€å€‹processorä¹‹å·¥ä½œèƒ½åŠ›æ˜¯ç›¸åŒçš„ï¼ˆidenticalï¼‰</p>
<p>æ¯ä¸€å€‹CPUçš†æœ‰å°ç­‰çš„æ¬Šåˆ©ä¾†å­˜å–è³‡æº</p>
</li>
<li>
<p>å„ªé»ï¼š1ï¸âƒ£ å¯é åº¦è¼ƒASMPé«˜      2ï¸âƒ£ æ•ˆèƒ½è¼ƒé«˜</p>
</li>
<li>
<p>ç¼ºé»ï¼šSMPçš„<!-- raw HTML omitted -->OSè¨­è¨ˆé–‹ç™¼è¼ƒç‚ºè¤‡é›œ<!-- raw HTML omitted -->ï¼Œä¾‹å¦‚äº’æ–¥å­˜å–ä¹‹æ©Ÿåˆ¶çš„è¨­è¨ˆ</p>
</li>
</ul>
<p>(2) ASMP (Asymmetric MultiProcessors) éå°ç¨±</p>
<ul>
<li>
<p>å®šç¾©ï¼šæ¯å€‹processorä¹‹å·¥ä½œèƒ½åŠ›ä¸ç›¡ç›¸åŒï¼Œé€šå¸¸æ¡å–â€œMaster-Slaveâ€æ¶æ§‹ (æé¾æœ¬: Boss-Employee)ï¼ŒMaster processor è² è²¬å·¥ä½œåˆ†æ´¾ä»¥åŠè³‡æºåˆ†é…ï¼Œç›£ç£ slaves ç­‰ç®¡ç†æ€§å·¥ä½œï¼›å…¶å®ƒ slave processor è² è²¬åŸ·è¡Œå·¥ä½œ</p>
</li>
<li>
<p>å„ªé»ï¼šASMPçš„OSè¨­è¨ˆé–‹ç™¼è¼ƒç‚ºç°¡å–®ï¼Œå› ç‚ºä»–è·Ÿsimple-CPUçš„OSç‰ˆè¼ƒç‚ºé¡ä¼¼ï¼Œé–‹ç™¼å®¹æ˜“ï¼Œæˆæœ¬è¼ƒä½</p>
</li>
<li>
<p>ç¼ºé»ï¼š1ï¸âƒ£ ç›¸è¼ƒæ–¼SMPçš„å¯é åº¦è¼ƒä½</p>
<p>â€‹              2ï¸âƒ£ æ•ˆèƒ½è¼ƒä½ï¼ˆå› ç‚ºMaster CPUæ˜¯ç“¶é ¸ï¼‰</p>
<p>å¤šå€‹slavesèˆ‡masterå„æœ‰å¤§é‡è¨Šæ¯äº¤æ›ï¼Œmasteråšæ±ºç­–ï¼Œè¡Œæ”¿æ•ˆç‡è¼ƒå·®ï¼Œå¦‚æœæ˜¯ç‚ºäº†æ¶å¸‚å ´ï¼Œé€šå¸¸æœƒå…ˆæ¨ ASMP</p>
</li>
</ul>
<p>(å››ï¼‰Multiprocessors system v.s. MultiCores CPU (å¤šæ ¸ï¼‰</p>
<ul>
<li>
<p>ä¸»è¦æ˜¯ç¡¬é«”çš„å·®ç•°ï¼›å°±OSè€Œè¨€ï¼Œæ²’æœ‰å·®ç•°</p>
</li>
<li>
<p>å°‡ä¸€å€‹Coreè¦–ç‚ºlogical CPUä¾†çœ‹å¾…</p>
</li>
<li>
<p>ä¾‹ï¼šä¸»æ©Ÿæ¿è£äº†å››é¡†é›™æ ¸çš„CPUsï¼Œå°OSè€Œè¨€ï¼Œå³æ˜¯æœ‰ 4*2 = <strong>8</strong> é¡†CPUså¯ç”¨</p>
</li>
<li>
<p>å„ªé»</p>
<p>â€§ Power saving</p>
<p>â€§ é€Ÿåº¦è¼ƒå¿«</p>
<p>(åŒä¸€å€‹æ™¶ç‰‡å…§è³‡æ–™çš„å‚³è¼¸é€Ÿåº¦)</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/EPOxKdr.png"
        data-srcset="https://i.imgur.com/EPOxKdr.png, https://i.imgur.com/EPOxKdr.png 1.5x, https://i.imgur.com/EPOxKdr.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/EPOxKdr.png"
        title="image-20240126151044539" /></p>
</li>
</ul>
<h1 id="distributed-system-åˆ†æ•£å¼ç³»çµ±">Distributed system åˆ†æ•£å¼ç³»çµ±</h1>
<p>(ä¸€ï¼‰</p>
<ul>
<li>
<p>å®šç¾©ï¼šåˆå« <!-- raw HTML omitted -->Loosely-Coupled<!-- raw HTML omitted --> system é¬†æ•£è€¦åˆ</p>
</li>
<li>
<p>ä¸»è¦ç‰¹å¾µå¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>å¤šéƒ¨æ©Ÿå™¨å½¼æ­¤é€é network (LAN, WAN, etc.)ï¼ˆor Busï¼‰ç›¸äº’ä¸²é€£</p>
</li>
<li>
<p>æ¯éƒ¨æ©Ÿå™¨ä¹‹CPUæœ‰å„è‡ªç§æœ‰çš„Memory, Bus, I/O-Devices, etc. ä¸¦éå…±äº«</p>
</li>
<li>
<p>å„å€‹CPUä¹‹clockæ™‚è„ˆæ§åˆ¶ä¸ä¸€å®šç›¸åŒ</p>
</li>
<li>
<p>å„å€‹CPUä¸Šçš„OSä¹Ÿä¸è¦‹å¾—ç›¸åŒ (ä½ Linux, æˆ‘Mac, å®ƒWindows)</p>
</li>
<li>
<p>å„å€‹processorsä¹‹é–“çš„æºé€šå¤§éƒ½æ¡ç”¨â€œ<!-- raw HTML omitted -->Message Passing<!-- raw HTML omitted -->â€æ–¹å¼</p>
<p>Step1: å»ºç«‹é€šè¨Šéˆçµ communication link</p>
<p>Step2: Message è¨Šæ¯ä¹‹é–“ç›¸äº’å‚³è¼¸</p>
<p>Step3: é‡‹æ”¾ link</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/kMYropH.png"
        data-srcset="https://i.imgur.com/kMYropH.png, https://i.imgur.com/kMYropH.png 1.5x, https://i.imgur.com/kMYropH.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/kMYropH.png"
        title="image-20240126151528731" /></p>
</li>
</ol>
</li>
</ul>
<p>(äºŒï¼‰æ§‹å»ºåˆ†æ•£å¼ç³»çµ±ä¹‹ç†ç”±ï¼ˆå¥½è™•ï¼‰</p>
<ol>
<li>
<p>Increased Throughput - å› ç‚ºå®ƒæ”¯æŒå¹³è¡Œé‹ç®— parallel computing</p>
</li>
<li>
<p>Increased Reliability</p>
</li>
<li>
<p><!-- raw HTML omitted -->Resource Sharing<!-- raw HTML omitted --> - å› ç‚ºè³‡æºå…±äº«ï¼Œå°è‡´æˆæœ¬é™ä½</p>
<ul>
<li>èªªæ˜ï¼šæ”¯æŒ â€œclient-serverâ€ computing model ä¹‹å¯¦æ–½</li>
<li>Server: æä¾›æŸäº›æœå‹™çš„æ©Ÿå™¨</li>
<li>e.g. MailServer, FileServer, Domain name server (DNS),</li>
<li>PrinterServer (æ—©æœŸ), Computing server (æä¾›é«˜é€Ÿé‹ç®—èƒ½åŠ›çš„ä¼ºæœå™¨ï¼‰</li>
<li>Client: æœ¬èº«ä¸æä¾›æœå‹™ï¼Œä¸”å®ƒéœ€è¦æŸäº›æœå‹™æ™‚ï¼Œå‰‡ç™¼è«‹æ±‚çµ¦ server</li>
<li>Serveræœå‹™å®Œï¼Œå†å°‡çµæœå‚³å›client</li>
<li>Note: â€œpeer-to-peerâ€ model  peer - åŒæ™‚å…·æœ‰ server ä»¥åŠ client çš„è§’è‰²</li>
</ul>
</li>
<li>
<p><!-- raw HTML omitted -->Remote Sites Communication<!-- raw HTML omitted --> éœ€æ±‚è¢«æ»¿è¶³</p>
<p>e.g. email, FTP via internet</p>
</li>
</ol>
<blockquote>
<p>#3 è·Ÿ #4 æ˜¯ distributed system æœ‰åˆ¥æ–¼ multiprocessor system æ“æœ‰çš„å¥½è™•</p>
</blockquote>
<h1 id="real-time-system-å³æ™‚ç³»çµ±">Real-Time System å³æ™‚ç³»çµ±</h1>
<p>(ä¸€ï¼‰åˆ†ç‚ºå…©ç¨®ï¼š</p>
<ol>
<li>Hard real time system</li>
<li>Soft real-time system</li>
</ol>
<p>(äºŒï¼‰Hard real-time system</p>
<ul>
<li>
<p>å®šç¾©ï¼šThis system must ensure the critical tasks complete on time.  å³å·¥ä½œå¿…é ˆåœ¨è¦å®šçš„æ™‚é–“é™åˆ¶å…§å®Œæˆï¼Œå¦å‰‡å³ç®—å¤±æ•—</p>
</li>
<li>
<p>èˆ‰ä¾‹ï¼šè»äº‹é˜²è¡›ç³»çµ±ã€æ ¸èƒ½å®‰æ§ç³»çµ±ã€å·¥å» è‡ªå‹•åŒ–ç”Ÿç”¢ã€æ©Ÿå™¨äººæ§åˆ¶ï¼Œç­‰ç­‰ã€‚</p>
<p>military defense, nuclear safety control, manufacturing automation, robot control</p>
</li>
</ul>
<p>ã€åœ–ç¤ºã€‘æ„Ÿæ¸¬å™¨ï¼šå£“åŠ›ã€æº«åº¦ã€ä¸€æ°§åŒ–ç¢³åµæ¸¬ã€é›·é”ã€è²ç´</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/x902W2L.png"
        data-srcset="https://i.imgur.com/x902W2L.png, https://i.imgur.com/x902W2L.png 1.5x, https://i.imgur.com/x902W2L.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/x902W2L.png"
        title="image-20240126152400575" /></p>
<h4 id="è¨­è¨ˆè€ƒé‡">è¨­è¨ˆè€ƒé‡ï¼š</h4>
<ol>
<li>
<p>æ‰€æœ‰æ™‚é–“å»¶é²ä¹‹å› ç´ çš†é ˆç´å…¥è€ƒé‡ï¼Œç¢ºä¿é€™äº›æ™‚é–“åŠ ç¸½èƒ½æ»¿è¶³ (&lt;=) æ™‚é–“deadlineè¦æ±‚</p>
<p>ä¾‹å¦‚ï¼šsensor data transmission å‚³è¼¸é€Ÿåº¦ã€é‹ç®—é€Ÿåº¦ã€signalçš„å‚³è¼¸</p>
</li>
<li>
<p>æ‰€æœ‰æœƒé€ æˆè™•ç†æ™‚é–“éä¹…æˆ–è€…ç„¡æ³•é æ¸¬ä¹‹è¨­å‚™æˆ–æ©Ÿåˆ¶ï¼Œå®œå°‘æ¡ç”¨æˆ–ä¸ç”¨</p>
<p>ä¾‹å¦‚ï¼šç£ç¢Ÿdiskå®œå°‘ç”¨æˆ–ä¸ç”¨ï¼ˆé‹ä½œé€Ÿåº¦æ¯”è¼ƒä¹…ï¼‰ã€ çµ•å°ä¸æ¡ç”¨virtual memory</p>
</li>
<li>
<p>å°± cpu scheduling è¨­è¨ˆ(ch4)è€Œè¨€ï¼Œé ˆå…ˆè€ƒé‡ schedulable èˆ‡å¦ï¼Œå†é€²è¡Œæ’ç¨‹</p>
<p>ä¾‹å¦‚ï¼šrate-monotonic, EDF scheduling (cpuæ’ç­è¨­è¨ˆåœ¨è©³è«‡ï¼‰</p>
</li>
<li>
<p>Time sharing system ç„¡æ³•èˆ‡ä¹‹ä¸¦å­˜</p>
<p>è‚¯å®šæ˜¯èµ°priorityæ©Ÿåˆ¶ï¼Œä¸æœƒRR scheduling</p>
</li>
<li>
<p>OS æ‰€é€ æˆçš„ä»»ä½• dispatch latency etc. å®œé™ä½</p>
<p>Noteï¼šä¸€èˆ¬å¯¦å‹™ä¸Šï¼Œhard real-time system é®®å°‘æœ‰OS (OSå¹¾ä¹ä¸å­˜åœ¨ï¼‰ï¼Œå°¤å…¶æ˜¯ embedded real-time systemï¼ˆåµŒå…¥å¼çš„é«”ç©ä¸€å®šè¦å°ï¼‰</p>
</li>
<li>
<p>ç¾è¡Œå•†ç”¨ OS ä¸æ”¯æ´ Hard real-time featuresï¼Œé€šå¸¸æ˜¯å®¢è£½åŒ–è¨­è¨ˆ</p>
<p>ï¼ˆå•†ç”¨OSï¼šLinux, Unix, Windows, AppleOS, Solaris, etc.)</p>
</li>
</ol>
<p>ï¼ˆä¸‰ï¼‰Soft real-time system</p>
<ul>
<li>
<p>å®šç¾©ï¼šThis system must ensure <strong>the real-time process get the highest priority</strong> than the others, and <strong>retain this priority level</strong> until it completed.</p>
<p>è¦å–å¾—æœ€é«˜å„ªå…ˆæ¬Šï¼Œä¸¦ä¸”ç¶­æŒä½ä¸å¯è¡°é€€</p>
</li>
<li>
<p>èˆ‰ä¾‹ï¼šMultimedia system, simulation system, VR system, etc.</p>
<p>å·¥ä½œæœ‰å…ˆå¾ŒåŸ·è¡Œå¡é—œçš„é—œä¿‚ï¼Œä¾‹å¦‚å…ˆæ’­éŸ³è¨Šå†æ”¾å½±ç‰‡ï¼Œç§‘å­¸æ¨¡æ“¬éµç…§æ­¥é©Ÿï¼Œç­‰ç­‰</p>
</li>
<li>
<p>ç³»çµ±è¨­è¨ˆè€ƒé‡ï¼š</p>
<ol>
<li>
<p>å°±cpu schedulingè¨­è¨ˆ (ch4) è§’åº¦è€Œè¨€ï¼š</p>
<ol>
<li>å¿…é ˆæ”¯æŒ preemptive priority scheduling å¯æ’éšŠå„ªå…ˆæ¬Šæ’ç­æ³•å‰‡</li>
<li>ä¸å¯ä»¥æä¾› â€œAgingâ€ æŠ€è¡“ï¼ˆaging: é˜²æ­¢ä½å„ªå…ˆæ¬Šçš„ starvation, é€æ­¥èª¿é«˜å„ªå…ˆæ¬Šï¼‰</li>
</ol>
</li>
<li>
<p>ç›¡é‡é™ä½ kernel çš„åˆ†é…å»¶é²æ™‚é–“ Dispatch latency time (ch4)</p>
</li>
<li>
<p>å¯æ”¯æ´ virtual memory ä¸¦å­˜ï¼Œä½†æ˜¯è¦æ±‚ real-time process çš„å…¨éƒ¨é é¢ (pages) å¿…é ˆçš†å¾…åœ¨ memory ä¸­ï¼Œä¸å¯ä»¥è¢«ç•¶ä½œçŠ§ç‰²é é¢ swapped outï¼Œç›´åˆ°å®Œå·¥</p>
</li>
<li>
<p>èˆ‡ Time-sharing system å¯ä»¥ä¸¦å­˜ï¼Œä¾‹å¦‚ï¼šSolarisä½œæ¥­ç³»çµ±</p>
</li>
<li>
<p>ä¸€èˆ¬å•†ç”¨ç³»çµ± OS çš†æ”¯æŒ soft real-time system çš„ç‰¹å¾µ</p>
<p>ï¼ˆæ”¹è®Šä¸€ä¸‹OSæ¶æ§‹åƒæ•¸ï¼Œå°±å¯ä»¥é”æˆä»¥ä¸Šè¦æ±‚ï¼‰</p>
</li>
</ol>
</li>
</ul>
<h1 id="04batch-system-æ‰¹æ¬¡ç³»çµ±">04.Batch System æ‰¹æ¬¡ç³»çµ±</h1>
<blockquote>
<p>Operating System çš„å‰èº«ç‚º resident monitor</p>
</blockquote>
<ul>
<li>
<p>å®šç¾©ï¼šå°‡ä¸€äº›<!-- raw HTML omitted -->è¼ƒä¸ç·Šæ€¥<!-- raw HTML omitted -->ã€<!-- raw HTML omitted -->å®šæœŸæ€§<!-- raw HTML omitted -->ã€<!-- raw HTML omitted -->éäº¤è«‡äº’å‹•æ€§<!-- raw HTML omitted -->ä¹‹ jobsï¼Œç´¯ç¸¾æˆå †ï¼Œå†åˆ†æ‰¹é€å…¥ç³»çµ±è™•ç†</p>
</li>
<li>
<p>èˆ‰ä¾‹ï¼šåº«å­˜ç›¤é»ã€å ±ç¨…ã€æƒæ¯’å·¥ä½œã€ç£ç¢Ÿé‡çµ„ã€ä¸‹è¼‰éŸ³æ¨‚ã€éŠ€è¡Œæ¸…ç®—ç³»çµ±ç­‰ç­‰</p>
</li>
<li>
<p>ä¸»è¦ç›®çš„ï¼š</p>
<ul>
<li>æé«˜ resource utilizationï¼Œå°¤å…¶æ˜¯å†·é–€æ™‚æ®µ/éå°–å³°æ™‚æœŸçš„è³‡æºåˆ©ç”¨ç‡</li>
<li>ä¸é©åˆç”¨åœ¨ real-time systemï¼Œæˆ–è€…user-interactive application (e.g. game)</li>
</ul>
</li>
</ul>
<h4 id="handheld-system-æ‰‹æŒå¼ç³»çµ±">HandHeld system æ‰‹æŒå¼ç³»çµ±</h4>
<p>(ä¸€ï¼‰èˆ‰ä¾‹ï¼šPDAå€‹äººæ•¸ä½åŒ–åŠ©ç†ã€Smartphoneæ™ºæ…§å‹æ‰‹æ©Ÿã€Padå¹³æ¿</p>
<p>(äºŒï¼‰Hardwareå¤©ç”Ÿä¹‹é™åˆ¶ï¼Œå¸¶ä¾†Softwareå¿…é ˆé…åˆä¹‹è™•</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/Z9dD5mA.png"
        data-srcset="https://i.imgur.com/Z9dD5mA.png, https://i.imgur.com/Z9dD5mA.png 1.5x, https://i.imgur.com/Z9dD5mA.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/Z9dD5mA.png"
        title="image-20240126153137477" /></p>
<h1 id="05-ioé‹ä½œèˆ‡hardwarehw-resources-protection">05. I/Oé‹ä½œèˆ‡Hardware(Hw) resources Protection</h1>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/JXjD5sC.png"
        data-srcset="https://i.imgur.com/JXjD5sC.png, https://i.imgur.com/JXjD5sC.png 1.5x, https://i.imgur.com/JXjD5sC.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/JXjD5sC.png"
        title="image-20240126153446919" /></p>
<h3 id="io-é‹ä½œæ–¹å¼">I/O é‹ä½œæ–¹å¼</h3>
<h4 id="polling-io-è©¢å•å¼-io">Polling I/O (è©¢å•å¼ I/O)</h4>
<ul>
<li>
<p>å®šç¾©ï¼šåˆç¨±ç‚º Busy-waiting I/O (å¿™ç¢Œç­‰å¾…I/O) æˆ–è€… programmed I/O (å¯ç¨‹å¼åŒ–I/O)</p>
</li>
<li>
<p>å¦‚ä¸‹æ­¥é©Ÿï¼š</p>
<ol>
<li>
<p>user process ç™¼å‡º I/O-request</p>
</li>
<li>
<p>OS æ”¶åˆ°è«‹æ±‚å¾Œï¼Œ(Blocking I/Oæˆ–è€…Non-Blocking I/Oå¯èƒ½ï¼‰æœƒæš«åœæ­¤ process åŸ·è¡Œï¼Œä¸¦åŸ·è¡Œå°æ‡‰çš„ system calls</p>
</li>
<li>
<p>Kernelçš„I/O-subsystemæœƒPassæ­¤è«‹æ±‚çµ¦<!-- raw HTML omitted -->Device driver (è¨­å‚™çš„é©…å‹•ç¨‹å¼, Software (Sw))<!-- raw HTML omitted --></p>
</li>
<li>
<p>Device Driverä¾ç…§æ­¤è«‹æ±‚ï¼Œè¨­å®šå°æ‡‰çš„ I/O Commands åƒæ•¸çµ¦ <!-- raw HTML omitted -->Device Controller (è¨­å‚™æ§åˆ¶å™¨(Hw))<!-- raw HTML omitted --></p>
</li>
<li>
<p>Device Controller å•Ÿå‹•ï¼Œç›£ç£ I/O-Device ä¹‹ I/O é‹ä½œé€²è¡Œ</p>
</li>
<li>
<p>åœ¨æ­¤ä¹‹æ™‚ï¼ŒOSï¼ˆå¯èƒ½ï¼‰å°‡ CPU åˆ‡çµ¦å¦å¤–ä¸€å€‹ process åŸ·è¡Œ</p>
</li>
<li>
<p>ç„¶è€Œï¼Œcpuåœ¨åŸ·è¡Œprocesså·¥ä½œéç¨‹ä¸­ï¼Œå»è¦ä¸æ–·å»polling Device Controllerï¼Œä»¥ç¢ºå®šI/Oé‹ä½œæ˜¯å¦å®Œæˆæˆ–æœ‰I/O-error</p>
<blockquote>
<p>æ²’äººå‘Šè¨´CPUå…¶I/Oåšå®Œäº†æ²’ï¼Œè¨­å‚™æ§åˆ¶å™¨ä¸æœƒä¸»å‹•å‘ŠçŸ¥</p>
</blockquote>
</li>
</ol>
</li>
<li>
<p>ç¼ºé»ï¼š</p>
<p>CPU è€—è²»å¤§é‡æ™‚é–“ (80~90%) ç”¨æ–¼ polling I/O Device Controller ä¸Šï¼Œä¸¦æœªå…¨ç”¨æ–¼ process execution (10~20%)ä¸Šï¼Œæ•… CPU utilization ä½ (çœŸæ­£ç”¨åœ¨process executionçš„æ¯”ä¾‹) ï¼Œthroughput ä¸é«˜</p>
</li>
</ul>
<p>ã€åœ–ç¤ºã€‘</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/RlOfzex.png"
        data-srcset="https://i.imgur.com/RlOfzex.png, https://i.imgur.com/RlOfzex.png 1.5x, https://i.imgur.com/RlOfzex.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/RlOfzex.png"
        title="image-20240126155133275" /></p>
<h4 id="interrupted-io-ä¸­æ–·å¼-io">Interrupted I/O (ä¸­æ–·å¼ I/O)</h4>
<p>é‹ç”¨ä¸­æ–·çš„æŠ€å·§ä¾†è™•ç†I/Oè¨­å‚™èˆ‡CPUä¹‹é–“æºé€šçš„æ–¹å¼</p>
<ul>
<li>
<p>å®šç¾©ï¼šæ­¥é©Ÿå¦‚ä¸‹</p>
<ul>
<li>Step 1 ~ Step 6 åŒå‰é¢æ•˜è¿°</li>
<li>Step 7ï¼šç•¶I/Oé‹ä½œå®Œæˆï¼Œè¨­å‚™æ§åˆ¶å™¨æœƒç™¼å‡º â€œI/O-Completedâ€ Interrupt é€šçŸ¥ OS (CPU)</li>
<li>Step 8ï¼šOSæ”¶åˆ°ä¸­æ–·ä¹‹å¾Œï¼Œï¼ˆå¯èƒ½ï¼‰æœƒå…ˆæš«åœç›®å‰Processçš„åŸ·è¡Œï¼Œå¦‚æœä¸­æ–·çš„å„ªå…ˆæ¬Šå¾ˆä½ï¼Œæˆ–æœ‰æ›´ç·Šæ€¥çš„äº‹è¦åšï¼Œå°±å¯èƒ½å…ˆä¸è™•ç†é€™å€‹ä¸­æ–·</li>
<li>Step 9ï¼šOSå¿…é ˆæŸ¥è©¢ â€œInterrupt Vectorâ€(ä¸­æ–·å‘é‡è¡¨)ï¼Œç¢ºèªä½•ç¨®ä¸­æ–·ç™¼ç”Ÿï¼ŒåŒæ™‚ä¹Ÿè¦æ‰¾åˆ°è©²ä¸­æ–·çš„ ISR (Interrupt Service Routineï¼Œæœå‹™è™•ç†ç¨‹å¼) çš„ä½å€</li>
<li>Step10ï¼šJump to ISR ä½å€ï¼ŒåŸ·è¡Œ ISR</li>
<li>Step11ï¼šISR å®Œæˆå¾Œï¼Œæ§åˆ¶æ¬Šè¿”å› kernel (return control to kernel)ï¼Œkernel ä¹Ÿè¨±ä½œä¸€äº›é€šçŸ¥å·¥ä½œ</li>
<li>Step12ï¼šæ¢å¾©ï¼ˆresumeï¼‰åŸå…ˆä¸­æ–·ä¹‹å‰çš„å·¥ä½œåŸ·è¡Œï¼Œæˆ–äº¤ç”± cpu scheduler æ±ºå®š</li>
</ul>
</li>
<li>
<p>å„ªé»ï¼š</p>
<p>CPUä¸é ˆè€—è²»æ™‚é–“ç”¨æ–¼polling I/O-Deviceï¼Œè€Œæ˜¯å¯ä»¥ç”¨æ–¼process executionä¸Šã€‚å› æ­¤ï¼ŒCPU utilizationæœ‰æ‰€æå‡ï¼Œä¸”æé«˜äº†Throughputï¼Œæ”¹å–„äº†system performance</p>
</li>
<li>
<p>ç¼ºé»ï¼š</p>
<ol>
<li>
<p>ä¸­æ–·çš„è™•ç†ä»ç„¶éœ€è¦è€—è²»ä¸€äº›CPUçš„æ™‚é–“ (overhead)ï¼Œæ‰€ä»¥è‹¥I/Oé‹ä½œæ™‚é–“ (é–‹å§‹-çµæŸ) å°æ–¼interruptè™•ç†æ™‚é–“ï¼Œå‰‡ä½¿ç”¨Interrupted I/Oå°±ä¸åˆ’ç®—ï¼Œ å› æ­¤ï¼Œpolling I/Oä»ç„¶æœ‰å…¶å¿…è¦æ€§</p>
<blockquote>
<p>å‡è¨­å®¶è£¡æ˜¯å¼·åŠ›ç“¦æ–¯çˆï¼Œé–‹æ°´è¦ç‡’æ»¾åªè¦ä¸€åˆ†é˜ï¼Œå¾æ²™ç™¼å›æƒ³ç¬›éŸ³æ˜¯ä»€éº¼æ„æ€ï¼ˆæŸ¥è¡¨, Interruptè™•ç†ï¼‰ä¹Ÿè¦ä¸€åˆ†é˜ &hellip; é€™æ¨£ç”¨ä¸­æ–·å°±ä¸åˆ’ç®—ï¼Œåœ¨æ—é‚Šç­‰ (busy-waiting) æ›´ä½³</p>
</blockquote>
</li>
<li>
<p>è‹¥ä¸­æ–·ç™¼ç”Ÿçš„é »ç‡å¤ªé«˜ï¼Œå‰‡å¤§é‡çš„ä¸­æ–·è™•ç†ï¼Œæœƒä½”ç”¨å¹¾ä¹å…¨éƒ¨çš„cpu timeï¼Œç³»çµ±æ•ˆèƒ½æœƒå¾ˆå·®</p>
<blockquote>
<p>ä¾‹å¦‚æ‰¾åˆ°ä¸€å€‹å®Œç¾çš„ç¬›éŸ³å£ºä½†æ°´é‡åªæœ‰5mlï¼Œæ³¡ä¸€æ¯å’–å•¡è¦250mlï¼ˆç‚ºäº†æ¥ä¸‹ä¾†çš„DMAé‹ªè·¯ï¼‰</p>
</blockquote>
</li>
<li>
<p>CPU ä»é ˆè€—è²»ä¸€äº›æ™‚é–“ï¼Œç”¨æ–¼ç›£ç£/è² è²¬ I/O-Device èˆ‡è¨˜æ†¶é«”ä¹‹é–“çš„è³‡æ–™å‚³è¼¸éç¨‹è¨­å‚™ (DiskRead/DiskWrite Buffer registerï¼‰çš„è³‡æ–™å‚³è¼¸åˆ°Memoryæ˜¯ç”± ISR è»Ÿé«”åŸ·è¡Œ (Step10)ï¼Œä»è¦æ¶ˆè€—CPUæ™‚é–“</p>
<blockquote>
<p>è©²æ‰¾ç‘ªè‰äºå¹«ä½ æ³¡å’–å•¡äº†ï¼</p>
<p>è©²å­˜éŒ¢è²·å’–å•¡æ©Ÿäº†ï¼ï¼<strong>DMAä»‹å…¥</strong></p>
</blockquote>
</li>
</ol>
</li>
</ul>
<p>â€‹</p>
<h4 id="dma-direct-memory-access-io">DMA (Direct Memory Access I/O)</h4>
<p>(ä¸€ï¼‰å®šç¾©ï¼šDMA controllerè² è²¬I/O-Deviceèˆ‡Memoryä¹‹é–“çš„Data transferè³‡æ–™å‚³è¼¸å·¥ä½œï¼Œéç¨‹ä¸­ç„¡é ˆCPUä¹‹åƒèˆ‡ç›£ç£ï¼Œcpuæœ‰æ›´å¤šæ™‚é–“ç”¨æ–¼processor executionä¸Š</p>
<ul>
<li>
<p>å„ªé»ï¼š</p>
<ol>
<li>
<p>CPU utilizationæ›´é«˜</p>
</li>
<li>
<p>é©åˆç”¨åœ¨Block-Transfer oriented I/O-Device (ä»¥å€å¡Šå‚³è¼¸ç‚ºå°å‘çš„I/Oè¨­å‚™) ä¸Š</p>
<p>ä»£è¡¨ä¸­æ–·ç™¼ç”Ÿçš„é »ç‡ä¸è‡³æ–¼éé«˜</p>
<p>ä¾‹ï¼šç£ç¢Ÿçš„æ§åˆ¶å™¨æœƒèˆ‡DMAæ§åˆ¶å™¨åˆä½œï¼Œé€™éç¨‹ä¸éœ€è¦cpuçš„ç›£ç£</p>
<p>ä¾‹ï¼š<strong>ä¸</strong>é©åˆç”¨åœ¨Byte-Transfer oriented I/O-Device</p>
</li>
</ol>
</li>
<li>
<p>ç¼ºé»ï¼š</p>
<ol>
<li>
<p>å¼•é€²DMA controlleræœƒå¢åŠ ç¡¬é«”è¨­è¨ˆçš„è¤‡é›œåº¦</p>
<p>Complicated the hardware design</p>
<p>åŸå› ï¼šDMA Controlleræœƒèˆ‡CPUç«¶çˆ­ (çˆ­å¥ª) Memory ä»¥åŠ Bus çš„ä½¿ç”¨æ¬Š</p>
<p>ç•¶ DMA controller ä½”ç”¨äº† memory æˆ– bus æ™‚ï¼ŒCPU è¦è¢«è¿«ç­‰å¾…</p>
</li>
</ol>
</li>
</ul>
<h5 id="è£œå……">[è£œå……]</h5>
<ol>
<li>
<p>DMA Controlleré€šå¸¸æ¡ç”¨ â€œCycle Stealingâ€ æŠ€è¡“ï¼ˆæˆ–Interleaving (per theæé¾æœ¬)) èˆ‡CPUè¼ªç•ªäº¤éŒ¯ä½¿ç”¨ memory ä»¥åŠ busã€‚å¦‚æœCPUèˆ‡DMA controllerç™¼ç”Ÿconflict (è¡çª-åŒæ™‚è¦ç”¨memoryä»¥åŠbus)ï¼Œå‰‡æœƒçµ¦ <strong><!-- raw HTML omitted -->DMA<!-- raw HTML omitted --></strong> æ¯”è¼ƒé«˜çš„å„ªå…ˆæ¬Šã€‚</p>
<blockquote>
<p>ç‘ªè‰äºä¸åƒ…æœƒæ³¡å’–å•¡ï¼Œé‚„æœƒç‡’èœï¼</p>
</blockquote>
</li>
<li>
<p>é€šå¸¸ç³»çµ±æœƒçµ¦äºˆ â€œå°è©²è³‡æºéœ€æ±‚é‡ã€é »ç‡ç­‰è¼ƒ<strong>å°</strong>â€ çš„å°è±¡æœ‰è¼ƒé«˜çš„å„ªå…ˆæ¬Š</p>
<p>æœƒç²å¾—1ï¸âƒ£å¹³å‡ç­‰å¾…æ™‚é–“è¼ƒå° 2ï¸âƒ£å¹³å‡ç”¢èƒ½æ¯”è¼ƒé«˜ çš„å¥½è™•</p>
<blockquote>
<p>æœ€çŸ­å·¥ä½œå„ªå…ˆ</p>
</blockquote>
</li>
</ol>
<h1 id="06-æ©Ÿå™¨æŒ‡ä»¤-stages">06. æ©Ÿå™¨æŒ‡ä»¤ Stages</h1>
<ol start="3">
<li>
<p>æ©Ÿå™¨æŒ‡ä»¤ Stages FOï¼šFetch Operand</p>
<ul>
<li>æœ‰è¨˜æ†¶é«”è®Šæ•¸ï¼Œç«‹å³/ç›´æ¥/ç›¸å°å®šå€</li>
</ul>
<table>
<thead>
<tr>
<th>IF</th>
<th>DE</th>
<th>FO</th>
<th>EX</th>
<th>WM</th>
</tr>
</thead>
<tbody>
<tr>
<td>instruction Fetch</td>
<td>Decode</td>
<td>Fetch Operand</td>
<td>Execution</td>
<td>Write result to Memory</td>
</tr>
<tr>
<td>æŠ“æŒ‡ä»¤</td>
<td>è§£OP code</td>
<td>æŠ“é‹ç®—å…ƒ</td>
<td>åŸ·è¡Œ</td>
<td>å¯«å…¥è³‡æ–™é€²è¨˜æ†¶é«”è®Šæ•¸</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>CPUæœƒMemory Access</th>
<th>DMAè¦ç”¨Memory</th>
</tr>
</thead>
<tbody>
<tr>
<td>IF</td>
<td>æœƒï¼ˆå¿…è¦ï¼‰</td>
<td>è¡çª (Conflict, çˆ­å¥ªmemory)</td>
</tr>
<tr>
<td>DE</td>
<td>ä¸æœƒ</td>
<td>OK</td>
</tr>
<tr>
<td>FO</td>
<td>å¯èƒ½æœƒ</td>
<td>OKæˆ–è€…æœ‰è¡çªï¼ˆå¦‚æœæœ‰è¡çªçš„æ™‚å€™ï¼Œæœƒçµ¦äºˆDMAæ¯”è¼ƒé«˜çš„å„ªå…ˆæ¬Š)</td>
</tr>
<tr>
<td>EX</td>
<td>ä¸æœƒ</td>
<td>OK</td>
</tr>
<tr>
<td>WM</td>
<td>å¯èƒ½æœƒï¼ˆæœ‰å¯èƒ½æœƒç”¨memory, ä¹Ÿå¯èƒ½ä¸ç”¨ï¼‰</td>
<td>OKæˆ–è€…æœ‰è¡çª</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h4 id="dmaä¹‹six-stepsåœ–ç¤º">DMAä¹‹six stepsåœ–ç¤º</h4>
<ol>
<li>
<p><!-- raw HTML omitted -->Device driver<!-- raw HTML omitted --> is told to transfer disk data to <!-- raw HTML omitted -->buffer<!-- raw HTML omitted --> address X</p>
<p>è¨­å‚™é©…å‹•ç¨‹å¼è¢«å‘ŠçŸ¥è¦å‚³è¼¸è³‡æ–™åˆ°è¨˜æ†¶é«”bufferï¼ŒBufferä¹‹èµ·å§‹ä½ç½®ç‚º X</p>
</li>
<li>
<p><!-- raw HTML omitted -->Device driver<!-- raw HTML omitted --> tells <!-- raw HTML omitted -->disk controller<!-- raw HTML omitted --> to transfer C bytes from disk to Buffer at address X</p>
<p>è¨­å‚™é©…å‹•ç¨‹å¼å‘ŠçŸ¥ç£ç¢Ÿæ§åˆ¶å™¨, å¾ç£ç¢Ÿè£¡å‚³è¼¸C bytesçš„é‡é€²buffer add.3</p>
</li>
<li>
<p><!-- raw HTML omitted -->Disk controller<!-- raw HTML omitted --> initiates DMA transfer</p>
</li>
<li>
<p><!-- raw HTML omitted -->Disk controller<!-- raw HTML omitted --> sends each byte to DMA controller</p>
</li>
<li>
<p>DMA transfer bytes to Buffer X increasing memory address (X+1) and decreasing C until C=âˆ… (C byteçš„é‡, counter C-1)</p>
</li>
<li>
<p>When C = âˆ…, DMA interrupts CPU to signal transfer completion</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/WVnkbbc.png"
        data-srcset="https://i.imgur.com/WVnkbbc.png, https://i.imgur.com/WVnkbbc.png 1.5x, https://i.imgur.com/WVnkbbc.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/WVnkbbc.png"
        title="image-20240126160627526" /></p>
</li>
</ol>
<h4 id="life-cycle-of-io-request-via-interrupted-io">Life cycle of I/O-request via Interrupted I/O</h4>
<p>(ç¶“ç”±ä¸­æ–·å¼I/OS) ä¹‹I/Oè«‹æ±‚çš„ç”Ÿå‘½é€±æœŸ</p>
<p><!-- raw HTML omitted -->ğŸš§ é€™æ®µä¸å¤ªæ‡‚ 35:34 - 50:21 (06)<!-- raw HTML omitted --></p>
<h1 id="07-blocking-and-non-blocking-io">07. Blocking and Non-Blocking I/O</h1>
<ol>
<li>
<p>Blocking-I/O: Process suspended until I/O completed</p>
<ul>
<li>
<p>ç™¼å‡ºè«‹æ±‚ä¹‹å¾Œæš«åœï¼Œç›´åˆ°I/oå®Œæˆå¾Œæ‰ç¹¼çºŒprocess</p>
</li>
<li>
<p>å„ªï¼šEasy to use and understand</p>
</li>
<li>
<p>ç¼ºï¼šInsufficient for some needs</p>
</li>
</ul>
</li>
<li>
<p>Non-Blocking I/O:</p>
<p>æ’­æ”¾é›»å½±çš„æ™‚å€™ï¼Œç¸½å…±æœ‰1GBï¼Œå…ˆæŠ“å–2mbçš„è³‡æ–™ [ 20:51 çš„åœ–æœ‰æ”¹ç‰ˆğŸš§ ]</p>
<ul>
<li>
<p>I/O calls returns as much as available</p>
<p>e.g. user interface data copy (buffered I/O)</p>
</li>
<li>
<p>Implemented via multi-threading</p>
</li>
<li>
<p>Returns quickly with count of bytes read or written</p>
</li>
</ul>
</li>
<li>
<p>Asynchronous I/O:</p>
<p>Process runs while I/O executes</p>
<ul>
<li>
<p>Difficult to use</p>
</li>
<li>
<p>I/O subsystem signals process when I/O completed</p>
<p>ç™¼é€I/O requestä¹‹å¾Œï¼Œæ§åˆ¶æ¬Šé¦¬ä¸Šé‚„çµ¦user process</p>
<p>ç™¼é€åœ¨åŸ·è¡Œï¼ŒI/Oè¨­å‚™ä¹Ÿåœ¨åŸ·è¡Œ</p>
</li>
</ul>
</li>
</ol>
<p>ã€åœ–ç¤ºã€‘</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/pgPdJ4W.png"
        data-srcset="https://i.imgur.com/pgPdJ4W.png, https://i.imgur.com/pgPdJ4W.png 1.5x, https://i.imgur.com/pgPdJ4W.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/pgPdJ4W.png"
        title="image-20240126161629760" /></p>
<h5 id="å°å·®ç•°">å°å·®ç•°ï¼š</h5>
<ul>
<li>
<p>Non-blocking I/O:</p>
<p>I/O å®Œæˆè³‡æ–™æœ‰å¤šå°‘å°±ä¸Ÿå¤šå°‘å›ä¾†(å³å°‘é‡ returns as much as possible)</p>
<p>è¦æ±‚è®€100bytesï¼Œæ¯25bytes, kernel å°±æœƒé€šçŸ¥process</p>
</li>
<li>
<p>Asynchronous I/O:</p>
<p>æ•´å€‹I/Oå®Œæˆï¼Œæ‰é€šçŸ¥process</p>
<p>è®€å®Œæ•´å€‹100byteså®Œæˆå¾Œæ‰é€šçŸ¥process</p>
</li>
</ul>
<h4 id="interruptæ©Ÿåˆ¶èˆ‡ç¨®é¡">Interruptæ©Ÿåˆ¶èˆ‡ç¨®é¡</h4>
<p>ï¼ˆä¸€ï¼‰ç•¶Interruptç™¼ç”Ÿï¼ŒOSä¹‹è™•ç†æ­¥é©Ÿå¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>OSæ”¶åˆ°ä¸­æ–·å¾Œï¼Œï¼ˆè‹¥æ­¤ä¸­æ–·è¦è¢«ç«‹å³è™•ç†çš„è©±ï¼‰å‰‡OSæœƒæš«åœç›®å‰Processä¹‹åŸ·è¡Œï¼Œä¸”ä¿å­˜å…¶ Status and Registers Contents</p>
</li>
<li>
<p>OSæœƒä¾ Interrupt ID.(No.) å»æŸ¥è©¢ä¸­æ–·å‘é‡è¡¨ (interrupt vector) ç¢ºèªä½•ç¨®ä¸­æ–·ç™¼ç”Ÿï¼Œä¸¦ä¸”æ‰¾å‡ºå…¶ ISR çš„ä½å€</p>
</li>
<li>
<p>Jump to ISRä½å€ï¼ŒåŸ·è¡ŒISR</p>
</li>
<li>
<p>ISR å®Œæˆä¹‹å¾Œï¼Œæ§åˆ¶æ¬Šè¿”å› kernel</p>
</li>
<li>
<p>OS æœƒæ¢å¾©ï¼ˆresumeï¼‰ä¸­æ–·ä¹‹å‰ process ä¹‹åŸ·è¡Œ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/bJv8atO.png"
        data-srcset="https://i.imgur.com/bJv8atO.png, https://i.imgur.com/bJv8atO.png 1.5x, https://i.imgur.com/bJv8atO.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/bJv8atO.png"
        title="image-20240126162224778" /></p>
</li>
</ol>
<p>ï¼ˆäºŒï¼‰Interruptç¨®é¡ âœ¨âœ¨</p>
<ul>
<li>
<p><strong>[åˆ†é¡ä¸€]</strong> åˆ†ç‚ºä¸‰ç¨®ï¼š</p>
<ol>
<li>
<p>External interrupt å¤–éƒ¨ä¸­æ–·:</p>
<p>CPUä»¥å¤–çš„å‘¨é‚Šè¨­å‚™ï¼Œæ§åˆ¶å¡ï¼Œetc. æ‰€ç™¼å‡ºä¾†çš„</p>
<p>ä¾‹å¦‚ï¼šâ€I/O Completedâ€, â€œI/O-errorâ€, â€œmachine-checkâ€</p>
</li>
<li>
<p>Internal interrupt:</p>
<p>CPUåœ¨åŸ·è¡ŒProcesséç¨‹ä¸­ï¼Œé­é‡é‡å¤§éŒ¯èª¤è€Œå¼•ç™¼</p>
<p>ä¾‹å¦‚ï¼šDivide-by-zero, åŸ·è¡Œéæ³•çš„ç‰¹æ¬ŠæŒ‡ä»¤, etc.</p>
</li>
<li>
<p>Software interrupt:</p>
<p>user process åœ¨åŸ·è¡Œä¸­ï¼Œè‹¥é ˆè¦OSæä¾›æœå‹™æ™‚ï¼Œå¿…é ˆç™¼å‡ºæ­¤é¡ä¸­æ–·ï¼Œ</p>
<p>ç›®çš„æ˜¯é€šçŸ¥ä½œæ¥­ç³»çµ±ï¼Œè«‹å®ƒåŸ·è¡Œå°æ‡‰çš„æœå‹™è«‹æ±‚</p>
<p>ä¾‹å¦‚ï¼šI/O-request</p>
<p>Note: å¥½æ¯”æ˜¯â€œæœå‹™éˆ•â€</p>
</li>
</ol>
</li>
<li>
<p><strong>[åˆ†é¡äºŒ]</strong> Interrupt èˆ‡ Trapå…©ç¨®</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/SIlx8FA.png"
        data-srcset="https://i.imgur.com/SIlx8FA.png, https://i.imgur.com/SIlx8FA.png 1.5x, https://i.imgur.com/SIlx8FA.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/SIlx8FA.png"
        title="image-20240126163005722" /></p>
<ul>
<li>
<p>ä¾‹ï¼šè¨­å‚™ç™¼å‡ºâ€œI/O-Completedâ€, â€œI/O-errorâ€, â€œmachine-checkâ€, etc.  ä»¥åŠ â€œTime-outâ€ by Timerï¼ˆç¡¬é«”è¨ˆæ™‚å™¨ï¼‰</p>
</li>
<li>
<p>Trap ç”¨é€”ä¸»è¦æœ‰äºŒï¼š</p>
<ol>
<li>
<p>Catch the arithmetic error ç¨‹å¼åŸ·è¡Œé­é‡é‡å¤§éŒ¯èª¤</p>
<p>ä¾‹å¦‚ï¼šDivide-by-zeroã€åŸ·è¡Œéæ³•çš„ç‰¹æ¬ŠæŒ‡ä»¤ï¼ˆè©²æŒ‡ä»¤ä¸è©²æ˜¯ä½ åŸ·è¡Œï¼‰ã€illegal memory access</p>
</li>
<li>
<p>user processåŸ·è¡Œé ˆè¦OSæä¾›æœå‹™æ™‚ï¼Œä¹Ÿæœƒç™¼Trapé€šçŸ¥OS</p>
<p>ä¾‹å¦‚ï¼šI/O-request</p>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>[åˆ†é¡ä¸‰]</strong> åˆ†ç‚ºå…©é¡              <code>ä¸­æ–·ä¹‹é–“ä¹Ÿæœ‰å„ªå…ˆæ¬Šé«˜ä½</code></p>
<ol>
<li>
<p><strong>maskable interrupt</strong> å¯é®ç½©ä¸­æ–·ï¼š</p>
<p>æ­¤é¡ä¸­æ–·ç™¼ç”Ÿå¯ä»¥è¢«å¿½ç•¥ (ignored, å‡è£æ²’è½åˆ°) æˆ–å»¶å¾Œè™•ç† (queued, çŸ¥é“äº†, æ‰“å®Œå°±å»)ï¼Œä¸ä¸€å®šè¦é¦¬ä¸Šè™•ç†</p>
<p>e.g. Software interrupt (å„ªå…ˆæ¬Šè¼ƒä½)</p>
</li>
<li>
<p><strong>non-maskable interrupt</strong> ä¸å¯é®ç½©ä¸­æ–·ï¼š</p>
<p>æ­¤é¡ä¸­æ–·å¿…é ˆç«‹åˆ»è™•ç†ï¼Œé€šå¸¸æ¯”è¼ƒç·Šæ€¥</p>
<p>e.g. internal interruptï¼ˆç¨‹å¼åŸ·è¡Œé­é‡é‡å¤§éŒ¯èª¤ï¼‰, I/O-error, etc.</p>
</li>
</ol>
</li>
</ul>
<h4 id="hardware-resources-protection-ç¡¬é«”è³‡æºä¿è­·">Hardware Resources Protection ç¡¬é«”è³‡æºä¿è­·</h4>
<p>ã€–åŸºç¤å»ºè¨­ã€—</p>
<ul>
<li>å¿…é ˆè¦å…ˆæœ‰é€™å…©ç¨®æ±è¥¿ï¼š
<ol>
<li>Dual-modes operation é›™é‡æ¨¡å¼é‹ä½œ</li>
<li>Privileged instructions</li>
</ol>
</li>
</ul>
<h4 id="dual-modes-operation">Dual-modes operation</h4>
<p>ï¼ˆä¸€ï¼‰å®šç¾©ï¼šsystem ä¹‹é‹ä½œæ¨¡å¼è‡³å°‘è¦å¯ä»¥è¢«å€åˆ†ç‚ºå…©ç¨®æ¨¡å¼</p>
<ol>
<li>
<p>kernel mode:</p>
<ul>
<li>
<p>åˆå«ä½œ system mode, supervisor mode, ä¹Ÿæœ‰äººç¨±ä¹‹ç‚ºprivileged mode</p>
<p>ï¼ˆæ—©æœŸæœ‰ï¼Œç¾ç§»é™¤çš„ monitor modeï¼‰</p>
</li>
<li>
<p>ä»£è¡¨æ­¤åˆ»æ˜¯ kernel å–å¾—ç³»çµ±çš„æ§åˆ¶æ¬Šï¼ˆi.e. å–å¾—CPUåŸ·è¡Œ)</p>
</li>
<li>
<p>å…è¨±ç‰¹æ¬Šçš„æŒ‡ä»¤ (privileged instructions) åœ¨æ­¤æ¨¡å¼ä¸‹åŸ·è¡Œ</p>
</li>
</ul>
</li>
<li>
<p>user mode:</p>
<ul>
<li>ä»£è¡¨user processå–å¾—CPUåŸ·è¡Œï¼Œæ­¤æ¨¡å¼ä¸‹<strong>ä¸å…è¨±</strong>åŸ·è¡Œç‰¹æ¬ŠæŒ‡ä»¤ï¼Œè‹¥åŸ·è¡Œç”¢ç”ŸTrap</li>
</ul>
</li>
</ol>
<blockquote>
<p>æ­¤å¤–ï¼Œdual-modes å¿…é ˆè¦æœ‰ç¡¬é«”çš„æ”¯æŒæ‰å¯å¯¦ç¾</p>
<p>ä¾‹å¦‚ï¼šCPUå…§æœƒæœ‰Mode Bitï¼Œç”¨ä»¥å€åˆ†ç¾åœ¨æ˜¯å“ªå€‹æ¨¡å¼</p>
</blockquote>
<h5 id="privileged-instructionç‰¹æ¬ŠæŒ‡ä»¤">Privileged instructionï¼ˆç‰¹æ¬ŠæŒ‡ä»¤ï¼‰</h5>
<ul>
<li>
<p>å®šç¾©ï¼š</p>
<p>ä»»ä½•å¯èƒ½æœƒé€ æˆç³»çµ±é‡å¤§å±å®³çš„æŒ‡ä»¤ï¼Œå¯ä»¥è¨­ç‚ºç‰¹æ¬ŠæŒ‡ä»¤</p>
<p>ç‰¹æ¬ŠæŒ‡ä»¤åªå¯ä»¥åœ¨ kernel mode åŸ·è¡Œï¼Œä¸å¯ä»¥åœ¨ user mode åŸ·è¡Œï¼Œ</p>
<p>ä¸€æ—¦åœ¨ user mode ä¸‹åŸ·è¡Œï¼Œæœƒç™¼ç”Ÿ Trap é€šçŸ¥ OSï¼Œå°‡æ­¤ user process terminates</p>
</li>
<li>
<p>ä¾‹å¦‚</p>
<ul>
<li>
<p>Turn-offï¼ˆdisable) interrupt æŠŠä¸­æ–·çš„æ©Ÿåˆ¶é—œæ‰</p>
</li>
<li>
<p>Clear memory</p>
</li>
<li>
<p>I/O-instructions (for I/O protection)</p>
</li>
<li>
<p>Timer å€¼ Set / change (for CPU protection)</p>
</li>
<li>
<p>Base/limit register ä¿®æ”¹/set (for memory protection)</p>
</li>
<li>
<p>Change mode from user mode to kernel mode</p>
</li>
</ul>
</li>
</ul>
<h5 id="quests">Quests</h5>
<ul>
<li>
<p>ä¸‹åˆ—å“ªäº›æ˜¯ç‰¹æ¬ŠæŒ‡ä»¤ï¼Ÿ</p>
<p>(1) Set value of Timer</p>
<p>(2) Read the clock</p>
<p>(3) Clear Memory</p>
<p>(4) Turn off interrupt</p>
<p>(5) Switch from user to monitor mode</p>
<blockquote>
<p>Ans: (1)(3)(4)(5)</p>
</blockquote>
</li>
<li>
<p>ä¿è­·ä½œæ¥­ç³»çµ±æ˜¯è‡³é—œé‡è¦çš„äº‹æƒ…ï¼Œå› ç‚ºè¦åšåˆ°é€™æ¨£çš„ä¿è­·ï¼Œæ‰æœƒæœ‰Dual-Modes</p>
<p>ç„¶è€Œç‚ºäº†è®“user flexibilityæœ€å¤§åŒ–ï¼Œå°user processçš„é™åˆ¶ä¹Ÿè¦è¶Šå°‘è¶Šå¥½ï¼Œ</p>
<p>ä»¥ä¸‹ä¸ƒæ¢é€šå¸¸å¯ä»¥è¢«åˆ—å…¥ç‰¹æ¬ŠæŒ‡ä»¤ï¼Œä½†æœ‰äº›å¥½åƒä¸å¤ªéœ€è¦ï¼Œå“ªäº›å¿…é ˆï¼Ÿ</p>
<p>(1) Change to user mode</p>
<p>(2) Change to monitor mode</p>
<p>(3) Read form monitor memory</p>
<p>(4) Write into monitor memory</p>
<p>(5) Fetch an instruction from monitor memory</p>
<p>(6) Turn on timer interrupt</p>
<p>(7) Turn off timer interrupt</p>
<p>Ans: to be discussed</p>
</li>
</ul>
<p>ç‚ºä½•æ§‹æˆprotectionä¹‹åŸºç¤ &hellip;</p>
<ol>
<li>[User Mode] user process é€é Trap ç™¼å‡ºè«‹æ±‚</li>
<li>[Mode change] to kernel mode</li>
<li>[Kernel mode] kernel åŸ·è¡Œ I/O æŒ‡ä»¤ / ç‰¹æ¬ŠæŒ‡ä»¤</li>
<li>I/O æŒ‡ä»¤ / ç‰¹æ¬ŠæŒ‡ä»¤å°‡çµæœå‚³å› kernel</li>
<li>[Mode change] to user mode</li>
<li>å°‡çµæœå‚³å› user process</li>
</ol>
<h4 id="hardware-resources-protection">Hardware Resources Protection</h4>
<ol>
<li>I/O protection</li>
<li>Memory protection</li>
<li>CPU protection</li>
</ol>
<h5 id="io-protection">I/O Protection</h5>
<ul>
<li>
<p>ç›®çš„ï¼šç”±æ–¼I/Oé‹ä½œè¼ƒç‚ºç¹ç‘£è¤‡é›œï¼Œç‚ºäº†<strong>é™ä½ user processes æ“æ§ I/O ä¹‹è¤‡é›œåº¦</strong>ï¼ŒåŠé¿å…user process å° I/O Devices ä¹‹ä¸ç•¶æ“ä½œï¼Œæ‰€ä»¥æ‰æœ‰ I/O protection</p>
</li>
<li>
<p>ä½œæ³•ï¼šå°‡æ‰€æœ‰ I/O æŒ‡ä»¤è¨­ç‚ºç‰¹æ¬ŠæŒ‡ä»¤ (privileged instruction)ï¼Œé…åˆ Dual Modesï¼Œ<strong>ä¸€å¾‹è®“ user process å§”è¨— kernel åŸ·è¡Œ I/O é‹ä½œ</strong></p>
</li>
</ul>
<h5 id="memory-protection">Memory Protection</h5>
<ul>
<li>
<p>ç›®çš„ï¼šé˜²æ­¢ user process å­˜å–å…¶å®ƒ user processes ä¹‹ memory area åŠ kernel memory area</p>
</li>
<li>
<p>ä½œæ³•ï¼šï¼ˆä»¥Contiguous Memory Allocationç‚ºä¾‹ï¼‰</p>
<p>é‡å°æ¯ä¸€å€‹ processï¼Œkernel æœƒæä¾›ä¸€å¥— Registersï¼Œç¨±ç‚º Base/Limit Register</p>
<p>å…¶ä¸­ Base register: è¨˜éŒ„ Process ä¹‹<strong>èµ·å§‹ä½å€</strong></p>
<p>â€‹          Limit register: ç´€éŒ„ Process ä¹‹<strong>å¤§å°</strong></p>
<p>å°‡ä¾†ï¼ŒProcessåŸ·è¡Œï¼Œæœƒé€²è¡Œä¸‹åˆ—çš„checking:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/wvzvDdh.png"
        data-srcset="https://i.imgur.com/wvzvDdh.png, https://i.imgur.com/wvzvDdh.png 1.5x, https://i.imgur.com/wvzvDdh.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/wvzvDdh.png"
        title="image-20240126165148804" /></p>
<p>æª¢æŸ¥memoryä½å€æ˜¯å¦å¤§æ–¼ç­‰æ–¼ Base(èµ·å§‹ä½å€, e.g. base=1000)ï¼Œå¦‚æœå°æ–¼baseå‰‡ç‚ºéæ³•çš„è¨˜æ†¶é«”å­˜å–ï¼Œæ¥è‘—ç¢ºèªæœ€å¾Œä¸€å€‹åˆæ³•çš„ä½å€ç‚ºä½• (if Base = 1000, limit = 500) ?</p>
<p>æœ€å¾Œä½å€ = 1000 + 500 - 1 = 1499</p>
<p>è‹¥ memory ä½å€ä¸å°æ–¼ Base + limitï¼Œå‰‡ä¹Ÿæ˜¯éæ³•çš„è¨˜æ†¶é«”å­˜å–</p>
<p>ä»¥ä¸Šå…©é …æª¢æŸ¥ç”±ç¡¬é«”å®Œæˆï¼ŒHardware = MMU (è¨˜æ†¶é«”ç®¡ç†å–®å…ƒ, Memory Management Unit)</p>
<p>æ­¤å¤–ï¼ŒBaseèˆ‡Limit registerå€¼ä¹‹set/changeé ˆè¨­ç‚ºâ€œç‰¹æ¬ŠæŒ‡ä»¤â€</p>
</li>
</ul>
<h5 id="cpu-protection">CPU Protection</h5>
<ul>
<li>
<p>ç›®çš„ï¼šé˜²æ­¢ user process ç„¡é™æœŸ/é•·æœŸä½”ç”¨ CPUï¼Œè€Œä¸é‡‹æ”¾</p>
</li>
<li>
<p>ä½œæ³•ï¼š</p>
<p>åˆ©ç”¨ Timer å¯¦æ–½ï¼ŒåŒæ™‚ OS æœƒè¦å®š process ä½¿ç”¨ CPU æ™‚é–“ä¹‹æœ€å¤§é…é¡å€¼ (Maximum Time Quantum) ç•¶ process å–å¾— CPU ä¹‹å¾Œï¼ŒTimer åˆå€¼å³è¨­ç‚º maximum time quantum å€¼ï¼Œéš¨è‘— process å¯¦è¡Œæ™‚é–“å¢åŠ ï¼ŒTimer å€¼æœƒé€æ­¥éæ¸›ï¼Œç›´åˆ° Timer å€¼ç‚ºé›¶ï¼ŒTimer æœƒç™¼å‡ºTime-Outâ€ interrupt é€šçŸ¥ OSï¼ŒOS ä¾¿å¯å¼·è¿«æ­¤ process æ”¾æ‰ CPUã€‚</p>
<p>æ­¤å¤–ï¼ŒTimerå€¼ä¹‹set/changeï¼ˆè¨­å®š/ä¿®æ”¹ï¼‰ä¹Ÿé ˆè¨­ç‚ºç‰¹æ¬ŠæŒ‡ä»¤ã€‚</p>
</li>
</ul>
<h2 id="ch3-osä¹‹development">Ch3. OSä¹‹Development</h2>
<ul>
<li>
<p>OSæ‡‰æä¾›çš„æœå‹™é …ç›® (3-5, 3-6 what is the OS? What r the services provided by OS?)</p>
</li>
<li>
<p>OSä¹‹æœå‹™å…ƒä»¶ç¨®é¡ (3-3)</p>
</li>
<li>
<p>System Callsä¹‹ä»‹ç´¹ ğŸŒ </p>
</li>
<li>
<p>OSä¹‹Structureç¨®é¡ (ğŸŒ ä½œæ¥­ç³»çµ±æ¨¡çµ„ä¹‹é–“çš„æ¶æ§‹ï¼‰</p>
<ul>
<li>Simple                                          (e.g. DOS)</li>
<li>More Complex than simple (e.g. UNIX)</li>
<li><strong>Layered</strong> Approach                (e.g. OSI 7å±¤)</li>
<li><strong>Microkernel</strong> ğŸŒ å¾®æ ¸å¿ƒ       (e.g. Mach)</li>
<li>Module                                         (e.g. åªæ”¶éœ€è¦çš„)</li>
<li>Hybridã€‚                                      (e.g. ä¸Šè¿°ç„¡æ³•åˆ†é¡ï¼‰</li>
</ul>
</li>
<li>
<p>æ¶æ§‹è¨­è¨ˆåŸå‰‡ï¼špolicy èˆ‡ mechanism å®œåˆ†é–‹</p>
<ul>
<li>policyç­–ç•¥ - è¦å‘ˆç¾ä»€éº¼è¡Œç‚º what</li>
<li>mechanismæ©Ÿåˆ¶ - æ€éº¼åšå‡ºé€™å€‹è¡Œç‚º how</li>
</ul>
</li>
<li>
<p>Virtual Machine ä»‹ç´¹ï¼šä¸€é–‹å§‹æ˜¯ç‚ºäº†æ¸¬è©¦é–‹ç™¼å®Œçš„OS</p>
</li>
<li></li>
</ul>
<h5 id="è»Ÿé«”ç³»çµ±è¨­è¨ˆçš„å…©å¤§å‘½é¡Œ">ã€–è»Ÿé«”ç³»çµ±è¨­è¨ˆçš„å…©å¤§å‘½é¡Œã€—</h5>
<ul>
<li>
<p>é«˜å…§èšï¼šåŒæ¨£æˆ–é¡ä¼¼çš„åŠŸèƒ½è¶Šèšåœ¨ä¸€èµ·è¶Šå¥½</p>
</li>
<li>
<p>ä½è€¦åˆï¼šæ¨¡çµ„ä¹‹é–“çš„é—œè¯æ€§è¦è¶Šä½è¶Šå¥½</p>
</li>
</ul>
<blockquote>
<p>ç³»çµ±åˆ†æ</p>
<p>è»Ÿé«”å·¥ç¨‹</p>
<ul>
<li>
<p>Waterfall</p>
<ul>
<li>
<p>Analysis åˆ†æ/ç­è§£éœ€æ±‚</p>
</li>
<li>
<p>Design</p>
<ul>
<li>
<p>æ¶æ§‹</p>
</li>
<li>
<p>ç´°éƒ¨è¨­è¨ˆ Algo + DS</p>
</li>
</ul>
</li>
<li>
<p>U.I.</p>
</li>
</ul>
</li>
<li>
<p>Coding/Implementation</p>
</li>
<li>
<p>Testing</p>
</li>
<li>
<p>Maintain</p>
</li>
</ul>
</blockquote>
<h1 id="09-system-call">09. System call</h1>
<ul>
<li>
<p>å®šç¾©ï¼š</p>
<ul>
<li>
<p>ä½œç‚ºåŸ·è¡Œä¸­user proessèˆ‡kernelä¹‹é–“çš„æºé€šç•Œé¢ï¼Œç•¶user processé ˆè¦OSæä¾›æŸç¨®æœå‹™æ™‚ï¼Œæœƒå…ˆtrapé€šçŸ¥OSï¼Œä¸¦ä»£å…¥system call ID(No.) ä»¥åŠæ‰€é ˆåƒæ•¸ï¼Œæ¥è‘—ï¼ŒOSåŸ·è¡Œå°æ‡‰çš„system callï¼Œå®Œæˆå¾Œï¼Œå°‡æœå‹™çµæœreturn to user process</p>
</li>
<li>
<p>It&rsquo;s a programing interface to the services provided by the O.S.</p>
</li>
<li>
<p>Note: é¡æ¯”</p>
<ul>
<li>Trap =&gt; æœå‹™éˆ•ï¼ˆåŒ…å»‚æœå‹™éˆ´)</li>
<li>System call =&gt; æœå‹™é …ç›®ï¼ˆKTV_kernelå«è»Š,é»é¤,é€BDC,ä½œé¤ç­‰20ç¨®æœå‹™ï¼‰</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ã€åœ–ç¤ºã€‘</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/GW2DMdB.png"
        data-srcset="https://i.imgur.com/GW2DMdB.png, https://i.imgur.com/GW2DMdB.png 1.5x, https://i.imgur.com/GW2DMdB.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/GW2DMdB.png"
        title="image-20240126170503851" /></p>
<blockquote>
<p>User processå¼•ç™¼system call(<code>open()</code>)ï¼Œå¼•ç™¼sys.callä¸€å®šä¼´éš¨Trapï¼Œsys.Callç•Œé¢æŸ¥è¡¨ï¼ŒåŸ·è¡Œå°æ‡‰çš„æŒ‡ä»¤ï¼Œå¯¦ä½œå¾Œå›å‚³çµæœ</p>
<p>C library æŸ¥ printf å°æ‡‰çš„ tableï¼ŒSystem Call Interfaceé€šå¸¸æ˜¯èµ°APIè¦æ ¼</p>
</blockquote>
<ul>
<li>
<p>System call ä½œæ¥­ç³»çµ±æä¾›çš„æœå‹™é …ç›®ç¨®é¡. (3-8 ~ 3-9)</p>
<ol>
<li>
<p><strong>Process Control</strong></p>
<p>e.g. å»ºç«‹, çµ‚æ­¢, æš«åœ, æ¢å¾©åŸ·è¡Œprocess, set/read attribute</p>
</li>
<li>
<p><strong>File Management</strong></p>
<p>e.g. å»ºç«‹, è®€æª”, å¯«æª”, é–‹æª”, é—œæª”, æ›´æ”¹æª”å, è®Šæ›´æª”æ¡ˆæŒ‡æ¨™, åˆªé™¤</p>
</li>
<li>
<p><strong>Device Management</strong></p>
<p>è¨­å‚™ç®¡ç†</p>
</li>
<li>
<p><strong>Information of Maintenance</strong></p>
<p>e.g. å–å¾—ç³»çµ±æ—¥æœŸ/æ™‚é–“, å–å¾—processå±¬æ€§ç­‰ç­‰</p>
</li>
<li>
<p><strong>Communications</strong></p>
<p>ç¨‹åºprocessä¹‹é–“çš„é€šè¨Š, è€Œä¸”åªé‡å°â€œmessage passingâ€æ–¹å¼æä¾›æœå‹™</p>
</li>
<li>
<p><strong>Protections</strong></p>
<p>ç¡¬é«”è³‡æºçš„ä¿è­·, æª”æ¡ˆå­˜å–æ¬Šåˆ©çš„æ§åˆ¶HW resources protection, File access control, etc.</p>
</li>
</ol>
</li>
<li>
<p>System call ä¹‹åƒæ•¸ (parameters) å‚³éçš„ä¸‰ç¨®æ–¹å¼</p>
<ol>
<li>
<p>åˆ©ç”¨<strong>æš«å­˜å™¨</strong> (Registers) ä¿å­˜åƒæ•¸</p>
<ul>
<li>
<p>å„ªé»ï¼š(1) æœ€ç°¡å–® (2) å­˜å–é€Ÿåº¦æœ€å¿« (without memory access)</p>
</li>
<li>
<p>ç¼ºé»ï¼šä¸é©ç”¨æ–¼å¤§é‡åƒæ•¸ä¹‹æƒ…æ³</p>
</li>
</ul>
</li>
<li>
<p>åˆ©ç”¨ <strong>Memory</strong>ï¼Œä»¥ Block (Table) å„²å­˜é€™äº›åƒæ•¸ï¼Œä¸¦ä¸”å°‡æ­¤è¡¨æ ¼çš„èµ·å§‹ä½ç½®æ–¼ä¸€å€‹ register ä¸­ï¼Œpass çµ¦ OS</p>
<ul>
<li>
<p>å„ªé»ï¼šé©ç”¨æ–¼å¤§é‡åƒæ•¸</p>
</li>
<li>
<p>ç¼ºé»ï¼šå­˜å–é€Ÿåº¦æ¯”è¼ƒæ…¢ (need memory access)ï¼Œä¸”æ“ä½œè¼ƒç‚ºéº»ç…©</p>
</li>
</ul>
</li>
<li>
<p>åˆ©ç”¨ Stack (ç³»çµ±çš„å †ç–Šï¼‰å°‡åƒæ•¸pushå…¥æ­¤Stackï¼ŒOSå† pop from Stackï¼Œä»¥å–å¾—åƒæ•¸</p>
<ul>
<li>
<p>å„ªé»ï¼šä¹Ÿé©ç”¨æ–¼å¤§é‡åƒæ•¸ä¹‹ç‹€æ³ï¼Œæ“ä½œä¹Ÿç°¡å–®</p>
</li>
<li>
<p>ç¼ºé»ï¼šå †ç–ŠStackç©ºé–“è¦ç•™å¤§ä¸€é»ï¼Œå¦å‰‡å¯èƒ½æœƒoverflowï¼Œå †ç–Šå¦‚æœå¹³å‡å°‘é‡ï¼Œç”¨æš«å­˜å™¨ï¼›å¦‚æœå¤§é‡ï¼Œå°±ç”¨è¨˜æ†¶é«”</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="osä¹‹ç³»çµ±æ¶æ§‹-structure-åˆ†é¡">OSä¹‹ç³»çµ±æ¶æ§‹ (Structure) åˆ†é¡</h4>
<ol>
<li>
<p><strong>Simple</strong></p>
<p>ä¾‹ï¼šMS-DOS (resident system program, device driver, etc. ç„¡dual-modeè¨­è¨ˆ)</p>
</li>
<li>
<p>More complex than simple</p>
<p>ä¾‹ï¼šUNIX</p>
<ul>
<li>Limited by Hardware functionality å—é™æ–¼ç¡¬é«”åŠŸèƒ½æ€§</li>
<li>The original UNIX had limited structuring</li>
<li>The UNIXåŒ…å«å…©å€‹separate parts:
<ol>
<li>System Programs</li>
<li>The kernel</li>
</ol>
</li>
<li>Beyond simple but not fully layered</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/Gb4MPfz.png"
        data-srcset="https://i.imgur.com/Gb4MPfz.png, https://i.imgur.com/Gb4MPfz.png 1.5x, https://i.imgur.com/Gb4MPfz.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/Gb4MPfz.png"
        title="image-20240126171044726" /></p>
</li>
<li>
<p><strong>Layered approach</strong></p>
<ul>
<li>
<p>å®šç¾©ï¼š</p>
<ol>
<li>
<p>æ¡å– Top-Down æ–¹å¼åˆ‡å‰²ç³»çµ±åŠŸèƒ½/å…ƒä»¶ï¼Œä»¥é™ä½è¤‡é›œåº¦</p>
</li>
<li>
<p>å…ƒä»¶/æ¨¡çµ„ä¹‹é–“ä¾ç…§å‘¼å«é—œä¿‚åˆ†å±¤ï¼Œå³ä¸Šå±¤å¯ä»¥ä½¿ç”¨ä¸‹å±¤åŠŸèƒ½ï¼Œä½†ä¸‹å±¤ä¸å¯ä»¥ä½¿ç”¨ä¸Šå±¤åŠŸèƒ½ï¼ˆä¸Šå¯ä»¥callä¸‹ï¼Œä¸‹ä¸èƒ½callä¸Šï¼‰</p>
</li>
<li>
<p>æ¸¬è©¦æ™‚ä½¿ç”¨ Bottom-up æ–¹å¼ä¾†é€²è¡Œæ¸¬è©¦é™¤éŒ¯ï¼Œæ¯”è¼ƒå®¹æ˜“çŸ¥é“bugæ˜¯è½åœ¨å“ªä¸€å±¤</p>
</li>
<li>
<p>å±¤æ¬¡çš„åŠƒåˆ†æ²’æœ‰æ˜ç¢ºè¦å®šï¼Œé€šå¸¸ç¬¬é›¶å±¤æ˜¯ç¡¬é«”ï¼Œæœ€å¤–å±¤æ˜¯user interface</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/stqQdbu.png"
        data-srcset="https://i.imgur.com/stqQdbu.png, https://i.imgur.com/stqQdbu.png 1.5x, https://i.imgur.com/stqQdbu.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/stqQdbu.png"
        title="image-20240126171244198" /></p>
</li>
</ol>
</li>
<li>
<p>å„ªé»ï¼š</p>
<ol>
<li>é™ä½è¨­è¨ˆè¤‡é›œåº¦</li>
<li>æœ‰åŠ©æ–¼åˆ†å·¥</li>
<li>æ¸¬è©¦ã€é™¤éŒ¯ã€ç¶­è­·å®¹æ˜“</li>
</ol>
</li>
<li>
<p>ç¼ºé»ï¼š</p>
<ol>
<li>
<p>å¾ˆé›£åšåˆ°å¾ˆç²¾ç¢ºçš„å±¤æ¬¡åŠƒåˆ†</p>
</li>
<li>
<p>è‹¥å±¤æ¬¡æ•¸å¤ªå¤šï¼Œå‰‡ç³»çµ±æ•ˆèƒ½å¯èƒ½æœƒéå¸¸çš„å·®</p>
<p>If too many layer, then system performance would be very poor.</p>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>Microkernel</strong> ğŸŒ  å¾®æ ¸å¿ƒ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/rVjyr8e.jpg"
        data-srcset="https://i.imgur.com/rVjyr8e.jpg, https://i.imgur.com/rVjyr8e.jpg 1.5x, https://i.imgur.com/rVjyr8e.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/rVjyr8e.jpg"
        title="image-20240126171721680" /></p>
<ul>
<li>
<p>ç”±CMUï¼ˆå¡å…§åŸº-ç¾éš†å¤§å­¸ï¼‰ç‡å…ˆæå‡ºï¼Œä»£è¡¨ç”¢å“ç‚º Mach O.S.</p>
</li>
<li>
<p>å®šç¾©ï¼šå°‡kernelä¸­ä¸€äº›Non-essential servicesï¼ˆæ¯”è¼ƒä¸æ˜¯é‚£éº¼é‡è¦çš„æœå‹™ï¼‰è‡ªkernelä¸­ç§»é™¤ï¼ˆä¸åœ¨kernel modeä¸­é‹è¡Œï¼‰ï¼Œæ”¹æˆåœ¨user sideæä¾›æœå‹™ï¼Œåœ¨user modeä¸­ï¼Œä»¥system programsçš„æ–¹å¼å­˜åœ¨ï¼Œå¦‚æ­¤ä¸€ä¾†ï¼Œå¯ä»¥å¾—åˆ°ä¸€å€‹æ¯”è¼ƒå°çš„kernelï¼Œç¨±ä¹‹ç‚ºmicrokernel</p>
</li>
<li>
<p>ä¸€èˆ¬è€Œè¨€ï¼Œmicrokernelæä¾›ä¸‹åˆ—ä¸‰å€‹minimum servicesï¼š</p>
<ol>
<li>Process control</li>
<li>Memory managementï¼ˆä¸åŒ…å«virtual memoryï¼‰</li>
<li>Process Communicationsï¼ˆæä¾›message passingæœå‹™è€Œå·²ï¼‰</li>
</ol>
</li>
<li>
<p>å„ªé»</p>
<ol>
<li>Easier to extend a microkernel</li>
<li>Easier to port the the O.S. to new architectures (ç¡¬é«”æ¶æ§‹)</li>
<li>More reliable</li>
<li>More secure</li>
</ol>
<blockquote>
<p>èªªæ˜å¦‚ä¸‹ï¼š</p>
<p>1ï¸âƒ£ æœå‹™çš„å¢åŠ è·Ÿåˆªé™¤æ˜¯å®¹æ˜“çš„ï¼Œå› ç‚ºé€™äº›æœå‹™æ˜¯åœ¨user sideåŸ·è¡Œï¼Œæ‰€ä»¥æœå‹™çš„å¢åˆªä¸é ˆè¦ç‰½æ‰¯åˆ° kernelä¹Ÿè¦æ›´å‹•ï¼Œå³ä½¿è¦ï¼Œä¹Ÿæ˜¯å°å¹…åº¦ä¿®æ”¹</p>
<p>2ï¸âƒ£ å› ç‚ºkernelå¾ˆå°ï¼Œæ‰€ä»¥ä½œæ¥­ç³»çµ±ç§»æ¤åˆ°æ–°çš„ç¡¬é«”å¹³å°ä¹‹æ›´å‹•å¹…åº¦ä¸å¤§</p>
<p>3ï¸âƒ£ï¼†4ï¸âƒ£ è¬ä¸€æŸå€‹æœå‹™åœ¨åŸ·è¡Œä¸­æ›æ‰äº†ï¼Œå……å…¶é‡åªæ˜¯ç›¸ç•¶æ–¼ä¸€å€‹ user process æ›æ‰è€Œå·²ï¼Œå°hardwareã€kernel ä»¥åŠå…¶å®ƒ user processes æ²’æœ‰ä¸è‰¯å½±éŸ¿ï¼Œæ‰€ä»¥æ›´åŠ å®‰å…¨å¯é </p>
</blockquote>
</li>
<li>
<p>ç¼ºé»</p>
<p>Performance overhead of user space to kernel space communication</p>
<p>æ•ˆèƒ½è¼ƒå·®ï¼Œå› ç‚ºå……æ–¥è‘—å¤§é‡user modeèˆ‡kernel modeä¹‹é–“è¨Šæ¯çš„å‚³é</p>
<blockquote>
<p>Microkernelçš„ç›¸åè© <strong>Monolithic kernel</strong></p>
<p>å®šç¾©ï¼š</p>
<ul>
<li>
<p>æ‰€æœ‰çš„servicesçš†é ˆrun in kernel mode</p>
</li>
<li>
<p>å¤§éƒ¨åˆ†å•†ç”¨ä½œæ¥­ç³»çµ±éƒ½æ˜¯ monolithic kernel</p>
</li>
<li>
<p>Monolithic kernelä¹‹å„ªç¼ºé»èˆ‡å¾®æ ¸å¿ƒç›¸å</p>
</li>
</ul>
</blockquote>
</li>
</ul>
</li>
<li>
<p>Module</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/ysuqo39.jpg"
        data-srcset="https://i.imgur.com/ysuqo39.jpg, https://i.imgur.com/ysuqo39.jpg 1.5x, https://i.imgur.com/ysuqo39.jpg 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/ysuqo39.jpg"
        title="image-20240126172335461" /></p>
<ul>
<li>
<p>Many OS implement loadable kernel modules</p>
</li>
<li>
<p>Use object-oriented approach</p>
</li>
<li>
<p>Each core component is separate</p>
</li>
<li>
<p>Each talks to the others over known interface</p>
</li>
<li>
<p>Each is loadable as needed within the kernel</p>
</li>
<li>
<p>ç°¡è¨˜ï¼šSimilar to layers but with more flexible, æ•ˆèƒ½ä¹Ÿæ›´å¥½</p>
</li>
<li>
<p>Examples: Linux, Solaris, etc.</p>
</li>
</ul>
</li>
<li>
<p>Hybrid æ··åˆå‹</p>
<ul>
<li>
<p>ç¾ä»£çš„ä½œæ¥­ç³»çµ±å¾ˆé›£å­˜ç²¹æ­¸å±¬æ–¼æŸä¸€å‹</p>
</li>
<li>
<p>ä¾‹: Linux and Solaris æ˜¯ Monolithic (æ‰€æœ‰æœå‹™éƒ½åœ¨ kernel mode é‹è¡Œï¼‰ä¸”ä¹Ÿæ˜¯Modular approach for dynamic loading</p>
</li>
<li>
<p>ä¾‹: Windows mostly Monolithic, æœ‰æ™‚é‡å°ä¸åŒå®¢æˆ¶éœ€æ±‚åŠ ä¸Šmicrokernel for subsystem</p>
</li>
<li>
<p>ä¾‹: Apple MacOS ä¹Ÿæ˜¯æ··åˆçš„ï¼ŒkernelåŒ…å«ï¼š</p>
<ul>
<li>
<p>Mach: microkernelçš„ä»£è¡¨</p>
</li>
<li>
<p>éƒ¨åˆ†çš„ BSD UNiX</p>
</li>
<li>
<p>I/O kit</p>
</li>
<li>
<p>Dynamic loadable module (å«ä½œ kernel extension)</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/Y1SPbT0.png"
        data-srcset="https://i.imgur.com/Y1SPbT0.png, https://i.imgur.com/Y1SPbT0.png 1.5x, https://i.imgur.com/Y1SPbT0.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/Y1SPbT0.png"
        title="image-20240126172537764" /></p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h1 id="10-virtual-machine">10. Virtual Machine</h1>
<ul>
<li>å®šç¾©ï¼šåˆ©ç”¨SoftwareæŠ€è¡“ï¼Œæ¨¡æ“¬å‡ºä¸€ä»½èˆ‡åº•å±¤ç¡¬é«”ä¸€æ¨¡ä¸€æ¨£çš„åŠŸèƒ½ç•Œé¢ä¹‹æŠ½è±¡åŒ–æ©Ÿå™¨ (abstract machine) ç¨±ä¹‹</li>
</ul>
<p>ã€åœ–ç¤ºã€‘</p>
<ol>
<li>
<p><strong>Host</strong>: Underlying hardware system, Host OS, Host hardware</p>
</li>
<li>
<p><strong>VMM</strong> (Virtual Machine Manager) æˆ–Hypervisor: Creates and manages/runs virtual machineså°ˆé–€è² è²¬å»ºç«‹ã€ç®¡ç†ã€åŸ·è¡ŒVMçš„æ¨¡çµ„</p>
</li>
<li>
<p><strong>Guest</strong>: Process provided with virtual copy of the host Guest Applications, Guest OS</p>
</li>
</ol>
<p>![image-20240126172800689](/Users/wysiwyz/Library/Application Support/typora-user-images/image-20240126172800689.png)</p>
<blockquote>
<p>[æ] ä¹‹å…¶å®ƒè‹±æ–‡ï¼š</p>
<ul>
<li>
<p>Abstract hardware of a single computer into several different execution environments</p>
</li>
<li>
<p>Similar to layered approach, but layer creates virtual machine (VM)</p>
</li>
</ul>
<p>Hardware ä¸»è¦æœ‰CPU, Memory, I/O-Devices</p>
<p>å¦‚ä½•è®“VMä»¥ç‚ºè‡ªå·±ä¹Ÿæœ‰ä¸€é¡†CPUï¼ŸTime-sharing</p>
<p>Memoryï¼ŸVirtual Memory</p>
<p>I/O-Devicesï¼ŸSpooling, buffering</p>
</blockquote>
<ul>
<li>
<p>å„ªé»/å¥½è™•</p>
<ol>
<li>
<p>ä½œç‚ºæ¸¬è©¦é–‹ç™¼ä¸­çš„OSä¸€å€‹è‰¯å¥½çš„è² è¼‰å¹³å°ï¼Œå…·æœ‰ä¸‹åˆ—å¥½è™•</p>
<ol>
<li>å…¶å®ƒuser, user processeså·¥ä½œä»å¯ä»¥æŒçºŒé‹ä½œï¼Œä¸é ˆæš«åœ</li>
<li>è¬ä¸€æ¸¬è©¦ä¸­çš„OSä¸ç©©å®šã€æ›æ‰æˆ–æ˜¯å¤±æ•—äº†ï¼Œä¹Ÿä¸æœƒå½±éŸ¿Host hardware OSå…¶å®ƒuser processä¹‹å·¥ä½œï¼Œå› ç‚ºåªæ˜¯ç›¸ç•¶æ–¼ä¸€å€‹user process failsè€Œå·²ï¼Œæœƒå°ç³»çµ±æœ‰é‡å¤§å±å®³</li>
</ol>
</li>
<li>
<p>åŒä¸€éƒ¨Host Hardwareå¯ä»¥åŸ·è¡Œå¤šå€‹OSï¼Œrunning onå¤šå€‹virtual machineså¯ç¯€çœæˆæœ¬</p>
</li>
<li>
<p>Consolidation: åœ¨cloud computing environmentä¸­ï¼Œæˆ‘å€‘æœƒç”¨æœ‰é™çš„æ©Ÿå™¨ï¼ˆç¡¬é«”ï¼‰ï¼Œå»ºç«‹ç‚ºæ•¸çœ¾å¤šçš„virtual machinesï¼Œæˆ‘å€‘å¯ä»¥ä¾VMä¸Šçš„applicationsä¹‹åŸ·è¡Œè² æ“”è¼•é‡ï¼Œèª¿å‹•Host Machinesè³‡æºä½œå› æ‡‰çš„æ”¯æ´</p>
</li>
<li>
<p>VMè¼ƒç‚ºå®‰å…¨ï¼šå¦‚æœVMè¢«ç—…æ¯’å…¥ä¾µï¼Œä¸è‡³æ–¼æ“´æ•£ï¼Œå› ç‚ºVMä¹‹é–“æ˜¯ç¨ç«‹çš„</p>
</li>
<li>
<p>å¯ä»¥Freeze, suspend, running VM åŠclone (è¤‡è£½) VM</p>
</li>
</ol>
</li>
</ul>
<h4 id="vmmçš„implementation">VMMçš„implementation</h4>
<ol>
<li>
<p>Type 0 Hypervisor:</p>
<ul>
<li>
<p>Hardware-based solutions via firmware</p>
</li>
<li>
<p>e.g. IBM, LPARS and Oracle, LDOMS, etc</p>
</li>
</ul>
</li>
<li>
<p>Type 1 Hypervisor:</p>
<ul>
<li>
<p>OS-like software: e.g. VMWare ESX, Joyent SmartOS, Citrix XenServer</p>
</li>
<li>
<p>General purpose OS that provides VMM functions (services)</p>
<p>e.g. MicroSoft Window Server with HyperV, RedHat Linux with KVM</p>
</li>
</ul>
</li>
<li>
<p>Type 2 Hypervisor:</p>
<ul>
<li>
<p>Applications level provides VMM functionality</p>
</li>
<li>
<p>e.g. Parallel DeskTop (install Windows on Apple), Oracle VirtualBox</p>
</li>
</ul>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/WMKlkgB.png"
        data-srcset="https://i.imgur.com/WMKlkgB.png, https://i.imgur.com/WMKlkgB.png 1.5x, https://i.imgur.com/WMKlkgB.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/WMKlkgB.png"
        title="image-20240126173533373" /></p>
<h1 id="11-vmmhypervisor-implementation">11. VMM(Hypervisor) Implementation</h1>
<table>
<thead>
<tr>
<th></th>
<th>VMM</th>
<th>level of implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.</td>
<td>Type 0 Hypervisor</td>
<td>hardware level</td>
</tr>
<tr>
<td>2.</td>
<td>Type 1 Hypervisor</td>
<td>kernel mode</td>
</tr>
<tr>
<td>3.</td>
<td>Type 2 Hypervisor</td>
<td>user mode</td>
</tr>
</tbody>
</table>
<p>å…±åŒç‰¹å¾µï¼šå®ƒå€‘å»ºç«‹çš„VMä¸¦ä¸ç­‰æ–¼åº•å±¤çš„ç¡¬é«”</p>
<p>å…¶å®ƒè®Šå½¢å¦‚ä¸‹ï¼š</p>
<ol start="4">
<li>
<p>Paravirtualization:</p>
<ul>
<li>
<p>The guest OS need modify to work in cooperation with VMM to optimize performance</p>
</li>
<li>
<p>ğŸ¥It presents guest with similar but not identical to hardware(HW).</p>
<p>å‰µé€ å‡ºä¾†çš„ç¡¬é«”ï¼Œå‘ˆç¾å‡ºä¾†çµ¦guestèˆ‡åº•å±¤ç¡¬é«”ä¸¦ä¸å®Œå…¨ä¸€æ¨£ï¼ˆåªæˆªå–éœ€è¦çš„éƒ¨åˆ†ï¼‰</p>
</li>
<li>
<p>ğŸ¥Guest must be modified to run on paravirtualization HW.</p>
<p>Guest OSå¦‚æœè¦åœ¨Paravirtualizationé‹è¡Œçš„è©±ï¼Œä¸€å®šè¦ä¿®æ”¹é</p>
</li>
</ul>
</li>
<li>
<p>Programming-environment Virtualization</p>
<ul>
<li>VMMs do not virtualize read HW, but instead create an optimized virtual system</li>
<li>e.g. Java Virtual Machine (JVM), Microsoft .NET</li>
</ul>
</li>
<li>
<p>Emulators æ¨¡æ“¬å™¨</p>
<ul>
<li>Allow application written from one hardware to run on a very different hardware, such as different type of CPU.</li>
</ul>
</li>
<li>
<p>Application Containment</p>
<ul>
<li>e.g. Oracle Solaris Zones, BSD Jails, IBM AIX WPARs</li>
<li>Solaris Zonesæ—©æœŸæ˜¯åˆ—åœ¨ParaVirtualizationè£¡é¢</li>
<li>å‰µé€ å‡ºä¾†çš„æ˜¯<strong>åŸ·è¡Œç’°å¢ƒ</strong>ï¼Œè€Œä¸æ˜¯ç¡¬é«”</li>
</ul>
</li>
</ol>
<blockquote>
<p>JVM is a Specification, not an implementation.</p>
<p>JVM spec è¦ç¯„äº†ä¸‰é»ï¼š</p>
<ol>
<li>Class Loader   ä¸‹è¼‰åˆ°clientç«¯</li>
<li>Class Verifier   é©—è­‰æ˜¯å¦å®‰å…¨</li>
<li>Java Interpreter å¦‚ä½•åœ¨ä¸åŒç¡¬é«”æ¶æ§‹ä¸Šé–‹ç™¼Java</li>
</ol>
</blockquote>
<h4 id="policyèˆ‡mechanism-æ”¿ç­–ç­–ç•¥-èˆ‡-æ©Ÿåˆ¶">Policyèˆ‡Mechanism (æ”¿ç­–/ç­–ç•¥) èˆ‡ æ©Ÿåˆ¶</h4>
<ul>
<li>
<p>Policyï¼š</p>
<ol>
<li>å®šç¾© &ldquo;What&rdquo; to be provided</li>
<li>ç¶“å¸¸æ”¹è®Š</li>
</ol>
</li>
<li>
<p>Mechanismï¼š</p>
<ol>
<li>å®šç¾©  &ldquo;How&rdquo; to do that</li>
<li>The underlying mechanism ç”šå°‘æ”¹è®Šæˆ–ä¸è®Š</li>
</ol>
</li>
<li>
<p>è¨­è¨ˆåŸå‰‡ï¼š</p>
<p>&ldquo;Policy èˆ‡ Mechanism å®œ separateï¼Œä»¥å¢é€² system flexibility&rdquo;</p>
<p>æ”¿ç­–èˆ‡æ©Ÿåˆ¶è¦éš”é›¢/ç¨ç«‹ï¼Œé€™æ¨£ç³»çµ±çš„ç¶­è­·/æ“´å……/åŠ å¼·/ç®¡ç†æœƒæ¯”è¼ƒå®¹æ˜“</p>
</li>
<li>
<p>èˆ‰ä¾‹ï¼šç¡¬é«”è³‡æºä¿è­· &mdash; I/Oã€Memoryã€CPU</p>
<ol>
<li>
<p>é‹ç”¨Timerä½œç‚ºCPU protection â¡ï¸ Mechanism   [é™„ç¨‹å¼]</p>
<p>Maximum Time Quantumå¤§å°åˆ¶å®š â¡ï¸ Policy   [åƒæ•¸]</p>
</li>
<li>
<p>CPUæ’ç­æ¡å„ªå…ˆæ¬Šæ’ç­ Priority scheduling â¡ï¸ Mechanism</p>
<p>Priorityå¤§å°ä¹‹å®šç¾© â¡ï¸ Policy</p>
</li>
</ol>
</li>
</ul>
<h2 id="ch4-process-management-èˆ‡-thread-management">Ch4: Process Management èˆ‡ Thread Management</h2>
<ol>
<li>Processå®šç¾©ã€èˆ‡Programæ¯”è¼ƒ</li>
<li>ğŸŒ  Process Control Block (PCB) å…§å®¹</li>
<li>ğŸŒ ğŸŒ ğŸŒ ğŸŒ ğŸŒ  Process State Transition Diagram (STD)</li>
<li>ğŸŒ ğŸŒ ğŸŒ  Schedulerç¨®é¡ï¼šé•·æœŸæ’ç­å™¨ã€çŸ­æœŸæ’ç­å™¨ã€ä¸­æœŸæ’ç­å™¨</li>
<li>ğŸŒ ğŸŒ ğŸŒ  Context switching</li>
<li>ğŸŒ  Dispatcher, Dispatching latency åˆ†æ´¾å™¨èˆ‡åˆ†æ´¾å»¶é²</li>
<li>ğŸŒ ğŸŒ ğŸŒ ğŸŒ ğŸŒ  <strong>Process Control Operations</strong>ï¼ˆä»¥ UNIX system call ç‚ºä¸»çš„ç¨‹å¼è¿½è¹¤ï¼‰</li>
<li>ğŸŒ ğŸŒ ğŸŒ  è©•ä¼°CPU scheduling performanceä¹‹äº”å€‹criteria</li>
<li>ğŸŒ ğŸŒ ğŸŒ ğŸŒ ğŸŒ  å„ç¨®CPUæ’ç­æ³•å‰‡ä»‹ç´¹ä»¥åŠç›¸é—œåè©ï¼ˆ7å€‹æ’ç­æ³•å‰‡ï¼‰ (Starvation, Aging, preemptive, non-preemptive, Convoy effect)</li>
<li>ç‰¹å®šç³»çµ±æ’ç­è¨­è¨ˆ (âœ¨âœ¨multiprocessors system, âœ¨âœ¨âœ¨ real-time system)</li>
<li>Thread Management</li>
</ol>
<h1 id="12-process">12. Process</h1>
<ul>
<li>
<p>å®šç¾©ï¼šA program in execution åŸ·è¡Œä¸­çš„ç¨‹å¼ [æé¾æœ¬]</p>
<ul>
<li>Processå»ºç«‹ä¹‹å¾Œï¼Œå…¶ä¸»è¦çµ„æˆæœ‰ï¼š
<ul>
<li>Process No. (ID)</li>
<li>Process State</li>
<li>Code section, data section
(é€™å…©å€‹åˆèµ·ä¾†å°±æ˜¯process memory space)</li>
<li>Programming Counter (PC, ç¨‹å¼è¨ˆæ•¸å™¨ - å…§æ”¾ä¸‹ä¸€æ¢æŒ‡ä»¤çš„ä½å€ï¼‰</li>
<li>Stack (ä¿å­˜åƒæ•¸ã€å€åŸŸè®Šæ•¸ã€è¿”å›ä½å€,etc.)</li>
<li>CPU registers value, etc.</li>
</ul>
</li>
<li>æ˜¯OSåˆ†é… Resource ä¹‹å°è±¡å–®ä½ï¼ˆResource: CPU, I/O-Devices, Memory)</li>
</ul>
</li>
<li>
<p>èˆ‡Programï¼ˆç¨‹å¼ï¼‰æ¯”è¼ƒ</p>
<table>
<thead>
<tr>
<th>Process</th>
<th>Program</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸ·è¡Œä¸­çš„ç¨‹å¼</td>
<td>Just a File stored in storage device</td>
</tr>
<tr>
<td>Active entity</td>
<td>Passive  entity</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="process-control-block-pcb-å…§å®¹">Process Control Block (PCB) å…§å®¹</h4>
<ul>
<li>å®šç¾©ï¼šOSç‚ºäº†ç®¡ç†æ‰€æœ‰Processesï¼Œæœƒåœ¨ kernel memory ä¸­ï¼Œæ›¿æ¯ä¸€å€‹processå„å­—ï¼Œæº–å‚™ä¸€å€‹ Blockï¼ˆè¡¨æ ¼ï¼‰è¨˜éŒ„ process ä¹‹æ‰€æœ‰ç›¸é—œè³‡è¨Š</li>
</ul>
<h4 id="pcbä¸»è¦å…§å®¹æœ‰å…«å€‹">PCBä¸»è¦å…§å®¹æœ‰ï¼ˆå…«å€‹ï¼‰</h4>
<ol>
<li>Process No.(ID): è™•ç†ç¨‹å¼ç·¨è™Ÿæ˜¯ <strong>unique</strong>ï¼ˆå”¯ä¸€çš„ï¼‰</li>
<li>Process state: e.g. ready, running, wait, etc.</li>
<li>Programming Counter: å…§æ”¾the <strong>next</strong> instructionâ€™s address</li>
<li>CPU registers: e.g. è¨ˆéŒ„ä½¿ç”¨åˆ°æš«å­˜å™¨çš„å€¼</li>
</ol>
<p>â€‹              e.g. Accumulator, PSW (process status word), Stack Top, etc.</p>
<ol start="5">
<li>
<p>CPU scheduling info:</p>
<p>e.g. processå„ªå…ˆæ¬Šå€¼ process arrival time (FIFO), etc.</p>
</li>
<li>
<p>Memory Management info</p>
<p>(éš¨OS Memoryè¨˜æ†¶é«”ç®¡ç†æ–¹æ³•ä¸åŒï¼Œç´€éŒ„ä¸åŒè³‡è¨Šï¼‰</p>
<p>e.g. Base/limit register, æˆ– Page Table æˆ– segment table</p>
</li>
<li>
<p>Accounting Info</p>
<p>ä¾‹: processå·²ç”¨å¤šå°‘cpu timeï¼Œå“ªäº›è³‡æºï¼Œé‚„å‰©å¤šå°‘è³‡æºã€cpu timeå¯ç”¨, etc.</p>
<blockquote>
<p>Note:</p>
<p>ç›®çš„ (1) è¨˜å¸³ã€æ”¶éŒ¢ (2) Administrator èª¿æ ¡æ•ˆèƒ½çš„ä¾æ“š</p>
</blockquote>
</li>
<li>
<p>I/O Status info</p>
<p>ä¾‹: processå·²ç™¼å‡ºå¤šå°‘I/O-request, å®Œæˆç‹€æ³å¦‚ä½•, ä½”ç”¨å“ªäº›I/O resources (ç›®å‰) etc.</p>
</li>
</ol>
<h4 id="quests-1">Quests</h4>
<ul>
<li>
<p>ä¸‹åˆ—å“ªä¸€é …ä¸¦æœªéš¸å±¬æ–¼PCBï¼Ÿ</p>
<ol>
<li>
<p>Process number</p>
</li>
<li>
<p>CPU register</p>
</li>
<li>
<p>I/O-Device Queue</p>
<p>â¡ï¸é€™æ˜¯OSæˆ–device driveråœ¨ç®¡çš„ã€‚å®¹æ˜“èˆ‡I/O-Status Infoæ··æ·†ã€‚</p>
</li>
<li>
<p>CPU scheduling info</p>
</li>
<li>
<p>Memory Management info</p>
</li>
</ol>
</li>
<li>
<p>Which of the following is not encoded in the process control block?</p>
<ol>
<li>
<p>process state</p>
</li>
<li>
<p>the bitmap of this process</p>
<p>â¡ï¸Bitmapæ˜¯ç£ç¢Ÿåœ¨ç”¨çš„ï¼ˆDiskå¯ç”¨ç©ºé–“ç®¡ç†æ–¹æ³•ä¹‹ä¸€)</p>
</li>
<li>
<p>cpu register</p>
</li>
<li>
<p>memory management</p>
</li>
</ol>
</li>
</ul>
<h4 id="processçš„state-transition-diagram">Processçš„State Transition Diagram</h4>
<ul>
<li>
<p>STD, ç‹€æ…‹è½‰æ›åœ–</p>
</li>
<li>
<p>ç›®çš„ï¼šæè¿°processä¹‹lifecycle</p>
</li>
<li>
<p>ç‰ˆæœ¬æœ‰ä¸‰ç¨®</p>
<ol>
<li>æé¾æœ¬       5å€‹ status ä¹‹STD â¡ï¸ çœ‹ä¸åˆ°mediumä¸­ç¨‹</li>
<li>Stallingç‰ˆ 7å€‹ status STD</li>
<li>UNIX STD (Stallingç‰ˆï¼‰</li>
</ol>
</li>
</ul>
<h5 id="æé¾æœ¬äº”å€‹-status-ä¹‹-std">æé¾æœ¬ï¼šäº”å€‹ Status ä¹‹ STD</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/bqxOpsF.png"
        data-srcset="https://i.imgur.com/bqxOpsF.png, https://i.imgur.com/bqxOpsF.png 1.5x, https://i.imgur.com/bqxOpsF.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/bqxOpsF.png"
        title="image-20240126181011915" /></p>
<table>
<thead>
<tr>
<th>State</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>New (create)</td>
<td>Processè¢«å»ºç«‹ï¼Œå·²åˆ†å¾—PCBç©ºé–“ï¼Œå°šæœªè¼‰å…¥memoryï¼ˆæˆ–å°šæœªå–å¾—memoryè³‡æºï¼‰(æœ‰èº«åˆ†è­‰ä½†ä¸çŸ¥é“ä½å“ª)</td>
</tr>
<tr>
<td>Ready</td>
<td>Processå·²åœ¨memoryä¸­ï¼Œä¸”åœ¨ready queueå…§ï¼Œå…·æœ‰è³‡æ ¼çˆ­å¥ªCPU</td>
</tr>
<tr>
<td>Running</td>
<td>Processå–å¾—CPUï¼ŒåŸ·è¡Œä¸­</td>
</tr>
<tr>
<td>Wait (blocked)</td>
<td>Processåœ¨waiting queueä¸­ï¼Œwaiting for I/O completed or event occurs. ä¸æœƒèˆ‡å…¶å®ƒ process çˆ­å¥ª/ç«¶çˆ­cpu</td>
</tr>
<tr>
<td>Exit (terminate/ zombie/ abort)</td>
<td>Processå®Œæˆå·¥ä½œ æ­£å¸¸çµæŸ æˆ– ç•°å¸¸çµ‚æ­¢ï¼Œæ­¤æ™‚å¯èƒ½å…¶PCBç©ºé–“å°šæœªå›æ”¶ï¼Œå› ç‚ºè¦ç­‰å…¶çˆ¶è¦ª (Parent Process) collectæ”¶é›†å®Œè©²å­Processä¹‹æˆæœå¾Œï¼Œæ‰æœƒå›æ”¶PCBé€™å€‹è¡¨æ ¼çš„ç©ºé–“ã€‚å…¶å®ƒè³‡æº(memory, cpu, I/O-Devices)å·²å›æ”¶</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Transition</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1ï¸âƒ£</td>
<td>ä¹Ÿå«Admit, ç•¶Memory spaceè¶³å¤ æ™‚, å¯ä»¥ç”±long-term scheduler (in batch sys.) æ±ºå®šå°‡æ­¤Jobè¼‰å…¥åˆ°memoryä¸­</td>
</tr>
<tr>
<td>2ï¸âƒ£</td>
<td>å« dispatchï¼Œç”± short-term scheduler (cpu scheduler) æ±ºå®šè®“é«˜å„ªå…ˆæ¬Š process å–å¾— cpu</td>
</tr>
<tr>
<td>3ï¸âƒ£</td>
<td>å«time-out/interrupted, etc. åŸ·è¡Œä¸­çš„Processå› æŸäº›äº‹ä»¶ç™¼ç”Ÿè€Œè¢«è¿«æ”¾æ£„cpuï¼Œå›å»ready Queue. e.g. time-out, interruptç™¼ç”Ÿ, é«˜å„ªå…ˆprocessåˆ°é”, æ’åˆ°éšŠä¼ä½ ä½ç½®çš„å‰é¢</td>
</tr>
<tr>
<td>4ï¸âƒ£</td>
<td>å« wait for I/O-Completed or event occurs</td>
</tr>
<tr>
<td>5ï¸âƒ£</td>
<td>I/O-Completed æˆ– Event occurs</td>
</tr>
<tr>
<td>6ï¸âƒ£</td>
<td>Processå®Œå·¥æˆ–ç•°å¸¸è™•ç†</td>
</tr>
</tbody>
</table>
<h4 id="stalling">Stalling</h4>
<ul>
<li>
<p>Medium term scheduling</p>
</li>
<li>
<p>Which of the five status has the property that its process is in memory?</p>
<p>ã€”Newã€•  ã€”<strong>Ready</strong>ã€•  ã€”<strong>Running</strong>ã€•  ã€”<strong>Wait</strong>ã€•  ã€”Exitã€•</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Transition</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Blocked/suspend</td>
<td>Process è¢« swap out åˆ° Disk ä¸­æš«å­˜ï¼Œå³ blocked (asleep) in Disk</td>
</tr>
<tr>
<td>Ready/suspend</td>
<td>event occurs or I/O-Completed.</td>
</tr>
<tr>
<td></td>
<td>ready in Disk</td>
</tr>
<tr>
<td>Suspend/ (swap out).  1ï¸âƒ£</td>
<td>ç•¶è¨˜æ†¶é«”memoryç©ºé–“ä¸è¶³ï¼Œåˆæœ‰å…¶å®ƒé«˜å„ªå…ˆæ¬Šprocessé ˆæ›´å¤šè¨˜æ†¶é«”ç©ºé–“æ™‚ï¼Œæœƒç”±ä¸­æœŸæ’ç­å™¨ medium-term scheduler æ±ºå®šå°‡ blocked process</td>
</tr>
<tr>
<td>Activate/ swap in</td>
<td>swap-outåˆ° Diskï¼Œä»¥ç©ºå‡ºè¨˜æ†¶é«”ç©ºé–“ memory space (è¨˜æ†¶é«”-&gt;ç£ç¢Ÿ) ç•¶memory spaceæœ‰ç©ºï¼Œmedium-term schedulerå¯ä»¥å°‡å®ƒå€‘ swap in å›memoryä¸­ï¼Œready for execution</td>
</tr>
<tr>
<td>Suspend/ (swap out). 2ï¸âƒ£</td>
<td>æ”¯æŒtransitionä¹‹ç†ç”±æœ‰å…©å€‹: <!-- raw HTML omitted -->1ï¸âƒ£ æ‰€æœ‰blocked processesçš†swap outå¾Œ, è¨˜æ†¶é«”ç©ºé–“ä»ä¸è¶³æ™‚</td>
</tr>
</tbody>
</table>
<iframe class="LikeCoin" height="235" src="https://button.like.co/in/embed/wysiwyz/button?referrer=http%3a%2f%2fwysiwyz.github.io%2fposts%2foperating_system%2f" width="100%" frameborder=0></iframe><div class="disqus markdown">
                
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'blog-wysiwyz';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </div>
        </div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 1993-01-26</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://wysiwyz.github.io/posts/operating_system/" data-hashtag="OperatingSystem"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://wysiwyz.github.io/posts/operating_system/" data-title="Operating_system"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/operatingsystem/">OperatingSystem</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/direct-style/" class="prev" rel="prev" title=""><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i></a>
            <a href="/posts/algorithm/" class="next" rel="next" title="Algorithm">Algorithm<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">strict with yourself; lenient with others.</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-CCS3QPVY5N', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-CCS3QPVY5N" async></script></body>
</html>
