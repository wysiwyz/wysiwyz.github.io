<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>1Z0-819 æ›¾å¸«ç­†è¨˜ (2/duology) - Ich bin yiwen.</title><meta name="Description" content="An ordinary space for storing and groups pieces of articles."><meta property="og:title" content="1Z0-819 æ›¾å¸«ç­†è¨˜ (2/duology)" />
<meta property="og:description" content="# 01 æ³›å‹å’Œé›†åˆç‰©ä»¶ æ³›å‹ Java 5 ä¹‹å¾ŒåŠ å…¥æ³›å‹ï¼Œä½¿å‹åˆ¥ä½¿ç”¨å¤šäº†å¦ä¸€ç¨®å½ˆæ€§ã€‚
é›†åˆç‰©ä»¶ï¼ˆç”¨ä¾†è£å¡«ç‰©ä»¶ï¼‰ï¼‹æ³›å‹ï¼Œå¯ä»¥é™åˆ¶è£å¡«ç‰©ä»¶çš„å‹åˆ¥ã€‚
ä½¿ç”¨æ³›å‹çš„æ•ˆç›Š æä¾›æ›´å½ˆæ€§çš„ã€Œå‹åˆ¥å®‰å…¨ type safetyã€æª¢æŸ¥æ©Ÿåˆ¶ï¼ŒåŸæœ¬åœ¨åŸ·è¡Œæ™‚æ‰èƒ½ç™¼ç¾çš„å‹åˆ¥éŒ¯èª¤ï¼Œç¾åœ¨åœ¨ç·¨è­¯æ™‚æœŸå°±å¯ä»¥é ç™¼ç¾ åœ¨é›†åˆç‰©ä»¶ Collections è£¡å¤§é‡ä½¿ç”¨ï¼Œé™åˆ¶å…§æ¶µç‰©ä»¶ä¹‹å‹åˆ¥ æ¸›å°‘è½‰å‹ casting éœ€è¦ï¼Œä½¿ç¨‹å¼ç¢¼æ›´ç°¡æ½” ä½¿ç”¨æ³›å‹è¨­è¨ˆé¡åˆ¥ å¯ä»¥å°‡ç¨‹å¼ç¢¼è£¡çš„ç¬¦è™Ÿ Tæ›æˆ String( å³ UseString())ï¼Œæˆ–æ›æˆ Shirt (å³ UseShirt()) å¸¸è¦‹çš„ç¬¦è™ŸåŠè¡¨ç¤ºæ–¹å¼å¦‚ä¸‹ï¼š T -ã€Œå‹åˆ¥ï¼ˆtypeï¼‰ã€ E -ã€Œæˆå“¡ï¼ˆelementï¼‰ã€ K -ã€Œéµ - å€¼å°è£¡çš„éµï¼ˆkeyï¼‰ã€ V -ã€Œéµ - å€¼å°è£¡çš„å€¼ï¼ˆvalueï¼‰ã€ class UseAny&lt;T&gt; { private T t; public void add(T t) { this.t = t; } public T get() { return this.t; } } class UseString { private String message; public void add(String message) { this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://wysiwyz.github.io/posts/ocpjp_11_2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-18T17:50:34+08:00" />
<meta property="article:modified_time" content="2022-12-18T17:50:34+08:00" /><meta property="og:site_name" content="Ich bin yiwen." />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="1Z0-819 æ›¾å¸«ç­†è¨˜ (2/duology)"/>
<meta name="twitter:description" content="# 01 æ³›å‹å’Œé›†åˆç‰©ä»¶ æ³›å‹ Java 5 ä¹‹å¾ŒåŠ å…¥æ³›å‹ï¼Œä½¿å‹åˆ¥ä½¿ç”¨å¤šäº†å¦ä¸€ç¨®å½ˆæ€§ã€‚
é›†åˆç‰©ä»¶ï¼ˆç”¨ä¾†è£å¡«ç‰©ä»¶ï¼‰ï¼‹æ³›å‹ï¼Œå¯ä»¥é™åˆ¶è£å¡«ç‰©ä»¶çš„å‹åˆ¥ã€‚
ä½¿ç”¨æ³›å‹çš„æ•ˆç›Š æä¾›æ›´å½ˆæ€§çš„ã€Œå‹åˆ¥å®‰å…¨ type safetyã€æª¢æŸ¥æ©Ÿåˆ¶ï¼ŒåŸæœ¬åœ¨åŸ·è¡Œæ™‚æ‰èƒ½ç™¼ç¾çš„å‹åˆ¥éŒ¯èª¤ï¼Œç¾åœ¨åœ¨ç·¨è­¯æ™‚æœŸå°±å¯ä»¥é ç™¼ç¾ åœ¨é›†åˆç‰©ä»¶ Collections è£¡å¤§é‡ä½¿ç”¨ï¼Œé™åˆ¶å…§æ¶µç‰©ä»¶ä¹‹å‹åˆ¥ æ¸›å°‘è½‰å‹ casting éœ€è¦ï¼Œä½¿ç¨‹å¼ç¢¼æ›´ç°¡æ½” ä½¿ç”¨æ³›å‹è¨­è¨ˆé¡åˆ¥ å¯ä»¥å°‡ç¨‹å¼ç¢¼è£¡çš„ç¬¦è™Ÿ Tæ›æˆ String( å³ UseString())ï¼Œæˆ–æ›æˆ Shirt (å³ UseShirt()) å¸¸è¦‹çš„ç¬¦è™ŸåŠè¡¨ç¤ºæ–¹å¼å¦‚ä¸‹ï¼š T -ã€Œå‹åˆ¥ï¼ˆtypeï¼‰ã€ E -ã€Œæˆå“¡ï¼ˆelementï¼‰ã€ K -ã€Œéµ - å€¼å°è£¡çš„éµï¼ˆkeyï¼‰ã€ V -ã€Œéµ - å€¼å°è£¡çš„å€¼ï¼ˆvalueï¼‰ã€ class UseAny&lt;T&gt; { private T t; public void add(T t) { this.t = t; } public T get() { return this.t; } } class UseString { private String message; public void add(String message) { this."/>
<meta name="application-name" content="Ich bin yiwen.">
<meta name="apple-mobile-web-app-title" content="Ich bin yiwen."><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/moon_icon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://wysiwyz.github.io/posts/ocpjp_11_2/" /><link rel="prev" href="http://wysiwyz.github.io/posts/ocpjp_11/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "1Z0-819 æ›¾å¸«ç­†è¨˜ (2/duology)",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/wysiwyz.github.io\/posts\/ocpjp_11_2\/"
        },"genre": "posts","keywords": "Java, 1Z0-819","wordcount":  8587 ,
        "url": "http:\/\/wysiwyz.github.io\/posts\/ocpjp_11_2\/","datePublished": "2022-12-18T17:50:34+08:00","dateModified": "2022-12-18T17:50:34+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "celine"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Ich bin yiwen.">Ich bin yiwen.</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Ich bin yiwen.">Ich bin yiwen.</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">1Z0-819 æ›¾å¸«ç­†è¨˜ (2/duology)</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>celine</a></span>&nbsp;<span class="post-category">included in <a href="/categories/studynote/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>StudyNote</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-12-18">2022-12-18</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;8587 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;41 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#æ³›å‹">æ³›å‹</a>
      <ul>
        <li><a href="#ä½¿ç”¨æ³›å‹çš„æ•ˆç›Š">ä½¿ç”¨æ³›å‹çš„æ•ˆç›Š</a></li>
        <li><a href="#ä½¿ç”¨æ³›å‹è¨­è¨ˆé¡åˆ¥">ä½¿ç”¨æ³›å‹è¨­è¨ˆé¡åˆ¥</a></li>
      </ul>
    </li>
    <li><a href="#é›†åˆç‰©ä»¶">é›†åˆç‰©ä»¶</a>
      <ul>
        <li><a href="#collection-å®šç¾©èˆ‡ç¨®é¡">Collection å®šç¾©èˆ‡ç¨®é¡</a></li>
        <li><a href="#list">List</a></li>
        <li><a href="#arraylist--list-æœ€å¸¸ä½¿ç”¨çš„ä¸€ç¨®å¯¦ä½œé¡åˆ¥"><code>ArrayList</code> : List æœ€å¸¸ä½¿ç”¨çš„ä¸€ç¨®å¯¦ä½œé¡åˆ¥</a></li>
        <li><a href="#è‡ªå‹•è£ç®±-boxingå’Œé–‹ç®±-unboxing">è‡ªå‹•è£ç®± <code>Boxing</code>å’Œé–‹ç®± <code>Unboxing</code></a></li>
        <li><a href="#set">Set</a></li>
        <li><a href="#deque-queue">Deque (Queue)</a></li>
      </ul>
    </li>
    <li><a href="#map">Map</a></li>
    <li><a href="#é›†åˆç‰©ä»¶æˆå“¡çš„æ’åº">é›†åˆç‰©ä»¶æˆå“¡çš„æ’åº</a>
      <ul>
        <li><a href="#æ’åºä½œæ³•">æ’åºä½œæ³•</a></li>
        <li><a href="#ä½¿ç”¨-comparable-ä»‹é¢æ’åº">ä½¿ç”¨ <code>Comparable</code> ä»‹é¢æ’åº</a></li>
        <li><a href="#ä½¿ç”¨-comparator-ä»‹é¢æ’åº">ä½¿ç”¨ <code>Comparator</code> ä»‹é¢æ’åº</a></li>
      </ul>
    </li>
    <li><a href="#ä½¿ç”¨-of-èˆ‡-copyof-æ–¹æ³•å»ºç«‹-listset-èˆ‡-map-ç‰©ä»¶">ä½¿ç”¨ <code>of()</code> èˆ‡ <code>copyOf()</code> æ–¹æ³•å»ºç«‹ <code>List</code>ã€<code>Set</code> èˆ‡ <code>Map</code> ç‰©ä»¶</a>
      <ul>
        <li><a href="#ä½¿ç”¨ofæ–¹æ³•å»ºç«‹-list-set-map-ç‰©ä»¶">ä½¿ç”¨<code>of()</code>æ–¹æ³•å»ºç«‹ List, Set, Map ç‰©ä»¶</a></li>
        <li><a href="#ä½¿ç”¨copyofæ–¹æ³•å»ºç«‹-list-set-map-ç‰©ä»¶">ä½¿ç”¨<code>copyOf()</code>æ–¹æ³•å»ºç«‹ List, Set, Map ç‰©ä»¶</a></li>
        <li><a href="#ä½¿ç”¨-arraysaslistå»ºç«‹-list-ç‰©ä»¶">ä½¿ç”¨ <code>Arrays.asList()</code>å»ºç«‹ List ç‰©ä»¶</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#ä¾‹å¤–">ä¾‹å¤–</a>
      <ul>
        <li><a href="#ä½¿ç”¨try-catchç¨‹å¼ç¢¼å€å¡Š">ä½¿ç”¨<code>try-catch</code>ç¨‹å¼ç¢¼å€å¡Š</a></li>
        <li><a href="#ä½¿ç”¨-try-with-resources-ç¨‹å¼ç¢¼å€å¡Šå’Œ-autocloseable-ä»‹é¢">ä½¿ç”¨ <code>try-with-resources</code> ç¨‹å¼ç¢¼å€å¡Šå’Œ <code>AutoCloseable</code> ä»‹é¢</a></li>
        <li><a href="#suppressed-exceptions">Suppressed Exceptions</a></li>
        <li><a href="#ä½¿ç”¨-multi-catch-æ•˜è¿°">ä½¿ç”¨ <code>multi-catch</code> æ•˜è¿°</a></li>
        <li><a href="#ä½¿ç”¨-throws-å®£å‘Š">ä½¿ç”¨ <code>throws</code> å®£å‘Š</a></li>
        <li><a href="#å»ºç«‹å®¢è£½çš„-exception">å»ºç«‹å®¢è£½çš„ <code>Exception</code></a></li>
      </ul>
    </li>
    <li><a href="#æ–·è¨€">æ–·è¨€</a>
      <ul>
        <li><a href="#assertions-çš„ç°¡ä»‹å’Œèªæ³•">Assertions çš„ç°¡ä»‹å’Œèªæ³•</a></li>
        <li><a href="#assertions-çš„ä½¿ç”¨">Assertions çš„ä½¿ç”¨</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#io-åŸºç¤">I/O åŸºç¤</a>
      <ul>
        <li><a href="#ä½•è¬‚-io">ä½•è¬‚ I/O</a></li>
        <li><a href="#è™•ç†ä¸²æµçš„é¡åˆ¥">è™•ç†ä¸²æµçš„é¡åˆ¥</a></li>
        <li><a href="#ä¸²æµé¡åˆ¥çš„ä¸²æ¥">ä¸²æµé¡åˆ¥çš„ä¸²æ¥</a></li>
        <li><a href="#ä½¿ç”¨-javaiofile-é¡åˆ¥">ä½¿ç”¨ <code>java.io.File</code> é¡åˆ¥</a></li>
      </ul>
    </li>
    <li><a href="#ç”±ä¸»æ§å°è®€å¯«è³‡æ–™">ç”±ä¸»æ§å°è®€å¯«è³‡æ–™</a>
      <ul>
        <li><a href="#ä¸»æ§å°çš„-io">ä¸»æ§å°çš„ I/O</a></li>
        <li><a href="#ä½¿ç”¨æ¨™æº–è¼¸å‡ºæ–¹æ³•">ä½¿ç”¨æ¨™æº–è¼¸å‡ºæ–¹æ³•</a></li>
        <li><a href="#javaioconsole-é¡åˆ¥ä»‹ç´¹"><code>java.io.Console</code> é¡åˆ¥ä»‹ç´¹</a></li>
      </ul>
    </li>
    <li><a href="#channel-io">Channel I/O</a></li>
    <li><a href="#ä½¿ç”¨åºåˆ—åŒ–æŠ€è¡“è®€å¯«ç‰©ä»¶">ä½¿ç”¨åºåˆ—åŒ–æŠ€è¡“è®€å¯«ç‰©ä»¶</a>
      <ul>
        <li><a href="#java-è£¡çš„è³‡æ–™ä¿å­˜-persistence">Java è£¡çš„è³‡æ–™ä¿å­˜ <em>Persistence</em></a></li>
        <li><a href="#åºåˆ—åŒ–å’Œç‰©ä»¶åœ–è­œ">åºåˆ—åŒ–å’Œç‰©ä»¶åœ–è­œ</a></li>
        <li><a href="#ä¸éœ€è¦åƒåŠ åºåˆ—åŒ–çš„æ¬„ä½">ä¸éœ€è¦åƒåŠ åºåˆ—åŒ–çš„æ¬„ä½</a></li>
        <li><a href="#å®šç¾©ç‰©ä»¶ä¿å­˜çš„ç‰ˆæœ¬è™Ÿç¢¼">å®šç¾©ç‰©ä»¶ä¿å­˜çš„ç‰ˆæœ¬è™Ÿç¢¼</a></li>
        <li><a href="#åºåˆ—åŒ–å’Œååºåˆ—åŒ–ç¯„ä¾‹">åºåˆ—åŒ–å’Œååºåˆ—åŒ–ç¯„ä¾‹</a></li>
        <li><a href="#3-serialization-and-de-serialization">3. Serialization and De-serialization</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#nio2-åŸºç¤"><code>NIO.2</code> åŸºç¤</a>
      <ul>
        <li><a href="#javajofileé™åˆ¶"><code>java.jo.File</code>é™åˆ¶</a></li>
        <li><a href="#java-io-å¥—ä»¶ç™¼å±•æ­·å²">Java I/O å¥—ä»¶ç™¼å±•æ­·å²</a></li>
        <li><a href="#æª”æ¡ˆç³»çµ±è·¯å¾‘å’Œæª”æ¡ˆ">æª”æ¡ˆç³»çµ±ã€è·¯å¾‘å’Œæª”æ¡ˆ</a></li>
        <li><a href="#symbolic-link-æª”æ¡ˆ">Symbolic Link æª”æ¡ˆ</a></li>
        <li><a href="#nio2-çš„åŸºæœ¬æ¶æ§‹"><code>NIO.2</code> çš„åŸºæœ¬æ¶æ§‹</a></li>
      </ul>
    </li>
    <li><a href="#ä½¿ç”¨-path-ä»‹é¢æ“ä½œæª”æ¡ˆç›®éŒ„">ä½¿ç”¨ Path ä»‹é¢æ“ä½œæª”æ¡ˆ/ç›®éŒ„</a>
      <ul>
        <li><a href="#path-ä»‹é¢">Path ä»‹é¢</a></li>
        <li><a href="#path-ä»‹é¢ä¸»è¦åŠŸèƒ½">Path ä»‹é¢ä¸»è¦åŠŸèƒ½</a></li>
        <li><a href="#ç§»é™¤è·¯å¾‘è£¡çš„å¤šé¤˜çµ„æˆ">ç§»é™¤è·¯å¾‘è£¡çš„å¤šé¤˜çµ„æˆ</a></li>
        <li><a href="#å»ºç«‹å­è·¯å¾‘---subpath">å»ºç«‹å­è·¯å¾‘ - <code>subpath()</code></a></li>
        <li><a href="#çµåˆ-2-å€‹è·¯å¾‘---resolve">çµåˆ 2 å€‹è·¯å¾‘ - <code>resolve()</code></a></li>
        <li><a href="#å»ºç«‹é€£æ¥-2-å€‹è·¯å¾‘çš„è·¯å¾‘---relativize">å»ºç«‹é€£æ¥ 2 å€‹è·¯å¾‘çš„è·¯å¾‘ - <code>relativize()</code></a></li>
        <li><a href="#hard-link">Hard Link</a></li>
        <li><a href="#è™•ç†-symbolic-link">è™•ç† Symbolic Link</a></li>
      </ul>
    </li>
    <li><a href="#ä½¿ç”¨-files-é¡åˆ¥å°æª”æ¡ˆç›®éŒ„é€²è¡Œæª¢æŸ¥åˆªé™¤è¤‡è£½ç§»å‹•">ä½¿ç”¨ Files é¡åˆ¥å°æª”æ¡ˆ/ç›®éŒ„é€²è¡Œæª¢æŸ¥ã€åˆªé™¤ã€è¤‡è£½ã€ç§»å‹•</a>
      <ul>
        <li><a href="#è™•ç†æª”æ¡ˆ">è™•ç†æª”æ¡ˆ</a></li>
        <li><a href="#æª¢æŸ¥æª”æ¡ˆ--ç›®éŒ„æ˜¯å¦å­˜åœ¨">æª¢æŸ¥æª”æ¡ˆ / ç›®éŒ„æ˜¯å¦å­˜åœ¨</a></li>
        <li><a href="#æª¢æŸ¥æª”æ¡ˆ--ç›®éŒ„å±¬æ€§">æª¢æŸ¥æª”æ¡ˆ / ç›®éŒ„å±¬æ€§</a></li>
        <li><a href="#å»ºç«‹æª”æ¡ˆ--ç›®éŒ„">å»ºç«‹æª”æ¡ˆ / ç›®éŒ„</a></li>
        <li><a href="#åˆªé™¤æª”æ¡ˆ--ç›®éŒ„">åˆªé™¤æª”æ¡ˆ / ç›®éŒ„</a></li>
        <li><a href="#è¤‡è£½å’Œç§»å‹•æª”æ¡ˆ--ç›®éŒ„">è¤‡è£½å’Œç§»å‹•æª”æ¡ˆ / ç›®éŒ„</a></li>
        <li><a href="#stream-å’Œ-path-äº’ç›¸è¤‡è£½">Stream å’Œ Path äº’ç›¸è¤‡è£½</a></li>
        <li><a href="#åˆ—å‡ºç›®éŒ„å…§å®¹">åˆ—å‡ºç›®éŒ„å…§å®¹</a></li>
        <li><a href="#è®€å–å’Œå¯«å…¥æª”æ¡ˆ">è®€å–å’Œå¯«å…¥æª”æ¡ˆ</a></li>
      </ul>
    </li>
    <li><a href="#ä½¿ç”¨-files-é¡åˆ¥æ“ä½œ-channel-io-å’Œ-stream-io-è®€å¯«æª”æ¡ˆ">ä½¿ç”¨ Files é¡åˆ¥æ“ä½œ Channel I/O å’Œ Stream I/O è®€å¯«æª”æ¡ˆ</a>
      <ul>
        <li><a href="#ä»‹é¢-channel-å’Œé¡åˆ¥-bytebuffer">ä»‹é¢ Channel å’Œé¡åˆ¥ <code>ByteBuffer</code></a></li>
        <li><a href="#éš¨æ©Ÿå­˜å–æª”æ¡ˆ">éš¨æ©Ÿå­˜å–æª”æ¡ˆ</a></li>
        <li><a href="#å°æ–‡å­—æª”æä¾›-buffered-io-æ–¹æ³•">å°æ–‡å­—æª”æä¾› Buffered I/O æ–¹æ³•</a></li>
        <li><a href="#å–å¾—ä½å…ƒä¸²æµç‰©ä»¶çš„æ–¹æ³•">å–å¾—ä½å…ƒä¸²æµç‰©ä»¶çš„æ–¹æ³•</a></li>
      </ul>
    </li>
    <li><a href="#è®€å¯«æª”æ¡ˆç›®éŒ„çš„å±¬æ€§">è®€å¯«æª”æ¡ˆ/ç›®éŒ„çš„å±¬æ€§</a>
      <ul>
        <li><a href="#ä½¿ç”¨-files-ç®¡ç†æª”æ¡ˆçš„å±¬æ€§è³‡æ–™">ä½¿ç”¨ Files ç®¡ç†æª”æ¡ˆçš„å±¬æ€§è³‡æ–™</a></li>
        <li><a href="#è®€å–æª”æ¡ˆå±¬æ€§">è®€å–æª”æ¡ˆå±¬æ€§</a></li>
        <li><a href="#ä¿®æ”¹æª”æ¡ˆå±¬æ€§">ä¿®æ”¹æª”æ¡ˆå±¬æ€§</a></li>
        <li><a href="#dos-ä¹‹å¤–çš„-file-attribute-views">DOS ä¹‹å¤–çš„ File Attribute Views</a></li>
        <li><a href="#posix-æª”æ¡ˆç³»çµ±çš„æ¬Šé™"><code>POSIX</code> æª”æ¡ˆç³»çµ±çš„æ¬Šé™</a></li>
      </ul>
    </li>
    <li><a href="#éè¿´å­˜å–ç›®éŒ„çµæ§‹">éè¿´å­˜å–ç›®éŒ„çµæ§‹</a>
      <ul>
        <li><a href="#å°æª”æ¡ˆç›®éŒ„é€²è¡Œéè¿´æ“ä½œ">å°æª”æ¡ˆç›®éŒ„é€²è¡Œéè¿´æ“ä½œ</a></li>
      </ul>
    </li>
    <li><a href="#ä½¿ç”¨-pathmatcher-é¡åˆ¥æ‰¾å°‹ç¬¦åˆçš„æª”æ¡ˆ">ä½¿ç”¨ <code>PathMatcher</code> é¡åˆ¥æ‰¾å°‹ç¬¦åˆçš„æª”æ¡ˆ</a>
      <ul>
        <li><a href="#æœå°‹æª”æ¡ˆ">æœå°‹æª”æ¡ˆ</a></li>
        <li><a href="#glob-æ¨£å¼èªæ³•ä»‹ç´¹"><code>glob</code> æ¨£å¼èªæ³•ä»‹ç´¹</a></li>
      </ul>
    </li>
    <li><a href="#å…¶å®ƒ">å…¶å®ƒ</a>
      <ul>
        <li><a href="#filestore-é¡åˆ¥"><code>FileStore</code> é¡åˆ¥</a></li>
        <li><a href="#ä½¿ç”¨-watchservice">ä½¿ç”¨ <code>WatchService</code></a></li>
        <li><a href="#ç”±åŸºç¤-io-è½‰æ›è‡³-nio2">ç”±åŸºç¤ I/O è½‰æ›è‡³ NIO.2</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#ä»‹ç´¹">ä»‹ç´¹</a>
      <ul>
        <li><a href="#åè©èªªæ˜">åè©èªªæ˜</a></li>
        <li><a href="#å¤šåŸ·è¡Œç·’çš„é‡è¦æ€§">å¤šåŸ·è¡Œç·’çš„é‡è¦æ€§</a></li>
        <li><a href="#åŸ·è¡Œç·’é¡åˆ¥">åŸ·è¡Œç·’é¡åˆ¥</a></li>
      </ul>
    </li>
    <li><a href="#åŸ·è¡Œç·’å¸¸è¦‹å•é¡Œ">åŸ·è¡Œç·’å¸¸è¦‹å•é¡Œ</a>
      <ul>
        <li><a href="#ä½¿ç”¨-shared-data-å¯èƒ½é€ æˆçš„å•é¡Œ">ä½¿ç”¨ <code>Shared Data</code> å¯èƒ½é€ æˆçš„å•é¡Œ</a></li>
        <li><a href="#ä½¿ç”¨-non-atomic-functions-å¯èƒ½é€ æˆçš„å•é¡Œ">ä½¿ç”¨ <code>Non-Atomic Functions</code> å¯èƒ½é€ æˆçš„å•é¡Œ</a></li>
        <li><a href="#ä½¿ç”¨-cached-data-å¯èƒ½é€ æˆçš„å•é¡Œ">ä½¿ç”¨ <code>Cached Data</code> å¯èƒ½é€ æˆçš„å•é¡Œ</a></li>
      </ul>
    </li>
    <li><a href="#åŸ·è¡Œç·’çš„-synchronized-èˆ‡ç­‰å¾…">åŸ·è¡Œç·’çš„ synchronized èˆ‡ç­‰å¾…</a>
      <ul>
        <li><a href="#ä½¿ç”¨-synchronized-é—œéµå­—">ä½¿ç”¨ <code>synchronized</code> é—œéµå­—</a></li>
        <li><a href="#ä½¿ç”¨-synchronized-çš„æ™‚æ©Ÿ">ä½¿ç”¨ <code>synchronized</code> çš„æ™‚æ©Ÿ</a></li>
        <li><a href="#ç¸®å°-synchronized-çš„ç¨‹å¼å€å¡Š">ç¸®å° synchronized çš„ç¨‹å¼å€å¡Š</a></li>
        <li><a href="#å…¶å®ƒåŸ·è¡Œç­‰å¾…çš„æƒ…æ³">å…¶å®ƒåŸ·è¡Œç­‰å¾…çš„æƒ…æ³</a></li>
      </ul>
    </li>
    <li><a href="#å…¶å®ƒåŸ·è¡Œç·’æ–¹æ³•ä»‹ç´¹">å…¶å®ƒåŸ·è¡Œç·’æ–¹æ³•ä»‹ç´¹</a>
      <ul>
        <li><a href="#ä½¿ç”¨-interrupt-æ–¹æ³•">ä½¿ç”¨ <code>interrupt()</code> æ–¹æ³•</a></li>
        <li><a href="#ä½¿ç”¨-sleep-æ–¹æ³•">ä½¿ç”¨ <code>sleep()</code> æ–¹æ³•</a></li>
        <li><a href="#ä½¿ç”¨å…¶å®ƒæ–¹æ³•">ä½¿ç”¨å…¶å®ƒæ–¹æ³•</a></li>
        <li><a href="#ä¸å»ºè­°ä½¿ç”¨çš„æ–¹æ³•">ä¸å»ºè­°ä½¿ç”¨çš„æ–¹æ³•</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#ä½¿ç”¨ä¸¦è¡Œ-api">ä½¿ç”¨ä¸¦è¡Œ API</a>
      <ul>
        <li><a href="#ä¸¦è¡Œ-api-ä»‹ç´¹">ä¸¦è¡Œ API ä»‹ç´¹</a></li>
        <li><a href="#atomicinteger-é¡åˆ¥"><code>AtomicInteger</code> é¡åˆ¥</a></li>
        <li><a href="#reentrantreadwritelock-é¡åˆ¥"><code>ReentrantReadWriteLock</code> é¡åˆ¥</a></li>
        <li><a href="#åŸ·è¡Œç·’å®‰å…¨çš„é›†åˆç‰©ä»¶">åŸ·è¡Œç·’å®‰å…¨çš„é›†åˆç‰©ä»¶</a></li>
        <li><a href="#å¸¸ç”¨çš„åŒæ­¥å™¨å·¥å…·é¡åˆ¥">å¸¸ç”¨çš„åŒæ­¥å™¨å·¥å…·é¡åˆ¥</a></li>
      </ul>
    </li>
    <li><a href="#ä½¿ç”¨-executorservice-ä»‹é¢åŒæ™‚åŸ·è¡Œå¤šæ¨£å·¥ä½œ">ä½¿ç”¨ <code>ExecutorService</code> ä»‹é¢åŒæ™‚åŸ·è¡Œå¤šæ¨£å·¥ä½œ</a>
      <ul>
        <li><a href="#ä½¿ç”¨æ›´é«˜éšçš„å¤šåŸ·è¡Œç·’åŸ·è¡Œæ–¹æ¡ˆ">ä½¿ç”¨æ›´é«˜éšçš„å¤šåŸ·è¡Œç·’åŸ·è¡Œæ–¹æ¡ˆ</a></li>
        <li><a href="#executorserviceæ¦‚è§€"><code>ExecutorService</code>æ¦‚è§€</a></li>
        <li><a href="#ä½¿ç”¨-javautilconcurrentcallable">ä½¿ç”¨ <code>java.util.concurrent.Callable</code></a></li>
        <li><a href="#ä½¿ç”¨-javautilconcurrentfuture">ä½¿ç”¨ <code>java.util.concurrent.Future</code></a></li>
        <li><a href="#é—œé–‰-executorservice">é—œé–‰ <code>ExecutorService</code></a></li>
        <li><a href="#executorserviceå®Œæ•´ç¯„ä¾‹"><code>ExecutorService</code>å®Œæ•´ç¯„ä¾‹</a></li>
        <li><a href="#executorservice-é€²éšç¯„ä¾‹"><code>ExecutorService</code> é€²éšç¯„ä¾‹</a></li>
      </ul>
    </li>
    <li><a href="#ä½¿ç”¨-fork-join-æ¡†æ¶åŒæ™‚åŸ·è¡Œå¤šæ¨£å·¥ä½œ">ä½¿ç”¨ Fork-Join æ¡†æ¶åŒæ™‚åŸ·è¡Œå¤šæ¨£å·¥ä½œ</a>
      <ul>
        <li><a href="#å¹³è¡Œè™•ç†çš„ç­–ç•¥">å¹³è¡Œè™•ç†çš„ç­–ç•¥</a></li>
        <li><a href="#å¥—ç”¨-fork-join-æ¡†æ¶">å¥—ç”¨ <code>Fork-Join</code> æ¡†æ¶</a></li>
        <li><a href="#fork-join-æ¡†æ¶çš„ä½¿ç”¨å»ºè­°"><code>Fork-Join</code> æ¡†æ¶çš„ä½¿ç”¨å»ºè­°</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#äº†è§£-databasedbms-å’Œ-sql">äº†è§£ Databaseã€DBMS å’Œ SQL</a>
      <ul>
        <li></li>
        <li><a href="#ä½¿ç”¨sqlå­˜å–è³‡æ–™åº«">ä½¿ç”¨<code>SQL</code>å­˜å–è³‡æ–™åº«</a></li>
        <li><a href="#derby-è³‡æ–™åº«ä»‹ç´¹">Derby è³‡æ–™åº«ä»‹ç´¹</a></li>
        <li><a href="#æ“ä½œ-derby-è³‡æ–™åº«">æ“ä½œ Derby è³‡æ–™åº«</a></li>
        <li><a href="#heading"></a></li>
      </ul>
    </li>
    <li><a href="#eclipse-é€£ç·šä¸¦å­˜å–è³‡æ–™åº«">Eclipse é€£ç·šä¸¦å­˜å–è³‡æ–™åº«</a>
      <ul>
        <li><a href="#é€£ç·šè³‡æ–™åº«">é€£ç·šè³‡æ–™åº«</a></li>
        <li><a href="#å­˜å–è³‡æ–™è¡¨">å­˜å–è³‡æ–™è¡¨</a></li>
      </ul>
    </li>
    <li><a href="#ä½¿ç”¨-jdbc">ä½¿ç”¨ JDBC</a>
      <ul>
        <li><a href="#jdbc-api--æ¦‚è§€">JDBC API  æ¦‚è§€</a></li>
        <li><a href="#å°ˆæ¡ˆå¼•ç”¨è³‡æ–™åº«é©…å‹•å‡½å¼åº«">å°ˆæ¡ˆå¼•ç”¨è³‡æ–™åº«é©…å‹•å‡½å¼åº«</a></li>
        <li><a href="#èªè­˜-jdbc-é©…å‹•å‡½å¼åº«-jar-çš„çµ„æˆ">èªè­˜ JDBC é©…å‹•å‡½å¼åº« JAR çš„çµ„æˆ</a></li>
      </ul>
    </li>
    <li><a href="#jdbc-é€²è¡Œäº¤æ˜“">JDBC é€²è¡Œäº¤æ˜“</a></li>
    <li><a href="#ä½¿ç”¨-jdbc-41-çš„-rowsetprovider-å’Œ-rowsetfactory">ä½¿ç”¨ JDBC 4.1 çš„ RowSetProvider å’Œ RowSetFactory</a></li>
  </ul>

  <ul>
    <li><a href="#äº†è§£-java-çš„è»Ÿé«”å€åŸŸåŒ–ä½œæ³•">äº†è§£ Java çš„è»Ÿé«”å€åŸŸåŒ–ä½œæ³•</a></li>
    <li><a href="#ä½¿ç”¨-dateformat-é¡åˆ¥æä¾›æ—¥æœŸçš„å€åŸŸåŒ–é¡¯ç¤º">ä½¿ç”¨ DateFormat é¡åˆ¥æä¾›æ—¥æœŸçš„å€åŸŸåŒ–é¡¯ç¤º</a></li>
    <li><a href="#ä½¿ç”¨-numberformat-é¡åˆ¥æä¾›å¹£åˆ¥å€åŸŸåŒ–é¡¯ç¤º">ä½¿ç”¨ NumberFormat é¡åˆ¥æä¾›å¹£åˆ¥å€åŸŸåŒ–é¡¯ç¤º</a></li>
  </ul>

  <ul>
    <li><a href="#ä½¿ç”¨-lambda-è¡¨ç¤ºå¼">ä½¿ç”¨ Lambda è¡¨ç¤ºå¼</a></li>
    <li><a href="#ä½¿ç”¨å…§å»ºçš„åŠŸèƒ½æ€§ä»‹é¢">ä½¿ç”¨å…§å»ºçš„åŠŸèƒ½æ€§ä»‹é¢</a></li>
    <li><a href="#åœ¨æ³›å‹å…§ä½¿ç”¨è¬ç”¨å­—å…ƒ">åœ¨æ³›å‹å…§ä½¿ç”¨è¬ç”¨å­—å…ƒ</a></li>
    <li><a href="#ä½¿ç”¨å…¶å®ƒå…§å»ºçš„åŠŸèƒ½æ€§ä»‹é¢">ä½¿ç”¨å…¶å®ƒå…§å»ºçš„åŠŸèƒ½æ€§ä»‹é¢</a></li>
    <li><a href="#ä½¿ç”¨æ–¹æ³•åƒç…§">ä½¿ç”¨æ–¹æ³•åƒç…§</a></li>
  </ul>

  <ul>
    <li><a href="#å»ºæ§‹è€…è¨­è¨ˆæ¨¡å¼å’Œæ–¹æ³•éˆçµ">å»ºæ§‹è€…è¨­è¨ˆæ¨¡å¼å’Œæ–¹æ³•éˆçµ</a></li>
    <li><a href="#ä½¿ç”¨-optional-é¡åˆ¥">ä½¿ç”¨ Optional é¡åˆ¥</a></li>
    <li><a href="#stream-api-ä»‹ç´¹">Stream API ä»‹ç´¹</a></li>
    <li><a href="#stream-api-æ“ä½œ">Stream API æ“ä½œ</a></li>
    <li><a href="#stream-api-å’Œ-nio2">Stream API å’Œ NIO.2</a></li>
    <li><a href="#stream-api-æ“ä½œå¹³è¡ŒåŒ–">Stream API æ“ä½œå¹³è¡ŒåŒ–</a></li>
  </ul>

  <ul>
    <li><a href="#date--time-ç›¸é—œé¡åˆ¥çš„æ¼”é€²">Date &amp; Time ç›¸é—œé¡åˆ¥çš„æ¼”é€²</a></li>
    <li><a href="#ç•¶åœ°æ—¥æœŸèˆ‡æ™‚é–“">ç•¶åœ°æ—¥æœŸèˆ‡æ™‚é–“</a></li>
    <li><a href="#æ™‚å€å’Œæ—¥å…‰ç¯€ç´„æ™‚é–“">æ™‚å€å’Œæ—¥å…‰ç¯€ç´„æ™‚é–“</a></li>
    <li><a href="#æè¿°æ—¥æœŸèˆ‡æ™‚é–“çš„æ•¸é‡">æè¿°æ—¥æœŸèˆ‡æ™‚é–“çš„æ•¸é‡</a></li>
  </ul>

  <ul>
    <li><a href="#èªè­˜æ¨™è¨»å‹åˆ¥">èªè­˜æ¨™è¨»å‹åˆ¥</a></li>
    <li><a href="#å»ºç«‹è‡ªå®šç¾©æ¨™è¨»å‹åˆ¥">å»ºç«‹è‡ªå®šç¾©æ¨™è¨»å‹åˆ¥</a></li>
    <li><a href="#æ¨™è¨»å‹åˆ¥çš„æ‡‰ç”¨">æ¨™è¨»å‹åˆ¥çš„æ‡‰ç”¨</a></li>
    <li><a href="#è‡ªå®šç¾©æ¨™è¨»å‹åˆ¥æ™‚ä½¿ç”¨çš„å…§å»ºæ¨™è¨»å‹åˆ¥">è‡ªå®šç¾©æ¨™è¨»å‹åˆ¥æ™‚ä½¿ç”¨çš„å…§å»ºæ¨™è¨»å‹åˆ¥</a></li>
    <li><a href="#é–‹ç™¼ä¸€èˆ¬ç¨‹å¼ç¢¼ç¶“å¸¸ä½¿ç”¨çš„å…§å»ºæ¨™è¨»å‹åˆ¥">é–‹ç™¼ä¸€èˆ¬ç¨‹å¼ç¢¼ç¶“å¸¸ä½¿ç”¨çš„å…§å»ºæ¨™è¨»å‹åˆ¥</a></li>
  </ul>

  <ul>
    <li><a href="#èªè­˜-java-æ¨¡çµ„åŒ–">èªè­˜ Java æ¨¡çµ„åŒ–</a></li>
    <li><a href="#å»ºç«‹å’ŒåŸ·è¡Œæ¨¡çµ„åŒ–ç¨‹å¼">å»ºç«‹å’ŒåŸ·è¡Œæ¨¡çµ„åŒ–ç¨‹å¼</a></li>
    <li><a href="#å»ºç«‹ç›¸ä¾æ¨¡çµ„ç¨‹å¼">å»ºç«‹ç›¸ä¾æ¨¡çµ„ç¨‹å¼</a></li>
    <li><a href="#èªè­˜-module-infojava-çš„å®£å‘Šé—œéµå­—">èªè­˜ <code>module-info.java</code> çš„å®£å‘Šé—œéµå­—</a></li>
    <li><a href="#åœ¨å‘½ä»¤åˆ—-command-line-ä½¿ç”¨æ¨¡çµ„æŒ‡ä»¤é¸é …">åœ¨å‘½ä»¤åˆ— <code>command line</code> ä½¿ç”¨æ¨¡çµ„æŒ‡ä»¤é¸é …</a></li>
  </ul>

  <ul>
    <li><a href="#å›é¡§æ¨¡çµ„æŒ‡ä»¤">å›é¡§æ¨¡çµ„æŒ‡ä»¤</a></li>
    <li><a href="#æ¯”è¼ƒæ¨¡çµ„é¡å‹">æ¯”è¼ƒæ¨¡çµ„é¡å‹</a></li>
    <li><a href="#åˆ†æ-jdk-ä¾è³´é—œä¿‚">åˆ†æ JDK ä¾è³´é—œä¿‚</a></li>
    <li><a href="#æ¨¡çµ„åŒ–æ—¢æœ‰æ‡‰ç”¨ç¨‹å¼">æ¨¡çµ„åŒ–æ—¢æœ‰æ‡‰ç”¨ç¨‹å¼</a></li>
    <li><a href="#æ¨¡çµ„åŒ–-java-æœå‹™çµæ§‹">æ¨¡çµ„åŒ– Java æœå‹™çµæ§‹</a></li>
  </ul>

  <ul>
    <li><a href="#è¨­è¨ˆå®‰å…¨ç‰©ä»¶">è¨­è¨ˆå®‰å…¨ç‰©ä»¶</a></li>
    <li><a href="#æ³¨å…¥-injection-æ”»æ“Šèˆ‡è¼¸å…¥-input-é©—è­‰">æ³¨å…¥ <em>injection</em> æ”»æ“Šèˆ‡è¼¸å…¥ <em>input</em> é©—è­‰</a></li>
    <li><a href="#è™•ç†æ©Ÿæ•è³‡è¨Š">è™•ç†æ©Ÿæ•è³‡è¨Š</a></li>
    <li><a href="#åºåˆ—åŒ–èˆ‡ååºåˆ—åŒ–ç‰©ä»¶">åºåˆ—åŒ–èˆ‡ååºåˆ—åŒ–ç‰©ä»¶</a></li>
    <li><a href="#å»ºç«‹ä¿è­·æ©Ÿæ•è³‡æ–™çš„å®‰å…¨ç‰©ä»¶">å»ºç«‹ä¿è­·æ©Ÿæ•è³‡æ–™çš„å®‰å…¨ç‰©ä»¶</a></li>
    <li><a href="#é¿å…æœå‹™é˜»æ–·-denial-of-service-æ”»æ“Š">é¿å…æœå‹™é˜»æ–· <em>denial of service</em> æ”»æ“Š</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><pre><code># 01 æ³›å‹å’Œé›†åˆç‰©ä»¶
</code></pre>
<h2 id="æ³›å‹">æ³›å‹</h2>
<p>Java 5 ä¹‹å¾ŒåŠ å…¥æ³›å‹ï¼Œä½¿å‹åˆ¥ä½¿ç”¨å¤šäº†å¦ä¸€ç¨®å½ˆæ€§ã€‚</p>
<p>é›†åˆç‰©ä»¶ï¼ˆç”¨ä¾†è£å¡«ç‰©ä»¶ï¼‰ï¼‹æ³›å‹ï¼Œå¯ä»¥é™åˆ¶è£å¡«ç‰©ä»¶çš„å‹åˆ¥ã€‚</p>
<h3 id="ä½¿ç”¨æ³›å‹çš„æ•ˆç›Š">ä½¿ç”¨æ³›å‹çš„æ•ˆç›Š</h3>
<ol>
<li>æä¾›æ›´å½ˆæ€§çš„ã€Œå‹åˆ¥å®‰å…¨ type safetyã€æª¢æŸ¥æ©Ÿåˆ¶ï¼ŒåŸæœ¬åœ¨åŸ·è¡Œæ™‚æ‰èƒ½ç™¼ç¾çš„å‹åˆ¥éŒ¯èª¤ï¼Œç¾åœ¨åœ¨ç·¨è­¯æ™‚æœŸå°±å¯ä»¥é ç™¼ç¾</li>
<li>åœ¨é›†åˆç‰©ä»¶ Collections è£¡å¤§é‡ä½¿ç”¨ï¼Œé™åˆ¶å…§æ¶µç‰©ä»¶ä¹‹å‹åˆ¥</li>
<li>æ¸›å°‘è½‰å‹ casting éœ€è¦ï¼Œä½¿ç¨‹å¼ç¢¼æ›´ç°¡æ½”</li>
</ol>
<h3 id="ä½¿ç”¨æ³›å‹è¨­è¨ˆé¡åˆ¥">ä½¿ç”¨æ³›å‹è¨­è¨ˆé¡åˆ¥</h3>
<ul>
<li>å¯ä»¥å°‡ç¨‹å¼ç¢¼è£¡çš„ç¬¦è™Ÿ <code>T</code>æ›æˆ <code>String</code>( å³ UseString())ï¼Œæˆ–æ›æˆ <code>Shirt</code> (å³ UseShirt())</li>
<li>å¸¸è¦‹çš„ç¬¦è™ŸåŠè¡¨ç¤ºæ–¹å¼å¦‚ä¸‹ï¼š
<ol>
<li><strong>T</strong> -ã€Œå‹åˆ¥ï¼ˆtypeï¼‰ã€</li>
<li><strong>E</strong> -ã€Œæˆå“¡ï¼ˆelementï¼‰ã€</li>
<li><strong>K</strong> -ã€Œéµ - å€¼å°è£¡çš„éµï¼ˆkeyï¼‰ã€</li>
<li><strong>V</strong> -ã€Œéµ - å€¼å°è£¡çš„å€¼ï¼ˆvalueï¼‰ã€</li>
</ol>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UseAny</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> T t<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>T t<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">t</span> <span style="color:#f92672">=</span> t<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> T <span style="color:#a6e22e">get</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">t</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UseString</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String message<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>String message<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> message<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">get</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">message</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UseShirt</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Shirt shirt<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>Shirt shirt<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">shirt</span> <span style="color:#f92672">=</span> shirt<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Shirt <span style="color:#a6e22e">get</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">shirt</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>
<p>Java 7 é–‹å§‹ï¼Œå–æ¶ˆã€Œåƒè€ƒå‹åˆ¥ã€å’Œã€Œå»ºæ§‹å­ã€éƒ½å¿…é ˆåœ¨&lt;&gt;ç¬¦è™Ÿå…§åŠ ä¸Šç½®æ›å‹åˆ¥çš„è¦å®šï¼Œå› ç‚ºç­‰è™Ÿå³å´å¯ä»¥ç”±å‰è€…æ¨æ–·ï¼ˆinferenceï¼‰è€ŒçŸ¥å…¶å‹åˆ¥</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>UseAny<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> shirt2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UseAny<span style="color:#f92672">&lt;</span>Shirt<span style="color:#f92672">&gt;();</span>
</span></span><span style="display:flex;"><span>UseAny<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> msg2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UseAny<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;();</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// see below for simplified code
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>UseAny<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> shirt2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UseAny<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>UseAny<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> msg2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UseAny<span style="color:#f92672">&lt;&gt;();</span>
</span></span></code></pre></div></li>
</ul>
<h2 id="é›†åˆç‰©ä»¶">é›†åˆç‰©ä»¶</h2>
<h3 id="collection-å®šç¾©èˆ‡ç¨®é¡">Collection å®šç¾©èˆ‡ç¨®é¡</h3>
<p>é›†åˆç‰©ä»¶ <em>Collection</em> ç›¸è¼ƒé™£åˆ—å…·å‚™æ›´å¤šç®¡ç†åŠŸèƒ½ï¼š</p>
<ol>
<li>ä»¥ interface Collection ç‚ºä»£è¡¨</li>
<li>é›†åˆå…§ç‰©ä»¶ <code>elements</code>ï¼Œç°¡å¯«ç‚º <code>E</code></li>
<li>é›†åˆå…§ç‰©ä»¶å¿…é ˆç‚ºåƒè€ƒå‹åˆ¥æˆ–åŸºæœ¬å‹åˆ¥çš„åŒ…è£¹é¡åˆ¥ <em>wrapper class</em></li>
<li>æœ‰å¤šç¨®å¸¸è¦‹è³‡æ–™çµæ§‹ï¼Œä¾‹å¦‚ <code>stack</code>ã€<code>queue</code>ã€<code>dynamic array</code> ç­‰</li>
<li>å¤§é‡ä½¿ç”¨æ³›å‹ <code>generic</code></li>
<li>éƒ½å±¬æ–¼ <code>java.util.*</code> package</li>
<li>interface Collection ç¹¼æ‰¿äº† interface Iterableï¼Œå› æ­¤æ‰€æœ‰é›†åˆç‰©ä»¶éƒ½å…·å‚™ä½¿ç”¨ Iterator (ç–Šä»£å™¨) çš„èƒ½åŠ›</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/Dm02pU2.png"
        data-srcset="https://i.imgur.com/Dm02pU2.png, https://i.imgur.com/Dm02pU2.png 1.5x, https://i.imgur.com/Dm02pU2.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/Dm02pU2.png"
        title="image-20221214143907275" /></p>
<h3 id="list">List</h3>
<p>é›†åˆç‰©ä»¶åº•ä¸‹æœ€å¸¸ä½¿ç”¨çš„ä»‹é¢ï¼Œå…·å‚™ index èƒ½ä¾ç…§æ”¾å…¥å…ˆå¾Œå€åˆ†é †åº <em>order</em></p>
<ol>
<li>æ–°å¢ elementï¼Œä½¿ç”¨ index æŒ‡å®šæ’å…¥ä½ç½®</li>
<li>æ–°å¢ elementï¼Œç›´æ¥åŠ åˆ°å°¾ç«¯</li>
<li>å–å¾— element index</li>
<li>ä½¿ç”¨ index ç§»é™¤æˆ–è¦†å¯«æˆå“¡</li>
<li>å–å¾— List é•·åº¦</li>
</ol>
<h3 id="arraylist--list-æœ€å¸¸ä½¿ç”¨çš„ä¸€ç¨®å¯¦ä½œé¡åˆ¥"><code>ArrayList</code> : List æœ€å¸¸ä½¿ç”¨çš„ä¸€ç¨®å¯¦ä½œé¡åˆ¥</h3>
<ul>
<li>ç‰¹è‰²ï¼š
<ol>
<li>è¡Œç‚ºå’Œé™£åˆ— <em>array</em> ç›¸è¿‘ï¼Œä½†é•·åº¦å¯ä»¥è‡ªå‹•æˆé•·ï¼Œåˆç¨±ç‚ºã€Œå‹•æ…‹é™£åˆ—ã€(dynamic array)</li>
<li>ä½¿ç”¨ index æ–°å¢ / å­˜å– / ä¿®æ”¹ element</li>
<li>å¯ä»¥ç”¨ index å€åˆ†ï¼Œæ‰€ä»¥å…è¨±é‡è¤‡æˆå“¡</li>
</ol>
</li>
<li>æœªæ­é…æ³›å‹è¨­è¨ˆçš„ List
<ol>
<li>ä½¿ç”¨ Iterator å–å‡ºçš„ç‰©ä»¶å¿…é ˆè½‰å‹</li>
<li>éŒ¯æ”¾æˆå“¡æ™‚ï¼Œåœ¨åŸ·è¡Œæ™‚æœŸæ‰èƒ½çŸ¥é“ (e.g. add Integer, add Integer, and then add String)</li>
</ol>
</li>
</ul>
<h3 id="è‡ªå‹•è£ç®±-boxingå’Œé–‹ç®±-unboxing">è‡ªå‹•è£ç®± <code>Boxing</code>å’Œé–‹ç®± <code>Unboxing</code></h3>
<ol>
<li>
<p>Primitive â†’ Wrapper Class : æŠŠåŸºæœ¬å‹åˆ¥è£ç®± <em>Boxing</em></p>
</li>
<li>
<p>Wrapper Class â†’ Primitive : å°‡åŸºæœ¬å‹åˆ¥ç”±åŒ…è£¹é¡åˆ¥çš„ç®±å­è£¡å–å‡ºï¼Œé–‹ç®± <em>Unboxing</em></p>
</li>
<li>
<p>åœ¨è¿´åœˆå…§ä½¿ç”¨ boxing / unboxing æœƒè®“æ•ˆèƒ½è€—æå¢å¹…</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Integer partNumObj <span style="color:#f92672">=</span> elements<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> partNum <span style="color:#f92672">=</span> partNumObj<span style="color:#f92672">.</span><span style="color:#a6e22e">intValue</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// see below for concised code
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> partNum <span style="color:#f92672">=</span> elements<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">();</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="set">Set</h3>
<ol>
<li>
<p>å…¶æˆå“¡ element å¿…é ˆç‚ºç¨ä¸€ç„¡äºŒï¼ˆuniqueï¼‰ï¼Œä¸èƒ½é‡è¤‡</p>
</li>
<li>
<p>æ²’æœ‰ index</p>
</li>
<li>
<p>è‹¥æ”¾å…¥é‡è¤‡ elementï¼Œä¸æœƒå‡ºéŒ¯ï¼Œä½†ç„¡æ•ˆ</p>
</li>
<li>
<p>å¸¸ä½¿ç”¨ <code>HashSet</code> å¯¦ä½œé¡åˆ¥ã€‚<code>TreeSet</code> é¡åˆ¥æœƒä¾ç‰©ä»¶ç‰¹æ€§è‡ªå‹•æ’åº</p>
</li>
<li>
<p>element æ˜¯å¦å”¯ä¸€ï¼Œæˆ–æ˜¯æ’åºå…ˆå¾Œï¼Œå–æ±ºæ–¼æ–¹æ³• <code>equals()</code> å’Œ <code>hashCode()</code> çš„è¦†å¯«çµæœ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestSet</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testHashSet</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> set <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashSet<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>        set<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;uno&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        set<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;deux&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        set<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;trois&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        set<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;trois&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>String s <span style="color:#f92672">:</span> set<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;item: &#34;</span> <span style="color:#f92672">+</span> s<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// only prints &#34;trois&#34; once
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#a6e22e">testTreeSet</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> set <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TreeSet<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>        set<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;uno&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        set<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;deux&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        set<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;trois&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        set<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;trois&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        set<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;turban&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>String s <span style="color:#f92672">:</span> set<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;item: &#34;</span> <span style="color:#f92672">+</span> s<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// only prints &#34;trois&#34; once
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// print by String alphabetical order: d, tr-, tu-, u
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="deque-queue">Deque (Queue)</h3>
<p>Interface Deque ç¹¼æ‰¿äº†ä»‹é¢ Queueï¼Œç‰¹è‰²å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>Double-Ended Queue</strong> : å…·å‚™å…©ç«¯é»çš„ Queue</p>
</li>
<li>
<p>å¯åŒæ™‚ä½¿ç”¨æ–¼ Stack å’Œ Queue å…©ç¨®è³‡æ–™çµæ§‹ï¼Œåªè¦å‘¼å«ä¸åŒæ–¹æ³•</p>
<ul>
<li>ä½¿ç”¨<code>add()</code>ã€<code>remove()</code>æ™‚ï¼šDeque ç‰©ä»¶è¡¨ç¾å‡º Queue è³‡æ–™çµæ§‹çš„è¡Œç‚º (FIFO)</li>
<li>ä½¿ç”¨<code>push()</code>ã€<code>pop()</code>æ™‚ï¼šDeque ç‰©ä»¶è¡¨ç¾å‡º Stack è³‡æ–™çµæ§‹çš„è¡Œç‚º (FILO)<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/U7FO4qK.png"
        data-srcset="https://i.imgur.com/U7FO4qK.png, https://i.imgur.com/U7FO4qK.png 1.5x, https://i.imgur.com/U7FO4qK.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/U7FO4qK.png"
        title="image-20221214161745531" /></li>
</ul>
</li>
<li>
<p><code>Deque&lt;String&gt; deque = new ArrayDeque&lt;&gt;(); </code></p>
</li>
</ol>
<h2 id="map">Map</h2>
<ul>
<li>
<p>Map æ˜¯ key - value æˆå°é›†åˆï¼Œä½†ä¸å±¬æ–¼ Collection é›†åˆç‰©ä»¶å®¶æ—</p>
<ol>
<li><strong>key ç‰©ä»¶</strong> : ç”¨ä¾†å°‹æ‰¾ value ç‰©ä»¶ï¼Œæ¯å€‹ key ç‰©ä»¶é ˆç‚ºç¨ç‰¹è€Œä¸é‡è¤‡çš„</li>
<li><strong>value ç‰©ä»¶</strong> : å’Œ key ç‰©ä»¶æœ‰é—œé€£æ€§ï¼ˆassociativeï¼‰</li>
</ol>
</li>
<li>
<p>åœ¨å…¶å®ƒèªè¨€ä¸­ï¼ŒMap åˆç¨±ã€Œé—œè¯æ€§é™£åˆ— associative arraysã€ï¼Œkey å¯æ§‹æˆä¸€é™£åˆ—ï¼Œvalue å¯æ§‹æˆå¦ä¸€å€‹é™£åˆ—ï¼Œå…©é™£åˆ—æœ‰è‘—é—œè¯æ€§</p>
</li>
<li>
<p>Map æ³›å‹ &lt;<code>K</code>, <code>V</code>&gt;</p>
</li>
<li>
<p>Map åŸºæœ¬ç”¨æ³•</p>
<ul>
<li><code>map.values()</code> å–å¾— <code>Collection&lt;T of V&gt;</code></li>
<li><code>map.keySet()</code> å–å¾— <code>Set&lt;T of K&gt;</code> (å› ç‚º keys ä¸èƒ½é‡è¤‡ï¼Œå›å‚³ Set è€Œé Collection)</li>
</ul>
</li>
<li>
<p>Map ä¸¦æœªç¹¼æ‰¿æ–¼ Collection interfaceï¼ŒMap family å¦‚ä¸‹ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/talB7Y5.png"
        data-srcset="https://i.imgur.com/talB7Y5.png, https://i.imgur.com/talB7Y5.png 1.5x, https://i.imgur.com/talB7Y5.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/talB7Y5.png"
        title="image-20221214165500408" /></p>
</li>
<li>
<p>Map family å¸¸ç”¨é¡åˆ¥ï¼š</p>
<ol>
<li>
<p><strong>TreeMap</strong> : keys è‡ªå‹•ä¾é †åºæ’åº</p>
</li>
<li>
<p><strong>HashTable</strong> : <em>åŸ·è¡Œç·’å®‰å…¨</em>ï¼Œä¸” <em>keys å’Œ values ä¸å…è¨±ç‚º null</em></p>
</li>
<li>
<p><strong>HashMap</strong> : <em><strong>é</strong>åŸ·è¡Œç·’å®‰å…¨</em>ï¼Œä¸” <em>keys å’Œ values <strong>å¯</strong>ç‚º null</em></p>
<blockquote>
<p>åŸ·è¡Œç·’å®‰å…¨ :</p>
<p>ä¸€å€‹ç‰©ä»¶è¢«ä¸€å€‹åŸ·è¡Œç·’ä½¿ç”¨å’ŒåŒæ™‚è¢«å¤šå€‹åŸ·è¡Œç·’ä½¿ç”¨æ™‚ï¼Œè¡Œç‚ºæˆ–çµæœéƒ½ä¸€è‡´ï¼Œä¸æœƒç”¢ç”Ÿéé æœŸçµæœ</p>
</blockquote>
</li>
</ol>
</li>
</ul>
<blockquote>
<p>ğŸªâ˜• <strong>LittleTips</strong> : <code>Set</code> å’Œ <code>Map</code> å…©è€…éƒ½æœ‰å¯ä»¥æ”¯æ´æ’åºçš„åˆ†æ”¯</p>
<ol>
<li>æ”¯æ´æ’åºçš„åˆ†æ”¯èµ·æºçš†ä»¥ <code>Sorted</code> ä½œç‚ºå‰ç¶´ã€‚ä¾‹ï¼š<strong>Sorted</strong>Map ã€ <strong>Sorted</strong>Set (interface)</li>
<li>å¯¦ä½œé¡åˆ¥éƒ½æ˜¯ä»¥ <code>Tree</code> ç‚ºé–‹é ­ã€‚ä¾‹ï¼š<strong>Tree</strong>Map ã€ <strong>Tree</strong>Set</li>
</ol>
</blockquote>
<h2 id="é›†åˆç‰©ä»¶æˆå“¡çš„æ’åº">é›†åˆç‰©ä»¶æˆå“¡çš„æ’åº</h2>
<h3 id="æ’åºä½œæ³•">æ’åºä½œæ³•</h3>
<p>å¦‚ä½•æ’åºç‰©ä»¶é¡åˆ¥ï¼Œå¦‚ä½•å®šç¾©é †åºï¼Œä¸€å€‹é¡åˆ¥å¯ä»¥å®šç¾©å¤šå€‹æ’åºæ¨™æº–å—ï¼Ÿæœ‰ä»¥ä¸‹å…©å€‹ä»‹é¢å¯é¸æ“‡</p>
<ol>
<li>Comparable ä»‹é¢ - å¯¦ä½œ <code>compareTo()</code> æ–¹æ³•</li>
<li>Comparator ä»‹é¢ - å¯¦ä½œ <code>compare()</code> æ–¹æ³•</li>
</ol>
<p>å…©ç¨®æ–¹æ³•éƒ½å›å‚³ä¸€å€‹æ•´æ•¸ï¼Œè¡¨ç¤ºæ¯”è¼ƒçµæœï¼š</p>
<ol>
<li>å›å‚³æ•´æ•¸ <code>= 0</code>ï¼šå…©è€…ç›¸ç­‰</li>
<li>å›å‚³æ•´æ•¸ <code>&lt; 0</code>ï¼šè¡¨ç¤ºã€Œè‡ªå·±ï¼ˆthisï¼‰ã€**å°æ–¼ï¼ˆæ•¸å€¼ä¸Šï¼‰**æˆ– <strong>å…ˆæ–¼ï¼ˆé †åºä¸Šï¼‰</strong>ã€Œæ–¹æ³•åƒæ•¸ç‰©ä»¶ã€</li>
<li>å›å‚³æ•´æ•¸ <code>&gt; 0</code>ï¼šè¡¨ç¤ºã€Œè‡ªå·±ï¼ˆthisï¼‰ã€**å¤§æ–¼ï¼ˆæ•¸å€¼ä¸Šï¼‰**æˆ– <strong>å¾Œæ–¼ï¼ˆé †åºä¸Šï¼‰</strong>ã€Œæ–¹æ³•åƒæ•¸ç‰©ä»¶ã€</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Calendar today <span style="color:#f92672">=</span> Calendar<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>Calendar tomorrow <span style="color:#f92672">=</span> Calendar<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>tomorrow<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>Calendar<span style="color:#f92672">.</span><span style="color:#a6e22e">DATE</span><span style="color:#f92672">,</span> 1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>today<span style="color:#f92672">.</span><span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>tomorrow<span style="color:#f92672">));</span>   <span style="color:#75715e">// å­—ä¸² today å…ˆæ–¼ tomorrowï¼Œæ‰€ä»¥å›å‚³-1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;A&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;B&#34;</span><span style="color:#f92672">));</span>          <span style="color:#75715e">// å­—ä¸²&#34;A&#34;æ—©æ–¼å­—ä¸²&#34;B&#34;ï¼Œæ‰€ä»¥å›å‚³-1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span>5<span style="color:#f92672">).</span><span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span>6<span style="color:#f92672">)));</span>
</span></span></code></pre></div><h3 id="ä½¿ç”¨-comparable-ä»‹é¢æ’åº">ä½¿ç”¨ <code>Comparable</code> ä»‹é¢æ’åº</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Comparable</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>T o<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>ç‰¹è‰²ï¼š</p>
<ol>
<li>
<p>æ”¯æ´æ³›å‹è¨­è¨ˆ</p>
</li>
<li>
<p>å¿…é ˆå¯¦ä½œ <code>compareTo()</code> æ–¹æ³•ï¼Œæ¯”è¼ƒè‡ªå·±ï¼ˆthisï¼‰å’Œæ–¹æ³•åƒæ•¸ç‰©ä»¶</p>
</li>
<li>
<p>ä¸€å€‹ class åªèƒ½å¯¦ä½œä¸€æ¬¡ Comparable ä»‹é¢ï¼Œæ‰€ä»¥åªèƒ½æä¾›å–®ä¸€æ–¹å¼æ’åºï¼Œå¯ç”¨æ–¼ <code>TreeSet</code> å’Œ <code>TreeMap</code> ç­‰å¯¦ä½œé¡åˆ¥ï¼Œæˆ–éœ€è¦ç‰©ä»¶ä¹‹é–“æ¯”è¼ƒçš„åœ°æ–¹</p>
</li>
<li>
<p>æ±ºå®šè©²ç‰©ä»¶é¡åˆ¥è¦ä»¥å“ªä¸€å€‹æ¢ä»¶æ±ºå®š Student ç‰©ä»¶çš„æ’åºå…ˆå¾Œï¼Œå†è®“è©²é¡åˆ¥å¯¦ä½œ Comparable ä»‹é¢</p>
<ol>
<li>å¿…é ˆæä¾› <code>compareTo()</code> æ–¹æ³•çš„å…§å®¹</li>
<li>åªèƒ½æä¾›ä¸€ç¨®æ’åºé¸æ“‡</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span> <span style="color:#66d9ef">implements</span> Comparable<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>Student s<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// use method delegation æ–¹æ³•å§”æ´¾ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">int</span> sortById <span style="color:#f92672">=</span> Long<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">id</span><span style="color:#f92672">).</span><span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>s<span style="color:#f92672">.</span><span style="color:#a6e22e">id</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> sortByName <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">name</span><span style="color:#f92672">.</span><span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>s<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> sortByScome <span style="color:#f92672">=</span> Double<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">score</span><span style="color:#f92672">).</span><span style="color:#a6e22e">compareTO</span><span style="color:#f92672">(</span>s<span style="color:#f92672">.</span><span style="color:#a6e22e">score</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sortById<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="ä½¿ç”¨-comparator-ä»‹é¢æ’åº">ä½¿ç”¨ <code>Comparator</code> ä»‹é¢æ’åº</h3>
<ul>
<li>
<p>å¯¦ä½œ <code>Comparable</code> interface çš„é¡åˆ¥åªæœ‰æä¾›ä¸€æ¬¡ <code>compareTo()</code> æ–¹æ³•å…§å®¹çš„æ©Ÿæœƒï¼Œæ•…åªæœ‰ä¸€ç¨®æ’åºèƒ½åŠ›</p>
</li>
<li>
<p>ä½¿ç”¨ <code>Comparator</code> interface å‰‡å¯ä»¥æä¾›å¤šç¨®é¸æ“‡</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Comparator</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span><span style="color:#f92672">(</span>T o1<span style="color:#f92672">,</span> T o2<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p>ç‰¹è‰²ï¼š</p>
<ol>
<li>
<p>æ”¯æ´æ³›å‹è¨­è¨ˆ</p>
</li>
<li>
<p>éœ€å¯¦ä½œ <code>compare()</code>ï¼Œç”¨ä»¥æ¯”è¼ƒã€Œç¬¬ä¸€å€‹åƒæ•¸ç‰©ä»¶ã€å’Œã€Œç¬¬äºŒå€‹åƒæ•¸ç‰©ä»¶ã€</p>
</li>
<li>
<p>å¯è—‰ç”±æä¾›å¤šç¨® Comparator é¡åˆ¥ï¼Œé”æˆå¤šç¨®æ’åºæ–¹å¼ã€‚</p>
<ul>
<li>
<p>å¸¸ç”¨æ–¼æ­é…ä»¥ä¸‹æ–¹æ³•ï¼Œä»¥å¹«åŠ© List æˆå“¡æ’åº</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sort</span><span style="color:#f92672">(</span>List<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> list<span style="color:#f92672">,</span> Comparator<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">super</span> T<span style="color:#f92672">&gt;</span> c<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    list<span style="color:#f92672">.</span><span style="color:#a6e22e">sort</span><span style="color:#f92672">(</span>c<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NameSorter</span> <span style="color:#66d9ef">implements</span> Comparator<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span><span style="color:#f92672">(</span>Student s1<span style="color:#f92672">,</span> Student s2<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> s1<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">().</span><span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>s2<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ScoreSorter</span> <span style="color:#66d9ef">implements</span> Comparator<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span><span style="color:#f92672">(</span>Student s1<span style="color:#f92672">,</span> Student s2<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Double<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span>s1<span style="color:#f92672">.</span><span style="color:#a6e22e">getScore</span><span style="color:#f92672">()).</span><span style="color:#a6e22e">compareTo</span><span style="color:#f92672">(</span>s2<span style="color:#f92672">.</span><span style="color:#a6e22e">getScore</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestComparator</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">showList</span><span style="color:#f92672">(</span>List<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> studentList<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> studentList<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">();</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;index#&#34;</span> <span style="color:#f92672">+</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: &#34;</span> <span style="color:#f92672">+</span> studentList<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>i<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> studentList <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;(</span>3<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        studentList<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Student<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thomas&#34;</span><span style="color:#f92672">,</span> 1<span style="color:#f92672">,</span> 3<span style="color:#f92672">.</span><span style="color:#a6e22e">8</span><span style="color:#f92672">));</span> 
</span></span><span style="display:flex;"><span>        studentList<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Student<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;John&#34;</span><span style="color:#f92672">,</span> 2<span style="color:#f92672">,</span> 3<span style="color:#f92672">.</span><span style="color:#a6e22e">9</span><span style="color:#f92672">));</span> 
</span></span><span style="display:flex;"><span>        studentList<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Student<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;George&#34;</span><span style="color:#f92672">,</span> 3<span style="color:#f92672">,</span> 3<span style="color:#f92672">.</span><span style="color:#a6e22e">4</span><span style="color:#f92672">));</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n------ Original ------&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        showList<span style="color:#f92672">(</span>studentList<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n----- Sort by name -----&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        Comparator<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> sortName <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> NameSorter<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        Collections<span style="color:#f92672">.</span><span style="color:#a6e22e">sort</span><span style="color:#f92672">(</span>studentList<span style="color:#f92672">,</span> sortName<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        showList<span style="color:#f92672">(</span>studentList<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n----- Sort by score -----&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        Comparator<span style="color:#f92672">&lt;</span>Student<span style="color:#f92672">&gt;</span> sortScore <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ScoreSorter<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        Collections<span style="color:#f92672">.</span><span style="color:#a6e22e">sort</span><span style="color:#f92672">(</span>studentList<span style="color:#f92672">,</span> sortScore<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        showList<span style="color:#f92672">(</span>studentList<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="ä½¿ç”¨-of-èˆ‡-copyof-æ–¹æ³•å»ºç«‹-listset-èˆ‡-map-ç‰©ä»¶">ä½¿ç”¨ <code>of()</code> èˆ‡ <code>copyOf()</code> æ–¹æ³•å»ºç«‹ <code>List</code>ã€<code>Set</code> èˆ‡ <code>Map</code> ç‰©ä»¶</h2>
<h3 id="ä½¿ç”¨ofæ–¹æ³•å»ºç«‹-list-set-map-ç‰©ä»¶">ä½¿ç”¨<code>of()</code>æ–¹æ³•å»ºç«‹ List, Set, Map ç‰©ä»¶</h3>
<ul>
<li>
<p>è‡ª Java 9 é–‹å§‹ï¼Œé™¤äº†å‚³çµ±ä½¿ç”¨ new å‘¼å«å­é¡åˆ¥å»ºæ§‹å­ä»¥å»ºç«‹ List, Set, Map ç‰©ä»¶å¤–</p>
<ul>
<li>
<p>å°å…¥éœæ…‹å·¥å» æ–¹æ³• <code>of()</code> ä¾†å»ºç«‹ä¸å¯æ”¹è®Šï¼ˆimmutableï¼‰çš„ç‰©ä»¶</p>
<ul>
<li>
<p><code>List.of()</code> | <code>Set.of()</code> | <code>Map.of()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">=</span> List<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span>t1<span style="color:#f92672">,</span> t2<span style="color:#f92672">,</span> <span style="color:#f92672">...);</span>
</span></span><span style="display:flex;"><span>Set<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> set <span style="color:#f92672">=</span> Set<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span>t1<span style="color:#f92672">,</span> t2<span style="color:#f92672">,</span> <span style="color:#f92672">...);</span>
</span></span><span style="display:flex;"><span>Map<span style="color:#f92672">&lt;</span>K<span style="color:#f92672">,</span> V<span style="color:#f92672">&gt;</span> map <span style="color:#f92672">=</span> Map<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span>key1<span style="color:#f92672">,</span> value1<span style="color:#f92672">,</span> key2<span style="color:#f92672">,</span> value2<span style="color:#f92672">,</span> <span style="color:#f92672">...);</span>
</span></span></code></pre></div></li>
<li>
<p>line 5, 15, 26 : ä»¥ <code>of()</code> å»ºç«‹ç‰©ä»¶å¾Œï¼Œè‹¥å†å˜—è©¦æ–°å¢æˆå“¡ï¼ˆ<code>list.add(...)</code>ã€<code>set.add(...)</code>ã€<code>map.put(...)</code>ï¼‰ï¼Œéƒ½æœƒæ‹‹å‡º <em><strong>java.lang.UnsupportOperationException</strong></em></p>
</li>
<li>
<p>line 9, 19, 30 : å¦‚æœè¦å°‡ä¸å¯æ›´æ”¹çš„ç‰©ä»¶è½‰æ›ç‚ºå¯æ›´æ”¹ç‰©ä»¶ï¼Œå¯å°‡å…¶ä½œç‚º <code>ArrayList</code>ã€<code>HashSet</code>ã€<code>HashMap</code> ç­‰å»ºæ§‹å­çš„åƒæ•¸ï¼Œé‡æ–°å»ºç«‹å¯æ›´æ”¹ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">createImmutablesByOf</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// List.of()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> list1 <span style="color:#f92672">=</span> List<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i1&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i2&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i3&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i4&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">// line 5 : UnsupportedException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> list2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;(</span>list1<span style="color:#f92672">);</span>  <span style="color:#75715e">// line 9 : mutable w/ ArrayList
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    list2<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i4&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>list2<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Set.of()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> set1 <span style="color:#f92672">=</span> Set<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i1&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i2&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i3&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        set1<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i4&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">// line 15 : UnsupportedException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> set2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashSet<span style="color:#f92672">&lt;&gt;(</span>set1<span style="color:#f92672">);</span>  <span style="color:#75715e">// line 19 : mutable w/ HashSet
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    set2<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i4&#34;</span><span style="color:#f92672">);</span>  
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>set2<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Map.of()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Employee<span style="color:#f92672">&gt;</span> map1 <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>            Map<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;jim&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Employee<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;jim&#34;</span><span style="color:#f92672">),</span> <span style="color:#e6db74">&#34;duke&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Employee<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;duke&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        map1<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bill&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Employee<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bill&#34;</span><span style="color:#f92672">));</span> <span style="color:#75715e">// line 26 : UnsupportedException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Employee<span style="color:#f92672">&gt;</span> map2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;(</span>map1<span style="color:#f92672">);</span>  <span style="color:#75715e">// line 30 : mutable w/ HashMap
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    map2<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bill&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Employee<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bill&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>map2<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ä½¿ç”¨copyofæ–¹æ³•å»ºç«‹-list-set-map-ç‰©ä»¶">ä½¿ç”¨<code>copyOf()</code>æ–¹æ³•å»ºç«‹ List, Set, Map ç‰©ä»¶</h3>
<ul>
<li>
<p>å¾ Java 10 é–‹å§‹ï¼Œåˆå°å…¥å¦ä¸€å€‹éœæ…‹å·¥å» æ–¹æ³• <code>copyOf()</code>ï¼Œå¯ä»¥å»ºç«‹ã€Œ<strong>ä¸å¯æ”¹è®Š</strong>ã€çš„ã€Œ<strong>å‰¯æœ¬ç‰©ä»¶</strong>ã€</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">createImmutablesByCopyOf</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// List.copyOf()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> list1 <span style="color:#f92672">=</span> List<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i1&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i2&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i3&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> list2 <span style="color:#f92672">=</span> List<span style="color:#f92672">.</span><span style="color:#a6e22e">copyOf</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>     <span style="color:#75715e">// immutable copy
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        list2<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i4&#34;</span><span style="color:#f92672">);</span>     <span style="color:#75715e">// UnsupportedOperationException 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Set.copyOf()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> set1 <span style="color:#f92672">=</span> Set<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i1&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i2&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i3&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> set2 <span style="color:#f92672">=</span> Set<span style="color:#f92672">.</span><span style="color:#a6e22e">copyOf</span><span style="color:#f92672">(</span>set1<span style="color:#f92672">);</span>     <span style="color:#75715e">// immutable copy
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        set2<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i4&#34;</span><span style="color:#f92672">);</span>     <span style="color:#75715e">// UnsupportedOperationException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Map.copyOf()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Employee<span style="color:#f92672">&gt;</span> map1 <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>            Map<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;jim&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Employee<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;jim&#34;</span><span style="color:#f92672">),</span> <span style="color:#e6db74">&#34;duke&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Employee<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;duke&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>    Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Employee<span style="color:#f92672">&gt;</span> map2 <span style="color:#f92672">=</span> Map<span style="color:#f92672">.</span><span style="color:#a6e22e">copyOf</span><span style="color:#f92672">(</span>map1<span style="color:#f92672">);</span>     <span style="color:#75715e">// immutable copy
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        map2<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bill&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Employee<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bill&#34;</span><span style="color:#f92672">));</span>     <span style="color:#75715e">// UnsupportedOperationException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="ä½¿ç”¨-arraysaslistå»ºç«‹-list-ç‰©ä»¶">ä½¿ç”¨ <code>Arrays.asList()</code>å»ºç«‹ List ç‰©ä»¶</h3>
<p>List å¦ä¸€ç¨®ä»¥ã€Œå–®å€‹å…ƒç´ æˆå“¡ã€ä½œç‚ºåƒæ•¸å»ºç«‹ List ç‰©ä»¶çš„æ–¹å¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">=</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">asList</span><span style="color:#f92672">(</span>t1<span style="color:#f92672">,</span> t2<span style="color:#f92672">,</span> <span style="color:#f92672">...);</span>
</span></span></code></pre></div><p>ä½¿ç”¨ <code>Arrays.asList()</code> å»ºç«‹çš„ List ç‰©ä»¶å’Œé™£åˆ—ï¼ˆArrayï¼‰ç›¸ä¼¼ï¼Œç‰¹æ€§ï¼š</p>
<ol>
<li>
<p>é•·åº¦å›ºå®šï¼Œä¸å¯ä»¥æ–°å¢/åˆªé™¤æˆå“¡ï¼ˆåƒè€ƒ line 6ï¼‰</p>
</li>
<li>
<p>å¯ä»¥ä¿®æ”¹æˆå“¡ï¼ˆåƒè€ƒ line 4ï¼‰</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">createList</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> list1 <span style="color:#f92672">=</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">asList</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i1&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i2&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;i3&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">set</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;iil&#34;</span><span style="color:#f92672">);</span>    <span style="color:#75715e">// line 4 : element updatable
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>list1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        list1<span style="color:#f92672">.</span><span style="color:#a6e22e">remove</span><span style="color:#f92672">(</span>0<span style="color:#f92672">);</span>        <span style="color:#75715e">// line 6 : removing or adding not permitted
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> list2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;(</span>list1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    list2<span style="color:#f92672">.</span><span style="color:#a6e22e">remove</span><span style="color:#f92672">(</span>0<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>list2<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ol>
<hr>
<h1 id="02-ä¾‹å¤–èˆ‡æ–·è¨€">02 ä¾‹å¤–èˆ‡æ–·è¨€</h1>
<h2 id="ä¾‹å¤–">ä¾‹å¤–</h2>
<p>å€¼å¾—ä¿¡è³´çš„ç¨‹å¼æœƒå„ªé›…çš„è™•ç†ä¾‹å¤–ç‹€æ³ï¼š</p>
<ol>
<li>è™•ç†ç›®æ¨™æ˜¯ã€Œexceptionï¼ˆä¾‹å¤–ï¼‰ã€ï¼Œéé æœŸç‹€æ³</li>
<li>ä¾‹å¤–å¿…é ˆè™•ç†ä»¥å»ºç«‹å¯ä¿¡è³´çš„ç¨‹å¼</li>
<li>ç™¼ç”ŸåŸå› å¯èƒ½æ˜¯ç¨‹å¼ bugs</li>
<li>ç™¼ç”ŸåŸå› å¯èƒ½æ˜¯ç¨‹å¼ç„¡æ³•è™•ç†çš„ç‹€æ³
<ul>
<li>è³‡æ–™åº«ç„¡æ³•é€£ç·š</li>
<li>ç¡¬ç¢Ÿæ¯€æ</li>
</ul>
</li>
</ol>
<p>Cèªè¨€ç™¼ç”ŸéŒ¯èª¤çš„è©±ï¼Œé€šå¸¸ä»¥<strong>å›å‚³è² å€¼</strong>è¡¨ç¤ºï¼Œä¾‹å¦‚ <code>int x = printf(&quot;hi&quot;)</code></p>
<p>Java å‰‡åœ¨å‡ºç¾éŒ¯èª¤æ™‚ï¼Œç”± JVM æ‹‹å‡ºä¾‹å¤–ç‰©ä»¶ï¼Œä¸åŒç¨®é¡çš„ä¾‹å¤–ï¼Œæœ‰ä¸åŒè™•ç†æ–¹å¼</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/BHInvNP.png"
        data-srcset="https://i.imgur.com/BHInvNP.png, https://i.imgur.com/BHInvNP.png 1.5x, https://i.imgur.com/BHInvNP.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/BHInvNP.png"
        title="image-20221215142633549" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/xYQBNxF.png"
        data-srcset="https://i.imgur.com/xYQBNxF.png, https://i.imgur.com/xYQBNxF.png 1.5x, https://i.imgur.com/xYQBNxF.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/xYQBNxF.png"
        title="image-20221215160311402" /></p>
<ul>
<li>ç•¶é¡åˆ¥æ–¹æ³•å‘¼å«å…¶ä»–é¡åˆ¥æ–¹æ³•æ™‚ï¼Œå¦‚æœè¢«å‘¼å«çš„æ–¹æ³•å·²å®£å‘Šæœ‰æ‹‹å‡º <strong>checked exception</strong> çš„é¢¨éšªï¼Œç·¨è­¯å™¨æœƒè¦æ±‚å‘¼å«è€…æ–¹æ³•å¿…é ˆè™•ç†ï¼ˆhandleï¼‰æˆ–æ˜¯ä¹Ÿå®£å‘Šï¼ˆdeclareï¼‰å¯èƒ½ç™¼ç”Ÿçš„å•é¡Œï¼š
<ol>
<li><strong>Handling Exception</strong>ï¼šè¡¨ç¤ºå¿…é ˆæœ‰ç¨‹å¼ç¢¼å€å¡Šä¾†è™•ç†ç•°å¸¸ç‹€æ³ï¼Œæ­¤æ™‚ä½¿ç”¨ã€Œtry-catchã€æ•˜è¿°</li>
<li><strong>Declaring Exception</strong>ï¼šåœ¨æ–¹æ³•ä¸Šè¨»è¨˜åŸ·è¡Œå¯èƒ½å‡ºç¾çš„éŒ¯èª¤ï¼Œæé†’ä½¿ç”¨çš„æ–¹æ³•å¿…é ˆè™•ç†ï¼Œæ­¤æ™‚ä½¿ç”¨ã€Œthrowsã€å®£å‘Š</li>
</ol>
</li>
</ul>
<h3 id="ä½¿ç”¨try-catchç¨‹å¼ç¢¼å€å¡Š">ä½¿ç”¨<code>try-catch</code>ç¨‹å¼ç¢¼å€å¡Š</h3>
<h4 id="ä¸€èˆ¬ä¾‹å¤–ç‹€æ³">ä¸€èˆ¬ä¾‹å¤–ç‹€æ³</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">tryCatchTest</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Opening a file...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        InputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;lostFile.txt&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;File is opened&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>
<p><code>catch</code>ç¨‹å¼ç¢¼å€å¡Šå¿…é ˆå‚³å…¥ <code>java.lang.Exception</code> æˆ– <code>java.lang.Throwable</code> çš„å­é¡åˆ¥åƒè€ƒ</p>
</li>
<li>
<p>å…¶ä¸­<code>java.lang.Throwable</code> æ˜¯ä¾‹å¤–å§‹ç¥–ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p>æŠŠ catch ç•¶æˆä¸€ç¨®æ–¹æ³•ï¼Œå‰‡å¾Œé¢çš„ () ä»£è¡¨è¦å‚³å…¥çš„åƒæ•¸</p>
</li>
<li>
<p>å‚³å…¥å¤§åˆ†é¡çš„å‹åˆ¥ï¼ˆçˆ¶é¡åˆ¥æˆ–ä»‹é¢ï¼‰ç‚ºå¤šå‹çš„æ‡‰ç”¨ï¼Œä½†ä¸é©ç”¨æ–¼æ­¤ï¼Œä¾‹å¤–è™•ç†æ‡‰è©²å°ç—‡ä¸‹è—¥</p>
</li>
<li>
<p>catch æ–¹æ³•åªè®“ Java åœ¨ç¨‹å¼é‡åˆ°éŒ¯èª¤æ™‚å‘¼å« / å‚³å…¥ä¾‹å¤–ç‰©ä»¶</p>
</li>
<li>
<p>æ•æ‰ä¾‹å¤–å¾Œï¼š</p>
<ol>
<li>ç´€éŒ„éŒ¯èª¤è¨Šæ¯</li>
<li>é‡è©¦ä¸€æ¬¡</li>
<li>å˜—è©¦å…¶å®ƒæ›¿ä»£æ–¹æ¡ˆ</li>
<li>é›¢é–‹ï¼ˆreturnï¼‰æˆ–çµæŸç¨‹å¼ï¼ˆexitï¼‰</li>
</ol>
</li>
</ul>
<h4 id="è¤‡é›œä¾‹å¤–ç‹€æ³">è¤‡é›œä¾‹å¤–ç‹€æ³</h4>
<ul>
<li>
<p>ä¸€å€‹ç¨‹å¼ç¢¼å€å¡Š / æ–¹æ³•ï¼Œå¿…é ˆåŒæ™‚è™•ç†å¤šç¨®å¯èƒ½çš„ä¾‹å¤–ç‹€æ³ï¼š</p>
<ol>
<li>
<p>å–®ä¸€ã€Œtryã€æ­é…å¤šå€‹ã€Œcatchã€ï¼šä¾‹å¤–å­é¡åˆ¥æ’åºæ‡‰è©²åœ¨çˆ¶é¡åˆ¥ä¸Šé¢ï¼Œé¿å…æ‰€æœ‰ä¾‹å¤–ä¸€é–‹å§‹å°±è¢«ä¾‹å¤–çˆ¶é¡åˆ¥ï¼ˆException, Throwableï¼‰æ””æˆª</p>
</li>
<li>
<p>æ•æ‰ï¼ˆcatchï¼‰ç‰©ä»¶ Exception æ™‚ï¼Œç›¡å¯èƒ½æ•æ‰æœ€ç‰¹å®šï¼ˆspecific typeï¼‰çš„ä¾‹å¤–å­é¡åˆ¥</p>
</li>
<li>
<p>Java Persistence APIï¼ˆJPAï¼‰ä¾‹å¤–å¤§éƒ¨åˆ†ç¹¼æ‰¿ RuntimeExceptionï¼Œå±¬ unchecked exception</p>
<ul>
<li>
<p>æ…£ä¾‹ä¸Šç‚ºä¸ç”¨è™•ç†çš„æ„å¤–ï¼Œä½†æ­£å¼ç’°å¢ƒè£¡é‚„æ˜¯æ‡‰è©²è™•ç†</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">tryCatch</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Opening a file...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        InputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;lostFile.txt&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;File is opened&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> data <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="ç´€éŒ„loggingéŒ¯èª¤å…§å®¹">ç´€éŒ„ï¼ˆLoggingï¼‰éŒ¯èª¤å…§å®¹</h4>
<ul>
<li>æ­£å¼ç’°å¢ƒä¸­ï¼Œæ‡‰ç§»é™¤ <code>printStackTrace()</code> æˆ– <code>System.out.println(e.getMessage())</code>æ­¤é¡ç¨‹å¼ç¢¼</li>
<li>åŸ·è¡ŒéŒ¯èª¤æ™‚ï¼Œæ‡‰è©²å¯«å…¥ç´€éŒ„ / æ—¥èªŒæª”ï¼ˆlog fileï¼‰ï¼Œç›¸é—œå‡½å¼åº«
<ol>
<li>Simple logging facade for Java SLF4J</li>
<li>Apache&rsquo;s Log4j</li>
<li>Built-in java.util logging framework</li>
</ol>
</li>
</ul>
<h4 id="ä½¿ç”¨finallyæ•˜è¿°">ä½¿ç”¨<code>finally</code>æ•˜è¿°</h4>
<ul>
<li>
<p>ä½¿ç”¨å¤–éƒ¨è³‡æºï¼Œä¾‹å¦‚é–‹å•Ÿæª”æ¡ˆæˆ–é€£ç·šè³‡æ–™åº«ï¼Œæ‡‰è©²åœ¨ä¸ä½¿ç”¨æ™‚é—œé–‰è³‡æº</p>
</li>
<li>
<p>å¦‚æœåœ¨ try å€å¡Šä¸­é—œé–‰è³‡æºï¼Œå¯èƒ½å› ç‚ºåŸ·è¡ŒéŒ¯èª¤è€Œå°è‡´è³‡æºé–‹äº†ä¾†ä¸åŠé—œï¼Œæ­¤æ™‚å¯ç”¨ finally æ•˜è¿°</p>
<ol>
<li>
<p>ä¸ç®¡æ˜¯ try æˆ–è€… catch åŸ·è¡ŒçµæŸï¼Œéƒ½ä¸€å®šæœƒé€²å…¥ finally ç¨‹å¼ç¢¼å€å¡Š</p>
</li>
<li>
<p>æœ‰æ™‚åœ¨ finally å€çš„ç¨‹å¼ç¢¼ä¹Ÿå¯èƒ½å‡ºéŒ¯ï¼Œå› æ­¤éœ€è¦å·¢ç‹€ try-catch å€å¡Šä¾†è™•ç†</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">tryCatchFinally</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    InputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Opening a file...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;lostFile.txt&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;File is opened&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> data <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>in <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>   <span style="color:#75715e">// try to close file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Failed to close file&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ol>
</li>
</ul>
<h3 id="ä½¿ç”¨-try-with-resources-ç¨‹å¼ç¢¼å€å¡Šå’Œ-autocloseable-ä»‹é¢">ä½¿ç”¨ <code>try-with-resources</code> ç¨‹å¼ç¢¼å€å¡Šå’Œ <code>AutoCloseable</code> ä»‹é¢</h3>
<h4 id="ä½¿ç”¨-try-with-resources-æ•˜è¿°">ä½¿ç”¨ <code>try-with-resources</code> æ•˜è¿°</h4>
<ul>
<li>
<p>Java 7 æä¾›æ–°çš„ <code>try-with-resources</code> æ•˜è¿°ï¼Œå¯è‡ªå‹•é—œé–‰è¢«é–‹å•Ÿçš„ã€Œè³‡æºï¼ˆresourcesï¼‰ã€</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span> å®£å‘Šä¸¦é–‹å•Ÿè³‡æº <span style="color:#f92672">[;</span> å®£å‘Šä¸¦é–‹å•Ÿå…¶å®ƒè³‡æº <span style="color:#f92672">...]</span> <span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åœ¨ try ç¨‹å¼ç¢¼å€å¡Šä¹‹å¾Œï¼Œè³‡æºå°‡è‡ªå‹•é—œé–‰
</span></span></span></code></pre></div><ol>
<li>
<p>é€™è£¡å®šç¾©çš„è³‡æºï¼Œå¿…é ˆç‚ºå¯¦ä½œ <code>java.lang.AutoCloseable</code> ä»‹é¢çš„é¡åˆ¥</p>
</li>
<li>
<p>å¦‚æœè¦é–‹å¤šå€‹è³‡æºï¼Œå¯ä»¥ä½¿ç”¨ã€Œ<strong>;</strong>ã€åšå€éš”</p>
</li>
<li>
<p>è‡ªå‹•é—œé–‰çš„é †åºå°‡å’Œä½¿ç”¨è³‡æºçš„é–‹å•Ÿé †åºç›¸å</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">tryWithResource</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Opening a file...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>InputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;lostFile.txt&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span> <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;File is opened&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> data <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ol>
</li>
</ul>
<p>æ¯”è¼ƒ <code>tryCatchFinally</code> èˆ‡ <code>tryWithResource</code>ï¼Œå¯ä»¥ç™¼ç¾ï¼š</p>
<ol>
<li>ç§»é™¤ <code>finally</code> ç¨‹å¼ç¢¼å€å¡Šï¼Œå¦‚å‰ç¯„ä¾‹è¡Œ 16 - 23</li>
<li>ä½¿ç”¨ <code>try-with-resource</code> å®£å‘Šè¦é–‹å•Ÿçš„è³‡æº</li>
</ol>
<h4 id="èªè­˜-autocloseableä»‹é¢">èªè­˜ <code>AutoCloseable</code>ä»‹é¢</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InputStream</span> <span style="color:#66d9ef">implements</span> Closeable <span style="color:#f92672">{</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Closeable</span> <span style="color:#66d9ef">extends</span> AutoCloseable <span style="color:#f92672">{</span>
</span></span></code></pre></div><ul>
<li>
<p>è³‡æºï¼ˆresourceï¼‰è¦è—‰ç”± `try-with-resourcesâ€µ æ•˜è¿°é–‹å•Ÿå’Œè‡ªå‹•é—œé–‰ï¼Œå¿…é ˆå¯¦ä½œä»¥ä¸‹å…©è€…ä»»ä¸€</p>
<ol>
<li>
<p>ä»‹é¢ <em>java.lang.AutoCloseable</em></p>
<ul>
<li>
<p>Java 7 æ–°å¢</p>
</li>
<li>
<p>å”¯ä¸€çš„æŠ½è±¡æ–¹æ³• <code>close()</code> æœƒæ‹‹å‡º Exception ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">AutoCloseable</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">close</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> Exception<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>ä»‹é¢ <em>java.io.Closeable</em></p>
<ul>
<li>
<p>æ—©æœŸçš„ Java ç‰ˆæœ¬å°±å­˜åœ¨ï¼Œåœ¨ Java 7 ä¸­ä¿®æ”¹ä½¿å…¶ç¹¼æ‰¿ä»‹é¢ <code>AutoCloseable</code></p>
</li>
<li>
<p>å”¯ä¸€çš„æŠ½è±¡æ–¹æ³• <code>close()</code> æœƒæ‹‹å‡º <code>IOException</code> ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Closeable</span> <span style="color:#66d9ef">extends</span> AutoCloseable <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">close</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ol>
</li>
</ul>
<p><strong>Idempotent method</strong> - å³ä½¿é‡è¤‡åŸ·è¡Œå¤šæ¬¡ï¼Œä¹Ÿä¸æœƒæœ‰å‰¯ä½œç”¨ï¼ˆside effectsï¼‰ç”¢ç”Ÿ</p>
<ul>
<li>
<p><code>java.io.Closeable</code> çš„ close() æ–¹æ³•å¿…é ˆæ»¿è¶³ idempotent è¦æ±‚</p>
</li>
<li>
<p><code>java.lang.AutoCloseable</code> ä¸¦æœªä¸€è‡´è¦æ±‚å¯¦ä½œä¹‹ close() å¿…é ˆæ¯”ç…§è¾¦ç†</p>
<ul>
<li>
<p>å³ä¾¿å¦‚æ­¤ä»æ‡‰è©²è¦åšåˆ°åè¦†åŸ·è¡Œå¤šæ¬¡éƒ½æ²’æœ‰å‰¯ä½œç”¨ç”¢ç”Ÿ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// è‹¥è³‡æºç‚ºé—œé–‰ï¼ˆä»¥resource == null åˆ¤å®šï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>If <span style="color:#f92672">(</span>resource <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// é—œé–‰è³‡æºï¼Œä¸¦ä½¿ resource = null
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="suppressed-exceptions">Suppressed Exceptions</h3>
<p>ä½¿ç”¨ try-with-resource ä¹Ÿè¡ä¼¸å‡ºæ–°çš„ä¾‹å¤– exception è™•ç†å•é¡Œå¿…é ˆæ³¨æ„ï¼š</p>
<ol>
<li>Java é–‹å•Ÿè³‡æºæ™‚æ‹‹å‡ºä¾‹å¤–ï¼ŒæœªæˆåŠŸé–‹å•Ÿè³‡æº
<ul>
<li>ç¨‹å¼ç¢¼ç›´æ¥è·³åˆ° catch å€ï¼Œåªæ‹‹å‡ºä¸€å€‹ä¾‹å¤–</li>
</ul>
</li>
<li>Java æˆåŠŸé–‹å•Ÿè³‡æºï¼Œä½†åœ¨ try å€æ‹‹å‡ºä¾‹å¤–ï¼Œåœ¨èƒŒæ™¯é—œé–‰è³‡æºæ™‚åˆæ‹‹å‡ºä¾‹å¤–
<ul>
<li>å…±ç”¢ç”Ÿ 2 å€‹ä¾‹å¤–</li>
<li>catch å€å¿…é ˆåŒæ™‚æ¥æ”¶ 2 å€‹ä¾‹å¤–ç‰©ä»¶ <strong>è¡ä¼¸å•é¡Œ</strong></li>
</ul>
</li>
<li>Java æˆåŠŸé–‹å•Ÿè³‡æºï¼Œtry å€å¡Šå…§ä»»å‹™æˆåŠŸåŸ·è¡Œï¼Œä½†åœ¨é—œé–‰è³‡æºæ™‚å‡ºéŒ¯
<ul>
<li>å’Œä¸€èˆ¬æƒ…æ³ä¸€æ¨£ï¼Œåªæ‹‹å‡º 1 å€‹ä¾‹å¤–</li>
</ul>
</li>
</ol>
<ul>
<li>
<p>ç•¶æœ‰å…©å€‹ä¾‹å¤–é¡åˆ¥è¢«å…ˆå¾Œæ‹‹å‡ºï¼ŒJavaæœƒå°‡ <strong>å¾Œç™¼ç”Ÿï¼ŒåŒæ™‚å’Œé—œé–‰è³‡æºæœ‰é—œ</strong> çš„ä¾‹å¤–ç‰©ä»¶ï¼Œéš±åŒ¿/æ“ å£“ï¼ˆsuppressedï¼‰åˆ°ã€Œå…ˆç™¼ç”Ÿã€ä¹Ÿæ˜¯åœ¨ try å€å¡Šé€ æˆã€çš„ä¾‹å¤–ç‰©ä»¶è£¡ï¼Œä½¿å…¶å¯è¢«ä¿ç•™</p>
</li>
<li>
<p>Java æœƒå°‡è³‡æºç›¸é—œçš„ä¾‹å¤–éš±åŒ¿ / æ“ å£“é€²ç¨‹å¼ç¢¼çš„ä¾‹å¤–è£¡ï¼Œåªè¦çŸ¥é“å¦‚ä½•å°‡ suppressed ä¾‹å¤–ç‰©ä»¶å–å‡ºï¼ˆåƒä»¥ä¸‹ line 3 ~ line 5ï¼‰</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>e<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Throwable t <span style="color:#f92672">:</span> e<span style="color:#f92672">.</span><span style="color:#a6e22e">getSuppressed</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>  <span style="color:#75715e">// line 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>t<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>                                        <span style="color:#75715e">// line 5
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p>å°ä¾‹å¤–ç‰©ä»¶å‘¼å« <code>e.getSuppressed()</code> æ–¹æ³•æ™‚ï¼Œå¯å›å‚³ä¸€å€‹ Throwable é™£åˆ—</p>
<ul>
<li>åœ¨èƒŒæ™¯è¢«æ“ å£“ / éš±åŒ¿çš„ä¾‹å¤–ï¼Œå³ä½¿å†å¤šéƒ½èƒ½è¢«ä¿å­˜ä¸¦å–å‡º</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TryException</span> <span style="color:#66d9ef">extends</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FinallyException</span> <span style="color:#66d9ef">extends</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SuppressedExceptions</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        before7<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        after7<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before7</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> TryException<span style="color:#f92672">();</span>   <span style="color:#75715e">// This is lost.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> FinallyException<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;before 7: &#34;</span> <span style="color:#f92672">+</span> e<span style="color:#f92672">.</span><span style="color:#a6e22e">getClass</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">after7</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            Throwable t <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span> <span style="color:#75715e">// ä¿ç•™ç¬¬ä¸€å€‹æ‹‹å‡ºçš„ä¾‹å¤–ç‰©ä»¶ TryException (1/2)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> TryException<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                t <span style="color:#f92672">=</span> e<span style="color:#f92672">;</span>  <span style="color:#75715e">// ä¿ç•™ç¬¬ä¸€å€‹æ‹‹å‡ºçš„ä¾‹å¤–ç‰©ä»¶ TryException (2/2)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                FinallyException fe <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FinallyException<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>t <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    t<span style="color:#f92672">.</span><span style="color:#a6e22e">addSuppressed</span><span style="color:#f92672">(</span>fe<span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// å°‡ finallyException éš±åŒ¿è‡³ t, å†æ‹‹å‡º tryException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                    <span style="color:#66d9ef">throw</span> t<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">throw</span> fe<span style="color:#f92672">;</span> <span style="color:#75715e">// è‹¥ç„¡ tryException, å–®ç¨æ‹‹å‡º finallyException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Throwable e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;after7: &#34;</span> <span style="color:#f92672">+</span> e<span style="color:#f92672">.</span><span style="color:#a6e22e">getClass</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Throwable t <span style="color:#f92672">:</span> e<span style="color:#f92672">.</span><span style="color:#a6e22e">getSuppressed</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;after7: &#34;</span> <span style="color:#f92672">+</span> t<span style="color:#f92672">.</span><span style="color:#a6e22e">getClass</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="ä½¿ç”¨-multi-catch-æ•˜è¿°">ä½¿ç”¨ <code>multi-catch</code> æ•˜è¿°</h3>
<p>ä¸å»ºè­°ç›´æ¥æ•æ‰ä¾‹å¤–çš„çˆ¶é¡åˆ¥ï¼Œå¦‚ Exception æˆ– Throwableï¼Œå› ç‚ºï¼š</p>
<ol>
<li>æ¯ç¨®æ„å¤–çš„è™•ç†æ–¹å¼æ‡‰è©²ä¸åŒ</li>
<li>è¦æ¸…æ¥šçŸ¥é“ç©¶ç«Ÿæœ‰å¤šå°‘å€‹ä¾‹å¤–å¯èƒ½ç”¢ç”Ÿ</li>
</ol>
<p>å¦‚æœæ¯ç¨®ä¾‹å¤–è™•ç†æ–¹å¼çš†ç›¸åŒï¼Œå‰‡å¯ä»¥ä½¿ç”¨ Java 7 <code>multi-catch</code> æ•˜è¿°ï¼Œå„ªé»ï¼š</p>
<ol>
<li>å¯æ¸…æ¥šçŸ¥é“ç©¶ç«Ÿæœ‰å¤šå°‘ä¾‹å¤–å¯èƒ½æ‹‹å‡º</li>
<li>å¤šç¨®ä¾‹å¤–ï¼ŒåŒä¸€ç¨®æ–¹å¼è™•ç†ï¼Œç°¡æ½”åŒ–ç¨‹å¼ç¢¼</li>
<li><strong>ä¸åŒä¾‹å¤–ä»¥ã€Œ|ã€å€éš”æ™‚ï¼Œå‰å¾Œä¾‹å¤–å¿…é ˆã€Œæ²’æœ‰ç¹¼æ‰¿é—œä¿‚ã€</strong>
<ul>
<li>ä¾‹å¦‚ Exception class ä¸èƒ½å’Œä»¥ multi-catch æ•˜è¿°èšé›†çš„ä¾‹å¤–é¡åˆ¥æ”¾ä¸€èµ·</li>
</ul>
</li>
</ol>
<h3 id="ä½¿ç”¨-throws-å®£å‘Š">ä½¿ç”¨ <code>throws</code> å®£å‘Š</h3>
<ul>
<li>
<p>åœ¨é¡åˆ¥æ–¹æ³•ä¸Šå®£å‘Š <code>throws ExceptionTypes</code>ï¼Œè®“å‘¼å«è©²æ–¹æ³•çš„ caller è™•ç†</p>
</li>
<li>
<p>è¦†å¯«å­é¡åˆ¥æ–¹æ³•æ™‚ï¼Œè‹¥çˆ¶é¡åˆ¥æ–¹æ³•å®£å‘Šæ‹‹å‡ºä¾‹å¤–</p>
<ol>
<li>
<p><strong>checked exception</strong>ï¼Œå­é¡åˆ¥è¦†å¯«æ–¹æ³•æ‹‹å‡ºçš„ä¾‹å¤–å¿…é ˆï¼š</p>
<ul>
<li>ä¾‹å¤–å‹åˆ¥å¿…é ˆç›¸åŒï¼Œæˆ–è€…ç‚ºå…¶å­é¡åˆ¥ï¼ˆè¦†å¯«å¾Œæœ‰ç²¾é€²ï¼‰</li>
<li>æ•¸é‡ç›¸åŒæˆ–æ›´å°‘ï¼ˆè¡¨ç¤ºå•é¡Œå·²è¢«è™•ç† improvedï¼‰</li>
</ul>
</li>
<li>
<p><strong>unchecked exception</strong>ï¼šå­é¡åˆ¥è¦†å¯«æ–¹æ³•æ™‚å¯ä¸äºˆç†æœƒï¼Œä¾‹å¦‚ <code>RuntimeException</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Father</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fatherMethod1</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fatherMethod2</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> RuntimeException<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fatherMethod3</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> SQLException<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Child</span> <span style="color:#66d9ef">extends</span> Father <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fatherMethod1</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> FileNotFoundException <span style="color:#f92672">{</span>		
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>  <span style="color:#75715e">// FileNotFoundException ç‚º IOException å­é¡åˆ¥ï¼Œæœªè¶…å‡º IOException ç¯„åœ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fatherMethod2</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span> <span style="color:#75715e">// çˆ¶é¡åˆ¥ RuntimeException-UncheckExceptionï¼Œå­é¡åˆ¥å¯ä»¥ä¸è™•ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fatherMethod3</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>		
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span> <span style="color:#75715e">// SQLException åœ¨æ–¹æ³•å…§ä½¿ç”¨ try-catch æ•˜è¿°ï¼Œå¦¥å–„è™•ç†ä¸å†æ‹‹å‡ºä¾‹å¤–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ol>
</li>
</ul>
<h3 id="å»ºç«‹å®¢è£½çš„-exception">å»ºç«‹å®¢è£½çš„ <code>Exception</code></h3>
<h4 id="å®¢è£½åŒ–çš„ä¾‹å¤–é¡åˆ¥">å®¢è£½åŒ–çš„ä¾‹å¤–é¡åˆ¥</h4>
<p>å»ºç«‹å®¢è£½åŒ–çš„ä¾‹å¤–å­é¡åˆ¥ DAOExceptionï¼Œç¹¼æ‰¿ class Exception</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DAOException</span> <span style="color:#66d9ef">extends</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DAOException</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">super</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DAOException</span><span style="color:#f92672">(</span>String message<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">super</span><span style="color:#f92672">(</span>message<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>
<p>æ¨™æº– Java ä¸æœƒä¸»å‹•æ‹‹å‡ºå®¢è£½åŒ–ä¾‹å¤–å­é¡åˆ¥ï¼Œå¿…é ˆå…ˆæ•æ‰æ¨™æº–çš„ä¾‹å¤–é¡åˆ¥ï¼Œå†æ‹‹å‡ºå®¢è£½åŒ–ä¾‹å¤–å­é¡åˆ¥</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// some codes that might cause error
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DAOException<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<h4 id="å®¢è£½åŒ–åŒ…è£¹ä¾‹å¤–é¡åˆ¥wrapper-exception">å®¢è£½åŒ–åŒ…è£¹ä¾‹å¤–é¡åˆ¥ï¼ˆWrapper Exceptionï¼‰</h4>
<ul>
<li>
<p>å¦‚æœå¸Œæœ›å†æ‹‹å‡ºçš„å®¢è£½åŒ–ä¾‹å¤–å­é¡åˆ¥ä¹Ÿèƒ½ä¿ç•™æœ€åˆè¢«æ•æ‰çš„ä¾‹å¤–é¡åˆ¥è¨Šæ¯ï¼Œå¯ä½¿ç”¨ wrapper ä¾‹å¤–é¡åˆ¥ï¼Œå°‡æœ€åˆçš„ä¾‹å¤–é¡åˆ¥åŒ…è£¹åœ¨å®¢è£½ä¾‹å¤–é¡åˆ¥ä¸­</p>
<ul>
<li>
<p>è¨­è¨ˆå®¢è£½ä¾‹å¤–é¡åˆ¥</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DAOException</span> <span style="color:#66d9ef">extends</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DAOException</span><span style="color:#f92672">(</span>Throwable cause<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">super</span><span style="color:#f92672">(</span>cause<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DAOException</span><span style="color:#f92672">(</span>String msg<span style="color:#f92672">,</span> Throwable cause<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">super</span><span style="color:#f92672">(</span>msg<span style="color:#f92672">,</span> cause<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p>å°‡æ•æ‰çœŸå¯¦ä¾‹å¤–é¡åˆ¥ä½œç‚ºå®¢è£½ä¾‹å¤–é¡åˆ¥çš„å»ºæ§‹å­åƒæ•¸</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// some codes might error
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DAOException<span style="color:#f92672">(</span>e<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p>ä½¿ç”¨ <code>getCause()</code> æ–¹æ³•å–å‡ºè¢«åŒ…è£¹çš„åŸå§‹ä¾‹å¤–ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// some codes might cause error
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>DAOException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Throwable t <span style="color:#f92672">=</span> e<span style="color:#f92672">.</span><span style="color:#a6e22e">getCause</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p>ä½¿ç”¨åŒ…è£¹ä¾‹å¤–å‹åˆ¥æä¾›è§£æ±ºç¯„ä¾‹</p>
<ol>
<li>
<p>å…ˆè¨­è¨ˆä»‹é¢çš„æŠ½è±¡æ–¹æ³•ä¸¦å®£å‘Šæ‹‹å‡º <code>DAOException</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span>Employee <span style="color:#a6e22e">findById</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> id<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> DAOException<span style="color:#f92672">;</span>
</span></span></code></pre></div></li>
<li>
<p>File-based çš„æ–¹æ³•å¯¦ä½œæ–¹å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> Employee <span style="color:#a6e22e">findById</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> id<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> DAOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DAOException<span style="color:#f92672">(</span>e<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p>JDBC-based çš„æ–¹æ³•å¯¦ä½œæ–¹å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> Employee <span style="color:#a6e22e">findById</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> id<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> DAOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> getEmployeeFromDatabase<span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> id<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>SQLException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DAOException<span style="color:#f92672">(</span>e<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ol>
</li>
</ul>
</li>
</ul>
<h2 id="æ–·è¨€">æ–·è¨€</h2>
<h3 id="assertions-çš„ç°¡ä»‹å’Œèªæ³•">Assertions çš„ç°¡ä»‹å’Œèªæ³•</h3>
<ul>
<li>æ–·è¨€è‹¥å¤±æ•—è¢«èªç‚ºæ˜¯åš´é‡çš„å•é¡Œï¼Œè¡¨ç¤ºç¨‹å¼åŸ·è¡Œçµæœå’Œé æœŸæœ‰å‡ºå…¥</li>
<li>ç¨‹å¼æœƒæ‹‹å‡º AssertionError ä¸¦ä¸­æ–·ç¨‹å¼åŸ·è¡Œï¼ŒAssertionError ç‚º unchecked exceptionã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Syntax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">assert</span> <span style="color:#f92672">&lt;</span>boolean_expression<span style="color:#f92672">&gt;;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">assert</span> <span style="color:#f92672">&lt;</span>boolean_expression<span style="color:#f92672">&gt;</span> <span style="color:#f92672">:</span> <span style="color:#f92672">&lt;</span>detail_expression<span style="color:#f92672">&gt;;</span>
</span></span></code></pre></div><ol>
<li>&lt;boolean_expression&gt; è‹¥ç‚º falseï¼Œå°‡æ‹‹å‡º <code>AssertionError</code></li>
<li>&lt;detail_expression&gt; ç‚ºæ•æ‰ <code>AssertionError</code> å¾Œå‘¼å« <code>getMessage()</code> æ–¹æ³•å›å‚³çš„å­ä¸²</li>
</ol>
<h4 id="assertions-ä½¿ç”¨æƒ…å¢ƒ">Assertions ä½¿ç”¨æƒ…å¢ƒ</h4>
<ul>
<li>ä½¿ç”¨ Assertions ä¾†é©—è­‰å‡è¨­å’Œæ–¹æ³•çš„ä¸è®Šé‡ï¼ˆä¸æœƒæ”¹è®Šçš„æ•¸å€¼æˆ–çµæœï¼Œinvariantï¼‰ï¼Œé€šå¸¸æƒ…æ³ï¼š
<ol>
<li>å…§éƒ¨çš„ä¸è®Šé‡ï¼ˆinternal invariantsï¼‰</li>
<li>æµç¨‹æ§ç®¡çš„ä¸è®Šé‡ï¼ˆcontrol flow invariantsï¼‰</li>
<li>äº‹å¾Œçš„ç‹€æ…‹å’Œé¡åˆ¥ä¸è®Šé‡ï¼ˆpost-conditions &amp; class invariantsï¼‰</li>
</ol>
</li>
</ul>
<h4 id="assertions-çš„ä½¿ç”¨æ³¨æ„äº‹é …">Assertions çš„ä½¿ç”¨æ³¨æ„äº‹é …</h4>
<ul>
<li>
<p>Assertions çš„æª¢æŸ¥é è¨­é—œé–‰ï¼ˆdisabledï¼‰ï¼Œä½¿ç”¨å‰å¿…é ˆé–‹å•Ÿ</p>
</li>
<li>
<p>è¦é¿å…ä¸ç•¶çš„ä½¿ç”¨æ–¹å¼ï¼š</p>
<ol>
<li>
<p>ä¸å¯ç”¨æ–¼é¡åˆ¥æ–¹æ³•çš„åƒæ•¸è¼¸å…¥æª¢æŸ¥</p>
</li>
<li>
<p>ä¸å¯å½±éŸ¿ç¨‹å¼æ­£å¸¸æµç¨‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// å°‡ç‰©ä»¶çš„ç”Ÿæˆæ”¾åœ¨ assertion çš„åˆ¤æ–·æ•˜è¿°ä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>SomeType s <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">assert</span> <span style="color:#f92672">(</span>s <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SomeType<span style="color:#f92672">())</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
</span></span></code></pre></div></li>
</ol>
</li>
</ul>
<h3 id="assertions-çš„ä½¿ç”¨">Assertions çš„ä½¿ç”¨</h3>
<h4 id="å…§éƒ¨çš„ä¸è®Šé‡-internal-invariants">å…§éƒ¨çš„ä¸è®Šé‡ <em>internal invariants</em></h4>
<ul>
<li>
<p>åœ¨ else block åŠ ä¸Š <code>assert == 0</code>ï¼Œä½¿ x ç„¡è² å€¼çš„å¯èƒ½</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>x <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// do if x &gt; 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> <span style="color:#f92672">(</span>x <span style="color:#f92672">==</span> 0<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<h4 id="æµç¨‹æ§ç®¡çš„ä¸è®Šé‡-control-flow-invariants">æµç¨‹æ§ç®¡çš„ä¸è®Šé‡ <em>control flow invariants</em></h4>
<ul>
<li>
<p>ç‚ºå§‹ switch case ä¸å¯èƒ½é€²å…¥ default blockï¼Œç›´æ¥åœ¨ default block è£¡ä½¿ç”¨ assert false</p>
<ul>
<li>
<p>è¡¨ç¤ºç¨‹å¼é€²åˆ°æ­¤ä¸ç”¨å†ä»¥ boolean è¡¨é”å¼åˆ¤æ–·ï¼Œè€Œæ˜¯é¦¬ä¸Šæ‹‹å‡º <code>AssertError</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">controlFlowInvariants</span><span style="color:#f92672">(</span>Gender g<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">switch</span> <span style="color:#f92672">(</span>g<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> MALE<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// do something
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> FEMALE<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// do something
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">assert</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Unknown gender!!&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h4 id="äº‹å¾Œçš„ç‹€æ…‹å’Œé¡åˆ¥ä¸è®Šé‡-post-conditions--class-invariants">äº‹å¾Œçš„ç‹€æ…‹å’Œé¡åˆ¥ä¸è®Šé‡ <em>post-conditions &amp; class invariants</em></h4>
<ul>
<li>
<p>ç„¡è«–é¡åˆ¥æ¬„ä½ç¶“éä»»ä½•æ”¹è®Šï¼Œéƒ½æ‡‰è©²èƒ½é€šéæ–¹æ³• rule() çš„æª¢é©—</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyTime</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> hours<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> minutes<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> seconds<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">rule</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assert</span><span style="color:#f92672">(</span>0 <span style="color:#f92672">&lt;=</span> hours <span style="color:#f92672">&amp;&amp;</span> hours <span style="color:#f92672">&lt;</span> 24<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assert</span> <span style="color:#f92672">(</span>0 <span style="color:#f92672">&lt;=</span> minutes <span style="color:#f92672">&amp;&amp;</span> minutes <span style="color:#f92672">&lt;</span> 60<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assert</span> <span style="color:#f92672">(</span>0 <span style="color:#f92672">&lt;=</span> seconds <span style="color:#f92672">&amp;&amp;</span> seconds <span style="color:#f92672">&lt;</span> 60<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<h4 id="assertions-çš„é–‹å•Ÿèˆ‡é—œé–‰">Assertions çš„é–‹å•Ÿèˆ‡é—œé–‰</h4>
<ul>
<li>
<p>Assertions é è¨­æ˜¯é—œé–‰ï¼Œé—œé–‰å¾Œ<strong>å®Œå…¨ä¸æœƒåŸ·è¡Œ</strong>ï¼Œå’Œè¨»è§£ï¼ˆcommentï¼‰é¡ä¼¼ï¼Œä¸å½±éŸ¿æ•ˆèƒ½</p>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">java -enableassertions HelloWord
java -ea HelloWorld
</code></pre></li>
<li>
<p><code>-ea</code>å³æ˜¯ <code>-enableassertions</code>ä¹‹ç¸®å¯«</p>
</li>
<li>
<p>è‹¥åœ¨ <code>-ea</code> å¾ŒåŠ ä¸Šå…¶å®ƒé¸é …ï¼Œå¯æ§åˆ¶ <strong>Assertions çš„å•Ÿç”¨åªåœ¨æŸå€‹ package æˆ– class</strong></p>
<p><a href="https://docs.oracle.com/javase/7/docs/technotes/guides/language/assert.html#enable-disable" target="_blank" rel="noopener noreffer ">Enable and Disable Assertions</a></p>
</li>
</ul>
<hr>
<h1 id="03-è¼¸å…¥èˆ‡è¼¸å‡º">03 è¼¸å…¥èˆ‡è¼¸å‡º</h1>
<h2 id="io-åŸºç¤">I/O åŸºç¤</h2>
<ul>
<li>ç•¶è¼¸å…¥/è¼¸å‡ºè¡Œç‚ºç™¼ç”Ÿæ™‚ï¼Œå¥½æ¯”ä¸²æµï¼ˆstreamï¼‰çš„æµå‹•ï¼Œæµå…¥æˆ–æµå‡ºæŸå€‹åœ°æ–¹</li>
<li>ä¸²æµéœ€è¦æœ‰ä¾†æºåŠç›®çš„ï¼Œex. ä¸»æ§å°è¦–çª—ï¼ˆconsoleï¼‰ã€æª”æ¡ˆã€è³‡æ–™åº«ã€ç¶²è·¯ã€å…¶å®ƒç¨‹å¼</li>
</ul>
<h3 id="ä½•è¬‚-io">ä½•è¬‚ I/O</h3>
<p>åŸºæœ¬èªçŸ¥ï¼š</p>
<ol>
<li>è³‡æ–™çš„é€²å‡ºåƒæ˜¯æ°´æµ / ä¸²æµ
<ul>
<li>ä¾†æºæµå‘ç›®çš„ï¼Œå…·æœ‰æ–¹å‘æ€§ï¼ŒJava ä¸­ç¨±ä¹‹ç‚º <code>stream (ä¸²æµ)</code></li>
<li>æµå‹•å…§å®¹ä¸»è¦åˆ†ç‚ºã€Œä½å…ƒï¼ˆbyteï¼‰ã€å’Œã€Œå­—å…ƒï¼ˆcharacterï¼‰ã€</li>
</ul>
</li>
<li>æ°´æµçš„æµå‹•ï¼Œè‹¥æä¾›ç®¡é“ï¼Œç¨±ç‚º <code>channel</code>ï¼Œè‹¥ä½¿ç”¨ <code>channel</code> æ”¯æ´ I/O æœƒæ›´æœ‰æ•ˆç‡</li>
</ol>
<h4 id="ä»¥-java-ç¨‹å¼ç‚ºå€åˆ†åŸºæº–">ä»¥ Java ç¨‹å¼ç‚ºå€åˆ†åŸºæº–</h4>
<ol>
<li>
<p>è¼¸å…¥ä¸²æµ | ä¾†æºä¸²æµï¼ˆinput stream, source streamï¼‰</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/hz0S8PM.png"
        data-srcset="https://i.imgur.com/hz0S8PM.png, https://i.imgur.com/hz0S8PM.png 1.5x, https://i.imgur.com/hz0S8PM.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/hz0S8PM.png"
        title="image-20221218122158764" /></p>
</li>
<li>
<p>è¼¸å‡ºä¸²æµ | ç›®çš„ä¸²æµï¼ˆoutput stream, sink streamï¼‰</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/2OgU1l1.png"
        data-srcset="https://i.imgur.com/2OgU1l1.png, https://i.imgur.com/2OgU1l1.png 1.5x, https://i.imgur.com/2OgU1l1.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/2OgU1l1.png"
        title="image-20221218122209539" /></p>
</li>
</ol>
<h4 id="ä»¥ç¨‹å¼é–‹ç™¼æœ€å¸¸ç”¨ä¸‰ç¨®ç«¯é»å€åˆ†">ä»¥ç¨‹å¼é–‹ç™¼æœ€å¸¸ç”¨ä¸‰ç¨®ç«¯é»å€åˆ†</h4>
<ol>
<li>æª”æ¡ˆï¼ˆfilesï¼‰å’Œç›®éŒ„ï¼ˆdirectoriesï¼‰</li>
<li>ä¸»æ§å°ï¼ˆconsoleï¼‰ï¼šæ¨™æº–è¼¸å…¥ï¼ˆstandard-inï¼‰å’Œæ¨™æº–è¼¸å‡ºï¼ˆstandard-outï¼‰</li>
<li>Socket ç¨‹å¼ï¼ˆé€£ç·šé ç«¯ç³»çµ±ï¼Œéœ€æŒ‡å®š port é€šè¨Šï¼‰</li>
</ol>
<h3 id="è™•ç†ä¸²æµçš„é¡åˆ¥">è™•ç†ä¸²æµçš„é¡åˆ¥</h3>
<p>ä¾ä¸²æµå…§çš„è³‡æ–™åˆ†é¡ã€æµå‹•æ–¹å‘ã€è™•ç†é¡åˆ¥åˆ†ç‚ºå››å€‹æŠ½è±¡é¡åˆ¥ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹å‘\ä¸²æµå…§å®¹</th>
<th>ä½å…ƒï¼ˆbyteï¼‰</th>
<th>å­—å…ƒï¼ˆcharacterï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>è¼¸å…¥ Java</td>
<td><code>InputStream</code></td>
<td><code>Reader</code></td>
</tr>
<tr>
<td>è¼¸å‡º Java</td>
<td><code>OutputStream</code></td>
<td><code>Writer</code></td>
</tr>
</tbody>
</table>
<hr>
<h4 id="class-inputstream">Class <code>InputStream</code></h4>
<table>
<thead>
<tr>
<th>method</th>
<th>name</th>
<th>feature</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸºæœ¬æ–¹æ³•</td>
<td><code>int read()</code></td>
<td>æ¯æ¬¡è®€å– 1 å€‹ byte</td>
</tr>
<tr>
<td>-</td>
<td><code>int read(byte[] buffer)</code></td>
<td>æ¯æ¬¡è®€å–ä¸€å€‹ byte[]</td>
</tr>
<tr>
<td>-</td>
<td><code>int read(byte[] buffer, int offset, int length)</code></td>
<td>æ¯æ¬¡è®€å–ä¸€å€‹ byte[]ï¼Œå¯ä»¥æŒ‡å®šåç§»é‡ï¼ˆoffsetï¼‰å’Œè®€å–é•·åº¦ï¼ˆlengthï¼‰</td>
</tr>
<tr>
<td>å…¶å®ƒæ–¹æ³•</td>
<td><code>void close()</code></td>
<td>é—œé–‰ stream</td>
</tr>
<tr>
<td>-</td>
<td><code>int available()</code></td>
<td>æœ‰å¤šå°‘çš„ bytes å¯ä¾›è®€å–</td>
</tr>
<tr>
<td>-</td>
<td><code>long skip(long n)</code></td>
<td>è®€å–æ™‚ç•¥é n å€‹ <strong>bytes</strong></td>
</tr>
<tr>
<td>-</td>
<td><code>boolean markSupported()</code><!-- raw HTML omitted --><code>void mark(int readlimit)</code><!-- raw HTML omitted --><code>void reset()</code></td>
<td>åˆä½µç”¨æ–¼æ”¹è®Šæª”æ¡ˆä¸­çš„è®€å–ä½ç½®ï¼Œç‰¹åˆ¥æ˜¯å›åˆ°éå»æŸå€‹æŒ‡å®šçš„è®€å–ä½ç½®<!-- raw HTML omitted -->åˆç¨± push-back æ“ä½œ</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="class-outputstream">Class <code>OutputStream</code></h4>
<table>
<thead>
<tr>
<th>method</th>
<th>name</th>
<th>feature</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸºæœ¬æ–¹æ³•</td>
<td><code>void write(int c)</code></td>
<td>å°‡ int å¯«å…¥ <code>OutputStream</code></td>
</tr>
<tr>
<td>-</td>
<td><code>void write(byte[] buffer)</code></td>
<td>å°‡ byte[] å¯«å…¥ <code>OutputStream</code></td>
</tr>
<tr>
<td>-</td>
<td><code>void write(byte[] buffer, int offset, int length)</code></td>
<td>å¯«å…¥ byte[] åˆ° <code>OutputStream</code>ï¼ŒæŒ‡å®šé•·åº¦ï¼ˆlengthï¼‰å’Œåç§»é‡ï¼ˆoffsetï¼‰</td>
</tr>
<tr>
<td>å…¶å®ƒæ–¹æ³•</td>
<td><code>void close()</code></td>
<td>é—œé–‰ stream</td>
</tr>
<tr>
<td>-</td>
<td><code>void flush()</code></td>
<td>å¼·åˆ¶å°‡ <code>OutputStream</code> ä¸­çš„è³‡æ–™å¯«å…¥ç›®çš„åœ°</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="class-reader">Class <code>Reader</code></h4>
<table>
<thead>
<tr>
<th>method</th>
<th>name</th>
<th>feature</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸºæœ¬æ–¹æ³•</td>
<td><code>int read()</code></td>
<td>æ¯æ¬¡è®€å– 1 å€‹ <strong>char</strong></td>
</tr>
<tr>
<td>-</td>
<td><code>int read(byte[] buffer)</code></td>
<td>æ¯æ¬¡è®€å–ä¸€å€‹ char[]</td>
</tr>
<tr>
<td>-</td>
<td><code>int read(byte[] buffer, int offset, int length)</code></td>
<td>æ¯æ¬¡è®€å–ä¸€å€‹ char[]ï¼Œå¯ä»¥æŒ‡å®šåç§»é‡ï¼ˆoffsetï¼‰å’Œè®€å–é•·åº¦ï¼ˆlengthï¼‰</td>
</tr>
<tr>
<td>å…¶å®ƒæ–¹æ³•</td>
<td><code>void close()</code></td>
<td>é—œé–‰ stream</td>
</tr>
<tr>
<td>-</td>
<td><code>boolean ready()</code></td>
<td>ç¢ºèª stream æ˜¯å¦å·²ç¶“æº–å‚™å¥½é€²è¡Œè³‡æ–™è®€å–</td>
</tr>
<tr>
<td>-</td>
<td><code>long skip(long n)</code></td>
<td>è®€å–æ™‚ç•¥é n å€‹ <strong>chars</strong></td>
</tr>
<tr>
<td>-</td>
<td><code>boolean markSupported()</code><!-- raw HTML omitted --><code>void mark(int readAheadLimit)</code><!-- raw HTML omitted --><code>void reset()</code></td>
<td>åˆä½µç”¨æ–¼æ”¹è®Šæª”æ¡ˆä¸­çš„è®€å–ä½ç½®ï¼Œç‰¹åˆ¥æ˜¯å›åˆ°éå»æŸå€‹æŒ‡å®šçš„è®€å–ä½ç½®<!-- raw HTML omitted -->åˆç¨± push-back æ“ä½œ</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="class-writer">Class Writer</h4>
<table>
<thead>
<tr>
<th>method</th>
<th>name</th>
<th>feature</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸºæœ¬æ–¹æ³•</td>
<td><code>void write(int c)</code></td>
<td>å°‡ int å¯«å…¥ <strong>Writer</strong></td>
</tr>
<tr>
<td>-</td>
<td><code>void write(char[] buffer)</code></td>
<td>å°‡æ•´å€‹ char[] å¯«å…¥ Writer</td>
</tr>
<tr>
<td>-</td>
<td><code>void write(char[] buffer, int offset, int length)</code></td>
<td>å¯«å…¥ char[] åˆ° Writerï¼Œä¸”æŒ‡å®šé•·åº¦ï¼ˆlengthï¼‰å’Œåç§»é‡ï¼ˆoffsetï¼‰</td>
</tr>
<tr>
<td>å…¶å®ƒæ–¹æ³•</td>
<td><code>void close()</code></td>
<td>é—œé–‰ stream</td>
</tr>
<tr>
<td>-</td>
<td><code>void flush()</code></td>
<td>å¼·åˆ¶å°‡ Writer ä¸­çš„è³‡æ–™å¯«å…¥ç›®çš„åœ°</td>
</tr>
</tbody>
</table>
<h3 id="ä¸²æµé¡åˆ¥çš„ä¸²æ¥">ä¸²æµé¡åˆ¥çš„ä¸²æ¥</h3>
<table>
<thead>
<tr>
<th>åŠŸèƒ½\ä¸²æµå…§å®¹</th>
<th>å­—å…ƒä¸²æµã€€<em>Character Streams</em></th>
<th>ä½å…ƒä¸²æµ <em>Byte Streams</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>Bufferingï¼ˆç·©è¡ï¼‰</td>
<td><code>BufferReader</code><!-- raw HTML omitted --><code>BufferedWriter</code></td>
<td><code>BufferedInputStream</code><!-- raw HTML omitted --><code>BufferedOutputStream</code></td>
</tr>
<tr>
<td>Filteringï¼ˆéæ¿¾ï¼‰</td>
<td><code>FilterReader</code><!-- raw HTML omitted --><code>FilterWriter</code></td>
<td><code>FilterInputStream</code><!-- raw HTML omitted --><code>FilterOutputStream</code></td>
</tr>
<tr>
<td>Conversionï¼ˆä½å…ƒè½‰æ›ç‚ºå­—å…ƒï¼‰</td>
<td><code>InputStreamReader</code><!-- raw HTML omitted --><code>OutputStreamWriter</code></td>
<td></td>
</tr>
<tr>
<td>Object serializationï¼ˆç‰©ä»¶åºåˆ—åŒ–ï¼‰</td>
<td></td>
<td><code>ObjectInputStream</code><!-- raw HTML omitted --><code>ObjectOutputStream</code></td>
</tr>
<tr>
<td>Data conversionï¼ˆè³‡æ–™å‹æ…‹è½‰æ›ï¼‰</td>
<td></td>
<td><code>DataInputStream</code><!-- raw HTML omitted --><code>DataOutputStream</code></td>
</tr>
<tr>
<td>Countingï¼ˆè¨ˆç®—è¡Œæ•¸ï¼‰</td>
<td><code>LineNumberReader</code></td>
<td><code>LineNumberInputStream</code></td>
</tr>
<tr>
<td>Printingï¼ˆåˆ—å°ï¼‰</td>
<td><code>PrintWriter</code></td>
<td><code>PrintStream</code></td>
</tr>
</tbody>
</table>
<h3 id="ä½¿ç”¨-javaiofile-é¡åˆ¥">ä½¿ç”¨ <code>java.io.File</code> é¡åˆ¥</h3>
<p><code>java.io.File</code> å¸¸ç”¨æ–¹æ³•ï¼š</p>
<table>
<thead>
<tr>
<th>method</th>
<th>return type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getName()</code></td>
<td>String</td>
<td>å–å¾—æª”æ¡ˆæˆ–ç›®éŒ„çš„åç¨±</td>
</tr>
<tr>
<td><code>getParent()</code></td>
<td>String</td>
<td>å–å¾—çˆ¶ç›®éŒ„çš„åç¨±</td>
</tr>
<tr>
<td><code>getParentFile()</code></td>
<td>File</td>
<td>å–å¾—ä»£è¡¨çˆ¶ç›®éŒ„çš„ File ç‰©ä»¶</td>
</tr>
<tr>
<td><code>getPath()</code></td>
<td>String</td>
<td>å–å¾—æª”æ¡ˆæˆ–ç›®éŒ„çš„è·¯å¾‘</td>
</tr>
<tr>
<td><code>isAbsolute()</code></td>
<td>boolean</td>
<td>æ˜¯å¦ç‚ºçµ•å°è·¯å¾‘</td>
</tr>
<tr>
<td><code>getAbsolutePath()</code></td>
<td>String</td>
<td>å–å¾—çµ•å°è·¯å¾‘</td>
</tr>
<tr>
<td><code>canRead()</code></td>
<td>boolean</td>
<td>æ˜¯å¦å¯è®€å–</td>
</tr>
<tr>
<td><code>canWrite()</code></td>
<td>boolean</td>
<td>æ˜¯å¦å¯ä¿®æ”¹</td>
</tr>
<tr>
<td><code>exists()</code></td>
<td>boolean</td>
<td>æ˜¯å¦å­˜åœ¨</td>
</tr>
<tr>
<td><code>isDirectory()</code></td>
<td>boolean</td>
<td>æ˜¯å¦ç‚ºç›®éŒ„</td>
</tr>
<tr>
<td><code>isFile()</code></td>
<td>boolean</td>
<td>æ˜¯å¦ç‚ºæª”æ¡ˆ</td>
</tr>
<tr>
<td><code>lastModified()</code></td>
<td>long</td>
<td>å–å¾—æœ€å¾Œä¸€æ¬¡ä¿®æ”¹æ™‚é–“</td>
</tr>
<tr>
<td><code>length()</code></td>
<td>long</td>
<td>å–å¾—æª”æ¡ˆå¤§å°</td>
</tr>
<tr>
<td><code>delete()</code></td>
<td>boolean</td>
<td>åˆªé™¤æª”æ¡ˆæˆ–ç›®éŒ„ä¸¦å›å‚³æˆåŠŸèˆ‡å¦</td>
</tr>
<tr>
<td><code>list()</code></td>
<td>String[]</td>
<td>åˆ—èˆ‰ç›®éŒ„ä¸‹çš„æª”æ¡ˆèˆ‡å­ç›®éŒ„</td>
</tr>
<tr>
<td><code>listFiles()</code></td>
<td>File[]</td>
<td>åˆ—èˆ‰ç›®éŒ„ä¸‹çš„æª”æ¡ˆèˆ‡å­ç›®éŒ„çš„ File ç‰©ä»¶</td>
</tr>
<tr>
<td><code>mkdir()</code></td>
<td>boolean</td>
<td>å»ºç«‹ç›®éŒ„</td>
</tr>
<tr>
<td><code>mkdirs()</code></td>
<td>boolean</td>
<td>å»ºç«‹ç›®éŒ„ + ä¸å­˜åœ¨ä½†æ˜¯éœ€è¦ä¸€ä½µå»ºç«‹çš„çˆ¶ç›®éŒ„</td>
</tr>
<tr>
<td><code>renameTo(File)</code></td>
<td>boolean</td>
<td>é‡æ–°å‘½å</td>
</tr>
<tr>
<td><code>createTempFIle()</code></td>
<td>File</td>
<td>å»ºç«‹æš«å­˜æª”æ¡ˆï¼Œæœ‰å¤šè¼‰ç‰ˆæœ¬</td>
</tr>
<tr>
<td><code>setLastModified(long)</code></td>
<td>boolean</td>
<td>è¨­å®šæœ€å¾Œä¸€æ¬¡ä¿®æ”¹æ™‚é–“</td>
</tr>
<tr>
<td><code>setReadOnly()</code></td>
<td>boolean</td>
<td>è¨­å®šæˆå”¯è®€</td>
</tr>
</tbody>
</table>
<h2 id="ç”±ä¸»æ§å°è®€å¯«è³‡æ–™">ç”±ä¸»æ§å°è®€å¯«è³‡æ–™</h2>
<h3 id="ä¸»æ§å°çš„-io">ä¸»æ§å°çš„ I/O</h3>
<p><code>java.lang.System</code> é¡åˆ¥è£¡çš„ä¸‰å€‹ static æ¬„ä½</p>
<table>
<thead>
<tr>
<th>ã€Œæ¬„ä½</th>
<th>æ¬„ä½å‹åˆ¥</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>System.out</code></td>
<td><code>PrintStream</code></td>
<td>å°‡è¨Šæ¯è¼¸å‡ºè‡³ consoleï¼Œåˆç¨± <strong>æ¨™æº–è¼¸å‡º</strong>ï¼ˆstandard outputï¼‰<!-- raw HTML omitted -->å¯æ¥å—ç”±ä¸»æ§å°å†ç¶“<code>&gt;</code> æˆ– <code>&gt;&gt;</code> çš„ã€Œé‡æ–°å°å‘æŒ‡ä»¤ã€ï¼Œå°‡è¼¸å‡ºå…§å®¹å°å‘è‡³å¦å¤–ä¸€å€‹æª”æ¡ˆ</td>
</tr>
<tr>
<td><code>System.in</code></td>
<td><code>InputStream</code></td>
<td>ç”± console æ¥æ”¶ä¾†è‡ªéµç›¤æˆ–å…¶ä»–ä¾†æºçš„è¨Šæ¯è¼¸å…¥<!-- raw HTML omitted -->åˆç¨± <strong>æ¨™æº–è¼¸å…¥</strong>ï¼ˆstandard inputï¼‰</td>
</tr>
<tr>
<td><code>System.err</code></td>
<td><code>PrintStream</code></td>
<td>å’Œ <code>System.out</code> ä¸€æ¨£éƒ½æ˜¯è¼¸å‡ºè¨Šæ¯è‡³ console<!-- raw HTML omitted -->ä½†ä¸»è¦ç”¨æ–¼è¼¸å‡ºéŒ¯èª¤è¨Šæ¯ï¼Œè¼ƒç‚ºæ€¥è¿«å¿…é ˆç«‹å³é¡¯ç¤ºï¼Œå› æ­¤ã€Œé‡æ–°å°å‘æŒ‡ä»¤ã€ç„¡æ•ˆï¼Œä¾ç„¶é¡¯ç¤ºåœ¨ console <!-- raw HTML omitted -->ä½¿ç”¨ Eclipse IDE çš„è©±ï¼Œè¼¸å‡ºé¡è‰²ç‚ºç´…è‰²ï¼ˆè­¦ç¤ºç”¨ï¼‰</td>
</tr>
</tbody>
</table>
<h3 id="ä½¿ç”¨æ¨™æº–è¼¸å‡ºæ–¹æ³•">ä½¿ç”¨æ¨™æº–è¼¸å‡ºæ–¹æ³•</h3>
<ul>
<li><code>println()</code> è¼¸å‡ºæ›è¡Œç¬¦ã€<code>print()</code>ä¸è¼¸å‡ºæ›è¡Œç¬¦è™Ÿ</li>
<li>ä»¥ä¸Šå…©æ–¹æ³•å°å¤§éƒ¨åˆ†åŸºæœ¬å‹åˆ¥ä»¥åŠåƒè€ƒå‹åˆ¥éƒ½æœ‰å¤šè¼‰æ–¹æ³•æ”¯æ´
<ul>
<li>boolean, char, int, long, float, doubleã€char[], <code>Object</code>, <code>String</code></li>
<li>å…¶å®ƒåƒè€ƒå‹åˆ¥å‰‡å‘¼å«è©²ç‰©ä»¶çš„ <code>toString()</code> æ–¹æ³•</li>
</ul>
</li>
</ul>
<h3 id="javaioconsole-é¡åˆ¥ä»‹ç´¹"><code>java.io.Console</code> é¡åˆ¥ä»‹ç´¹</h3>
<ul>
<li>
<p>é™¤äº†ä½¿ç”¨å‰è¿° <code>System.in</code> å–å¾—ä¸»æ§å°æ¨™æº–è¼¸å…¥å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨ <code>java.io.Console</code> ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConsoleInput</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        Console cons <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">console</span><span style="color:#f92672">();</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ä½¿ç”¨ System.console() æ–¹æ³•å–å¾— Console ç‰©ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">boolean</span> userValid <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>cons <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            String account<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            String passwd<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">do</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                account <span style="color:#f92672">=</span> cons<span style="color:#f92672">.</span><span style="color:#a6e22e">readLine</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;%s&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Account: &#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// readline() å¯å–å¾—æŒ‡ä»¤åˆ—è¼¸å…¥çš„è³‡æ–™
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                passwd <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String<span style="color:#f92672">(</span>cons<span style="color:#f92672">.</span><span style="color:#a6e22e">readPassword</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;%s&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Password: &#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// readPassword() é™¤äº†å¯ä»¥å–å¾—æŒ‡ä»¤åˆ—è¼¸å…¥çš„è³‡æ–™ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#75715e">// é‚„èƒ½éš±è—ä½¿ç”¨è€…è¼¸å…¥å…§å®¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>account<span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;joanna&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">&amp;&amp;</span> passwd<span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;password&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Correct! System quits!&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                    userValid <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Wrong! Try again!&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span> <span style="color:#66d9ef">while</span> <span style="color:#f92672">(!</span>userValid<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// å¾Œæ¸¬å¼è¿´åœˆï¼šå…ˆè¼¸å…¥å†é©—è­‰ï¼Œå¤±æ•—ç¹¼çºŒï¼ŒæˆåŠŸçµ‚æ­¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/Q8HsrVi.png"
        data-srcset="https://i.imgur.com/Q8HsrVi.png, https://i.imgur.com/Q8HsrVi.png 1.5x, https://i.imgur.com/Q8HsrVi.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/Q8HsrVi.png"
        title="image-20221218141013717" /></p>
</li>
</ul>
<h2 id="channel-io">Channel I/O</h2>
<ul>
<li>Channel : å¯ä»¥æŒ‡å…©å€‹è¨­å‚™ä¹‹é–“å‚³é€è³‡è¨Šç¶“éçš„é€šè·¯æˆ–é€£æ¥
<ul>
<li>å°å…¥æ–¼ JDK 1.4ï¼Œå±¬æ–¼ <code>java.nio</code> package</li>
<li>å¯ä»¥ä¸€æ¬¡å¤§é‡è®€å…¥ä½å…ƒå’Œå­—å…ƒï¼Œä¸éœ€è¦ä»¥è¿´åœˆæ¯æ¬¡è®€å–å°‘é‡å…§å®¹</li>
<li>ç¨‹å¼æ›´ç°¡æ½”ï¼Œç¨‹å¼æ•ˆèƒ½æ›´å¥½</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.*<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.nio.ByteBuffer<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.nio.channels.FileChannel<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CopyByteChannel</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		String source <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">,</span> target <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>FileChannel in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>source<span style="color:#f92672">).</span><span style="color:#a6e22e">getChannel</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>				FileChannel out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>target<span style="color:#f92672">).</span><span style="color:#a6e22e">getChannel</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			ByteBuffer buff <span style="color:#f92672">=</span> ByteBuffer<span style="color:#f92672">.</span><span style="color:#a6e22e">allocate</span><span style="color:#f92672">((</span><span style="color:#66d9ef">int</span><span style="color:#f92672">)</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>             <span style="color:#75715e">// å»ºç«‹å’Œ source æª”æ¡ˆ size å¤§å°ç›¸åŒçš„ ByteBuffer ç‰©ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>			in<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>buff<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>             <span style="color:#75715e">// å°‡å¯¦é«”æª”æ¡ˆä¸€æ¬¡å…¨æ•¸è®€å…¥åˆ° ByteBuffer ç‰©ä»¶ä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>			buff<span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">(</span>0<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>             <span style="color:#75715e">// å°‡ ByteBuffer è£¡çš„æ¨™ç¤ºä½ç½®ç§»åˆ°æœ€å‰é¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>			out<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>buff<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>       <span style="color:#75715e">/* å°‡ ByteBuffer è£¡çš„è³‡æ–™å…¨æ•¸è¼¸å‡ºè‡³ FileChannel outï¼Œå†ç”±å…¶è¼¸å‡ºç‚ºæª”æ¡ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          å› ç‚º FileChannel çš„ read() å’Œ write() æ–¹æ³•éƒ½æ˜¯é€é ByteBuffer ç‰©ä»¶ä¸€æ¬¡æå®š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          æ‰€ä»¥ä¸ç”¨è¿´åœˆï¼ˆloopï¼‰åˆ†æ¬¡è™•ç† */</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>FileNotFoundException f<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			f<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException i<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			i<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="ä½¿ç”¨åºåˆ—åŒ–æŠ€è¡“è®€å¯«ç‰©ä»¶">ä½¿ç”¨åºåˆ—åŒ–æŠ€è¡“è®€å¯«ç‰©ä»¶</h2>
<h3 id="java-è£¡çš„è³‡æ–™ä¿å­˜-persistence">Java è£¡çš„è³‡æ–™ä¿å­˜ <em>Persistence</em></h3>
<p>å°‡è³‡æ–™å„²å­˜æ–¼æ°¸ä¹…æ€§çš„å„²å­˜ç¡¬é«”ä¸­ï¼Œç¨±ç‚ºã€Œ<strong>persistence</strong>ã€</p>
<ol>
<li>æ”¯æ´ persistence çš„ Java ç‰©ä»¶å¯å„²å­˜æ–¼æœ¬æ©Ÿç¡¬é«”ï¼Œæˆ–ç¶“ç”±ç¶²è·¯åˆ°å¦ä¸€å€‹ç¡¬é«”è£ç½®
<ul>
<li>æœªæ”¯æ´ persistence çš„ Java ç‰©ä»¶åªèƒ½å­˜æ´»æ–¼åŸ·è¡Œä¸­çš„ JVM</li>
</ul>
</li>
<li>åºåˆ—åŒ– <em>serialization</em>ï¼šJava å°‡è¨˜æ†¶é«”ä¸­çš„ç‰©ä»¶ç‹€æ…‹å„²å­˜æ–¼ç¡¬é«”ï¼Œæˆç‚ºã€Œ<strong>å¯¦é«”æª”æ¡ˆ</strong>ã€çš„æ¨™æº–æ©Ÿåˆ¶
<ul>
<li>æœªä¾†å¯ç”¨ä¾†å»ºæ§‹ç‰©ä»¶çš„å‰¯æœ¬æˆ–æ˜¯é‚„åŸç‰©ä»¶ç‹€æ…‹</li>
</ul>
</li>
<li>æ”¯æ´åºåˆ—åŒ–çš„ç‰©ä»¶å¿…é ˆå¯¦ä½œ <code>java.io.Serializable</code> ä»‹é¢</li>
</ol>
<ul>
<li>è©²ä»‹é¢æ˜¯ä¸€å€‹ã€Œ<strong>maker interface</strong>ã€ï¼Œæ²’æœ‰ä»»ä½•éœ€è¦å¯¦ä½œçš„æ–¹æ³•</li>
<li>é¡åˆ¥å¯¦ä½œæ­¤ä»‹é¢åªæ˜¯è®“ Java çŸ¥é“å…¶ç‰©ä»¶æœ‰å…·å‚™åºåˆ—åŒ–çš„èƒ½åŠ›ï¼Œå…·é«”åºåˆ—åŒ–æ­¥é©Ÿç”± Java æŒæ§</li>
</ul>
<h3 id="åºåˆ—åŒ–å’Œç‰©ä»¶åœ–è­œ">åºåˆ—åŒ–å’Œç‰©ä»¶åœ–è­œ</h3>
<ul>
<li>ç•¶ç‰©ä»¶è¢«åºåˆ—åŒ–æ™‚ï¼Œåªæœ‰ã€Œ<strong>æ¬„ä½å€¼</strong>ã€æœƒè¢«ä¿ç•™
<ul>
<li>æ¬„ä½å€¼åŒ…å«è³‡æ–™ï¼Œä¹ŸåŒ…å«ç‰©ä»¶çš„ç‹€æ…‹</li>
<li>è‹¥ç‰©ä»¶çš„è©²æ¬„ä½æ˜¯åƒè€ƒå‹åˆ¥ï¼Œä¸”è¢«åƒè€ƒçš„ç‰©ä»¶ä¹Ÿæ”¯æ´åºåˆ—åŒ–ï¼Œå‰‡è©²æ¬„ä½ç‰©ä»¶ä¹Ÿæœƒä¸€ä½µè¢«åºåˆ—åŒ–</li>
</ul>
</li>
<li><strong>ç‰©ä»¶åœ–è­œ object graphs</strong>ï¼š
<ul>
<li>ç‰©ä»¶æ¬„ä½åƒç…§å…¶å®ƒç‰©ä»¶ï¼Œè¢«åƒç…§çš„ç‰©ä»¶åˆå¯ä»¥å†åƒç…§æ›´å¤šç‰©ä»¶&hellip;æ‰€å½¢æˆçš„æ¨¹ç‹€çµæ§‹</li>
</ul>
</li>
</ul>
<h3 id="ä¸éœ€è¦åƒåŠ åºåˆ—åŒ–çš„æ¬„ä½">ä¸éœ€è¦åƒåŠ åºåˆ—åŒ–çš„æ¬„ä½</h3>
<ul>
<li>
<p>ç‰©ä»¶åºåˆ—åŒ–æ™‚ï¼Œé è¨­æ‰€æœ‰æ¬„ä½éƒ½æœƒä¸€ä½µé€²è¡Œåºåˆ—åŒ–</p>
</li>
<li>
<p>å¦‚æœæ¬„ä½æ‰€å±¬é¡åˆ¥æ²’æœ‰å¯¦ä½œ <code>java.io.Serializable</code>ï¼Œæœƒä¸­æ–·åŸ·è¡Œä¸¦ä¸Ÿå‡ºä¾‹å¤– <code>NotSerializableException</code></p>
</li>
<li>
<p>è‹¥ç‰©ä»¶æ¬„ä½åªæ˜¯è¨˜éŒ„ç•¶ä¸‹ç³»çµ±ç‹€æ…‹çš„æŸäº›è³‡è¨Šï¼ˆex. ç›®å‰æ™‚é–“ï¼‰ï¼Œå±¬æ–¼ã€Œ<strong>çŸ­æš« <em>transient</em></strong>ã€è³‡è¨Š</p>
<ul>
<li>ä¸éœ€è¦å†åºåˆ—åŒ–éç¨‹ä¸­è¢«ä¿ç•™</li>
<li>é‡å»ºå‰¯æœ¬æ™‚ä¹Ÿä¸éœ€è¦å›å¾©</li>
<li>æ­¤é¡æ¬„ä½ä¸éœ€è¦åƒèˆ‡åºåˆ—åŒ–æµç¨‹ï¼Œå¯ä»¥åŠ ä¸Šã€Œ<strong>transient</strong>ã€å®£å‘Š</li>
</ul>
</li>
<li>
<p>å®£å‘Šã€Œ<strong>static</strong>ã€çš„æ¬„ä½å’Œç‰©ä»¶ç‹€æ…‹ç„¡é—œï¼Œå…¶å€¼åœ¨ç‰©ä»¶åºåˆ—åŒ–éç¨‹ä¸­ä¹Ÿä¸æœƒè¢«ä¿ç•™</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Order</span> <span style="color:#66d9ef">implements</span> Serializable <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Set<span style="color:#f92672">&lt;</span>Shirt<span style="color:#f92672">&gt;</span> shirts <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashSet<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> staticField <span style="color:#f92672">=</span> 100<span style="color:#f92672">;</span>        <span style="color:#75715e">// static
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">transient</span> <span style="color:#66d9ef">int</span> transientField <span style="color:#f92672">=</span> 100<span style="color:#f92672">;</span>  <span style="color:#75715e">// transient
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>å®£å‘Š <code>transient</code> ä»¥åŠ <code>static</code> çš„æ¬„ä½åœ¨ã€Œååºåˆ—åŒ– / é‚„åŸã€ç¨‹åºæ™‚
<ol>
<li>static : æœƒå¾—åˆ°é¡åˆ¥å…§åŸæœ¬å®šç¾©çš„å®£å‘Šå€¼</li>
<li>transient : æœƒå¾—åˆ°è©²å‹æ…‹çš„é è¨­å€¼</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="å®šç¾©ç‰©ä»¶ä¿å­˜çš„ç‰ˆæœ¬è™Ÿç¢¼">å®šç¾©ç‰©ä»¶ä¿å­˜çš„ç‰ˆæœ¬è™Ÿç¢¼</h3>
<ul>
<li>
<p><strong>åºåˆ—åŒ–</strong>ï¼šä¿ç•™ç‰©ä»¶ã€Œ<code>ç•¶ä¸‹ç‹€æ…‹ï¼ˆæ¬„ä½å€¼ï¼‰</code>ã€ï¼Œä¸¦æœªä¿ç•™é¡åˆ¥æ¶æ§‹</p>
</li>
<li>
<p><strong>ååºåˆ—åŒ–</strong>ï¼šå°‡ã€Œ<code>éå»ç‰©ä»¶æŸå€‹ç‹€æ…‹</code>ã€ï¼Œæ­é…ã€Œ<code>ç›®å‰é¡åˆ¥æ¶æ§‹</code>ã€é€²è¡Œé‚„åŸ</p>
<ul>
<li>
<p>è‹¥é‚„åŸæ™‚ç™¼ç¾ã€Œ<strong>éå»ç‰©ä»¶ç‹€æ…‹</strong>ã€å’Œã€Œ<strong>ç›®å‰é¡åˆ¥æ¶æ§‹</strong>ã€ä¸ä¸€è‡´ï¼Œå¯èƒ½ç”¢ç”Ÿä¸é æœŸçš„å•é¡Œæˆ–éŒ¯èª¤</p>
<ul>
<li>éå»æŸæ¬„ä½ç¾åœ¨å·²ç¶“ä¸å­˜åœ¨</li>
<li>é¡åˆ¥å¾Œä¾†æ–°å¢å¿…è¦æ¬„ä½ï¼Œåºåˆ—åŒ–å»æ²’æœ‰è©²æ¬„ä½</li>
</ul>
</li>
<li>
<p>ç‚ºäº†èƒ½å¤ ä½¿åºåˆ—åŒ–å¾Œçš„æª”æ¡ˆå¯ä»¥é †åˆ©çš„è¢«ååºåˆ—åŒ–é‚„åŸæˆç‰©ä»¶ï¼š</p>
<ol>
<li>
<p>åœ¨å¯åºåˆ—åŒ–ä¹‹é¡åˆ¥å®šç¾©ä¸€å€‹æ¬„ä½ <code>serialVersionUID</code> ä½œç‚ºç‰ˆæœ¬æ§ç®¡è™Ÿç¢¼</p>
<ul>
<li>
<p>æ¯æ¬¡å¢æ¸›é¡åˆ¥å…§æ¬„ä½æ™‚ï¼Œéƒ½æ‡‰è©²åŒæ­¥ä¿®æ”¹ç‰ˆæœ¬è™Ÿç¢¼ä¸¦ä¸”è¨˜éŒ„</p>
</li>
<li>
<p>ç‰ˆæœ¬æ§ç®¡è™Ÿç¢¼å¿…é ˆå®£å‘Šç‚º <strong>static</strong> ä¸” <strong>long</strong></p>
<p><code>private static final long serialVersionUID = 1L;</code></p>
</li>
</ul>
</li>
<li>
<p><code>InvalidClassException</code> é å…ˆä¿è­·æ©Ÿåˆ¶</p>
<ul>
<li>å‡è¨­ç›®å‰ç‰ˆæœ¬è™Ÿç‚º 1ï¼Œåºåˆ—åŒ–å¾Œå¾—åˆ°çš„æª”æ¡ˆå…§å­˜ç‰ˆæœ¬ä¹Ÿæœƒæ˜¯ 1</li>
<li>å¾Œä¾†é¡åˆ¥å¢æ¸›äº†æ¬„ä½ï¼Œç‰ˆæœ¬ä¿®æ”¹ç‚º 2</li>
<li>å¦‚æœä»¥ã€Œç‰ˆæœ¬#2çš„æœ€æ–°é¡åˆ¥å®šç¾©ã€ä¾†é‚„åŸã€Œåºåˆ—åŒ–æ™‚ç‰ˆæœ¬#1çš„æª”æ¡ˆã€æœƒæ‹‹å‡ºä¸Šè¿°éŒ¯èª¤</li>
</ul>
</li>
<li>
<p>è‹¥é¡åˆ¥å¯¦ä½œ <code>Serializable</code> ä»‹é¢ï¼Œä½†æœªå®£å‘Š<code>serialVersionUID</code></p>
<ul>
<li>
<p>Java é è¨­å°‡ä¸»å‹•å®£å‘Šä¸¦æä¾›æ¬„ä½å€¼ï¼Œè©²å€¼å°‡è€ƒæ…®é–‹ç™¼ç’°å¢ƒå› ç´ ï¼ˆIDEå·¥å…·æˆ–Javaç‰ˆæœ¬ï¼‰è¨ˆç®—å‡ºä¸€å€‹è¤‡é›œçš„é•·æ•´æ•¸</p>
<p><code>private static final long serialVersionUID =3696676879791539369L;</code></p>
</li>
<li>
<p>æ­¤é•·æ•´æ•¸åœ¨æ¯æ¬¡ç·¨è­¯éšæ®µï¼Œå³ä½¿åªæ˜¯æŸæ–¹æ³•å…§å­—ä¸²å¾®èª¿ï¼Œä¹Ÿå¯èƒ½å› ç‚ºç’°å¢ƒå†æ”¹è®Šè€Œè‡ªå‹•æ”¹è®Šç‰ˆæœ¬è™Ÿç¢¼</p>
</li>
<li>
<p>å¯èƒ½å°è‡´å…ˆå‰åºåˆ—åŒ–çš„æª”æ¡ˆå› ç‚ºç‰ˆæœ¬è™Ÿæ”¹è®Šï¼Œè€Œç„¡æ³•é‚„åŸå›ç‰©ä»¶</p>
</li>
<li>
<p>å»ºè­°é–‹ç™¼è€…æ‡‰è©²è‡ªå·±å®£å‘Š <code>serialVersionUID</code> æ¬„ä½</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>&hellip;</p>
<h3 id="åºåˆ—åŒ–å’Œååºåˆ—åŒ–ç¯„ä¾‹">åºåˆ—åŒ–å’Œååºåˆ—åŒ–ç¯„ä¾‹</h3>
<p>ä»¥ä¸‹ç¯„ä¾‹å°‡ç‰©ä»¶åºåˆ—åŒ–ç”¢å‡ºæª”æ¡ˆï¼Œå†å°‡æª”æ¡ˆé‚„åŸå›ç‰©ä»¶ï¼Œç‰¹æ®Šæƒ…å¢ƒï¼š</p>
<ul>
<li>class Order åº•ä¸‹å«æ•¸å€‹ class Shirt(s)ï¼Œå…¶ä¸­ Shirt(s) é¡åˆ¥å…§çš„åƒ¹éŒ¢æ¬„ä½æœƒå› æ™‚å› åœ°æ”¹è®Šï¼Œåºåˆ—åŒ–éç¨‹ä¸­ä¸éœ€è¦ç‰¹åˆ¥ä¿å­˜ï¼Œ<strong>ä»¥ transient å®£å‘Š</strong></li>
<li>Java çµ¦ç‰©ä»¶å¯ä»¥æ§åˆ¶è‡ªèº«åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æµç¨‹
<ul>
<li>åºåˆ—åŒ–æ™‚å¯ä»¥é¡å¤–å¯«å…¥ <code>java.util.Date</code>ç‰©ä»¶ï¼Œåœ¨ååºåˆ—åŒ–çš„æ™‚å€™è®€å‡ºï¼Œå¯çŸ¥é€²è¡Œåºåˆ—åŒ–æ™‚é–“é»</li>
</ul>
</li>
<li>ååºåˆ—åŒ–æ™‚ï¼Œå¸Œæœ› Shirt(s) é¡åˆ¥å…§çš„åƒ¹éŒ¢æ¬„ä½å¯ä»¥åƒè€ƒæˆæœ¬åƒ¹ï¼Œå†åŠ ä¸Š 50 å…ƒç®¡éŠ·è²»ç”¨</li>
</ul>
<h4 id="1-class-shirt">1. class Shirt</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Shirt</span> <span style="color:#66d9ef">implements</span> Serializable <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">long</span> serialVersionUID <span style="color:#f92672">=</span> 1L<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> String brand<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> quantity<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">double</span> cost<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">transient</span> <span style="color:#66d9ef">double</span> price<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Shirt</span><span style="color:#f92672">(</span>String brand<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> quantity<span style="color:#f92672">,</span> <span style="color:#66d9ef">double</span> cost<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">brand</span> <span style="color:#f92672">=</span> brand<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">quantity</span> <span style="color:#f92672">=</span> quantity<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">cost</span> <span style="color:#f92672">=</span> cost<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">price</span> <span style="color:#f92672">=</span> 2 <span style="color:#f92672">*</span> cost<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// This method is called post-serialization
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// è¦ä¿®æ”¹Javaååºåˆ—åŒ–(å°‡ç‰©ä»¶è‡ªæª”æ¡ˆä¸­è®€å‡º)çš„æµç¨‹ï¼Œå¿…é ˆå®šç¾©æœ¬æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">readObject</span><span style="color:#f92672">(</span>ObjectInputStream ois<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> ClassNotFoundException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ois.defaultReadObject() æ˜¯ç‰©ä»¶åŸæœ¬çš„ååºåˆ—åŒ–æµç¨‹ï¼Œä»é ˆå‘¼å«æ­¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		ois<span style="color:#f92672">.</span><span style="color:#a6e22e">defaultReadObject</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// perform other initiliazation å°‡æª”æ¡ˆé‚„åŸæˆç‰©ä»¶å¾Œï¼Œpriceæ¬„ä½+50å…ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">price</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">cost</span> <span style="color:#f92672">+</span> 50<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">toString</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Shirt: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">brand</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n&#34;</span> 
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Quantity: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">quantity</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n&#34;</span> 
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Cost: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">cost</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Price: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">price</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;------------------\n&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="2-class-order">2. class Order</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Order</span> <span style="color:#66d9ef">implements</span> Serializable <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">long</span> serialVersionUID <span style="color:#f92672">=</span> 1L<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> List<span style="color:#f92672">&lt;</span>Shirt<span style="color:#f92672">&gt;</span> shirts <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> staticField <span style="color:#f92672">=</span> 100<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">transient</span> <span style="color:#66d9ef">int</span> transientField <span style="color:#f92672">=</span> 100<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Order</span><span style="color:#f92672">(</span>Shirt<span style="color:#f92672">...</span> shirts<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Shirt s <span style="color:#f92672">:</span> shirts<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">shirts</span><span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>s<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>		staticField <span style="color:#f92672">=</span> 99<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		transientField <span style="color:#f92672">=</span> 99<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;--- Constructor is launched ---&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">writeObject</span><span style="color:#f92672">(</span>ObjectOutputStream oos<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ä½¿ç”¨æ­¤æ–¹æ³•ä¿®æ”¹Javaåºåˆ—åŒ–(ç‰©ä»¶å¯«å…¥æª”æ¡ˆ)çš„æµç¨‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		oos<span style="color:#f92672">.</span><span style="color:#a6e22e">defaultWriteObject</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// keep the serialization date
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		Date now <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		oos<span style="color:#f92672">.</span><span style="color:#a6e22e">writeObject</span><span style="color:#f92672">(</span>now<span style="color:#f92672">);</span> <span style="color:#75715e">// å°‡æ—¥æœŸç‰©ä»¶å¯«å…¥æª”æ¡ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\nSerialized at: &#34;</span> <span style="color:#f92672">+</span> now <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// This method is called post-serialization (ä¿®æ”¹Javaååºåˆ—åŒ–(æª”æ¡ˆé‚„åŸæˆç‰©ä»¶)çš„æµç¨‹)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">readObject</span><span style="color:#f92672">(</span>ObjectInputStream ois<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> ClassNotFoundException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		ois<span style="color:#f92672">.</span><span style="color:#a6e22e">defaultReadObject</span><span style="color:#f92672">();</span> <span style="color:#75715e">// é€²è¡Œç‰©ä»¶åŸæœ¬çš„ååºåˆ—åŒ–æµç¨‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\nRestored from date: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>Date<span style="color:#f92672">)</span> ois<span style="color:#f92672">.</span><span style="color:#a6e22e">readObject</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// è®€å‡ºåºåˆ—åŒ–æ™‚çš„æ—¥æœŸç‰©ä»¶ï¼Œå†è½‰å‹å›Dateå‹æ…‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Restored at: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">()</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">toString</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		StringBuilder sb <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuilder<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Order Summary ===\n&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Shirt s <span style="color:#f92672">:</span> shirts<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			sb<span style="color:#f92672">.</span><span style="color:#a6e22e">append</span><span style="color:#f92672">(</span>s<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>		sb<span style="color:#f92672">.</span><span style="color:#a6e22e">append</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;staticField = &#34;</span> <span style="color:#f92672">+</span> staticField<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		sb<span style="color:#f92672">.</span><span style="color:#a6e22e">append</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\ntransientField = &#34;</span> <span style="color:#f92672">+</span> transientField<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		sb<span style="color:#f92672">.</span><span style="color:#a6e22e">append</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n------------------&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> sb<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="3-serialization-and-de-serialization">3. Serialization and De-serialization</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SerializeOrder</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		String output <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">getProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;user.dir&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\\src\\course\\c03\\ser\\file\\Order.ser&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		serialization<span style="color:#f92672">(</span>output<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//	System.out.println(&#34;\n-----------------------------------------\n&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//	deSerialization(output);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">serialization</span><span style="color:#f92672">(</span>String output<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// Create a shirts Order
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		Shirt s1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Shirt<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Brand1&#34;</span><span style="color:#f92672">,</span> 100<span style="color:#f92672">,</span> 100<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		Shirt s2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Shirt<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Brand2&#34;</span><span style="color:#f92672">,</span> 100<span style="color:#f92672">,</span> 200<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		Shirt s3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Shirt<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Brand3&#34;</span><span style="color:#f92672">,</span> 100<span style="color:#f92672">,</span> 300<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		Order o <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Order<span style="color:#f92672">(</span>s1<span style="color:#f92672">,</span> s2<span style="color:#f92672">,</span> s3<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		Order<span style="color:#f92672">.</span><span style="color:#a6e22e">staticField</span> <span style="color:#f92672">=</span> 22<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// Write out the Order
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>FileOutputStream fos <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>output<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>				ObjectOutputStream out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ObjectOutputStream<span style="color:#f92672">(</span>fos<span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			out<span style="color:#f92672">.</span><span style="color:#a6e22e">writeObject</span><span style="color:#f92672">(</span>o<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException i<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			i<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== Before Serialization, &#34;</span> <span style="color:#f92672">+</span> o<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">deSerialization</span><span style="color:#f92672">(</span>String output<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// Read the Order back in
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>FileInputStream fis <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>output<span style="color:#f92672">);</span> ObjectInputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ObjectInputStream<span style="color:#f92672">(</span>fis<span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			Order restoredOrder <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>Order<span style="color:#f92672">)</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readObject</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>			System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== After Serialization, &#34;</span> <span style="color:#f92672">+</span> restoredOrder<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>ClassNotFoundException <span style="color:#f92672">|</span> IOException i<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			i<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><blockquote>
<ol>
<li><strong>Shirt</strong> ç‰©ä»¶ç”Ÿæˆæ™‚çš„ price éƒ½æ˜¯ cost çš„ 2 å€ï¼Œé‚„åŸæ™‚åœ¨ <code>readObject()</code> æ–¹æ³•è¢«æ”¹æˆ <code>price = cost + 50</code></li>
<li><strong>Order</strong>ç‰©ä»¶åºåˆ—åŒ–æ™‚ï¼Œåœ¨<code>writeObject()</code>è¢«ç‰¹åˆ¥å¯«å…¥çš„æ—¥æœŸï¼Œé‚„åŸæ™‚åœ¨<code>readObject()</code>æ–¹æ³•å¯ä¸€ä½µè¼¸å‡º</li>
<li><strong>static æ¬„ä½</strong> æœƒå¾—åˆ°é¡åˆ¥å…§åŸæœ¬å®šç¾©çš„å®£å‘Šå€¼</li>
<li><strong>transient æ¬„ä½</strong> æœƒå¾—åˆ°è©²å‹æ…‹çš„é è¨­å€¼</li>
</ol>
</blockquote>
<hr>
<h1 id="04-nio2">04 <code>NIO.2</code></h1>
<h2 id="nio2-åŸºç¤"><code>NIO.2</code> åŸºç¤</h2>
<h3 id="javajofileé™åˆ¶"><code>java.jo.File</code>é™åˆ¶</h3>
<p>åŸºç¤ I/O å­˜åœ¨ä¸€äº›ä¸æ–¹ä¾¿çš„åœ°æ–¹ï¼š</p>
<ol>
<li>å¾ˆå¤šæ–¹æ³•é‡åˆ°éŒ¯èª¤æ™‚å›å‚³ <em>false</em>ï¼Œè€Œéä¸Ÿå‡ºä¾‹å¤–</li>
<li>ç¼ºå°‘å¾ˆå¤šå­˜å–æª”æ¡ˆå¸¸ç”¨åŠŸèƒ½ï¼Œex. è¤‡è£½ <em>copy</em>ã€ç§»å‹• <em>move</em></li>
<li>ä¸æ˜¯æ¯ä¸€å€‹ä½œæ¥­ç³»çµ±éƒ½æ”¯æ´é‡æ–°å‘½å</li>
<li>ä¸æ”¯æ´ <em>symbolic link</em> é¡å‹çš„æª”æ¡ˆ</li>
<li>å°æ–¼ã€Œ<code>metadata</code>ï¼ˆæè¿°æª”æ¡ˆçš„è³‡æ–™ï¼‰ã€æª”æ¡ˆçš„å–å¾—å¾ˆæœ‰é™
<ul>
<li>ä¾‹å¦‚ï¼šæª”æ¡ˆæ¬Šé™ã€æª”æ¡ˆæ“æœ‰è€…ã€å®‰å…¨æ€§è¨­å®š</li>
</ul>
</li>
<li>å­˜å–ã€Œ<code>metadata</code>ï¼ˆæè¿°æª”æ¡ˆçš„è³‡æ–™ï¼‰ã€æª”æ¡ˆæ²’æœ‰æ•ˆç‡
<ul>
<li>ä¸€æ¬¡åªèƒ½å­˜å–ä¸€å€‹ï¼Œæ¯æ¬¡å‘¼å«éƒ½æœƒè½‰å‘¼å«ç³»çµ±æŒ‡ä»¤ <code>system call</code></li>
</ul>
</li>
<li>å¾ˆå¤šæ–¹æ³•é‡åˆ°æª”æ¡ˆè¼ƒå¤§æ™‚ï¼Œæœƒå‘ˆç¾å¡ä½ç‹€æ…‹ï¼ˆ<em>hang</em>ï¼‰ï¼Œä¹…ç„¡å›æ‡‰ç”šè‡³ç•¶æ‰</li>
<li>éè¿´ç›®éŒ„çµæ§‹æ™‚ï¼Œé‡åˆ° <em>symbolic link</em> é¡å‹çš„æª”æ¡ˆç„¡æ³•é©ç•¶è™•ç†</li>
<li>é‡åˆ°æ–°å‹æ…‹ä½œæ¥­ç³»çµ±æˆ–æ–°æª”æ¡ˆå‹æ…‹æ™‚ï¼Œä¸æ˜“æ“´å…… <code>API</code></li>
</ol>
<h3 id="java-io-å¥—ä»¶ç™¼å±•æ­·å²">Java I/O å¥—ä»¶ç™¼å±•æ­·å²</h3>
<table>
<thead>
<tr>
<th>åŠŸèƒ½</th>
<th><code>JSR</code></th>
<th>ç‰ˆæœ¬</th>
<th>å¥—ä»¶ï¼ˆPackageï¼‰</th>
<th>note</th>
</tr>
</thead>
<tbody>
<tr>
<td>I/O</td>
<td></td>
<td>Java 2</td>
<td><code>java.io.*</code></td>
<td></td>
</tr>
<tr>
<td>New I/O (<code>NIO</code>)</td>
<td>51</td>
<td>Java 4</td>
<td><code>java.nio.*</code></td>
<td>ex. Channel I/O</td>
</tr>
<tr>
<td>New I/O 2 (<code>NIO.2</code>)</td>
<td>203</td>
<td>Java 7</td>
<td><code>java.nio.file.*</code></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="æª”æ¡ˆç³»çµ±è·¯å¾‘å’Œæª”æ¡ˆ">æª”æ¡ˆç³»çµ±ã€è·¯å¾‘å’Œæª”æ¡ˆ</h3>
<p><code>NIO.2</code> è£¡é¢çš„æª”æ¡ˆ / ç›®éŒ„éƒ½ä»¥è·¯å¾‘ï¼ˆpathï¼‰ä¾†è¡¨é”ï¼Œå¯åˆ†ç‚ºçµ•å°è·¯å¾‘ <em>absolute path</em> å’Œç›¸å°è·¯å¾‘ <em>relative path</em></p>
<ol>
<li><strong>çµ•å°è·¯å¾‘</strong>
<ul>
<li>åŒ…å«æ ¹ç›®éŒ„ï¼Œex. ã€Œ<code>/</code>ã€æˆ– Windows çš„ã€Œ<code>C:</code>ã€</li>
<li>å®šä½æª”æ¡ˆä½ç½®å¿…é ˆ</li>
</ul>
</li>
<li><strong>ç›¸å°è·¯å¾‘</strong>
<ul>
<li>å¿…é ˆå†çµåˆçµ•å°è·¯å¾‘æ‰èƒ½æ‰¾åˆ°æª”æ¡ˆçœŸæ­£ä½ç½®</li>
</ul>
</li>
</ol>
<h3 id="symbolic-link-æª”æ¡ˆ">Symbolic Link æª”æ¡ˆ</h3>
<ul>
<li>
<p>åˆç¨±ç‚º <code>symlink</code> æˆ–è€… <code>soft link</code>ï¼Œä¸¦ä¸æ˜¯æ·å¾‘ï¼ˆ<em>short cut</em>ï¼‰</p>
</li>
<li>
<p>åŸ·è¡Œæ™‚ä»¥ç³»çµ±ç®¡ç†å“¡èº«åˆ†é–‹å•Ÿ cmdï¼Œè¼¸å…¥æŒ‡ä»¤</p>
<pre tabindex="0"><code class="language-TERMINAL" data-lang="TERMINAL">mklink $(é€£çµæª”æ¡ˆ) $(é€£çµä¾†æºæª”æ¡ˆ)
</code></pre><table>
<thead>
<tr>
<th>comparison</th>
<th><code>symlink</code></th>
<th><code>short cut</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>æª”æ¡ˆé¡å‹ä¸åŒ</td>
<td>.symlink<!-- raw HTML omitted --><code>.sl</code></td>
<td>æ·å¾‘<!-- raw HTML omitted --><code>.sc</code></td>
</tr>
<tr>
<td>æª”æ¡ˆå¤§å°ä¸åŒ</td>
<td>0 KB</td>
<td>2 KB</td>
</tr>
<tr>
<td>åˆ†åˆ¥è¤‡è£½å…©è€…æ™‚</td>
<td>è¤‡è£½ <strong>é€£çµä¾†æºæª”æ¡ˆ</strong>ï¼Œ<!-- raw HTML omitted -->é <code>symlink</code> æœ¬èº«</td>
<td>è¤‡è£½æ·å¾‘æœ¬èº«</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="nio2-çš„åŸºæœ¬æ¶æ§‹"><code>NIO.2</code> çš„åŸºæœ¬æ¶æ§‹</h3>
<ul>
<li>Before JDK 7
<ul>
<li><code>java.io.File</code> æ˜¯æ‰€æœ‰æª”æ¡ˆ / ç›®éŒ„çš„æ“ä½œåŸºç¤</li>
</ul>
</li>
<li>After JDK 7 (æ¨å‡º <code>NIO.2</code>)
<ul>
<li>æ”¹ç‚ºä¸‰å€‹åŸºç¤
<ol>
<li><code>java.nio.file.Path</code> : ç”¨ä¾†<strong>æ‰¾å‡º</strong>æª”æ¡ˆ / ç›®éŒ„</li>
<li><code>java.nio.file.Files</code> : ç”¨ä¾†<strong>æ“ä½œ</strong>æª”æ¡ˆ / ç›®éŒ„</li>
<li><code>java.nio.file.FileSystem</code> : ç”¨ä¾†<strong>å»ºç«‹</strong> Path æˆ–å…¶å®ƒå­˜å–æª”æ¡ˆç³»çµ±çš„ç‰©ä»¶</li>
</ol>
</li>
<li><code>NIO.2</code> æ‰€æœ‰æ–¹æ³•éƒ½ä¸Ÿå‡º <code>IOException</code> æˆ–å…¶å­é¡åˆ¥</li>
</ul>
</li>
</ul>
<h2 id="ä½¿ç”¨-path-ä»‹é¢æ“ä½œæª”æ¡ˆç›®éŒ„">ä½¿ç”¨ Path ä»‹é¢æ“ä½œæª”æ¡ˆ/ç›®éŒ„</h2>
<h3 id="path-ä»‹é¢">Path ä»‹é¢</h3>
<ul>
<li>
<p><code>java.nio.Path</code> ä»‹é¢æ˜¯ <code>NIO.2</code> æ¶æ§‹çš„é€²å…¥é»</p>
</li>
<li>
<p>å–å¾— <code>Path</code> ç‰©ä»¶æœ‰å…©ç¨®æ–¹æ³•ï¼Œç‰©ä»¶å»ºç«‹å¾Œä¸èƒ½ä¿®æ”¹ç‹€æ…‹ (å³ä¸å¯è®Šç‰©ä»¶ immutable)</p>
<ol>
<li>
<p>è—‰ç”± <code>FileSystem</code> ç‰©ä»¶çš„ <code>getPath()</code> æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>FileSystem fs <span style="color:#f92672">=</span> FileSystems<span style="color:#f92672">.</span><span style="color:#a6e22e">getDefault</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>Path p1 <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span><span style="color:#a6e22e">getPath</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;D:\\labs\\resources\\myFile.txt&#34;</span><span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p>è—‰ç”± <code>java.nio.file.Paths</code> é¡åˆ¥çš„éœæ…‹ <code>get()</code> æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Path p0 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;C:\\fakeFile\\pseudoDir\\temp.txt&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Path p1 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;C:/fakeFile/pseudoDir/temp.txt&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Path p2 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;D:&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;fakeFile&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;pseudoDir&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;temp.txt&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Path p3 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/temp/ferrero&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Path p4 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>URI<span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;file:///~/someTempFile&#34;</span><span style="color:#f92672">));</span>
</span></span></code></pre></div><blockquote>
<p>Windows æª”æ¡ˆè·¯å¾‘æ¥å—ä»¥ä¸‹å…©ç¨®æ–¹å‘çš„æ–œç·š</p>
<ul>
<li>
<p><code>\\</code> ( <code>\</code> + escape character <code>\</code>)</p>
</li>
<li>
<p><code>/</code></p>
</li>
</ul>
</blockquote>
</li>
</ol>
</li>
</ul>
<h3 id="path-ä»‹é¢ä¸»è¦åŠŸèƒ½">Path ä»‹é¢ä¸»è¦åŠŸèƒ½</h3>
<ul>
<li>
<p>Path ä»‹é¢ç”¨ä¾†æ‰¾å‡ºæª”æ¡ˆ / ç›®éŒ„ï¼Œå¸¸ç”¨æ–¹æ³•</p>
<table>
<thead>
<tr>
<th><strong>åˆ†è§£è·¯å¾‘</strong></th>
<th><strong>æ“ä½œè·¯å¾‘</strong></th>
<th><strong>æ¯”è¼ƒè·¯å¾‘</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>å–å¾—æ§‹æˆè·¯å¾‘çš„æ‰€æœ‰æª”æ¡ˆ / ç›®éŒ„ã€‚<!-- raw HTML omitted -->ä¸»è¦åˆ†æˆæ ¹ç›®éŒ„ <em>root</em> å’Œåç¨± <em>name</em> å…©ç¨®è·¯å¾‘æˆå“¡ã€‚<!-- raw HTML omitted -->root è·¯å¾‘æˆå“¡åªæœ‰ä¸€å€‹ï¼Œname è·¯å¾‘æˆå“¡å¯ä»¥æœ‰å¤šå€‹ã€‚</td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>getFileName()</code><!-- raw HTML omitted --><code>getParent()</code><!-- raw HTML omitted --><code>getRoot()</code><!-- raw HTML omitted --><code>getNameCount()</code> - ä¸å« root</td>
<td><code>normalize()</code><!-- raw HTML omitted --><code>toUri()</code><!-- raw HTML omitted --><code>toAbsolutePath()</code><!-- raw HTML omitted --><code>subpath()</code><!-- raw HTML omitted --><code>resolve()</code><!-- raw HTML omitted --><code>relativize()</code></td>
<td><code>startsWith()</code><!-- raw HTML omitted --><code>endsWith()</code><!-- raw HTML omitted --><code>equals()</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>getNameCount()</strong> åªè¨ˆç®— name è·¯å¾‘æˆå“¡å€‹æ•¸ï¼Œä¸åŒ…å« rootï¼Œä¸”ç´¢å¼•å¾ 0 ~ 2</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Path p1 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;D:/Temp/Foo/file1.txt&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">format</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;getNameCount: %d%n&#34;</span><span style="color:#f92672">,</span> p1<span style="color:#f92672">.</span><span style="color:#a6e22e">getNameCount</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// getNameCount: 3
</span></span></span></code></pre></div><table>
<thead>
<tr>
<th><strong>è·¯å¾‘çµ„æˆ</strong></th>
<th><code>D:</code></th>
<th><code>Temp</code></th>
<th><code>Foo</code></th>
<th><code>file1.txt</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æˆå“¡åˆ†é¡</strong></td>
<td>root</td>
<td>name<!-- raw HTML omitted -->0</td>
<td>name<!-- raw HTML omitted -->1</td>
<td>name<!-- raw HTML omitted -->2</td>
</tr>
</tbody>
</table>
</blockquote>
</li>
</ul>
<h3 id="ç§»é™¤è·¯å¾‘è£¡çš„å¤šé¤˜çµ„æˆ">ç§»é™¤è·¯å¾‘è£¡çš„å¤šé¤˜çµ„æˆ</h3>
<ul>
<li>
<p>æª”æ¡ˆç³»çµ±ç›®éŒ„</p>
<ol>
<li>ã€Œ<code>.</code>ã€ ç•¶å‰ç›®éŒ„</li>
<li>ã€Œ<code>..</code>ã€ ä¸Šä¸€å±¤ç›®éŒ„</li>
</ol>
</li>
<li>
<p>å¤šé¤˜çš„çµ„æˆ å¯ä»¥<strong>ä½¿ç”¨ normalize() æ–¹æ³•</strong> ç§»é™¤å¤šé¤˜éƒ¨åˆ†ï¼Œåƒæ˜¯ã€Œ<code>./</code>ã€å’Œã€Œ<code>directory/../</code>ã€</p>
<ul>
<li>/home/<strong>./</strong> pseudo/himmel</li>
<li>/home/<strong>acrawlingkitten/../</strong> pseudo/himmel</li>
</ul>
</li>
</ul>
<h3 id="å»ºç«‹å­è·¯å¾‘---subpath">å»ºç«‹å­è·¯å¾‘ - <code>subpath()</code></h3>
<p>ä½¿ç”¨ <code>subpath()</code> å¯å–å¾—è·¯å¾‘è£¡çš„éƒ¨åˆ†è·¯å¾‘</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSubPath</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Path p1 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;D:/Temp/finnish/schocolade&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    p1<span style="color:#f92672">.</span><span style="color:#a6e22e">subpath</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> 3<span style="color:#f92672">);</span>  <span style="color:#75715e">// immutable test
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>p1<span style="color:#f92672">);</span>  <span style="color:#75715e">// D:\Temp\finnish\schocolade
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    p1 <span style="color:#f92672">=</span> p1<span style="color:#f92672">.</span><span style="color:#a6e22e">subpath</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> 3<span style="color:#f92672">);</span>   <span style="color:#75715e">// finnish\bar
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>p1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><blockquote>
<p><code>subpath(1, 3)</code> è¡¨ç¤ºç”± index=1 é–‹å§‹å–ï¼Œä¸å« index=3 çš„æˆå“¡ï¼Œå³å–å‡ºæˆå“¡ 1 å’Œ 2</p>
</blockquote>
<table>
<thead>
<tr>
<th>D:</th>
<th>Temp</th>
<th>finnish</th>
<th>schocolade</th>
</tr>
</thead>
<tbody>
<tr>
<td>root</td>
<td>0</td>
<td>1</td>
<td>2</td>
</tr>
</tbody>
</table>
<h3 id="çµåˆ-2-å€‹è·¯å¾‘---resolve">çµåˆ 2 å€‹è·¯å¾‘ - <code>resolve()</code></h3>
<p>ä½¿ç”¨ <code>resolve()</code> çµåˆå…©å€‹è·¯å¾‘</p>
<ol>
<li>
<p>å‚³å…¥ã€Œ<strong>ç›¸å°è·¯å¾‘</strong>ã€- å°‡è©²ã€Œ<strong>ç›¸å°è·¯å¾‘</strong>ã€ï¼Œé€£æ¥åœ¨ã€Œ<strong>åŸè·¯å¾‘</strong>ã€ä¹‹å¾Œ</p>
</li>
<li>
<p>å‚³å…¥ã€Œ<strong>çµ•å°è·¯å¾‘</strong>ã€- æ–¹æ³•å›å‚³è©²ã€Œ<strong>çµ•å°è·¯å¾‘</strong>ã€ï¼Œå¿½ç•¥ã€Œ<strong>åŸè·¯å¾‘</strong>ã€</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testResolve</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    String p <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/home/clementine/fredrich&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    Path p1 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>p<span style="color:#f92672">).</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bones&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>p1<span style="color:#f92672">);</span>  <span style="color:#75715e">// \home\clementine\fredrich\bones
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Path p2 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>p<span style="color:#f92672">).</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/home/clementine&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>p2<span style="color:#f92672">);</span>  <span style="color:#75715e">// \home\clementine
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="å»ºç«‹é€£æ¥-2-å€‹è·¯å¾‘çš„è·¯å¾‘---relativize">å»ºç«‹é€£æ¥ 2 å€‹è·¯å¾‘çš„è·¯å¾‘ - <code>relativize()</code></h3>
<p>ä½¿ç”¨ <code>relativize()</code> å»ºæ§‹å…©å€‹è·¯å¾‘é–“çš„è·¯å¾‘ï¼Œç”±åŸè·¯å¾‘åˆ° <code>relativize()</code> æ–¹æ³•æ‰€å‚³å…¥çš„è·¯å¾‘ç¯„ä¾‹å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testRelative</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Path p1 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;peon&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    Path p2 <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;julia&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    Path p1Top2 <span style="color:#f92672">=</span> p1<span style="color:#f92672">.</span><span style="color:#a6e22e">relative</span><span style="color:#f92672">(</span>p2<span style="color:#f92672">);</span>  <span style="color:#75715e">// ç”±p1åˆ°p2çš„èµ°æ³•  ..\julia
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>p1Top2<span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>    Path p2Top1 <span style="color:#f92672">=</span> p2<span style="color:#f92672">.</span><span style="color:#a6e22e">relative</span><span style="color:#f92672">(</span>p1<span style="color:#f92672">);</span>  <span style="color:#75715e">// ç”±p2åˆ°p1çš„èµ°æ³•  ..\peon
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>p2Top1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="hard-link">Hard Link</h3>
<p><code>hard link</code>é¡å‹çš„æª”æ¡ˆï¼Œç›¸å°æ–¼ <code>soft link</code> æˆ– <code>symbolic link</code> æœ‰æ›´å¤šé™åˆ¶ï¼š</p>
<ol>
<li>ç›®æ¨™æª”æ¡ˆä¸€å®šè¦å­˜åœ¨</li>
<li>ç›®æ¨™ä¸å¯ä»¥æ˜¯ç›®éŒ„ï¼Œåªèƒ½æ˜¯æª”æ¡ˆ</li>
<li>ç›®æ¨™ä¸å¯ä»¥è·¨ç£ç¢Ÿï¼Œä¾‹å¦‚ä¸èƒ½åœ¨ Cç£ç¢Ÿå»ºç«‹ Dç£ç¢Ÿçš„æª”æ¡ˆ hard links</li>
<li>è¡Œç‚ºã€å¤–è§€ã€å±¬æ€§å’Œä¸€èˆ¬æª”æ¡ˆç›¸ä¼¼ï¼Œä¸å®¹æ˜“åˆ¤æ–·</li>
</ol>
<h3 id="è™•ç†-symbolic-link">è™•ç† Symbolic Link</h3>
<p><code>NIO.2</code>é¡åˆ¥å¯ä»¥æ„ŸçŸ¥ <em>link</em> é¡å‹æª”æ¡ˆçš„å­˜åœ¨ï¼Œç¨±ç‚ºã€Œ<em>link aware</em>ã€ã€‚ç›¸é—œæ–¹æ³•å…·å‚™ä»¥ä¸‹èƒ½åŠ›</p>
<ol>
<li>
<p>åµæ¸¬æ˜¯å¦é‡åˆ° symbolic link æª”æ¡ˆ</p>
</li>
<li>
<p>è¨­å®šé‡åˆ° symbolic link æª”æ¡ˆæ™‚çš„è™•ç†æ–¹å¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">createSymbolicLink</span><span style="color:#f92672">(</span>Path p1<span style="color:#f92672">,</span> Path p2<span style="color:#f92672">,</span> FileAttribute<span style="color:#f92672">&lt;?&gt;);</span>
</span></span><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">createLink</span><span style="color:#f92672">(</span>Path p1<span style="color:#f92672">,</span> Path p2<span style="color:#f92672">);</span>  <span style="color:#75715e">// å»ºç«‹ hard link
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isSymbolicLink</span><span style="color:#f92672">(</span>Path p1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">readSymbolicLink</span><span style="color:#f92672">(</span>Path p1<span style="color:#f92672">);</span>     <span style="color:#75715e">// æ‰¾å‡º symbolic link çš„ target
</span></span></span></code></pre></div><p>&hellip;</p>
</li>
</ol>
<h2 id="ä½¿ç”¨-files-é¡åˆ¥å°æª”æ¡ˆç›®éŒ„é€²è¡Œæª¢æŸ¥åˆªé™¤è¤‡è£½ç§»å‹•">ä½¿ç”¨ Files é¡åˆ¥å°æª”æ¡ˆ/ç›®éŒ„é€²è¡Œæª¢æŸ¥ã€åˆªé™¤ã€è¤‡è£½ã€ç§»å‹•</h2>
<h3 id="è™•ç†æª”æ¡ˆ">è™•ç†æª”æ¡ˆ</h3>
<p>å…ˆä½¿ç”¨ Path ç‰©ä»¶å®šä½æª”æ¡ˆ / ç›®éŒ„ã€‚å†ç”¨ Files é¡åˆ¥æ“ä½œ Path ç‰©ä»¶ï¼Œä»¥é”æˆï¼š</p>
<ol>
<li>æª”æ¡ˆèˆ‡ç›®éŒ„çš„ï¼š
<ul>
<li>æª¢æŸ¥ check | åˆªé™¤ delete | è¤‡è£½ copy | ç§»å‹• move</li>
</ul>
</li>
<li>ç®¡ç†å±¬æ€§è³‡æ–™ï¼ˆ<code>metadata</code>ï¼‰</li>
<li>è®€ / å¯«å’Œå»ºç«‹æª”æ¡ˆ</li>
<li>éš¨æ©Ÿå­˜å–æª”æ¡ˆ</li>
<li>è®€å–ç›®éŒ„ï¼ˆ<code>directory</code>ï¼‰å…§çš„æª”æ¡ˆ</li>
</ol>
<h3 id="æª¢æŸ¥æª”æ¡ˆ--ç›®éŒ„æ˜¯å¦å­˜åœ¨">æª¢æŸ¥æª”æ¡ˆ / ç›®éŒ„æ˜¯å¦å­˜åœ¨</h3>
<ul>
<li>
<p>Path ä»£è¡¨æª”æ¡ˆ / ç›®éŒ„ä½ç½®</p>
</li>
<li>
<p>å­˜å–ä¹‹å‰æ‡‰è©²å…ˆä½¿ç”¨ Files é¡åˆ¥æª¢æŸ¥æ˜¯å¦å­˜åœ¨ï¼ˆ<em>symbolic link</em> ä¹Ÿç®—æª”æ¡ˆï¼‰ï¼Œæ–¹æ³•å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">exists</span><span style="color:#f92672">(</span>Path p<span style="color:#f92672">,</span> LinkOption<span style="color:#f92672">...</span> option<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">notExists</span><span style="color:#f92672">(</span>Path p<span style="color:#f92672">,</span> LinkOption<span style="color:#f92672">...</span> option<span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p>å¦‚æœå…©å€‹æ–¹æ³•æ¸¬è©¦çµæœéƒ½æ˜¯ falseï¼Œè¡¨ç¤ºç‹€æ…‹ç„¡æ³•ç¢ºèªï¼ˆ<code>unknown</code>ï¼‰ï¼Œå¸¸è¦‹åŸå› </p>
<ol>
<li>æ²’æœ‰æ¬Šé™</li>
<li>é›¢ç·šç£ç¢Ÿæ©Ÿï¼ˆOff-line Driveï¼‰ï¼Œä¾‹å¦‚ CD-ROM</li>
</ol>
</li>
</ul>
<h3 id="æª¢æŸ¥æª”æ¡ˆ--ç›®éŒ„å±¬æ€§">æª¢æŸ¥æª”æ¡ˆ / ç›®éŒ„å±¬æ€§</h3>
<p>æª¢æŸ¥æ¬Šé™çš„ä½¿ç”¨æ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isReadable</span><span style="color:#f92672">(</span>Path p<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isWritable</span><span style="color:#f92672">(</span>Path p<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isExecutable</span><span style="color:#f92672">(</span>Path p<span style="color:#f92672">);</span>
</span></span></code></pre></div><p>æª¢æŸ¥æ˜¯å¦ç‚ºåŒä¸€æª”æ¡ˆçš„æ–¹æ³•ï¼ˆå¸¸ç”¨æ–¼ symbolic linkï¼‰</p>
<p><code>isSameFile()</code>æª¢æŸ¥ä¸€æ—¦çµæŸï¼Œå°±ä¸å†ä¿è­‰çµæœï¼Œå› ç‚ºæª”æ¡ˆå¯èƒ½é¦¬ä¸Šè¢«å…¶å®ƒç³»çµ±æŒ‡ä»¤æ›´æ”¹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isSameFile</span><span style="color:#f92672">(</span>Path p1<span style="color:#f92672">,</span> Path p2<span style="color:#f92672">);</span>
</span></span></code></pre></div><p>&hellip;</p>
<h3 id="å»ºç«‹æª”æ¡ˆ--ç›®éŒ„">å»ºç«‹æª”æ¡ˆ / ç›®éŒ„</h3>
<ul>
<li>
<p>å»ºç«‹æª”æ¡ˆçš„æ–¹æ³• - <code>createFile()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">createFile</span><span style="color:#f92672">(</span>Path file<span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p>å»ºç«‹å–®ä¸€ç›®éŒ„çš„æ–¹æ³• - <code>createDirectory()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">createDirectory</span><span style="color:#f92672">(</span>Path dir<span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p>å»ºç«‹å¤šé‡ç›®éŒ„çš„æ–¹æ³•ï¼Œé€šå¸¸ç”¨æ–¼å°‡è·¯å¾‘è£¡ç¼ºå°‘çš„ name æˆå“¡ä¸€æ¬¡å…¨éƒ¨å»ºç«‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">createDirectories</span><span style="color:#f92672">(</span>Path dir<span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p>å‡è¨­åªæœ‰ <code>D:/Temp</code> ç›®éŒ„å­˜åœ¨ï¼Œå‰‡ä½¿ç”¨ <code>Path.get(...)</code> å¯å°‡ç¼ºå°‘çš„ç›®éŒ„ä¸€æ¬¡å»ºç«‹å®Œæˆ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">createDirectories</span><span style="color:#f92672">(</span>Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;D:/Temp/foo/bar/example&#34;</span><span style="color:#f92672">));</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="åˆªé™¤æª”æ¡ˆ--ç›®éŒ„">åˆªé™¤æª”æ¡ˆ / ç›®éŒ„</h3>
<ul>
<li>
<p>åˆªé™¤æª”æ¡ˆ / ç›®éŒ„ä½¿ç”¨çš„æ–¹æ³• <code>Files.delete(Path p);</code></p>
</li>
<li>
<p>å¤±æ•—æ™‚å¯èƒ½ä¸Ÿå‡ºä»¥ä¸‹ä¾‹å¤–</p>
<ol>
<li><code>java.nio.NoSuchFileException</code> : è¦åˆªé™¤çš„æª”æ¡ˆä¸å­˜åœ¨</li>
<li><code>java.nio.file.DirectoryNotEmptyException</code> : è¦åˆªé™¤çš„ç›®éŒ„ä¸ç‚ºç©º</li>
<li><code>java.io.IOException</code> : å…¶å®ƒéŒ¯èª¤</li>
</ol>
</li>
<li>
<p>ä¹Ÿå¯ä»¥åˆªé™¤æª”æ¡ˆ / ç›®éŒ„å‰å…ˆç¢ºèªæ˜¯å¦å­˜åœ¨ - <code>deleteIfExists()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">deleteIfExists</span><span style="color:#f92672">(</span>Path p<span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p>å‰‡æª”æ¡ˆä¸å­˜åœ¨å°±ä¸æœƒåˆªé™¤ï¼Œå› æ­¤ä¸æœƒæœ‰ <code>NoSuchFileException</code></p>
</li>
</ul>
<h3 id="è¤‡è£½å’Œç§»å‹•æª”æ¡ˆ--ç›®éŒ„">è¤‡è£½å’Œç§»å‹•æª”æ¡ˆ / ç›®éŒ„</h3>
<ul>
<li>
<p>è¤‡è£½å’Œç§»å‹•æª”æ¡ˆ / ç›®éŒ„çš„æ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">copy</span><span style="color:#f92672">(</span>Path source<span style="color:#f92672">,</span> Path target<span style="color:#f92672">,</span> CopyOption<span style="color:#f92672">...);</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// source ä¾†æºè·¯å¾‘ (ç›®éŒ„ or æª”æ¡ˆ)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">move</span><span style="color:#f92672">(</span>Path source<span style="color:#f92672">,</span> Path target<span style="color:#f92672">,</span> CopyOption<span style="color:#f92672">...);</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// target ç›®æ¨™è·¯å¾‘ (ç›®éŒ„ or æª”æ¡ˆ)
</span></span></span></code></pre></div></li>
<li>
<p><code>CopyOption</code> ä»‹é¢ï¼Œæ­¤å‚³å…¥åƒæ•¸å…è¨±åŒæ™‚å¤šå€‹ï¼Œæœ‰å…©å€‹åˆ—èˆ‰å‹åˆ¥å¯¦ä½œå®ƒ</p>
<table>
<thead>
<tr>
<th>ä»‹é¢</th>
<th>åˆ—èˆ‰å‹åˆ¥ï¼ˆ<code>enum</code>ï¼‰</th>
<th>åˆ—èˆ‰é …ç›®ï¼ˆ<code>types</code>ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CopyOption</code></td>
<td><code>LinkOption</code></td>
<td><code>NOFOLLOW_LINKS</code></td>
</tr>
<tr>
<td>-</td>
<td><code>StandCopyOption</code></td>
<td><code>REPLACE_EXISTING</code></td>
</tr>
<tr>
<td>-</td>
<td><code>StandCopyOption</code></td>
<td><code>COPY_ATTRIBUTES</code></td>
</tr>
<tr>
<td>-</td>
<td><code>StandCopyOption</code></td>
<td><code>ATOMIC_MOVE</code></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>æ¯”è¼ƒ <strong>è¤‡è£½</strong> èˆ‡ <strong>ç§»å‹•</strong> å…©ç¨®æ“ä½œçš„ç›¸åŒä¹‹è™•</p>
<ol>
<li>å¦‚æœç›®æ¨™è·¯å¾‘å·²ç¶“å­˜åœ¨ï¼Œä½†æ“ä½œå‰æ²’æœ‰ä½¿ç”¨ <code>StandardCopyOption.REPLACE_EXISTING</code> æŒ‡å®šå¯ä»¥è¦†è“‹çš„è©±ï¼Œå°‡å¤±æ•—</li>
<li>å¦‚æœç›®æ¨™è·¯å¾‘ä¸å­˜åœ¨ï¼Œå‰‡æ“ä½œå¾Œå°‡è‡ªå‹•å»ºç«‹</li>
<li>åœ¨æ“ä½œ<strong>ä¹‹å‰</strong>ä¾†æºå’Œç›®æ¨™ã€Œéä¸€è‡´ã€æ˜¯æª”æ¡ˆ / ç›®éŒ„ï¼Œå°‡ä¸å½±éŸ¿çµæœ</li>
</ol>
</li>
<li>
<p>å®šç¾© <strong>ç›®æ¨™è·¯å¾‘</strong> éœ€è¦æ³¨æ„</p>
<ol>
<li>å¦‚æœç›®æ¨™è·¯å¾‘æ˜¯å­˜åœ¨çš„ã€Œæª”æ¡ˆã€æˆ–ã€Œç©ºç›®éŒ„ã€ï¼Œä½¿ç”¨ <strong>REPLACE_EXISTING</strong> æˆ– <strong>ATOMIC_MOVE</strong>ï¼Œå¯é¿å…æ‹‹å‡º <code>java.nio.file.FileAlreadyExistsException</code></li>
<li>è‹¥ç›®æ¨™è·¯å¾‘æ˜¯å­˜åœ¨çš„ã€Œéç©ºç›®éŒ„ã€ï¼Œç”¨ <strong>REPLACE_EXISTING</strong> é‚„ä¸å¤ ï¼Œé‚„æ˜¯æœƒæ‹‹å‡º <code>java.nio.file.DirectoryNotEmptyException</code></li>
</ol>
</li>
<li>
<p>å®šç¾© <strong>ä¾†æºè·¯å¾‘</strong> éœ€è¦æ³¨æ„</p>
<ol>
<li>å¿…é ˆç‚ºå­˜åœ¨çš„ã€Œæª”æ¡ˆã€ã€Œç›®éŒ„ã€ï¼Œå¦å‰‡æ‹‹å‡º <code>java.nio.file.NoSuchFileException</code></li>
<li>ä¾†æºè·¯å¾‘æ˜¯ã€Œç›®éŒ„ã€æ™‚
<ul>
<li>å³ä¾¿ã€Œè¤‡è£½ã€æˆåŠŸï¼Œä¹Ÿç„¡æ³•è¤‡è£½å…§å«æª”æ¡ˆï¼Œåªæœƒç”¢ç”Ÿæ–°ç›®éŒ„ï¼Œéç¨‹ä¸æœƒå‡ºéŒ¯</li>
</ul>
</li>
<li>ä¾†æºè·¯å¾‘æ˜¯ã€Œç›®éŒ„ã€æ™‚
<ul>
<li>å¦‚æœã€Œç§»å‹•ã€æˆåŠŸï¼Œå…§å«çš„æª”æ¡ˆ / ç›®éŒ„å°‡ä¸€ä½µæ¬å®¶</li>
</ul>
</li>
</ol>
</li>
<li>
<p>è¤‡è£½æˆ–ç§»å‹•è·¯å¾‘æ™‚ï¼Œå¯ä»¥åœ¨ç¬¬ä¸‰å€‹åƒæ•¸é–‹å§‹å‚³å…¥å¯¦ä½œä»‹é¢ <code>CopyOption</code> çš„åˆ—èˆ‰å‹æ…‹ï¼Œæ³¨æ„äº‹é …ç‚º</p>
<ol>
<li>ã€Œè¤‡è£½ã€æª”æ¡ˆ / ç›®éŒ„æ™‚çš„æ³¨æ„äº‹é …
<ul>
<li>ä¾†æºè·¯å¾‘æ˜¯ <code>symbolic link</code> æ™‚ï¼Œé è¨­å°‡è¤‡è£½ã€Œlink æŒ‡å‘çš„æª”æ¡ˆã€</li>
<li>åˆ—èˆ‰å‹æ…‹ã€Œ<code>StandardCopyOption.COPY_ATTRIBUTES</code>ã€ç”¨æ–¼å°‡æª”æ¡ˆå±¬æ€§ä¸€ä½µè¤‡è£½ã€‚å¤§éƒ¨åˆ†å±¬æ€§å°‡ä¾æª”æ¡ˆç³»çµ±ä¸åŒè€Œå¯èƒ½ä¸è¢«è¤‡è£½ï¼Œä½†æª”æ¡ˆæœ€å¾Œä¿®æ”¹æ™‚é–“ï¼ˆlast-modifiedï¼‰å°‡è¢«æ”¯æ´</li>
</ul>
</li>
<li>ã€Œç§»å‹•ã€æª”æ¡ˆ / ç›®éŒ„æ™‚çš„æ³¨æ„äº‹é …
<ul>
<li>ä½¿ç”¨åˆ—èˆ‰å‹æ…‹ <code>StandardCopyOption.ATOMIC_MOVE</code>
<ul>
<li>è‹¥æª”æ¡ˆç³»çµ±ä¸æ”¯æ´å°‡ä¸Ÿå‡ºä¾‹å¤–</li>
<li>è‹¥æ”¯æ´å‰‡å¯é¿å…ç§»å‹•éç¨‹ä¸­æœ‰å…¶å®ƒç³»çµ±ç¨‹åºå­˜å–æª”æ¡ˆ</li>
<li>å¦‚æœç”¨æ–¼è€—æ™‚è¼ƒä¹…çš„å¤§æª”æ¡ˆç§»å‹•ï¼Œå¯ä»¥ä¿è­‰æ¥ä¸‹ä¾†è¦å­˜å–è©²æª”æ¡ˆçš„ç³»çµ±ç¨‹åºéƒ½å¯å­˜å–åˆ°å®Œæ•´çš„æª”æ¡ˆ</li>
</ul>
</li>
<li>è‹¥ç§»å‹• symbolic link æª”æ¡ˆï¼Œä¸éœ€è¦ä½¿ç”¨åˆ—èˆ‰å‹æ…‹ <code>LinkOption.NOFOLLOW_LINKS</code></li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="stream-å’Œ-path-äº’ç›¸è¤‡è£½">Stream å’Œ Path äº’ç›¸è¤‡è£½</h3>
<ul>
<li>
<p>æª”æ¡ˆè¤‡è£½ä¾†æºæˆ–ç›®æ¨™é™¤äº† Path ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥æ˜¯åŸºç¤ I/O æåˆ°çš„ä¸²æµï¼ˆStreamï¼‰ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">copy</span><span style="color:#f92672">(</span>InputStream source<span style="color:#f92672">,</span> Path target<span style="color:#f92672">,</span> CopyOption<span style="color:#f92672">...</span> options<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">copy</span><span style="color:#f92672">(</span>Path source<span style="color:#f92672">,</span> OutputStream target<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// source: æª”æ¡ˆè¤‡è£½ä¾†æºï¼Œä½¿ç”¨ InputStream
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// target: æª”æ¡ˆè¤‡è£½å¾Œçš„è¼¸å‡ºï¼Œä½¿ç”¨ OutputStream
</span></span></span></code></pre></div></li>
<li>
<p>ä»¥ä¸‹ç¤ºç¯„å¦‚ä½•å°‡é ç«¯ç¶²é è½‰æ›æˆ <code>InputStream</code> ç‰©ä»¶å¾Œï¼Œå†è¤‡è£½ç‚ºæœ¬æ©Ÿæª”æ¡ˆ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CopyInputStreamTest</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        Path to <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir/c04/oracle.html/&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toAboslutePath</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        URL url <span style="color:#f92672">=</span> URI<span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;http://www.oracle.com/&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toURL</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span> InputStream from <span style="color:#f92672">=</span> url<span style="color:#f92672">.</span><span style="color:#a6e22e">openStream</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            Files<span style="color:#f92672">.</span><span style="color:#a6e22e">copy</span><span style="color:#f92672">(</span>from<span style="color:#f92672">,</span> to<span style="color:#f92672">,</span> StadardCopyOption<span style="color:#f92672">.</span><span style="color:#a6e22e">REPLACE_EXISTING</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="åˆ—å‡ºç›®éŒ„å…§å®¹">åˆ—å‡ºç›®éŒ„å…§å®¹</h3>
<ul>
<li>
<p><code>DirectoryStream</code> ä»‹é¢å¯ä»¥æ‰¾å‡ºç›®éŒ„ä¸‹æ‰€æœ‰æª”æ¡ˆ / ç›®éŒ„ï¼Œä½†åªé™åˆ¶åœ¨ç›®éŒ„ä¸‹ç¬¬ä¸€å±¤</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Path dir <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;D:/&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>DirectoryStream<span style="color:#f92672">&lt;</span>Path<span style="color:#f92672">&gt;</span> stream <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">newDirectoryStream</span><span style="color:#f92672">(</span>dir<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;*&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>Path file <span style="color:#f92672">:</span> stream<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>file<span style="color:#f92672">.</span><span style="color:#a6e22e">getFileName</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>PatternSyntaxException <span style="color:#f92672">|</span> DirectoryIteratorException <span style="color:#f92672">|</span> IOException x<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">err</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>x<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="è®€å–å’Œå¯«å…¥æª”æ¡ˆ">è®€å–å’Œå¯«å…¥æª”æ¡ˆ</h3>
<ul>
<li>
<p>Files é¡åˆ¥</p>
<ul>
<li>
<p><code>readAllBytes()</code> å’Œ <code>readAllLines()</code> å¯ä»¥ä¸€æ¬¡è®€å–æª”æ¡ˆå…¨éƒ¨å…§å®¹ï¼ˆä½†æª”æ¡ˆä¸å»ºè­°å¤ªå¤§ï¼‰</p>
</li>
<li>
<p><code>write()</code> å‰‡æä¾›å¯«å…¥æª”æ¡ˆçš„åŠŸèƒ½</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Path source <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir/c04/file.txt&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toAbsolutePath</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    Charset cs <span style="color:#f92672">=</span> Charset<span style="color:#f92672">.</span><span style="color:#a6e22e">defaultCharset</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> lines <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">readAllLines</span><span style="color:#f92672">(</span>source<span style="color:#f92672">,</span> cs<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    Path target <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir/c04/file2.txt&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toAbsolutePath</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    Files<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>target<span style="color:#f92672">,</span> lines<span style="color:#f92672">,</span> cs<span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>               StandardOpenOption<span style="color:#f92672">.</span><span style="color:#a6e22e">CREATE</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>               StandardOpenOption<span style="color:#f92672">.</span><span style="color:#a6e22e">TRUNCATE_EXISTING</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>               StandardOpenOption<span style="color:#f92672">.</span><span style="color:#a6e22e">WRITE</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;done...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<hr>
<h2 id="ä½¿ç”¨-files-é¡åˆ¥æ“ä½œ-channel-io-å’Œ-stream-io-è®€å¯«æª”æ¡ˆ">ä½¿ç”¨ Files é¡åˆ¥æ“ä½œ Channel I/O å’Œ Stream I/O è®€å¯«æª”æ¡ˆ</h2>
<h3 id="ä»‹é¢-channel-å’Œé¡åˆ¥-bytebuffer">ä»‹é¢ Channel å’Œé¡åˆ¥ <code>ByteBuffer</code></h3>
<ul>
<li>æ­é…ä½¿ç”¨ <code>Channel</code> interface å’Œ <code>ByteBuffer</code> classï¼Œå¯æé«˜ I/O æ•ˆç‡
<ol>
<li><strong>Stream I/O</strong> æ¯æ¬¡è®€å–ä¸€å€‹ä½å…ƒæˆ–å­—å…ƒï¼›<strong>Channel I/O</strong> æ¯æ¬¡è®€å–ä¸€å¡Šè¨˜æ†¶é«”ï¼ˆbufferï¼‰</li>
<li><code>java.nio.channels.ByteChannel</code> interface ç¹¼æ‰¿ <code>Channel</code> interfaceï¼Œæä¾›åŸºæœ¬è®€å¯«åŠŸèƒ½</li>
<li><code>java.nio.channels.SeekableByteChannel</code> interface ç¹¼æ‰¿ <code>ByteChannel</code>
<ul>
<li>æä¾›åœ¨ channel ä¸­è®€å¯«æ™‚ç´€éŒ„ç›®å‰ä½ç½®ï¼Œä¸”æ”¹è®Šè®€å¯«ä½ç½®çš„èƒ½åŠ›ï¼Œè®“ <strong>éš¨æ©Ÿå­˜å–</strong>ï¼ˆ<strong>random access</strong>ï¼‰è®Šå¾—å¯èƒ½</li>
</ul>
</li>
<li>ä½¿ç”¨ <code>Files.newByteChannel(Path, OpenOption...)</code> æ–¹æ³•å›å‚³ <code>SeekableByteChannel</code> å¯¦ä¾‹å¾Œï¼Œä¹Ÿå¯ä»¥å†è½‰å‹ç‚º <code>java.nio.channels.FileChannel</code> é¡åˆ¥</li>
</ol>
</li>
</ul>
<h3 id="éš¨æ©Ÿå­˜å–æª”æ¡ˆ">éš¨æ©Ÿå­˜å–æª”æ¡ˆ</h3>
<ul>
<li>
<p><code>SeekableByteChannel</code>ä»‹é¢å¯é€²è¡Œæª”æ¡ˆå…§å®¹çš„ã€Œéš¨æ©Ÿå­˜å–ã€</p>
<ol>
<li><!-- raw HTML omitted -->st<!-- raw HTML omitted --> step : æ‰“é–‹æª”æ¡ˆ</li>
<li><!-- raw HTML omitted -->nd<!-- raw HTML omitted --> step : æ‰¾åˆ°å­˜å–ä½ç½®</li>
<li><!-- raw HTML omitted -->rd<!-- raw HTML omitted --> step : é–‹å§‹è®€å¯«</li>
</ol>
</li>
<li>
<p>å¸¸ç”¨æ–¹æ³•ï¼ˆä»¥ä¸‹ channel ä»£è¡¨æª”æ¡ˆï¼‰</p>
<table>
<thead>
<tr>
<th>å¸¸ç”¨æ–¹æ³•</th>
<th>æ•˜è¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>position()</strong></td>
<td>å›å‚³åœ¨ <code>channel</code> ä¸­çš„ä½ç½®</td>
</tr>
<tr>
<td><strong>position(long)</strong></td>
<td>è¨­å®šåœ¨ <code>channel</code> ä¸­çš„ä½ç½®</td>
</tr>
<tr>
<td><strong>read(ByteBuffer)</strong></td>
<td>ç”± <code>channel</code> ä¸­å°‡è³‡æ–™è®€å…¥ buffer</td>
</tr>
<tr>
<td><strong>write(ByteBuffer)</strong></td>
<td>å°‡è³‡æ–™ç”± buffer ä¸­å¯«å…¥ <code>channel</code></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// ä½¿ç”¨ SeekableByteChannel ä»‹é¢ï¼Œå°‡æ–°å¢å­—ä¸²æ”¾åœ¨æª”æ¡ˆæŒ‡å®šä½ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		Path path <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir/c04/file.txt&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toAbsolutePath</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>SeekableByteChannel sbc <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">newByteChannel</span><span style="color:#f92672">(</span>path<span style="color:#f92672">,</span> StandardOpenOption<span style="color:#f92672">.</span><span style="color:#a6e22e">WRITE</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>             <span style="color:#75715e">/* ç”± Files.newByteChannel() å–å¾— SeekableByteChannel ä»‹é¢çš„å¯¦ä½œç‰©ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                è©²ç‰©ä»¶æŒ‡å‘ path æ‰€åœ¨æª”æ¡ˆï¼Œä¸¦æŒ‡å®šå±¬æ€§ç‚º StandardOpenOption.WRITE æ‰€ä»¥å¯å¯«å…¥ */</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">long</span> channelSize <span style="color:#f92672">=</span> sbc<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>			sbc<span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">(</span>channelSize<span style="color:#f92672">);</span>     <span style="color:#75715e">// å°‡æª”æ¡ˆè®€å–ä½ç½®ç§»åˆ°æœ€å°¾ç«¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>			System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;position: &#34;</span> <span style="color:#f92672">+</span> sbc<span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>			ByteBuffer buffer <span style="color:#f92672">=</span> ByteBuffer<span style="color:#f92672">.</span><span style="color:#a6e22e">wrap</span><span style="color:#f92672">((</span><span style="color:#e6db74">&#34;\n&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;0&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">());</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#75715e">// å»ºç«‹ ByteBuffer ç‰©ä»¶ï¼Œå…§å®¹: &#34;\n&#34; + &#34;0&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>			sbc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>buffer<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>			System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;position: &#34;</span> <span style="color:#f92672">+</span> sbc<span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span></code></pre></div><p>&hellip;</p>
</li>
</ul>
<h3 id="å°æ–‡å­—æª”æä¾›-buffered-io-æ–¹æ³•">å°æ–‡å­—æª”æä¾› Buffered I/O æ–¹æ³•</h3>
<ul>
<li>
<p><code>NIO.2</code> ä¸€æ¨£å¯ç”¨ <code>BufferedReader / BufferedWriter</code> ç‰©ä»¶æé«˜æª”æ¡ˆè®€å¯«æ•ˆç‡</p>
<ol>
<li>
<p>ä½¿ç”¨ <code>Files.newBufferedReader()</code> å–å¾— <code>java.io.BufferedReader</code> ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>BufferedReader reader <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">newBufferedReader</span><span style="color:#f92672">(</span>path<span style="color:#f92672">,</span> charset<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>line <span style="color:#f92672">=</span> reader<span style="color:#f92672">.</span><span style="color:#a6e22e">readLine</span><span style="color:#f92672">();</span>
</span></span></code></pre></div></li>
<li>
<p>ä½¿ç”¨ <code>Files.newBufferedWriter()</code> å–å¾— <code>java.io.BufferedWriter</code> ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>BufferedWriter writer <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">newBufferedWriter</span><span style="color:#f92672">(</span>path<span style="color:#f92672">,</span> charset<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>writer<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>s<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> s<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">());</span>
</span></span></code></pre></div></li>
</ol>
</li>
</ul>
<h3 id="å–å¾—ä½å…ƒä¸²æµç‰©ä»¶çš„æ–¹æ³•">å–å¾—ä½å…ƒä¸²æµç‰©ä»¶çš„æ–¹æ³•</h3>
<ul>
<li>
<p><code>NIO.2</code> ä¹Ÿå¯ä»¥å–å¾— <code>InputStream</code> ä»¥åŠ <code>OutputStream</code> ç‰©ä»¶</p>
<ol>
<li>
<p>ä½¿ç”¨ <code>Files.newInputStream()</code> å–å¾— <code>java.io.InputStream</code> ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>InputStream in <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">newInputStream</span><span style="color:#f92672">(</span>path<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>BufferedReader r <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> InputStreamReader<span style="color:#f92672">(</span>in<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>String line <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span><span style="color:#a6e22e">readLine</span><span style="color:#f92672">();</span>
</span></span></code></pre></div></li>
<li>
<p>ä½¿ç”¨ <code>Files.newOutputStream()</code> å–å¾— <code>java.io.OutputStream</code> ç‰©ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Path path <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir/c04/logFile.txt&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toAbsolutePath</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>String s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hi, Jim...&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">byte</span> data<span style="color:#f92672">[]</span> <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>OutputStream out <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">newOutputStream</span><span style="color:#f92672">(</span>path<span style="color:#f92672">,</span> CREATE<span style="color:#f92672">,</span> APPEND<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    BufferedOutputStream bot <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedOutputStream<span style="color:#f92672">(</span>out<span style="color:#f92672">);)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    out<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>data<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> data<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ol>
</li>
</ul>
<hr>
<h2 id="è®€å¯«æª”æ¡ˆç›®éŒ„çš„å±¬æ€§">è®€å¯«æª”æ¡ˆ/ç›®éŒ„çš„å±¬æ€§</h2>
<h3 id="ä½¿ç”¨-files-ç®¡ç†æª”æ¡ˆçš„å±¬æ€§è³‡æ–™">ä½¿ç”¨ Files ç®¡ç†æª”æ¡ˆçš„å±¬æ€§è³‡æ–™</h3>
<p><code>Files</code> class æä¾›è‹¥å¹²ç®¡ç†æª”æ¡ˆ / ç›®éŒ„å±¬æ€§çš„æ–¹æ³•</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>size</code></td>
<td>å›å‚³æª”æ¡ˆå¤§å°ï¼ˆbytesï¼‰</td>
</tr>
<tr>
<td><code>isDirectory</code></td>
<td>åˆ¤æ–·æ˜¯å¦ç‚ºç›®éŒ„</td>
</tr>
<tr>
<td><code>isRegularFile</code></td>
<td>åˆ¤æ–·æ˜¯å¦ç‚ºæª”æ¡ˆ</td>
</tr>
<tr>
<td><code>isSymbolicLink</code></td>
<td>åˆ¤æ–·æ˜¯å¦ç‚º symbolic link</td>
</tr>
<tr>
<td><code>isHidden</code></td>
<td>æ˜¯å¦ç‚ºéš±è—æª”</td>
</tr>
<tr>
<td><code>getLastModifiedTime</code></td>
<td>å–å¾—æœ€å¾Œä¿®æ”¹æ™‚é–“</td>
</tr>
<tr>
<td><code>setLastModifiedTime</code></td>
<td>è¨­å®šæœ€å¾Œä¿®æ”¹æ™‚é–“</td>
</tr>
<tr>
<td><code>getAttribute</code></td>
<td>å–å¾—å±¬æ€§</td>
</tr>
<tr>
<td><code>setAttribute</code></td>
<td>è¨­å®šå±¬æ€§</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>   Path basic <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir/c04/metadata&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toAbsolutePath</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åœ¨ç›¸å°è·¯å¾‘ä¸‹ï¼Œäº‹å…ˆå»ºç«‹æ‰€æœ‰æ¸¬è©¦æª”æ¡ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;basic path: &#34;</span> <span style="color:#f92672">+</span> basic<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   Path common <span style="color:#f92672">=</span> basic<span style="color:#f92672">.</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;file.txt&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>   Path shortcut <span style="color:#f92672">=</span> basic<span style="color:#f92672">.</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir.shortcut&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>   Path hidden <span style="color:#f92672">=</span> basic<span style="color:#f92672">.</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hiddenFile&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>   Path symlink <span style="color:#f92672">=</span> basic<span style="color:#f92672">.</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir.sl&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;size: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isDirectory: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isRegularFile: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isRegularFile</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>     
</span></span><span style="display:flex;"><span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isSymbolicLink(dir.sl): &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isSymbolicLink</span><span style="color:#f92672">(</span>symlink<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isSymbolicLink(dir.shortcut): &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isSymbolicLink</span><span style="color:#f92672">(</span>shortcut<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isHidden: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isHidden</span><span style="color:#f92672">(</span>hidden<span style="color:#f92672">));</span>    
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// å–å¾—ä¸¦ä¿®æ”¹LastModifiedTime
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;getLastModifiedTime: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">getLastModifiedTime</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>   FileTime t <span style="color:#f92672">=</span> FileTime<span style="color:#f92672">.</span><span style="color:#a6e22e">fromMillis</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">().</span><span style="color:#a6e22e">getTime</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è¦è¨­å®šæª”æ¡ˆçš„æ™‚é–“å±¬æ€§ï¼Œå¿…é ˆä½¿ç”¨é¡åˆ¥ FileTime
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   Files<span style="color:#f92672">.</span><span style="color:#a6e22e">setLastModifiedTime</span><span style="color:#f92672">(</span>common<span style="color:#f92672">,</span> t<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;getLastModifiedTime: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">getLastModifiedTime</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// ä½¿ç”¨Files.setAttribute()æ–¹æ³•è¨­å®šhiddenå±¬æ€§	
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		Path basic <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir/c04/metadata&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toAbsolutePath</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;basic path: &#34;</span> <span style="color:#f92672">+</span> basic<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		Path common <span style="color:#f92672">=</span> basic<span style="color:#f92672">.</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;file.txt&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		Path shortcut <span style="color:#f92672">=</span> basic<span style="color:#f92672">.</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir.shortcut&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		Path hidden <span style="color:#f92672">=</span> basic<span style="color:#f92672">.</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hiddenFile&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		Path symlink <span style="color:#f92672">=</span> basic<span style="color:#f92672">.</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir.sl&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;size: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isDirectory: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isRegularFile: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isRegularFile</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>		
</span></span><span style="display:flex;"><span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isSymbolicLink(dir.sl): &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isSymbolicLink</span><span style="color:#f92672">(</span>symlink<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isSymbolicLink(dir.shortcut): &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isSymbolicLink</span><span style="color:#f92672">(</span>shortcut<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isHidden: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">isHidden</span><span style="color:#f92672">(</span>hidden<span style="color:#f92672">));</span>	
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">//å–å¾—ä¸¦ä¿®æ”¹LastModifiedTime
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;getLastModifiedTime: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">getLastModifiedTime</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>		FileTime t <span style="color:#f92672">=</span> FileTime<span style="color:#f92672">.</span><span style="color:#a6e22e">fromMillis</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">().</span><span style="color:#a6e22e">getTime</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>		Files<span style="color:#f92672">.</span><span style="color:#a6e22e">setLastModifiedTime</span><span style="color:#f92672">(</span>common<span style="color:#f92672">,</span> t<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;getLastModifiedTime: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">getLastModifiedTime</span><span style="color:#f92672">(</span>common<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">//è¨­å®šhiddenå±¬æ€§
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		Files<span style="color:#f92672">.</span><span style="color:#a6e22e">setAttribute</span> <span style="color:#f92672">(</span>hidden<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;dos:hidden&#34;</span><span style="color:#f92672">,</span> Boolean<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>		out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isHidden: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">getAttribute</span><span style="color:#f92672">(</span>hidden<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;dos:hidden&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>   Files<span style="color:#f92672">.</span><span style="color:#a6e22e">setAttribute</span> <span style="color:#f92672">(</span>hidden<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;dos:hidden&#34;</span><span style="color:#f92672">,</span> Boolean<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>   out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;isHidden: &#34;</span> <span style="color:#f92672">+</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">getAttribute</span><span style="color:#f92672">(</span>hidden<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;dos:hidden&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// é™¤äº†ç”¨isHidden()æ–¹æ³•æ¸¬è©¦å±¬æ€§æ˜¯å¦ç‚ºhiddenï¼Œä¹Ÿå¯ä»¥ç”¨getAttribute()æ–¹æ³•æ­é…å­—ä¸²&#34;dos:hidden&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="è®€å–æª”æ¡ˆå±¬æ€§">è®€å–æª”æ¡ˆå±¬æ€§</h3>
<ul>
<li>
<p>éå» Java I/O è®€å–æª”æ¡ˆä¸€æ¬¡åªèƒ½ä¸€å€‹ï¼Œæ¯æ¬¡å‘¼å«éƒ½å¿…é ˆè½‰å‘¼å«ç³»çµ±æŒ‡ä»¤ï¼ˆsystem callï¼‰</p>
</li>
<li>
<p><code>NIO.2</code> æ”¹é€²ä»¥ä¸Šå•é¡Œï¼Œå¯ç”¨ <code>DosFileAttributes</code> interface ä¸€æ¬¡å–å›æª”æ¡ˆ / ç›®éŒ„çš„æ‰€æœ‰å±¬æ€§</p>
</li>
<li>
<p>ä»¥ Windows ä¹‹ DOS ç‚ºä¾‹ï¼Œä½¿ç”¨ Files class å–å¾—ç‰©ä»¶å¯¦ä¾‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>DosFileAttributes attrs <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">readAttributes</span><span style="color:#f92672">(</span>path<span style="color:#f92672">,</span> DosFileAttributes<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p>æ³¨æ„ Java 7 çš„ <code>DosFileAttributes</code> interface åªèƒ½è®€å–å±¬æ€§ï¼Œä¸èƒ½ä¿®æ”¹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	Path p <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir/c04/attributeTest.txt&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toAbsolutePath</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	DosFileAttributes attrs <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">readAttributes</span><span style="color:#f92672">(</span>p<span style="color:#f92672">,</span> DosFileAttributes<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// basic
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	FileTime creation <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">creationTime</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	FileTime modified <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">lastModifiedTime</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	FileTime lastAccess <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">lastAccessTime</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">long</span> size <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">boolean</span> isDirectory <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">isDirectory</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">boolean</span> isRegularFile <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">isRegularFile</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">boolean</span> isSymbolicLink <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">isSymbolicLink</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">boolean</span> isOther <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">isOther</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// only for DOS
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">boolean</span> archive <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">isArchive</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">boolean</span> hidden <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">isHidden</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">boolean</span> readOnly <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">isReadOnly</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">boolean</span> systemFile <span style="color:#f92672">=</span> attrs<span style="color:#f92672">.</span><span style="color:#a6e22e">isSystem</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/i4S6rSz.png"
        data-srcset="https://i.imgur.com/i4S6rSz.png, https://i.imgur.com/i4S6rSz.png 1.5x, https://i.imgur.com/i4S6rSz.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/i4S6rSz.png"
        title="1" /></p>
</li>
</ul>
<h3 id="ä¿®æ”¹æª”æ¡ˆå±¬æ€§">ä¿®æ”¹æª”æ¡ˆå±¬æ€§</h3>
<ul>
<li>
<p>å»ºç«‹æª”æ¡ˆå¾Œå¯ç”¨ <code>Files</code> class æ›´æ”¹å±¬æ€§</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">createFile</span><span style="color:#f92672">(</span>path<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>Files<span style="color:#f92672">.</span><span style="color:#a6e22e">setAttribute</span><span style="color:#f92672">(</span>path<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;dos:hidden&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p><code>setAttribute()</code> æ–¹æ³•å¯è¨­å®š 4 ç¨® <strong>DOS å±¬æ€§</strong>ï¼Œé ˆæŒ‡å®šå±¬æ€§å­—ä¸²</p>
<ol>
<li><strong>dos:hidden</strong></li>
<li><strong>dos:readonly</strong></li>
<li><strong>dos:system</strong></li>
<li><strong>dos:archive</strong></li>
</ol>
</li>
<li>
<p>ä»‹é¢ <code>DosFileAttributeView</code> ä¹Ÿæä¾›è¨­å®šå±¬æ€§çš„ç›¸é—œæ–¹æ³•</p>
<ol>
<li><code>setHidden()</code></li>
<li><code>setReadOnly()</code></li>
<li><code>setSystem()</code></li>
<li><code>setArchive()</code></li>
</ol>
</li>
<li>
<p>å¯ä»¥ä½¿ç”¨ class Files å–å¾—è©²ä»‹é¢çš„ç‰©ä»¶å¯¦ä¾‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>DosFileAttributeView view <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">getFileAttributeView</span><span style="color:#f92672">(</span>p<span style="color:#f92672">,</span> DosFileAttributeView<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p><code>DosFileAttributeView</code> æœ‰ç›´æ¥æ–¹æ³•å¯ä»¥è¨­å®šæª”æ¡ˆå±¬æ€§</p>
<ul>
<li>
<p>å¦‚æœè¦è®€å–å±¬æ€§ï¼Œéœ€å…ˆç”¨ <code>readAttributes()</code> æ–¹æ³•å–å¾— <code>DosFileAttributes</code>ç‰©ä»¶å¯¦ä¾‹ï¼Œåˆ†å·¥ï¼š</p>
<ol>
<li>
<p>interface <code>DosFileAttributeView</code> : <strong>æ”¹è®Š</strong> æª”æ¡ˆå±¬æ€§</p>
</li>
<li>
<p>interface <code>DosFileAttributes</code> : <strong>è®€å–</strong> æª”æ¡ˆå±¬æ€§</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Path p <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dir/cel/attributeTest.md&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">toAbsolutePath</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>DosFileAttributeView view <span style="color:#f92672">=</span> Files<span style="color:#f92672">.</span><span style="color:#a6e22e">getFileAttributeView</span><span style="color:#f92672">(</span>p<span style="color:#f92672">,</span> DosFileAttributeView<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å–å¾— DosFileAttributeView çš„æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>view<span style="color:#f92672">.</span><span style="color:#a6e22e">setArchive</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>view<span style="color:#f92672">.</span><span style="color:#a6e22e">setReadOnly</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>view<span style="color:#f92672">.</span><span style="color:#a6e22e">setHidden</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>view<span style="color:#f92672">.</span><span style="color:#a6e22e">setSystem</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FileTime lastModifiedTime <span style="color:#f92672">=</span> FileTime<span style="color:#f92672">.</span><span style="color:#a6e22e">fromMillis</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">().</span><span style="color:#a6e22e">getTime</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>FileTime lastAccessTime <span style="color:#f92672">=</span> FileTime<span style="color:#f92672">.</span><span style="color:#a6e22e">fromMillis</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">().</span><span style="color:#a6e22e">getTime</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>FileTime createTime <span style="color:#f92672">=</span> FileTime<span style="color:#f92672">.</span><span style="color:#a6e22e">fromMillis</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">().</span><span style="color:#a6e22e">getTime</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>view<span style="color:#f92672">.</span><span style="color:#a6e22e">setTimes</span><span style="color:#f92672">(</span>lastModifiedTime<span style="color:#f92672">,</span> lastAccessTime<span style="color:#f92672">,</span> createTime<span style="color:#f92672">);</span>    
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* è¨­å®šæª”æ¡ˆç›¸é—œæ™‚é–“ï¼ŒWindowsæ¯å€‹æª”æ¡ˆå±¬æ€§éƒ½æœ‰3å€‹æ™‚é–“ï¼šå»ºç«‹æ—¥æœŸ(createTime)ã€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   æœ€å¾Œä¿®æ”¹æ—¥æœŸ(lastModifiedTime)ã€æœ€å¾Œå­˜å–æ—¥æœŸ(lastAccessTime) */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>DosFileAttributes attrs <span style="color:#f92672">=</span> view<span style="color:#f92672">.</span><span style="color:#a6e22e">readAttributes</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å–å¾— DosFileAttributes çš„æ–¹æ³•
</span></span></span></code></pre></div></li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="dos-ä¹‹å¤–çš„-file-attribute-views">DOS ä¹‹å¤–çš„ File Attribute Views</h3>
<p>é™¤äº† DOS ä¹‹å¤–ï¼Œ<code>NIO.2</code> å…¶å®ƒå¯æ”¯æ´çš„ attribute views é‚„åŒ…å«</p>
<ol>
<li>
<p><code>BasicFileAttributeView</code> : æä¾›æ‰€æœ‰æª”æ¡ˆç³»çµ±éƒ½æ”¯æ´çš„åŸºæœ¬å±¬æ€§</p>
</li>
<li>
<p><code>PosixFileAttributeView</code> : æ”¯æ´ <code>POSIX</code> å®¶æ—ï¼Œä¾‹å¦‚ <code>UNIX</code></p>
</li>
<li>
<p><code>FileOwnerAttributeView</code> : æ”¯æ´æ‰€æœ‰å…·å‚™ã€Œ<strong>æª”æ¡ˆæ“æœ‰è€…</strong>ï¼ˆfile ownerï¼‰ã€æ¦‚å¿µçš„æª”æ¡ˆç³»çµ±</p>
</li>
<li>
<p><code>AclFileAttributeView</code> : æ”¯æ´è®€å¯«æª”æ¡ˆçš„ã€Œ<strong>å­˜å–æ§åˆ¶æ¸…å–®</strong>ï¼ˆaccess control listï¼‰ã€</p>
</li>
<li>
<p><code>UserDefinedFileAttributeView</code> : è®“ä½¿ç”¨è€…è‡ªè¡Œå®šç¾©</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/IiluySs.png"
        data-srcset="https://i.imgur.com/IiluySs.png, https://i.imgur.com/IiluySs.png 1.5x, https://i.imgur.com/IiluySs.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/IiluySs.png"
        title="image-20221228143511740" /></p>
</li>
</ol>
<h3 id="posix-æª”æ¡ˆç³»çµ±çš„æ¬Šé™"><code>POSIX</code> æª”æ¡ˆç³»çµ±çš„æ¬Šé™</h3>
<ul>
<li>
<p><code>NIO.2</code> å¯ä»¥åœ¨å¦‚ MacOSã€Linuxã€Solaris ç­‰ POSIXï¼ˆPortable Operating System Interfaceï¼‰æª”æ¡ˆç³»çµ±ä¸­å»ºç«‹æª”æ¡ˆ / ç›®éŒ„ã€‚Windows é POSIX ç›¸å®¹çš„ä½œæ¥­ç³»çµ±</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// å¦‚ä½•å–å¾—ç›®å‰ä½œæ¥­ç³»çµ±æ”¯æ´çš„æ‰€æœ‰ AttributeView
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>FileSystems<span style="color:#f92672">.</span><span style="color:#a6e22e">getDefault</span><span style="color:#f92672">().</span><span style="color:#a6e22e">supportedFileAttributeViews</span><span style="color:#f92672">();</span>
</span></span></code></pre></div></li>
<li>
<p>POSIX æª”æ¡ˆç³»çµ±ä¸­ï¼Œä½¿ç”¨ ACL é€²è¡Œæª”æ¡ˆ / ç›®éŒ„çš„æ¬Šé™æ§ç®¡</p>
<ul>
<li>ACLï¼ˆAccess Control List å­˜å–æ§åˆ¶æ¸…å–®ï¼‰: æä¾›å°æª”æ¡ˆ / ç›®éŒ„æ“æœ‰æ¬Šç›¸é—œçš„ä¸‰ç¨®ä½¿ç”¨è€…ç¾¤çµ„
<ol>
<li>ownerï¼ˆæª”æ¡ˆæ“æœ‰è€…ï¼‰</li>
<li>groupï¼ˆæª”æ¡ˆæ“æœ‰è€…æ‰€åœ¨ç¾¤çµ„ï¼‰</li>
<li>otherï¼ˆé owner å’Œ group çš„å…¶å®ƒäººï¼‰</li>
</ol>
</li>
</ul>
</li>
<li>
<p>å°æª”æ¡ˆ / ç›®éŒ„çš„ readã€writeã€executeï¼ˆè®€å¯«åŸ·è¡Œï¼‰æ¬Šé™è¨­å®šæ ¼å¼</p>
<table>
<thead>
<tr>
<th style="text-align:center">user</th>
<th style="text-align:center">group</th>
<th style="text-align:center">other</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">r    |    w    |    x</td>
<td style="text-align:center">r    |   w   |   x</td>
<td style="text-align:center">r   |   w   |    x</td>
</tr>
</tbody>
</table>
</li>
</ul>
<hr>
<h2 id="éè¿´å­˜å–ç›®éŒ„çµæ§‹">éè¿´å­˜å–ç›®éŒ„çµæ§‹</h2>
<h3 id="å°æª”æ¡ˆç›®éŒ„é€²è¡Œéè¿´æ“ä½œ">å°æª”æ¡ˆç›®éŒ„é€²è¡Œéè¿´æ“ä½œ</h3>
<hr>
<h2 id="ä½¿ç”¨-pathmatcher-é¡åˆ¥æ‰¾å°‹ç¬¦åˆçš„æª”æ¡ˆ">ä½¿ç”¨ <code>PathMatcher</code> é¡åˆ¥æ‰¾å°‹ç¬¦åˆçš„æª”æ¡ˆ</h2>
<h3 id="æœå°‹æª”æ¡ˆ">æœå°‹æª”æ¡ˆ</h3>
<h3 id="glob-æ¨£å¼èªæ³•ä»‹ç´¹"><code>glob</code> æ¨£å¼èªæ³•ä»‹ç´¹</h3>
<hr>
<h2 id="å…¶å®ƒ">å…¶å®ƒ</h2>
<h3 id="filestore-é¡åˆ¥"><code>FileStore</code> é¡åˆ¥</h3>
<h3 id="ä½¿ç”¨-watchservice">ä½¿ç”¨ <code>WatchService</code></h3>
<h3 id="ç”±åŸºç¤-io-è½‰æ›è‡³-nio2">ç”±åŸºç¤ I/O è½‰æ›è‡³ NIO.2</h3>
<hr>
<h1 id="05-åŸ·è¡Œç·’">05 åŸ·è¡Œç·’</h1>
<h2 id="ä»‹ç´¹">ä»‹ç´¹</h2>
<h3 id="åè©èªªæ˜">åè©èªªæ˜</h3>
<h4 id="å…ˆå å¼å¤šå·¥preemptive-multitasking">å…ˆå å¼å¤šå·¥ï¼ˆPreemptive Multitaskingï¼‰</h4>
<ul>
<li>ç¾ä»£é›»è…¦è¦åŸ·è¡Œçš„ç¨‹å¼å€‹æ•¸ç¶“å¸¸é å¤šæ–¼ CPU æ ¸æ•¸ï¼Œç‚ºäº†è®“ç¨‹å¼éƒ½å¯ä»¥æœ‰æ©ŸæœƒåŸ·è¡Œï¼Œæ¯å€‹è¦åŸ·è¡Œçš„ä»»å‹™æœƒè¢«åˆ†é…åˆ°ä¸€å°æ®µ CPU æ™‚é–“ï¼ˆtime sliceï¼‰ï¼Œä½¿æ¯å€‹ä»»å‹™éƒ½èƒ½åˆ†äº«åˆ° CPU è³‡æºä¾†å®Œæˆå·¥ä½œ</li>
<li>CPU æ™‚é–“é€šå¸¸ä»¥æ¯«ç§’ <code>milliseconds</code> ä¾†è¨ˆç®—ï¼Œä¸€æ—¦ä½¿ç”¨å®Œç•¢ï¼Œä»»å‹™å°±æš«åœåŸ·è¡Œï¼Œç­‰å¾…ä¸‹æ¬¡åˆ†é…</li>
</ul>
<h4 id="ä»»å‹™æ’ç¨‹task-scheduling">ä»»å‹™æ’ç¨‹ï¼ˆTask Schedulingï¼‰</h4>
<ul>
<li>å¤§éƒ¨åˆ†ä½œæ¥­ç³»çµ±éƒ½æ”¯æ´å¤šå·¥ï¼ˆmultitaskingï¼‰ï¼ŒæŠŠ CPU æ™‚é–“åˆ†é…çµ¦æ‰€æœ‰åŸ·è¡Œç¨‹å¼</li>
<li>ç¨‹å¼å…©å€‹é‡è¦çµ„æˆ
<ol>
<li><strong>ç¨‹åº Process</strong>
<ul>
<li>æ“æœ‰è¨˜æ†¶é«”ä¾†å„²å­˜è³‡æ–™ï¼ˆdataï¼‰å’Œç¨‹å¼ç¢¼ï¼ˆcodeï¼‰</li>
<li>ä½¿ç”¨åŸ·è¡Œç·’æ¥å—åˆ†é… CPU æ™‚é–“ä»¥åŸ·è¡Œç¨‹å¼</li>
</ul>
</li>
<li><strong>åŸ·è¡Œç·’ Thread</strong>
<ul>
<li>ç¨‹åºå¯åŒæ™‚æ“æœ‰å¤šå€‹åŸ·è¡Œç·’å„å¸å…¶è·</li>
<li>é€™äº›åŸ·è¡Œç·’å…±äº«ç¨‹åºçš„è¨˜æ†¶é«”è£¡çš„è³‡æ–™</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="å¤šåŸ·è¡Œç·’çš„é‡è¦æ€§">å¤šåŸ·è¡Œç·’çš„é‡è¦æ€§</h3>
<p>è¦è®“ç¨‹å¼å¿«é€ŸåŸ·è¡Œï¼Œå¿…é ˆé¿å…ã€Œæ•ˆèƒ½ç“¶é ¸ï¼ˆ<em>performance bottlenecks</em>ï¼‰ã€ï¼Œå¸¸è¦‹ç“¶é ¸ï¼š</p>
<ol>
<li><strong>è³‡æºç«¶çˆ­</strong>ï¼ˆ<strong>Resource Contention</strong>ï¼‰ï¼šå¤šå€‹ä»»å‹™æ¶å¥ªåŒä¸€ç¨ä½”è³‡æºï¼Œæœªæ¶åˆ°å¿…é ˆç­‰å¾…</li>
<li><strong>è¼¸å‡º/è¼¸å…¥æ“ä½œé˜»ç¤™</strong>ï¼ˆ<strong>I/O Operations Blocking</strong>ï¼‰ï¼šé€šå¸¸ç‚ºç­‰å¾…ç¡¬ç¢Ÿæˆ–ç¶²è·¯å‚³è¼¸è³‡æ–™</li>
<li><strong>CPU è³‡æºæœªå……åˆ†ä½¿ç”¨</strong>ï¼ˆ<strong>Underutilization of CPUs</strong>ï¼‰ï¼šç¨‹å¼åªç”¨åˆ°å–®æ ¸ CPU</li>
</ol>
<h3 id="åŸ·è¡Œç·’é¡åˆ¥">åŸ·è¡Œç·’é¡åˆ¥</h3>
<p>Java é¡åˆ¥ Thread çš„å…©ç¨®å»ºç«‹æ–¹å¼ï¼š</p>
<table>
<thead>
<tr>
<th>action</th>
<th>benefits/perks</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›´æ¥ç¹¼æ‰¿ Thread é¡åˆ¥</td>
<td>æ¯”è¼ƒç°¡å–®</td>
</tr>
<tr>
<td>å¯¦ä½œ Runnable ä»‹é¢</td>
<td>æ¯”è¼ƒæœ‰å½ˆæ€§ï¼Œå¯ä»¥å†ç¹¼æ‰¿å…¶å®ƒé¡åˆ¥</td>
</tr>
</tbody>
</table>
<h4 id="å»ºç«‹åŸ·è¡Œç·’ç›´æ¥ç¹¼æ‰¿-thread-é¡åˆ¥">å»ºç«‹åŸ·è¡Œç·’ï¼šç›´æ¥ç¹¼æ‰¿ Thread é¡åˆ¥</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ExampleThread</span> <span style="color:#66d9ef">extends</span> Thread <span style="color:#f92672">{</span>  <span style="color:#75715e">// #1 ç¹¼æ‰¿ java.lang.Thread é¡åˆ¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>  <span style="color:#75715e">// #2 è¦†å¯« run() æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> 100<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i:&#34;</span> <span style="color:#f92672">+</span> i<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>
<p>å•Ÿç”¨åŸ·è¡Œç·’ï¼š</p>
<ul>
<li>
<p>è¦å‘¼å« <code>start()</code> æ–¹æ³•ï¼ŒJava æœƒå•Ÿå‹•ç¨ç«‹åŸ·è¡Œç·’åŸ·è¡Œ <code>run()</code> æ–¹æ³•å…§å®¹</p>
</li>
<li>
<p>è‹¥ç›´æ¥å‘¼å« <code>run()</code> æ–¹æ³•ï¼Œå°‡å’Œä¸€èˆ¬æ–¹æ³•ç„¡ç•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Thread t1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ExampleThread<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    t1<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h4 id="å»ºç«‹åŸ·è¡Œç·’å¯¦ä½œ-runnable-ä»‹é¢">å»ºç«‹åŸ·è¡Œç·’ï¼šå¯¦ä½œ Runnable ä»‹é¢</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ExampleRunnable</span> <span style="color:#66d9ef">implements</span> Runnable <span style="color:#f92672">{</span>  <span style="color:#75715e">// #1 å¯¦ä½œ java.lang.Runnable ä»‹é¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Override</span>   
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span> <span style="color:#75715e">// #2 è¦†å¯« run() æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> 100<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i:&#34;</span> <span style="color:#f92672">+</span> i<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>
<p>è‹¥è¦ä»¥å¯¦ä½œ <code>Runnable</code> çš„é¡åˆ¥å•Ÿå‹•åŸ·è¡Œç·’ï¼Œå¯å°‡å…¶ç‰©ä»¶æ”¾å…¥ Thread é¡åˆ¥çš„å»ºæ§‹å­ï¼Œä¸¦ç”¨ <code>start()</code> å•Ÿå‹•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Runnable r1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ExampleRunnable<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    Thread t1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread<span style="color:#f92672">(</span>r1<span style="color:#f92672">);</span> <span style="color:#75715e">// å°‡ ExampleRunnable ç‰©ä»¶æ”¾å…¥ Thread constructor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    t1<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<h2 id="åŸ·è¡Œç·’å¸¸è¦‹å•é¡Œ">åŸ·è¡Œç·’å¸¸è¦‹å•é¡Œ</h2>
<p>åŸ·è¡Œç·’å¸¸é‡åˆ°å•é¡Œçš„ä¸‰é¡åŸå› ï¼š</p>
<ol>
<li>ä½¿ç”¨åˆ†äº«çš„è³‡æ–™ <em>shared data</em></li>
<li>ä½¿ç”¨å¯åˆ†æ®µçš„æ–¹æ³• <em>non-atomic function</em></li>
<li>ä½¿ç”¨å¿«å–çš„è³‡æ–™ <em>cached data</em></li>
</ol>
<h3 id="ä½¿ç”¨-shared-data-å¯èƒ½é€ æˆçš„å•é¡Œ">ä½¿ç”¨ <code>Shared Data</code> å¯èƒ½é€ æˆçš„å•é¡Œ</h3>
<p>åŸ·è¡Œç·’æœƒæ½›åœ¨ static å’Œ instance æ¬„ä½ï¼Œå¯èƒ½é€ æˆå•é¡Œå¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>åŸ·è¡Œç·’ç‰©ä»¶ç›®çš„åœ¨åŸ·è¡Œå…¶ <code>run()</code> æ–¹æ³•</p>
<ul>
<li>è‹¥å¤šå€‹åŸ·è¡Œç·’éƒ½è¦åŸ·è¡Œ <code>run()</code>ï¼Œå°±è¦æ³¨æ„è©²æ–¹æ³•å…±ç”¨çš„éƒ¨åˆ†</li>
<li>ä¾‹å¦‚ï¼šç‰©ä»¶å¯¦ä¾‹æ¬„ä½æœƒè¢«åŒæ™‚å­˜å–ï¼ˆconcurrently accessedï¼‰</li>
</ul>
</li>
<li>
<p>static æ¬„ä½åŸæœ¬å°±æ˜¯åˆ†äº«çš„è³‡æ–™ï¼Œä¹Ÿç„¡æ³•é¿å…åŒæ™‚è¢«å­˜å–çš„æƒ…æ³</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ExampleRunnable</span> <span style="color:#66d9ef">implements</span> Runnable <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> i<span style="color:#f92672">;</span>  <span style="color:#75715e">// å°‡è¢«å…±ç”¨!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> 10<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;i:&#34;</span> <span style="color:#f92672">+</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        ExampleRunnable r1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ExampleRunnable<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        Thread t1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread<span style="color:#f92672">(</span>r1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        t1<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        Thread t2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread<span style="color:#f92672">(</span>r1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        t2<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/h3ufiAX.png"
        data-srcset="https://i.imgur.com/h3ufiAX.png, https://i.imgur.com/h3ufiAX.png 1.5x, https://i.imgur.com/h3ufiAX.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/h3ufiAX.png"
        title="image-20221218163741687" /></p>
<ul>
<li>
<p>ä»¥ä¸Šçµæœå’Œé æœŸçµæœæœ‰è½å·®</p>
<p><code>i:0, i:1, i:2, i:3, i:4, i:5, i:6, i:7, i:8, i:9,</code></p>
</li>
<li>
<p>ç•¶å‰è¿°é¡åˆ¥ï¼ˆ<strong>static</strong>ï¼‰å’Œç‰©ä»¶å¯¦ä¾‹ï¼ˆ<strong>instance</strong>ï¼‰æ¬„ä½è³‡æ–™è¢«å¤šå€‹åŸ·è¡Œç·’å…±ç”¨ï¼Œå‡ºç¾åŸ·è¡Œç•°å¸¸æ™‚ï¼ŒIDE æ˜¯ç„¡æ³•è­¦å‘Šçš„</p>
</li>
<li>
<p>å› æ­¤ <em><strong>å®‰å…¨åœ°ï¼ˆsafelyï¼‰è™•ç†è¢«åˆ†äº«çš„è³‡æ–™</strong></em>ï¼Œå°±æˆç‚ºç¨‹å¼è¨­è¨ˆå¸«çš„ç¾©å‹™</p>
</li>
<li>
<p>è³‡æ–™è‹¥å› ç‚ºå¤šå€‹åŸ·è¡Œç·’åŒæ™‚å­˜å–è€Œç”¢ç”ŸéŒ¯èª¤ï¼Œä¸€èˆ¬ä¸å¥½è™•ç†</p>
<ol>
<li>Thread çš„åˆ†é…ç”±ä½œæ¥­ç³»çµ±æ±ºå®šï¼Œç¨‹å¼è¨­è¨ˆå¸«ç„¡æ³•å¹²é </li>
<li>æ¯ä¸€å°æ©Ÿå™¨çš„ CPU æ•ˆèƒ½ã€å€‹æ•¸ä¸ç›¡ç„¶ç›¸åŒ</li>
<li>å…¶å®ƒç¨‹å¼ä¹Ÿæœƒå ç”¨ CPU æ™‚é–“</li>
</ol>
</li>
<li>
<p>å› æ­¤å¯èƒ½æœ‰åœ¨æ¸¬è©¦ç’°å¢ƒç„¡ç•°å¸¸ï¼Œä½†éƒ¨ç½²åˆ°æ­£å¼ç’°å¢ƒå¾Œå»ç¶“å¸¸ç™¼ç”Ÿå¥‡æ€ªç‹€æ³</p>
<ul>
<li>ç›¡å¯èƒ½ä½¿ç”¨åŸ·è¡Œç·’å®‰å…¨çš„è¨­è¨ˆï¼ˆthread-safeï¼‰ï¼Œæ¸›å°‘ä½¿ç”¨ <code>shared data</code></li>
</ul>
</li>
<li>
<p>é¡åˆ¥å…§æœ‰äº›è³‡æ–™ä¸æœƒè¢«å¤šåŸ·è¡Œç·’åˆ†äº«ï¼Œæ°¸é éƒ½ <code>thread-safe</code> çš„ä¾‹å­</p>
<ol>
<li>å€åŸŸè®Šæ•¸ <em>local variables</em></li>
<li>æ–¹æ³•åƒæ•¸ <em>method parameters</em></li>
<li>ä¾‹å¤–è™•ç†åƒæ•¸ <em>exception handler parameters</em></li>
</ol>
</li>
</ul>
</li>
</ol>
<h3 id="ä½¿ç”¨-non-atomic-functions-å¯èƒ½é€ æˆçš„å•é¡Œ">ä½¿ç”¨ <code>Non-Atomic Functions</code> å¯èƒ½é€ æˆçš„å•é¡Œ</h3>
<ul>
<li><code>atomic function</code> - ç”¨åŸå­çš„æ¦‚å¿µæè¿°ä¸€å€‹åŠŸèƒ½
<ul>
<li>åŸå­ç„¡æ³•å†åˆ†å‰²ï¼Œä»£è¡¨ <code>single function</code>ï¼Œå³è©²åŠŸèƒ½åªæœ‰ä¸€å€‹æ­¥é©Ÿ</li>
</ul>
</li>
<li>Java è£¡ï¼Œå³ä½¿ç¨‹å¼ç¢¼åªæœ‰ä¸€å¥æ•˜è¿°ï¼Œä¹Ÿä¸ä»£è¡¨å®ƒå°±æ˜¯ <code>atomic function</code>
<ul>
<li>ä»¥æ•´æ•¸ i ä½¿ç”¨ éå¢é‹ç®—å­çš„ <code>i++</code> ç‚ºä¾‹ï¼ŒJava ä»¥ 3 å€‹æ­¥é©ŸåŸ·è¡Œ
<ol>
<li>å°æ•´æ•¸ <code>i</code> å»ºç«‹æš«æ™‚å‰¯æœ¬</li>
<li>æš«æ™‚å‰¯æœ¬å¢åŠ  1</li>
<li>å°‡æš«æ™‚å‰¯æœ¬çš„çµæœå›å¯« <code>i</code></li>
</ol>
</li>
<li>å¦å¤–æœ‰äº› 64 bit è®Šæ•¸çš„å­˜å–ä¹Ÿå¯ä»¥ä½¿ç”¨ 2 å€‹ 32 bit çš„æ“ä½œå®Œæˆ</li>
</ul>
</li>
</ul>
<h3 id="ä½¿ç”¨-cached-data-å¯èƒ½é€ æˆçš„å•é¡Œ">ä½¿ç”¨ <code>Cached Data</code> å¯èƒ½é€ æˆçš„å•é¡Œ</h3>
<ul>
<li>åŸ·è¡Œç·’ <code>thread</code> å› ç‚ºç¨‹åº <code>process</code> éœ€è¦åŒæ™‚åŸ·è¡Œä¸åŒå·¥ä½œè€Œç”¢ç”Ÿ</li>
<li>ç‚ºæ±‚åŸ·è¡Œæ•ˆèƒ½ï¼ŒåŸ·è¡Œç·’å•Ÿå‹•æ™‚ï¼Œæœƒå°‡ç¨‹åºä¸­çš„ <code>main memory</code> å…§çš„åˆ†äº«è³‡æ–™è¤‡è£½ä¸€ä»½ï¼Œæ”¾åœ¨è‡ªå·±çš„ <code>working memory</code> ä½œç‚ºå¿«å–è¤‡è£½ï¼ˆ<code>cached copies</code>ï¼‰ï¼Œå·¥ä½œçµæŸå¾Œå¯«å›ï¼Œå¦‚æ­¤ä¸€ä¾†å¯ä»¥é¿å…ç¨‹å¼é€²è¡Œéç¨‹ä¸­ï¼ŒåŸ·è¡Œç·’å¿…é ˆä¸æ–·å‘ç¨‹åºè¦æ±‚è³‡æ–™è€Œé€ æˆçš„æ•ˆç‡å•é¡Œ</li>
<li>é€™æ¨£çš„è¨­è¨ˆï¼Œè®“åŸ·è¡Œéç¨‹ä¸­çš„æ¯ä¸€åŸ·è¡Œç·’å„è‡ªåŠªåŠ›ï¼Œç„¡æ³•<strong>å³æ™‚</strong>å’Œå…¶ä»–åŸ·è¡Œç·’åˆ†äº«å·¥ä½œæˆæœï¼Œå¿…é ˆç­‰åˆ°å·¥ä½œçµæŸ</li>
<li>åªæœ‰ä»¥ä¸‹æƒ…æ³æ‰èƒ½è®“åŸ·è¡Œç·’å°‡å„è‡ª working memory çš„ç•°å‹•çµæœå¯«å› main memoryï¼š
<ol>
<li>ä½¿ç”¨åˆ° <code>volatile</code> å®£å‘Šçš„è®Šæ•¸</li>
<li>ä½¿ç”¨åˆ° <code>synchronized</code> å®£å‘Šçš„æ–¹æ³•ï¼Œäº¦å³æº–å‚™é–å®šå’Œè§£ç´¢ç‰©ä»¶ monitor</li>
<li>åŸ·è¡Œç·’åŸ·è¡Œæ™‚çš„ç¬¬ä¸€å€‹å‹•ä½œæˆ–æœ€å¾Œä¸€å€‹å‹•ä½œ</li>
<li>åŸ·è¡Œç·’å•Ÿå‹•æˆ–åŸ·è¡Œç·’çµæŸæ™‚</li>
</ol>
</li>
<li>è‹¥ç¨‹å¼è¨­è¨ˆéœ€è¦å¤šåŸ·è¡Œç·’åœ¨å·¥ä½œéç¨‹ä»ç„¶èƒ½äº’ç›¸æºé€šè¨Šæ¯ï¼Œå°±å¿…é ˆå–„ç”¨ä¸Šè¿°å››å€‹æ¢ä»¶
<ul>
<li>å°¤å…¶æ˜¯ä½¿ç”¨ <code>volatile</code> é—œéµå­—å®£å‘Šï¼Œå…¶ç”±ä¾†å’Œä½¿ç”¨æ–¹å¼ï¼š
<ol>
<li>ç¨‹å¼è¨­è¨ˆä¸­ï¼Œå¦‚æœè³‡æ–™ç¶“å¸¸ç¶­æŒä¸è®Šï¼Œå¯ä»¥å°‡ä¹‹å›ºå®šåœ¨è¨˜æ†¶é«”è£¡ï¼Œæˆ–è¤‡è£½å‡ºä¾†ä½¿ç”¨ï¼Œç¨±ä¹‹ç‚ºã€Œ<strong>å¿«å–è¤‡è£½</strong>ï¼ˆcached copiesï¼‰ã€</li>
<li>å–®å­— <code>volatile</code> è§£é‡‹ç‚ºã€Œ<strong>æ˜“è®Šçš„ã€åè¦†ç„¡å¸¸çš„</strong>ã€ï¼š
<ul>
<li>åŠ ä¸Šæ­¤å®£å‘Šç›¸ç•¶æ–¼å‘Šè¨´ Java è©²æ¬„ä½ç¶“å¸¸æœ‰è®ŠåŒ–ï¼Œä¸é©åˆç”¢ç”Ÿå¿«å–è¤‡è£½</li>
<li>å› æ­¤æ‰€æœ‰åŸ·è¡Œç·’å°‡çš†å­˜å–åŒä¸€ä»½è³‡æ–™ï¼Œä¾‹ï¼š<code>volatile int i;</code></li>
</ul>
</li>
<li>å¿…é ˆäº†è§£å®£å‘Š <code>volatile</code> åªæ˜¯ä¸ç”¢ç”Ÿå¿«å–è¤‡è£½ï¼Œå’ŒåŸ·è¡Œç·’å®‰å…¨æ˜¯å…©å›äº‹
<ul>
<li>é‚„æ˜¯å¿…é ˆåˆ©ç”¨å…ˆå‰æ‰€æçš„ä½œæ³•ä¾†ä¿è­‰åŸ·è¡Œç·’å®‰å…¨</li>
<li>volatile å®£å‘Šå¯ä»¥æ‡‰ç”¨åœ¨ã€Œç²¾æº–çµ‚æ­¢åŸ·è¡Œç·’çš„åŸ·è¡Œã€</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JAVA" data-lang="JAVA"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyRunnable</span> <span style="color:#66d9ef">implements</span> Runnable <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">volatile</span> <span style="color:#66d9ef">boolean</span> running <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>  <span style="color:#75715e">// line 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thread started&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>running<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thread finishing&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StopThreadExample</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        MyRunnable r1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> MyRunnable<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        Thread t1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread<span style="color:#f92672">(</span>r1<span style="color:#f92672">);</span>       <span style="color:#75715e">// line 16
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        t1<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        r1<span style="color:#f92672">.</span><span style="color:#a6e22e">running</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span> <span style="color:#75715e">// line 19 : terminate the thread immediately
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</span></span></code></pre></div><table>
<thead>
<tr>
<th>line#</th>
<th>desc</th>
</tr>
</thead>
<tbody>
<tr>
<td>16</td>
<td>thread <code>t1</code> åœ¨å•Ÿå‹•å‰<strong>é è¨­</strong>æœƒè‡ªå·±è¤‡è£½ä¸€ä»½è®Šæ•¸ runningï¼ˆå€¼=trueï¼‰ä½œç‚ºå¿«å–è¤‡è£½</td>
</tr>
<tr>
<td>2</td>
<td>æ‰€ä»¥å¦‚æœæ²’æœ‰å®£å‘Šè®Šæ•¸ running ç‚º <code>volatile</code></td>
</tr>
<tr>
<td>19</td>
<td>å³ä¾¿åœ¨ main åŸ·è¡Œç·’å°‡ running æ”¹ç‚º falseï¼ŒåŸ·è¡Œç·’ t1 ä¸ä¸€å®šæœƒé¦¬ä¸ŠçŸ¥é“ï¼Œå¿…é ˆç­‰åˆ°æœ‰äº‹ä»¶è§¸ç™¼ï¼Œè®“ working memory å’Œ main memory åŒæ­¥ï¼ŒåŸ·è¡Œç·’ <code>t1</code> æ‰æœƒæ”¶åˆ°é€šçŸ¥è€Œåœæ­¢</td>
</tr>
</tbody>
</table>
<p>&hellip;</p>
<h2 id="åŸ·è¡Œç·’çš„-synchronized-èˆ‡ç­‰å¾…">åŸ·è¡Œç·’çš„ synchronized èˆ‡ç­‰å¾…</h2>
<h3 id="ä½¿ç”¨-synchronized-é—œéµå­—">ä½¿ç”¨ <code>synchronized</code> é—œéµå­—</h3>
<ul>
<li>
<p>å»ºç«‹åŸ·è¡Œç·’å®‰å…¨çš„ç¨‹å¼ï¼Œé™¤äº†ç›¡é‡ä½¿ç”¨åŸ·è¡Œç·’å®‰å…¨çš„è®Šæ•¸ä¹‹å¤–ï¼Œå°±æ˜¯ä½¿ç”¨ã€Œ<strong>synchronized</strong>ã€é—œéµå­—å®£å‘Š<em>æ–¹æ³•</em>æˆ–æ˜¯<em>æ›´å°çš„ç¨‹å¼ç¢¼å€å¡Š</em>ï¼š</p>
<ol>
<li><code>synchronized</code> å’Œ <code>volatile</code> å®£å‘Šæœ‰é¡ä¼¼åŠŸç”¨ï¼š
<ul>
<li>åŸ·è¡Œç·’åœ¨åŸ·è¡Œè©²å€å¡Šçš„æœ€åˆå’Œæœ€å¾Œæ™‚ï¼Œæœƒå°‡è®Šæ•¸å€¼å¯«å› main memory</li>
</ul>
</li>
<li>è©²å€å¡Šç‚ºç¨å åŸ·è¡Œï¼ˆ<em>exclusive execution</em>ï¼‰ï¼š
<ul>
<li>äº¦å³åŒä¸€æ™‚é–“åªå…è¨±ä¸€å€‹åŸ·è¡Œç·’ä½¿ç”¨</li>
<li>å¯è§£æ±º <code>non-atomic</code>å•é¡Œï¼Œæ‰€ä»¥å€å¡Šå…§ç‚ºåŸ·è¡Œç·’å®‰å…¨</li>
</ul>
</li>
</ol>
</li>
<li>
<p>åŸ·è¡Œç·’å–å¾—ç¨å åŸ·è¡Œæ¬Šçš„æ©Ÿåˆ¶ï¼š</p>
<ol>
<li>
<p>æ¯å€‹ Java ç‰©ä»¶éƒ½æœ‰ä¸€å€‹ã€Œ<strong>object monitor</strong>ã€ï¼ŒåŸ·è¡Œç·’å¯ä»¥å°å®ƒé€²è¡Œé–å®šï¼ˆlockï¼‰å’Œè§£é–ï¼ˆunlockï¼‰</p>
<ul>
<li>è‹¥é–å®šæˆåŠŸï¼Œè¡¨ç¤ºå–å¾—è©²ç‰©ä»¶çš„ç¨å åŸ·è¡Œæ¬Š</li>
<li>æ­¤æ™‚å…¶å®ƒåŸ·è¡Œç·’ç„¡æ³•ä½¿ç”¨è©²ç‰©ä»¶çš„ <code>synchronized</code> ç¨‹å¼å€å¡Šï¼Œç­‰åŒå–®ä¸€åŸ·è¡Œç·’ç’°å¢ƒ</li>
</ul>
</li>
<li>
<p>è¦ä½¿ç”¨å®£å‘Š <code>synchronized</code> çš„æ–¹æ³•ï¼Œå°±å¿…é ˆå–å¾—ã€Œ<strong>this</strong>ã€çš„ object monitor</p>
</li>
<li>
<p>è¦ä½¿ç”¨å®£å‘Š <code>static</code> çš„æ–¹æ³•ï¼ŒåŒç†ä¹Ÿå¿…é ˆå–å¾—é¡åˆ¥çš„ã€Œ<strong>class monitor</strong>ã€</p>
</li>
<li>
<p>è¦ä½¿ç”¨å®£å‘Š <code>synchronized</code> å€å¡Šï¼Œå¿…é ˆæŒ‡å®šè¦ä½¿ç”¨å“ªä¸€å€‹ç‰©ä»¶çš„ monitor</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">synchronized</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p>ä½¿ç”¨ <code>synchronized</code> å€å¡Šå¯ä»¥æœ‰å·¢ç‹€çµæ§‹ï¼Œä¸”å¯ä»¥ä½¿ç”¨ä¸åŒçš„ object monitor</p>
</li>
</ol>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SynchronizedAll</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sleep</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>5000<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException e<span style="color:#f92672">)</span> <span style="color:#f92672">{}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">m1</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		sleep<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;-- Run m1() at: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">m2</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		sleep<span style="color:#f92672">();</span>	
</span></span><span style="display:flex;"><span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;-- Run m2() at: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> <span style="color:#75715e">/* å°‡å…©å€‹publicæ–¹æ³•éƒ½å®£å‘Šç‚ºsynchronizedï¼Œå¦‚æ­¤å»ºç«‹å‡ºçš„ç‰©ä»¶ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     m1()å’Œm2()æ–¹æ³•å°‡åŒæ™‚åªèƒ½æœ‰ä¸€å€‹è¢«å‘¼å«åŸ·è¡Œ */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">M1Runner</span> <span style="color:#66d9ef">extends</span> Thread <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	SynchronizedAll o<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	M1Runner<span style="color:#f92672">(</span>SynchronizedAll o<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">o</span> <span style="color:#f92672">=</span> o<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å»ºç«‹åŸ·è¡Œç·’é¡åˆ¥M1Runnerï¼Œåœ¨å»ºæ§‹å­å‚³å…¥ä¸€å€‹SynchronizedAllç‰©ä»¶å¾Œï¼Œå‘¼å«m1()æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		o<span style="color:#f92672">.</span><span style="color:#a6e22e">m1</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">M2Runner</span> <span style="color:#66d9ef">extends</span> Thread <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	SynchronizedAll o<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	M2Runner<span style="color:#f92672">(</span>SynchronizedAll o<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">o</span> <span style="color:#f92672">=</span> o<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å»ºç«‹åŸ·è¡Œç·’é¡åˆ¥M2Runnerï¼Œåœ¨å»ºæ§‹å­å‚³å…¥ä¸€å€‹SynchronizedAllç‰©ä»¶å¾Œï¼Œå‘¼å«m2()æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		o<span style="color:#f92672">.</span><span style="color:#a6e22e">m2</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SynchronizedTest</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		SynchronizedAll o <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SynchronizedAll<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>         <span style="color:#75715e">// å»ºç«‹ä¸€å€‹ SynchronizedAll ç‰©ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        
</span></span><span style="display:flex;"><span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Start main at: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>		Thread m1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> M1Runner<span style="color:#f92672">(</span>o<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		m1<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å»ºç«‹ M1Runner åŸ·è¡Œç·’ç‰©ä»¶ï¼Œä¸¦å‚³å…¥ä¹‹å‰å»ºç«‹çš„ SynchronizedAll ç‰©ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        
</span></span><span style="display:flex;"><span>		Thread m2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> M2Runner<span style="color:#f92672">(</span>o<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		m2<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å»ºç«‹ M2Runner åŸ·è¡Œç·’ç‰©ä»¶ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// ä¸¦å‚³å…¥å’Œ M1Runner æ‰€å‚³å…¥çš„ç›¸åŒçš„ SynchronizedAll ç‰©ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">//m1.interrupt();
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;End main at: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><blockquote>
<p>å› ç‚º <code>SynchronizedAll</code> å…§ <code>m1()</code> åŠ <code>m2()</code> æ–¹æ³•éƒ½æ˜¯ <code>synchronized</code>ï¼Œè¦åŸ·è¡Œéƒ½è¦å–å¾— this çš„ object monitorï¼Œå› æ­¤åŒæ™‚é–“åªèƒ½æœ‰ä¸€å€‹æ–¹æ³•è¢«å‘¼å«</p>
</blockquote>
<h3 id="ä½¿ç”¨-synchronized-çš„æ™‚æ©Ÿ">ä½¿ç”¨ <code>synchronized</code> çš„æ™‚æ©Ÿ</h3>
<ul>
<li><code>java.util.ConcurrentModificationException</code> :
<ul>
<li>å¦‚æœ Java åµæ¸¬åˆ°é›†åˆç‰©ä»¶çš„å…§å®¹å°‡è¢«åŒæ™‚ä¿®æ”¹ï¼ˆä¸é™å®šæ˜¯å¦å¤šåŸ·è¡Œç·’æ‰€ç‚ºï¼‰ï¼Œå°±æœƒæ‹‹å‡º <code>ConcurrentModificationException</code>
<ul>
<li>æ­¤ç‚ºã€Œ<strong>fail-fast</strong>ã€è¡Œç‚ºæ¨¡å¼ï¼Œäº¦å³å°æ–¼éŒ¯èª¤æˆ–æ˜¯å¯èƒ½é€ æˆéŒ¯èª¤çš„æƒ…æ³ï¼Œé¦¬ä¸Šä½œå‡ºåæ‡‰</li>
<li>ç‚ºäº†é¿å…ç™¼ç”Ÿ <strong>fail-fast</strong> ç‹€æ³ï¼Œæ‡‰é¿å…åœ¨åŸ·è¡Œ <code>getSummary()</code> æ–¹æ³•æ™‚ï¼Œå…¶å®ƒ 2 å€‹æ–¹æ³•è¢«åŒæ™‚å‘¼å«
<ul>
<li>å¯ä»¥å°‡é€™ä¸‰å€‹æ–¹æ³•éƒ½å®£å‘Šç‚º <code>synchronized</code>ï¼Œå¦‚æ­¤è¦å‘¼å«æ–¹æ³•å‰ï¼Œå¿…é ˆå–å¾—è©²ç‰©ä»¶çš„å”¯ä¸€ <strong>object monitor</strong>ï¼Œå°±ä¸æœƒæœ‰è¢«åŒæ™‚åŸ·è¡Œçš„å¯èƒ½æ€§</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code>ConcurrentModificationException</code> ä¸æ˜¯åªæœ‰åœ¨å¤šåŸ·è¡Œç·’çš„æƒ…æ³ä¸‹æ‰æœƒç™¼ç”Ÿ
<ul>
<li>ä»¥ä¸‹çš„ <strong>fail-fast_1</strong> æˆ– <strong>fail-fast_2</strong> æœƒæ‹‹å‡º <code>ConcurrentModificationException</code>
<ul>
<li>åŸå› ï¼šä½¿ç”¨ iterator æˆ–é€²éš for-loop èµ°è¨ª map ç‰©ä»¶æˆå“¡ï¼ŒåŒæ™‚å»åˆªé™¤ map æˆå“¡</li>
<li>é¿å…æ–¹æ³•ï¼š
<ul>
<li>è¤‡è£½ mapï¼Œè®“æ–°è¤‡è£½çš„ map ç”¨æ–¼èµ°è¨ªæˆå“¡</li>
<li>å†ç”¨å–å¾—çš„ key åˆªé™¤å¦å¤–ä¸€å€‹ map ç‰©ä»¶çš„æˆå“¡</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConcurrentModificationExceptionTest</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        Map<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;</span> map <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>        map<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        map<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        map<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span>3<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;c&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// fail-fast 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            Iterator<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> iter <span style="color:#f92672">=</span> map<span style="color:#f92672">.</span><span style="color:#a6e22e">keySet</span><span style="color:#f92672">().</span><span style="color:#a6e22e">iterator</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>iter<span style="color:#f92672">.</span><span style="color:#a6e22e">hasNext</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                Integer key <span style="color:#f92672">=</span> iter<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>key <span style="color:#f92672">&gt;=</span> 2<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    map<span style="color:#f92672">.</span><span style="color:#a6e22e">remove</span><span style="color:#f92672">(</span>key<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>java<span style="color:#f92672">.</span><span style="color:#a6e22e">util</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ConcurrentModificationException</span> e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// fail-fast 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Integer key <span style="color:#f92672">:</span> map<span style="color:#f92672">.</span><span style="color:#a6e22e">keySet</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>key <span style="color:#f92672">&gt;=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    map<span style="color:#f92672">.</span><span style="color:#a6e22e">remove</span><span style="color:#f92672">(</span>key<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>java<span style="color:#f92672">.</span><span style="color:#a6e22e">util</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ConcurrentModificationException</span> e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="ç¸®å°-synchronized-çš„ç¨‹å¼å€å¡Š">ç¸®å° synchronized çš„ç¨‹å¼å€å¡Š</h3>
<ul>
<li>
<p>ç‰©ä»¶è£¡æ‰€æœ‰ synchronized æ–¹æ³•åœ¨åŸ·è¡Œå‰ï¼Œéƒ½å¿…é ˆå–å¾— object monitor</p>
</li>
<li>
<p>å› æ­¤å¦‚æœè¶Šå¤šæ–¹æ³•ä½¿ç”¨ synchronizedï¼Œæˆ–æ˜¯è¢« synchronized çš„æ–¹æ³•å…§å®¹è¶Šé•·ï¼Œéƒ½æœƒé€ æˆåŸ·ã€Œè¡Œç­‰å¾…ã€</p>
</li>
<li>
<p>ç›¡å¯èƒ½ä½¿ç”¨ synchronized ç¨‹å¼å€å¡Šï¼Œè€Œéç›´æ¥ synchronized æ•´å€‹æ–¹æ³•</p>
</li>
<li>
<p>æ¸›å°‘è¢« synchronized çš„ç¨‹å¼ç¢¼ï¼Œæœ‰åŠ©æ–¼æ¸›å°‘ã€ŒåŸ·è¡Œç­‰å¾…ã€çš„æƒ…æ³</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getSummary</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    StringBuilder note <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuilder<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">synchronized</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>              <span style="color:#75715e">// line 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        Iterator<span style="color:#f92672">&lt;</span>Item<span style="color:#f92672">&gt;</span> iter <span style="color:#f92672">=</span> cart<span style="color:#f92672">.</span><span style="color:#a6e22e">iterator</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>iter<span style="color:#f92672">.</span><span style="color:#a6e22e">hasNext</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            Item i <span style="color:#f92672">=</span> iter<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            note<span style="color:#f92672">.</span><span style="color:#a6e22e">append</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Item:&#34;</span> <span style="color:#f92672">+</span> i<span style="color:#f92672">.</span><span style="color:#a6e22e">desc</span><span style="color:#f92672">()</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>  <span style="color:#75715e">// line 9
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> note<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><blockquote>
<p>å¯ä»¥ç›´æ¥æŠŠ <code>getSummary()</code> å®£å‘Šç‚º synchronized æ–¹æ³•ï¼Œ</p>
<p>ä½†æ¯”è¼ƒå¥½çš„åšæ³•æ˜¯æª¢è¨æ–¹æ³•å…§çœŸæ­£å½±éŸ¿åŸ·è¡Œç·’å®‰å…¨çš„ç¨‹å¼ç¢¼ã€‚</p>
<ul>
<li>
<p>line 3 ~ line 9 : synchronized ç¨‹å¼ç¢¼å€å¡Šå¯è®“å½±éŸ¿å€åŸŸç¸®å°</p>
</li>
<li>
<p>æ ¹æ“š line 3 å®£å‘Š : è¦åŸ·è¡Œæœ¬å€å¡Šå¿…é ˆå–å¾— this çš„ object monitor</p>
</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="å…¶å®ƒåŸ·è¡Œç­‰å¾…çš„æƒ…æ³">å…¶å®ƒåŸ·è¡Œç­‰å¾…çš„æƒ…æ³</h3>
<p>é™¤äº† synchronized ç¨‹å¼å€å¡Šé€ æˆçš„åŸ·è¡Œç­‰å¾…ï¼Œé‚„æœ‰ä»¥ä¸‹å¹¾ç¨®æƒ…å½¢å¿…é ˆé é˜²</p>
<h4 id="1-starvation--å› æ¶ä¸åˆ°è³‡æºè€Œæ’éšŠ">1. <strong>Starvation</strong> : å› æ¶ä¸åˆ°è³‡æºè€Œæ’éšŠ</h4>
<ul>
<li>æŒ‡å…©å€‹åŸ·è¡Œç·’å…±æ¶ä¸€å€‹è³‡æºï¼Œå…¶ä¸­æŸä¸€å€‹ç¶“å¸¸å¯ä»¥å–å¾—è³‡æºï¼ˆ<em>è²ªå¿ƒåŸ·è¡Œç·’ï¼Œgreedy thread</em>ï¼‰</li>
<li>å¦å¤–ä¸€å€‹ç¶“å¸¸ç„¡æ³•å–å¾—è³‡æºï¼ˆ<em>é£¢é¤“åŸ·è¡Œç·’ï¼Œstarved thread</em>ï¼‰</li>
</ul>
<h4 id="2-live-lock--å› å¤ªå¿™ç¢Œè€Œæ’éšŠ">2. Live Lock : å› å¤ªå¿™ç¢Œè€Œæ’éšŠ</h4>
<ul>
<li>æŒ‡å¤šå€‹åŸ·è¡Œç·’å› ç‚ºç­‰å¾…è³‡æºè€Œæ’éšŠï¼Œthread_B ç­‰ thread_Aã€thread_C ç­‰ thread_Bã€thread_D ç­‰ thread_C</li>
<li>thread_A å®Œæˆå¯ä»¥è¼ªåˆ° thread_Bï¼Œthread_B å®Œæˆè¼ªåˆ° thread_Cï¼Œä»¥æ­¤é¡æ¨</li>
</ul>
<h4 id="3-dead-lock--2-å€‹åŸ·è¡Œç·’äº’ç›¸çµ†ä½å°æ–¹å°è‡´æ°¸é ç­‰å¾…">3. Dead Lock : 2 å€‹åŸ·è¡Œç·’äº’ç›¸çµ†ä½å°æ–¹ï¼Œå°è‡´æ°¸é ç­‰å¾…</h4>
<ul>
<li>
<p>thread_A : å¿…é ˆå…ˆå¾Œå–å¾—ã€Œè³‡æº1ã€å’Œã€Œè³‡æº2ã€</p>
</li>
<li>
<p>thread_B : å¿…é ˆå…ˆå¾Œå–å¾—ã€Œè³‡æº2ã€å’Œã€Œè³‡æº1ã€</p>
</li>
<li>
<p>Deadlock æƒ…æ³ : A æŒæœ‰è³‡æº 1ï¼Œç­‰å¾…è³‡æº 2ï¼›æ­¤æ™‚ B æŒæœ‰è³‡æº 2ï¼Œç­‰å¾…è³‡æº 1</p>
<ul>
<li>é™¤é Thread-A æˆ– Thread-B å…¶ä¸­æœ‰ä¸€æ–¹è®“å‡ºè³‡æºæˆ–è¢«çµ‚æ­¢ï¼Œæ‰èƒ½çµæŸ Deadlock</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/yoRNlvk.png"
        data-srcset="https://i.imgur.com/yoRNlvk.png, https://i.imgur.com/yoRNlvk.png 1.5x, https://i.imgur.com/yoRNlvk.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/yoRNlvk.png"
        title="image-20221219105806769" /></p>
</li>
</ul>
<blockquote>
<p>ğŸªâ˜• <strong>Little Tips</strong></p>
<p>è¦ç”¢ç”Ÿ dead lock éœ€è¦ 2 å€‹åŸ·è¡Œç·’å’Œ 2 å€‹è¢«æ¶å¥ªçš„è³‡æºç‰©ä»¶ã€‚</p>
<p>è³‡æºå¯ä»¥æ˜¯ä»»ä½•ç‰©ä»¶ï¼Œä½¿ç”¨ <code>new Object()</code> éƒ½å¯ä»¥ã€‚e.g.:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">final</span> String resource1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jim1&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">final</span> String resource2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jim2&#34;</span><span style="color:#f92672">;</span>
</span></span></code></pre></div><p>å› ç‚ºå­—ä¸²æ± æœ‰é‡è¤‡ä½¿ç”¨ç›¸åŒå…§å®¹å­—ä¸²çš„æ©Ÿåˆ¶ï¼Œè‹¥æ”¹ç‚ºä»¥ä¸‹å…§å®¹ï¼Œå‰‡å…©å€‹è®Šæ•¸<strong>å¯¦éš›æŒ‡å‘åŒä¸€å€‹å­—ä¸²ç‰©ä»¶</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">final</span> String resource1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jim&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">final</span> String resource2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jim&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å› ç‚ºè¢«æ¶å¥ªçš„è³‡æºåªæœ‰ä¸€å€‹ï¼Œç„¡æ³•æ§‹æˆ dead lock
</span></span></span></code></pre></div></blockquote>
<p>&hellip;</p>
<h2 id="å…¶å®ƒåŸ·è¡Œç·’æ–¹æ³•ä»‹ç´¹">å…¶å®ƒåŸ·è¡Œç·’æ–¹æ³•ä»‹ç´¹</h2>
<h3 id="ä½¿ç”¨-interrupt-æ–¹æ³•">ä½¿ç”¨ <code>interrupt()</code> æ–¹æ³•</h3>
<p>é™¤äº†åˆ©ç”¨ <code>volatile</code> å®£å‘Šçš„è®Šæ•¸ä¾†åœæ­¢åŸ·è¡Œä¸­çš„åŸ·è¡Œç·’ï¼Œä¹Ÿå¯ä»¥ç”¨ <code>interrupt()</code> æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InterruptedRunnable</span> <span style="color:#66d9ef">implements</span> Runnable <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thread started&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(!</span>Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">interrupted</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* åŸ·è¡Œä¸­çš„åŸ·è¡Œç·’å¯è—‰ç”± interrupted æ–¹æ³•ä¸æ–·ç¢ºèªæ˜¯å¦æ”¶åˆ°ä¸­æ–·æŒ‡ä»¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">               è‹¥æ˜¯ï¼Œå°±ä¸­æ–·ç›®å‰åŸ·è¡Œå·¥ä½œ */</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;I am running...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thread finishing&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InterruptThreadExample</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        InterruptedRunnable r1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> InterruptedRunnable<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        Thread t1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread<span style="color:#f92672">(</span>r1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        t1<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>1<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException e<span style="color:#f92672">)</span> <span style="color:#f92672">{}</span>
</span></span><span style="display:flex;"><span>        t1<span style="color:#f92672">.</span><span style="color:#a6e22e">interrupt</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å°åŸ·è¡Œä¸­çš„åŸ·è¡Œç·’ä¸‹é” interrupt æŒ‡ä»¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="ä½¿ç”¨-sleep-æ–¹æ³•">ä½¿ç”¨ <code>sleep()</code> æ–¹æ³•</h3>
<p>è‹¥è¦ä½¿åŸ·è¡Œç·’æš«åœï¼Œå¯ä»¥å‘¼å« class Thread çš„éœæ…‹ <code>sleep()</code> æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">native</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span><span style="color:#66d9ef">long</span> millis<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> InterruptedException<span style="color:#f92672">;</span>
</span></span></code></pre></div><ul>
<li>
<p>å‘¼å« <code>Thread.sleep(4000)</code> å³æš«åœåŸ·è¡Œ 4 ç§’é˜ï¼Œ4 ç§’ä¹‹å¾Œå†ç­‰å¾… CPU åˆ†é…æ™‚é–“</p>
<ul>
<li>æ‹¿åˆ°æ‰èƒ½ç¹¼çºŒåŸ·è¡Œä»»å‹™ï¼Œåœæ­¢æ™‚é–“ã€Œ<strong>è‡³å°‘</strong>ã€ç‚º 4 ç§’é˜</li>
</ul>
</li>
<li>
<p>ä¼‘çœ ä¸­çš„åŸ·è¡Œç·’éš¨æ™‚æœ‰è¢«å«é†’è€Œä¸­æ–·ä¼‘çœ çš„å¯èƒ½ï¼Œæ‰€ä»¥è¢«è¦æ±‚å¿…é ˆè™•ç† <code>InterruptedException</code></p>
<ul>
<li>
<p>ä¸¦åœ¨ catch block ä¸­æ±ºå®šè¢«çµ‚æ­¢ä¼‘çœ å¾Œè¦åšçš„äº‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">long</span> start <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">currentTimeMillis</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>4000<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// what to do?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">long</span> time <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">currentTimeMillis</span><span style="color:#f92672">()</span> <span style="color:#f92672">-</span> start<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Slept for &#34;</span> <span style="color:#f92672">+</span> time <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;ms&#34;</span><span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="ä½¿ç”¨å…¶å®ƒæ–¹æ³•">ä½¿ç”¨å…¶å®ƒæ–¹æ³•</h3>
<p>Class Thread çš„å…¶å®ƒå¸¸ç”¨æ–¹æ³•ï¼š</p>
<p>ä»¥ä¸‹ 3 å€‹æ–¹æ³•ç¹¼æ‰¿è‡ª Object classï¼š</p>
<ol>
<li>
<p><code>wait()</code>ï¼šä¸é™æ™‚é–“çš„ç­‰å¾…ï¼Œç­‰å€™ <code>notify()</code> è¢«å‘¼å«å¾Œé†’éä¾†</p>
</li>
<li>
<p><code>notify()</code> å’Œ <code>notifyAll()</code> : é€šçŸ¥ <code>wait()</code> ä¸­çš„åŸ·è¡Œç·’</p>
<blockquote>
<p>ğŸªâ˜• <strong>Little Tips</strong></p>
<p><code>daemon</code> : åœ¨å¤šåŸ·è¡Œç·’çš„æƒ…å½¢ä¸‹ï¼Œç„¡æ³•å½±éŸ¿ JVM çš„çµæŸ</p>
</blockquote>
</li>
</ol>
<p>ä»¥ä¸‹ç¤ºç¯„ <code>join()</code> å’Œ <code>setDaemon()</code> ä¹‹ä½¿ç”¨æ–¹å¼èˆ‡å…¶å½±éŸ¿</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ThreadTest</span> <span style="color:#66d9ef">extends</span> Thread <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thread T is starting...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> 3<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>1000<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thread T is running...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thread T is ending...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ThreadMethodTest</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thread main is starting...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        testNormal<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// testJoin();
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// testDaemon();
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Thread main is ending...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testNormal</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        Thread t <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ThreadTest<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// #1 thread main å’Œ thread t å•Ÿå‹•å¾Œå„èµ°å„çš„ï¼Œäº’ä¸å½±éŸ¿
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testJoin</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        Thread t <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ThreadTest<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            t<span style="color:#f92672">.</span><span style="color:#a6e22e">join</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* #2 thread main å•Ÿå‹• thread tï¼Œåœ¨åŸ·è¡Œ t.join() æ™‚ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">      thread t æœƒæ’éšŠåˆ° main å‰é¢ï¼Œåªæœ‰ thread t çµæŸå¾Œæ‰æœƒåŸ·è¡Œ thread main */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testDaemon</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        Thread t <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ThreadTest<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span><span style="color:#a6e22e">setDaemon</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// t.setDaemon(true);  // java.lang.IllegalThreadStateException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* å°‡åŸ·è¡Œç·’ t è¨­ç‚º daemon å¾Œï¼Œä¸€æ—¦ non-daemon çš„ thread main çµæŸï¼ŒJVM å°±é—œé–‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   thread main çµæŸå¾Œï¼Œå³ä¾¿ thread t å°šæœªçµæŸï¼ŒJVM ä¹Ÿæœƒé—œé–‰ï¼Œå’Œå…ˆå‰2ç¨®æ¸¬è©¦æ˜é¡¯ä¸åŒ */</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>&hellip;</p>
<h3 id="ä¸å»ºè­°ä½¿ç”¨çš„æ–¹æ³•">ä¸å»ºè­°ä½¿ç”¨çš„æ–¹æ³•</h3>
<ul>
<li>
<p>class Thread ä¸€äº›ä¸å»ºè­°ä½¿ç”¨çš„æ–¹æ³•ï¼š</p>
<ol>
<li>
<p>å¯èƒ½é€ æˆå•é¡Œï¼Œé¿å…ä½¿ç”¨</p>
<ul>
<li><code>setPriority(int)</code></li>
<li><code>getPriority()</code></li>
</ul>
</li>
<li>
<p>å·²ç¶“ <strong>deprecated</strong>ï¼Œä¸è©²ä½¿ç”¨</p>
<ul>
<li><code>destroy()</code></li>
<li><code>resume()</code></li>
<li><code>suspend()</code></li>
<li><code>stop()</code></li>
</ul>
<blockquote>
<p>ä½¿ç”¨ deprecated æè¿°è¡¨ç¤ºæ–¹æ³•å¯èƒ½</p>
<ul>
<li>å¯«æ³•ä¸å¥½</li>
<li>å‘½åä¸ç¬¦åˆå‚³çµ±ï¼Œä¸å»ºè­°å†ä½¿ç”¨</li>
<li>æœªä¾†å¯èƒ½ç§»é™¤ ex.  <code>@Deprecated</code>ã€<del>stop</del>() {&hellip;}ã€<del>resume</del>();</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// è¨»è¨˜æ–¹å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Deprecated</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">stop</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    SecurityManager security <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">getSecurityManager</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>security <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        checkAccess<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span> <span style="color:#f92672">!=</span> Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">currentThread</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            security<span style="color:#f92672">.</span><span style="color:#a6e22e">checkPermission</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>                SecurityConstants<span style="color:#f92672">.</span><span style="color:#a6e22e">STOP_THREAD_PERMISSION</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// A zero status value corresponds to &#34;NEW&#34;, it can&#39;t change to
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// not-NEW because we hold the lock.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>threadStatus <span style="color:#f92672">!=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        resume<span style="color:#f92672">();</span> <span style="color:#75715e">// Wake up thread if it was suspended; no-op otherwise
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// The VM can handle all thread states
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    stop0<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ThreadDeath<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></blockquote>
</li>
</ol>
</li>
</ul>
<hr>
<h1 id="06-åŸ·è¡Œç·’èˆ‡ä¸¦è¡Œ-api-concurrency-api">06 åŸ·è¡Œç·’èˆ‡ä¸¦è¡Œ API <code>Concurrency API</code></h1>
<h2 id="ä½¿ç”¨ä¸¦è¡Œ-api">ä½¿ç”¨ä¸¦è¡Œ API</h2>
<h3 id="ä¸¦è¡Œ-api-ä»‹ç´¹">ä¸¦è¡Œ API ä»‹ç´¹</h3>
<ul>
<li>Concurrency API æ˜¯å¥—ä»¶ <code>java.util.concurrent</code> ä¸‹çš„ç›¸é—œé¡åˆ¥å’Œä»‹é¢ã€‚</li>
<li>å°å…¥æ–¼ Java 5ï¼Œé™¸çºŒæ“´å……ï¼Œç”¨æ–¼æ”¯æ´å¤šåŸ·è¡Œç·’åŸ·è¡Œï¼Œäº¦å³ concurrent programmingï¼ŒåŒ…å«
<ol>
<li>åŸ·è¡Œç·’å®‰å…¨ï¼ˆthread-safeï¼‰çš„é›†åˆç‰©ä»¶</li>
<li>å–ä»£å‚³çµ± <em>synchronization</em> å’Œ <em>locking</em> çš„æ›¿ä»£æ–¹æ¡ˆ</li>
<li>åŸ·è¡Œç·’æ± ï¼ˆthread poolsï¼‰ï¼Œåˆåˆ†æˆï¼š
<ul>
<li>åŸ·è¡Œç·’æ•¸é‡ã€Œå›ºå®šã€æˆ–ã€Œæµ®å‹•ã€çš„åŸ·è¡Œç·’æ± </li>
<li>åˆ†é€²åˆæ“Šçš„ <em>Fork-Join Framework</em></li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="atomicinteger-é¡åˆ¥"><code>AtomicInteger</code> é¡åˆ¥</h3>
<ul>
<li>
<p>class <code>AtomicInteger</code> ä½æ–¼<code>java.util.concurrent.atomic</code>å¥—ä»¶è£¡</p>
</li>
<li>
<p>æä¾›åŸ·è¡Œç·’å®‰å…¨åˆä¸éœ€è¦ä½¿ç”¨ <em>synchronization</em> å’Œ <em>locking</em> æ©Ÿåˆ¶ä¾†æ§ç®¡çš„ç‰©ä»¶</p>
</li>
<li>
<p>æ­¤é¡åˆ¥è£¡çš„æ–¹æ³•éƒ½æ˜¯ atomic functionï¼Œä¾‹å¦‚ <code>compareAndSet()</code>ã€<code>getAndIncrement()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>AtomicInteger ai <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AtomicInteger<span style="color:#f92672">(</span>5<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>ai<span style="color:#f92672">.</span><span style="color:#a6e22e">compareAndSet</span><span style="color:#f92672">(</span>5<span style="color:#f92672">,</span> 42<span style="color:#f92672">))</span> <span style="color:#f92672">{</span>  <span style="color:#75715e">// ğŸ¥¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;after compareAndSet(): &#34;</span> <span style="color:#f92672">+</span> ai<span style="color:#f92672">);</span>  <span style="color:#75715e">// 42
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>ai<span style="color:#f92672">.</span><span style="color:#a6e22e">getAndIncrement</span><span style="color:#f92672">();</span>  <span style="color:#75715e">// ğŸ¥¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;after getAndIncrement(): &#34;</span> <span style="color:#f92672">+</span> ai<span style="color:#f92672">);</span>   <span style="color:#75715e">// 43
</span></span></span></code></pre></div><table>
<thead>
<tr>
<th>ğŸ¥¨</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>compareAndSet(a,b)</code></td>
<td>åˆ¤æ–·æ•¸å€¼æ˜¯å¦ç‚º aï¼Œè‹¥æ˜¯å‰‡è¨­å®šç‚º bï¼Œäº¦å³å°‡ a å–ä»£ç‚º b</td>
</tr>
<tr>
<td><code>getAndIncrement()</code></td>
<td>å–å¾—æ•¸å€¼å¾ŒåŠ  1ã€‚ä½œç”¨åŒéå¢é‹ç®—å­ï¼Œä½† atomic function ä¸é ˆä½¿ç”¨ synchronized block</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="reentrantreadwritelock-é¡åˆ¥"><code>ReentrantReadWriteLock</code> é¡åˆ¥</h3>
<ul>
<li>
<p>æœ‰åˆ¥æ–¼<code>synchronization</code>èˆ‡<code>monitor</code>æ©Ÿåˆ¶ï¼Œ<code>ReentrantReadWriteLock</code>æä¾›å¦ä¸€ç¨®é–å®šï¼ˆlockingï¼‰</p>
</li>
<li>
<p>å¯æ ¹æ“šä¸åŒæƒ…æ³ï¼ˆconditionsï¼‰èª¿æ•´åŸ·è¡Œç·’ç­‰å¾…çš„ï¼ˆwaitï¼‰æ¶æ§‹</p>
<ol>
<li>
<p>éå»çš„ monitor æœªåˆ†é¡ï¼Œä¸€å€‹åŸ·è¡Œç·’å–å¾— monitor ä¹‹å¾Œï¼Œå…¶å®ƒåŸ·è¡Œç·’å¿…é ˆç­‰å¾…é–å®šè©² monitor</p>
</li>
<li>
<p>ä½¿ç”¨ <code>ReentrantReadWriteLock</code>ï¼Œå°‡åŸæœ¬ç”±æ¯å€‹ç‰©ä»¶å”¯ä¸€çš„ object monitorï¼Œæ”¹æä¾› <strong>read lock</strong> å’Œ <strong>write lock</strong> å…©ç¨®é–å®šæ©Ÿåˆ¶</p>
<ul>
<li>æœ‰ thread å…ˆå–å¾— <strong>read lock</strong> æ™‚ï¼Œå…¶å®ƒåŸ·è¡Œç·’å¯ä»¥åŒæ™‚å†å–å¾— read lock
<ul>
<li>å…è¨±å¤šå€‹åŸ·è¡Œç·’åŒæ™‚ readï¼Œä½†æ²’æœ‰åŸ·è¡Œç·’å¯ä»¥å–å¾— write lock</li>
</ul>
</li>
<li>ä¸€æ—¦æœ‰åŸ·è¡Œç·’å–å¾— <strong>write lock</strong>ï¼Œå°‡æ’æ“ å…¶å®ƒåŸ·è¡Œç·’å–å¾— read lock å’Œ write lock</li>
</ul>
</li>
<li>
<p>ã€Œ<strong>Reentrant</strong>ã€</p>
<ul>
<li>
<p>å¦‚æœæœ‰åŸ·è¡Œç·’å·²ç¶“ä½¿ç”¨æŸå€‹ synchronized æ–¹æ³•ï¼ˆ= å–å¾—æŸç‰©ä»¶çš„ object monitorï¼‰ï¼Œå‰‡è©²åŸ·è¡Œç·’å¯ç¹¼çºŒé€²å…¥å…¶å®ƒä½¿ç”¨ç›¸åŒ object monitor çš„ä»»ä½•ä¸€å€‹ synchronized æ–¹æ³•</p>
</li>
<li>
<p>ç”³è«‹ä¸€æŠŠé‘°åŒ™ä¹‹å¾Œï¼Œå¯ä»¥ç¹¼çºŒæ‰“é–‹æ¯ä¸€å€‹ä½¿ç”¨ç›¸åŒé‘°åŒ™çš„é–€ï¼Œä¸ç”¨æ¯æ¬¡é–‹é–€å¾Œéƒ½ç¹³å›ï¼Œä¹Ÿä¸ç”¨ç‚ºäº†å…¬å¹³è€Œé‡æ–°ç”³è«‹æ’éšŠ</p>
<blockquote>
<p>1ï¸âƒ£ å…è¨±å¤šåŸ·è¡Œç·’åŒæ™‚ã€Œholding read lockã€</p>
<p>2ï¸âƒ£ åŒä¸€æ™‚é–“ä¸€æ—¦æœ‰ä¸€å€‹åŸ·è¡Œç·’ã€Œholding write lockã€ï¼Œ</p>
<p>â€‹      å°±ä¸æœƒå†æœ‰å…¶å®ƒåŸ·è¡Œç·’ã€Œholding read lockã€æˆ–ã€Œholding write lockã€</p>
</blockquote>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="åŸ·è¡Œç·’å®‰å…¨çš„é›†åˆç‰©ä»¶">åŸ·è¡Œç·’å®‰å…¨çš„é›†åˆç‰©ä»¶</h3>
<p><code>java.util.*</code> ä¸‹çš„é›†åˆç‰©ä»¶é è¨­éåŸ·è¡Œç·’å®‰å…¨ï¼Œå¦‚æœè¦ thread-safeï¼Œå¿…é ˆç‰¹åˆ¥è™•ç†ï¼š</p>
<ol>
<li>
<p>å°æ‰€æœ‰ä¿®æ”¹é›†åˆç‰©ä»¶çš„ç¨‹å¼ç¢¼ï¼Œéƒ½å¿…é ˆæ”¾åœ¨ <em>synchronize</em> å€å¡Š</p>
</li>
<li>
<p>ä½¿ç”¨ç‰¹å®šé¡åˆ¥åŠæ–¹æ³•å»ºç«‹ <em>synchronized wrapper</em> class</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>java<span style="color:#f92672">.</span><span style="color:#a6e22e">util</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Collections</span><span style="color:#f92672">.</span><span style="color:#a6e22e">synchronizedList</span><span style="color:#f92672">(</span>List<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;)</span>
</span></span></code></pre></div></li>
<li>
<p>æ”¹ç”¨å¥—ä»¶ <code>java.util.concurrent</code> å¥—ä»¶ä¸‹çš„é›†åˆç‰©ä»¶</p>
<p><strong>æ³¨æ„</strong>ï¼šå³ä¾¿æ˜¯åŸ·è¡Œç·’å®‰å…¨çš„é›†åˆç‰©ä»¶ï¼Œä¸ä»£è¡¨å…¶æˆå“¡ä¹Ÿæ˜¯</p>
</li>
</ol>
<p>å¸¸ç”¨åŸ·è¡Œç·’å®‰å…¨çš„é›†åˆç‰©ä»¶ï¼š</p>
<table>
<thead>
<tr>
<th><code>java.util.concurrent.*</code></th>
<th><code>java.util.*</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CopyOnWriteArraySet</code></td>
<td></td>
</tr>
<tr>
<td><code>CopyOnWriteArrayList</code></td>
<td><code>ArrayList</code></td>
</tr>
<tr>
<td><code>ConcurrentHashMap</code></td>
<td><code>HashMap</code></td>
</tr>
<tr>
<td><code>ConcurrentSkipListMap</code></td>
<td><code>TreeMap</code></td>
</tr>
</tbody>
</table>
<p><code>Queue</code> family çš„åŸ·è¡Œç·’å®‰å…¨é›†åˆç‰©ä»¶ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/E0u3aAs.png"
        data-srcset="https://i.imgur.com/E0u3aAs.png, https://i.imgur.com/E0u3aAs.png 1.5x, https://i.imgur.com/E0u3aAs.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/E0u3aAs.png"
        title="1" /></p>
<blockquote>
<p>ğŸªâ˜• <strong>Little Tips</strong></p>
<p>æ”¯æ´åŸ·è¡Œç·’å®‰å…¨çš„é›†åˆç‰©ä»¶è£¡ï¼Œå¸¸å¯ä»¥çœ‹åˆ° <code>CopyOnWrite</code> çš„å‘½åæ–¹å¼ï¼Œæš—ç¤ºè©²é›†åˆç‰©ä»¶å¦‚ä½•æ”¯æ´åŸ·è¡Œç·’å®‰å…¨</p>
<ol>
<li>ç•¶è©²é›†åˆç‰©ä»¶è¦å¢åŠ æˆå“¡æ™‚ï¼Œä¸ç›´æ¥æ·»åŠ ï¼Œè€Œæ˜¯
<ul>
<li>å…ˆå°‡ç•¶å‰é›†åˆç‰©ä»¶è¤‡è£½å‡ºä¸€å€‹æ–°çš„é›†åˆç‰©ä»¶ï¼Œç„¶å¾Œåœ¨æ–°çš„é›†åˆç‰©ä»¶è£¡å¢åŠ æˆå“¡</li>
</ul>
</li>
<li>æ·»åŠ å®Œæˆå“¡ä¹‹å¾Œï¼Œå†å°‡åŸé›†åˆç‰©ä»¶çš„ç‰©ä»¶åƒè€ƒæŒ‡å‘æ–°çš„é›†åˆç‰©ä»¶</li>
<li>å¥½è™•ï¼šé›†åˆç‰©ä»¶å¯ä»¥è®€å¯«ä¸¦è¡Œï¼Œä¸éœ€è¦åœ¨ä¿®æ”¹çš„æ™‚å€™æ’é™¤å…¶å®ƒè¡Œç‚ºï¼Œå› ç‚ºç•¶å‰é›†åˆç‰©ä»¶ä¸æœƒæ·»åŠ ä»»ä½•å…ƒç´ 
<ul>
<li><code>CopyOnWrite</code> é›†åˆç‰©ä»¶æ˜¯ä¸€ç¨®è®€å¯«åˆ†é›¢çš„æ€æƒ³å¯¦è¸ï¼Œå°ä¸åŒçš„é›†åˆç‰©ä»¶è®€å–å’Œå¯«å…¥</li>
</ul>
</li>
</ol>
</blockquote>
<h3 id="å¸¸ç”¨çš„åŒæ­¥å™¨å·¥å…·é¡åˆ¥">å¸¸ç”¨çš„åŒæ­¥å™¨å·¥å…·é¡åˆ¥</h3>
<p>å¥—ä»¶ <code>java.util.concurrent</code> ä¸‹ï¼Œæä¾›æ•¸ç¨®æ”¯æ´ç‰¹æ®Šæƒ…å¢ƒçš„åŒæ­¥å™¨ï¼ˆ<em>synchronizers</em>ï¼‰é¡åˆ¥</p>
<table>
<thead>
<tr>
<th>class</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Semaphore</code></td>
<td>å‚³çµ±çš„ concurrencyï¼ˆå¹³è¡ŒåŸ·è¡Œï¼‰å·¥å…·</td>
</tr>
<tr>
<td><code>CountDownLatch</code></td>
<td>æš«åœ thread ç›´åˆ°æŸç¨®æƒ…å¢ƒé”æˆï¼Œä¾‹å¦‚ä¿¡è™Ÿæ•¸é‡ã€äº‹ä»¶ã€é è¨­æ¢ä»¶</td>
</tr>
<tr>
<td><code>CyclicBarrier</code>ï¼ˆå¾ªç’°è·¯éšœï¼‰</td>
<td>æ–¼å¹³è¡ŒåŸ·è¡Œæ™‚æä¾›åŒæ­¥é»ï¼Œå¯å¾ªç’°ä½¿ç”¨</td>
</tr>
<tr>
<td><code>Phaser</code></td>
<td>æ›´æœ‰å½ˆæ€§çš„ <code>CyclicBarrier</code></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> stopUntil <span style="color:#f92672">=</span> 2<span style="color:#f92672">;</span>  <span style="color:#75715e">// è¨­å®šå¤šå°‘å€‹ thread æŠµé”æ‰æ”¾è¡Œçš„æ¢ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">int</span> totalThreadCnt <span style="color:#f92672">=</span> 3<span style="color:#f92672">;</span>  <span style="color:#75715e">// ä»»æ„èª¿æ•´å•Ÿå‹•çš„ thread å€‹æ•¸ï¼Œæ¸¬è©¦ CyclicBarrier é¡çš„æ•ˆæœ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">final</span> CyclicBarrier barrier <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> CyclicBarrier<span style="color:#f92672">(</span>stopUntil<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å®£å‘Šä¸¦åˆå§‹åŒ– class Cyclic 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span>1<span style="color:#f92672">;</span> i<span style="color:#f92672">&lt;=</span>totalThreadCnt<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">new</span> Thread<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>					System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;before await&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>					barrier<span style="color:#f92672">.</span><span style="color:#a6e22e">await</span><span style="color:#f92672">();</span>  <span style="color:#75715e">// line
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>					System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;after await&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>BrokenBarrierException <span style="color:#f92672">|</span> InterruptedException ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><blockquote>
<p><code>await()</code> æ–¹æ³•ï¼šåƒæ˜¯æŸµæ¬„ï¼Œå¹³æ™‚æ”¾ä¸‹ã€‚</p>
<p>åªæœ‰æ»¿è¶³ <code>CyclicBarrier</code> å»ºæ§‹å­è¨­å®šçš„ <code>stopUntil</code> å€‹æ•¸çš„ thread æŠµé”å¾Œï¼Œæ‰æœƒæ”¾è¡Œ</p>
</blockquote>
<h2 id="ä½¿ç”¨-executorservice-ä»‹é¢åŒæ™‚åŸ·è¡Œå¤šæ¨£å·¥ä½œ">ä½¿ç”¨ <code>ExecutorService</code> ä»‹é¢åŒæ™‚åŸ·è¡Œå¤šæ¨£å·¥ä½œ</h2>
<h3 id="ä½¿ç”¨æ›´é«˜éšçš„å¤šåŸ·è¡Œç·’åŸ·è¡Œæ–¹æ¡ˆ">ä½¿ç”¨æ›´é«˜éšçš„å¤šåŸ·è¡Œç·’åŸ·è¡Œæ–¹æ¡ˆ</h3>
<p>å¤šåŸ·è¡Œç·’ç¨‹å¼æ¶æ§‹å¯åŒæ™‚åŸ·è¡Œå·¥ä½œï¼Œæå‡æ•ˆç‡ï¼Œä½†ä¹Ÿå®¹æ˜“è¡ç”Ÿå•é¡Œï¼Œå¿…é ˆå°å¿ƒæ“æ§ã€‚</p>
<p>å‚³çµ± <code>API</code> ä¸å®¹æ˜“è¢«é©ç•¶ä½¿ç”¨ï¼Œå¯è€ƒæ…®ä½¿ç”¨ä»¥ä¸‹å…©å€‹æ›´é«˜éšçš„æ›¿ä»£æ–¹æ¡ˆï¼š</p>
<ol>
<li><strong>åŸ·è¡Œè€…æœå‹™</strong>ï¼ˆ<em>java.util.concurrent.ExecutorService</em>ï¼‰
<ul>
<li>å»ºç«‹ä¸¦é‡è¤‡ä½¿ç”¨å¤šåŸ·è¡Œç·’</li>
<li><code>ExecutorService</code> ä»‹é¢
<ul>
<li>é™¤äº†å¯ä»¥ä½¿ç”¨éå»çš„ <code>Runnable</code> ä»‹é¢å®šç¾©å·¥ä½œå…§å®¹</li>
<li>ä¹Ÿå¯ç”¨æ–°çš„ <code>Callable</code> ä»‹é¢å®šç¾©å·¥ä½œå…§å®¹ï¼Œå…è¨±åœ¨æœªä¾†å·¥ä½œçµæŸå¾Œæª¢è¦–çµæœ</li>
</ul>
</li>
</ul>
</li>
<li><strong>åˆ†é€²åˆæ“Šç¨‹å¼æ¡†æ¶</strong>ï¼ˆ<em>Fork-Join Framework</em>ï¼‰
<ul>
<li>Java 7 æ¨å‡ºçš„ç‰¹æ®Šã€Œ<strong>å·¥ä½œç«Šå–</strong>ï¼ˆwork-stealingï¼‰ã€å¹³è¡Œé‹ç®—æ¶æ§‹</li>
<li>ç”¨æ–¼å¤šåŸ·è¡Œç·’åŸ·è¡Œï¼Œæ˜¯ä¸€ç¨®ç‰¹åŒ–çš„ ExecutorService</li>
<li>ç¨‹å¼é‹è¡Œæ™‚ï¼Œé™¤äº†ä¸æ–·å°‡æ•´é«”å·¥ä½œé€²è¡Œåˆ‡å‰²å¤–ï¼Œä¹Ÿè®“<strong>æœ‰èƒ½åŠ›ã€è¼ƒæœ‰é¤˜è£•çš„åŸ·è¡Œç·’åœ¨åšå®Œä»½å…§å·¥ä½œå¾Œï¼Œå¯ä»¥ç«Šå–ï¼ˆstealingï¼‰åˆ¥äººçš„å·¥ä½œä¾†åŸ·è¡Œ</strong>
<ul>
<li>æ”¯æ´ <em>èƒ½è€…å¤šå‹</em> ç†å¿µçš„å¤šåŸ·è¡Œç·’åŸ·è¡Œæ¶æ§‹</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="executorserviceæ¦‚è§€"><code>ExecutorService</code>æ¦‚è§€</h3>
<ul>
<li><code>ExecutorService</code> ä»‹é¢æ˜¯åŸ·è¡Œç·’æ± ï¼ˆthread poolï¼‰çš„æ¦‚å¿µï¼Œä½¿ç”¨éçš„åŸ·è¡Œç·’çš†å¯å›æ”¶æ± å…§ç¹¼çºŒä¸‹æ¬¡ä½¿ç”¨</li>
<li>åŸ·è¡Œç·’æ± ä¹Ÿæœƒè² è²¬ç®¡ç†æ‰€æœ‰åŸ·è¡Œç·’çš„ç”Ÿå‘½é€±æœŸï¼Œä½¿ç”¨ <code>ExecutorService</code>åŸ·è¡Œå¤šåŸ·è¡Œç·’å·¥ä½œæ™‚ï¼š
<ol>
<li>ä¸éœ€è¦è‡ªå·±å»ºç«‹å’Œç®¡ç†å¤šåŸ·è¡Œç·’ï¼Œä¸”å¯ä»¥å¹³è¡ŒåŸ·è¡Œ</li>
<li>å¯åˆ†æˆå…©ç¨®ä»»å‹™
<ul>
<li><code>java.lang.Runnable</code></li>
<li><code>java.util.concurrent.Callable</code></li>
</ul>
</li>
<li>ä½¿ç”¨ class <code>Executors</code> å¯ä»¥å–å¾— interface <code>ExecutorService</code> çš„å¯¦ä½œï¼Œå¸¸ç”¨å…©ç¨®
<ul>
<li>å¿«å–å¼åŸ·è¡Œç·’æ±  <em>cached thread pool</em></li>
<li>å›ºå®šå¼åŸ·è¡Œç·’æ±  <em>fixed thread pool</em></li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="å¿«å–å¼åŸ·è¡Œç·’æ± cached-thread-pool">å¿«å–å¼åŸ·è¡Œç·’æ± ï¼ˆcached thread poolï¼‰</h4>
<ul>
<li>
<p>å»ºç«‹æ–¹å¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>ExecutorService es <span style="color:#f92672">=</span> Executors<span style="color:#f92672">.</span><span style="color:#a6e22e">newCachedThreadPool</span><span style="color:#f92672">();</span>
</span></span></code></pre></div></li>
<li>
<p>ç‰¹é»</p>
<table>
<thead>
<tr>
<th>feature</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ•¸é‡æ§åˆ¶</td>
<td>åŸ·è¡Œç·’æ•¸é‡ç”±åŸ·è¡Œç·’æ± <strong>è‡ªå‹•èª¿æ§</strong></td>
</tr>
<tr>
<td>æ˜¯å¦é‡è¤‡ä½¿ç”¨</td>
<td>åŸ·è¡Œç·’å·¥ä½œå®Œæˆå¾Œï¼Œå›æ”¶é‡è¤‡ä½¿ç”¨</td>
</tr>
<tr>
<td>å·¥ä½œé‡å¤§æ™‚</td>
<td>é‡åˆ°éœ€è¦å¤§é‡ CPU é‹ç®—çš„å·¥ä½œï¼Œ<strong>åŸ·è¡Œç·’å¯èƒ½æœƒä¸€ç›´å¢ç”Ÿ</strong></td>
</tr>
<tr>
<td>ç”Ÿå‘½é€±æœŸ</td>
<td>é è¨­é–’ç½®è¶…é <strong>60 ç§’</strong>ï¼Œå°±çµ‚æ­¢ç”Ÿå‘½é€±æœŸ</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="å›ºå®šå¼åŸ·è¡Œç·’æ± fixed-thread-pool">å›ºå®šå¼åŸ·è¡Œç·’æ± ï¼ˆfixed thread poolï¼‰</h4>
<ul>
<li>
<p>å»ºç«‹æ–¹å¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> cpuCount <span style="color:#f92672">=</span> Runtime<span style="color:#f92672">.</span><span style="color:#a6e22e">getRuntime</span><span style="color:#f92672">().</span><span style="color:#a6e22e">availableProcessors</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åƒè€ƒä¸»æ©Ÿ CPU æ•¸é‡å»ºç«‹åŸ·è¡Œç·’æ•¸é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ExecutorService es <span style="color:#f92672">=</span> Executors<span style="color:#f92672">.</span><span style="color:#a6e22e">newFixedThreadPool</span><span style="color:#f92672">(</span>cpuCount<span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p>ç‰¹é»</p>
<table>
<thead>
<tr>
<th>feature/category</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ•¸é‡æ§åˆ¶</td>
<td>åŸ·è¡Œç·’æ•¸é‡å›ºå®š</td>
</tr>
<tr>
<td>æ˜¯å¦é‡è¤‡ä½¿ç”¨</td>
<td>åŸ·è¡Œç·’å·¥ä½œå®Œæˆå¾Œï¼Œå›æ”¶é‡è¤‡ä½¿ç”¨</td>
</tr>
<tr>
<td>å·¥ä½œé‡å¤§æ™‚</td>
<td>å·¥ä½œå¤ªå¤šæ™‚ï¼Œå¿…é ˆç­‰å¾…å¿™ç¢Œçš„åŸ·è¡Œç·’é‡‹å‡º</td>
</tr>
<tr>
<td>ç”Ÿå‘½é€±æœŸ</td>
<td>æ•¸é‡å›ºå®šï¼Œä¸æœƒä¸»å‹•çµ‚æ­¢ç”Ÿå‘½é€±æœŸ</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="ä½¿ç”¨-javautilconcurrentcallable">ä½¿ç”¨ <code>java.util.concurrent.Callable</code></h3>
<ul>
<li>
<p><code>ExecutorService</code> å¯ä»¥å”åŠ©ç®¡ç†åŸ·è¡Œç·’ï¼Œä½†é‚„æ˜¯éœ€è¦è‡ªå·±å®šç¾©åŸ·è¡Œç·’çš„å·¥ä½œå…§å®¹</p>
</li>
<li>
<p>é™¤äº†ä½¿ç”¨ <code>java.lang.Runnable</code> ä»‹é¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€å€‹ <code>java.util.concurrent.Callable</code> ä»‹é¢å¯¦ä½œé¡åˆ¥ä¾†å®šç¾©è¦åŸ·è¡Œçš„å·¥ä½œ</p>
<table>
<thead>
<tr>
<th>Runnable</th>
<th>Callable</th>
</tr>
</thead>
<tbody>
<tr>
<td>public interface <code>Runnable</code> {<!-- raw HTML omitted -->       void run();<!-- raw HTML omitted -->}</td>
<td>public interface <code>Callable&lt;V&gt;</code> {<!-- raw HTML omitted -->       V call() throws Exception;<!-- raw HTML omitted -->}</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><code>Callable</code> å’Œ <code>Runnable</code> ç›¸ä¼¼ï¼Œä¸»è¦ä¸åŒåœ°æ–¹</p>
<ol>
<li>å¯ä»¥å›å‚³çµæœï¼ˆä½¿ç”¨æ³›å‹ï¼‰</li>
<li>å¯ä»¥æ‹‹å‡º Exception</li>
</ol>
</li>
<li>
<p>è‹¥ä½¿ç”¨å‚³çµ± <strong>Runnable</strong> ä»‹é¢å¯¦ä½œç‰©ä»¶ä½œç‚º <code>ExecutorService</code> çš„åŸ·è¡Œå·¥ä½œå…§å®¹ï¼Œå¯ç”¨ä¸‹ä¾‹åŸ·è¡Œå·¥ä½œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">useRunnable</span><span style="color:#f92672">(</span>ExecutorService es<span style="color:#f92672">,</span> Runnable runnable<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    es<span style="color:#f92672">.</span><span style="color:#a6e22e">submit</span><span style="color:#f92672">(</span>runnable<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p>è‹¥ä½¿ç”¨ <strong>Callable</strong> ä»‹é¢å¯¦ä½œç‰©ä»¶ä½œç‚º <code>ExecutorService</code> çš„åŸ·è¡Œå·¥ä½œå…§å®¹ï¼Œå‰‡ç”¨ä¸‹ä¾‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">static</span><span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">useCallable</span><span style="color:#f92672">(</span>ExecutorService es<span style="color:#f92672">,</span> Callable<span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> callable<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Future<span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> future <span style="color:#f92672">=</span> es<span style="color:#f92672">.</span><span style="color:#a6e22e">submit</span><span style="color:#f92672">(</span>callable<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        V result <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>result<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        ex<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><blockquote>
<p><code>ExecutorService.submit()</code> æ–¹æ³•å‚³å…¥ Callable å¯¦ä½œç‰©ä»¶æ™‚ï¼Œå¯ä»¥å›å‚³ <strong>Future</strong> é¡åˆ¥çš„ç‰©ä»¶</p>
</blockquote>
<p>&hellip;</p>
</li>
</ul>
<h3 id="ä½¿ç”¨-javautilconcurrentfuture">ä½¿ç”¨ <code>java.util.concurrent.Future</code></h3>
<ul>
<li>
<p>ä»‹é¢ <code>ExecutorService</code> åŸ·è¡Œ Callable å·¥ä½œå¾Œçš„å›å‚³çµæœå±¬æ–¼ <code>Future&lt;V&gt;</code> classï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Future<span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> future <span style="color:#f92672">=</span> es<span style="color:#f92672">.</span><span style="color:#a6e22e">submit</span><span style="color:#f92672">(</span>callable<span style="color:#f92672">);</span>
</span></span></code></pre></div></li>
<li>
<p>ä½†æ˜¯çœŸæ­£å·¥ä½œçµæœéš±è—åœ¨ Future ç‰©ä»¶è£¡é¢ï¼Œå¿…é ˆå†å‘¼å« <code>get()</code> å»å–å¾—çµæœã€‚å›å‚³å‹æ…‹ <strong>V</strong> å¿…é ˆå’Œ<code>Callable&lt;V&gt;</code>è£¡å®šç¾©çš„æ³›å‹ç‰©ä»¶å‹æ…‹ä¸€è‡´ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>V result <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">();</span>
</span></span></code></pre></div></li>
<li>
<p>åŸå› ï¼šmain thread åœ¨å‰æ™¯ï¼ˆforegroundï¼‰åŸ·è¡Œå·¥ä½œï¼Œè€Œä¸æ˜¯ main çš„ thread éƒ½åœ¨èƒŒæ™¯ï¼ˆbackgroundï¼‰åŸ·è¡Œå·¥ä½œ</p>
</li>
</ul>
<blockquote>
<p>ğŸªâ˜• <strong>Little Tips</strong></p>
<p>é¤é¤¨å…§ç”¨åº§ä½ &amp; å¤–å¸¶é ˜å–è™Ÿç¢¼ç‰Œ</p>
<p>è™Ÿç¢¼ç‰Œï¼šéš±å«ä¸€ç¨®ã€Œ<strong>æœªä¾†äº¤è²¨</strong>ã€ä¹‹æ„</p>
<table>
<thead>
<tr>
<th>noodle shop</th>
<th>java program</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã€Œè™Ÿç¢¼ç‰Œã€</td>
<td>Java è£¡çš„ <code>Future</code> ç‰©ä»¶</td>
</tr>
<tr>
<td>æ‹¿ã€Œéºµã€éœ€è¦è™Ÿç¢¼ç‰Œ</td>
<td>åŒ…å«åœ¨ <code>Future</code> è£¡çš„æ³›å‹ç‰©ä»¶ï¼Œå‘¼å« <code>Future</code> çš„ <code>get()</code> æ–¹æ³•å¯å–å¾—è©²æ³›å‹ç‰©ä»¶</td>
</tr>
<tr>
<td>ã€Œç…®éºµã€</td>
<td><code>Callable</code> ä»‹é¢è£¡çš„ <code>call()</code> æ–¹æ³•å®šç¾©çš„å…§å®¹</td>
</tr>
<tr>
<td>ã€Œç…®éºµçš„å¸«å‚…ã€</td>
<td><code>ExecutorService</code>è£¡çš„åŸ·è¡Œç·’</td>
</tr>
<tr>
<td>ã€Œé¤é¤¨ã€</td>
<td><code>ExecutorService</code></td>
</tr>
<tr>
<td>ã€Œæ‚¨ã€</td>
<td><code>main</code> åŸ·è¡Œç·’</td>
</tr>
</tbody>
</table>
<p>å¦‚æœè²·æ±è¥¿éœ€è¦ç­‰å¾…ï¼Œå¤§éƒ¨åˆ†å•†å®¶<code>Executor Service</code> éƒ½æœƒçµ¦æ‚¨ä¸€å¼µè™Ÿç¢¼ç‰Œ <code>Future</code>ï¼Œç­‰æ™‚é–“å·®ä¸å¤šå†å›ä¾†é ˜å–ï¼ˆ<code>get</code>ï¼‰è³¼è²·çš„çœŸæ­£å•†å“ã€‚</p>
<p>é ˜å–è™Ÿç¢¼ç‰Œï¼Œä½¿ç”¨ <code>Callable</code>ã€‚</p>
<p>ä¸é ˜å–è™Ÿç¢¼ç‰Œï¼Œå³æ˜¯ä½¿ç”¨ <code>Runnable</code>ã€‚</p>
</blockquote>
<ul>
<li>å‘¼å« <code>Future.get()</code> æ–¹æ³•æ™‚ï¼Œè‹¥çµæœå°šæœªå‡ºçˆï¼Œmain åŸ·è¡Œç·’å°±æœƒé€²å…¥ç­‰å¾…ç‹€æ…‹ï¼Œæ¯”è¼ƒå¥½çš„åšæ³•ï¼š
<ol>
<li>å‘¼å« <code>get()</code> æ–¹æ³•å‰ï¼Œæ‡‰è©²å…ˆä¸Ÿå‡ºï¼ˆ<strong>submit</strong>ï¼‰æ‰€æœ‰å·¥ä½œ
<ul>
<li>å› ç‚ºå‘¼å« <code>get()</code>ä¹‹å¾Œåªèƒ½è€å¿ƒç­‰çµæœ</li>
</ul>
</li>
<li>å‘¼å« <code>get()</code> æ–¹æ³•å‰ä¹Ÿå¯ä»¥å…ˆå‘¼å« <code>isDone()</code>æ–¹æ³•ï¼Œç¢ºèªæ˜¯å¦å·¥ä½œå®Œæˆ</li>
</ol>
<ul>
<li>å–è²¨å‰å…ˆæ‰“é›»è©±ç¢ºèªæ˜¯å¦å®Œæˆï¼Œä»¥å…åˆ°é”å¾Œé‚„éœ€è¦ç­‰å¾…</li>
<li>å‘¼å«å¤šè¼‰çš„å¦å¤–ä¸€ç‰ˆæœ¬ <code>get(long timeout, TimeUnit unit)</code> æ–¹æ³•ï¼Œæ˜ç¢ºæŒ‡å®šç­‰å¾…æ™‚é–“</li>
</ul>
</li>
</ul>
<h3 id="é—œé–‰-executorservice">é—œé–‰ <code>ExecutorService</code></h3>
<ul>
<li>
<p>å› ç‚º <code>ExecutorService</code>æ‰€å»ºç«‹çš„åŸ·è¡Œç·’éƒ½æ˜¯ <strong>non-daemon</strong>ï¼ŒJVM æœƒå› ç‚ºé€™äº›åŸ·è¡Œç·’å­˜åœ¨ï¼Œè€Œå°è‡´æ°¸é ä¸æœƒçµæŸ</p>
</li>
<li>
<p>è‹¥è¦çµæŸç¨‹å¼ï¼Œå¿…é ˆå‘¼å« <code>ExecutorService</code> ä»‹é¢çš„ <code>shutdown()</code> æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>es<span style="color:#f92672">.</span><span style="color:#a6e22e">shutdown</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* shutdown() æ–¹æ³•æœƒåœ¨æ‰€æœ‰åŸ·è¡Œç·’å·¥ä½œéƒ½çµæŸå¾Œï¼Œé—œé–‰ ExecutorService 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   ä¸¦çµ‚æ­¢æ‰€æœ‰åŸ·è¡Œç·’ç”Ÿå‘½é€±æœŸï¼Œè®“ç¨‹å¼çµæŸ  */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    es<span style="color:#f92672">.</span><span style="color:#a6e22e">awaitTermination</span><span style="color:#f92672">(</span>5<span style="color:#f92672">,</span> TimeUnit<span style="color:#f92672">.</span><span style="color:#a6e22e">SECONDS</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/* è‹¥å·²åŸ·è¡Œ shutdown() æŒ‡ä»¤ï¼Œä½†åŸ·è¡Œç·’å·¥ä½œçµæŸå¾Œé‚„æ˜¯ç„¡æ³•é—œé–‰ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       å¯ä»¥ä½¿ç”¨ awaitTermination(5, TimeUnit.SECONDS) æ–¹æ³•å‚³å…¥ç­‰å¾…æ™‚é–“ï¼Œæ™‚é–“åˆ°å¾Œæœƒå¼·åˆ¶é—œé–‰*/</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Stopped waiting early&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>    
</span></span></code></pre></div></li>
</ul>
<h3 id="executorserviceå®Œæ•´ç¯„ä¾‹"><code>ExecutorService</code>å®Œæ•´ç¯„ä¾‹</h3>
<ul>
<li>
<p>æ‡‰ç”¨ <code>Callable</code>ä»‹é¢å’Œ<code>Future</code>é¡åˆ¥çš„ <code>ExecutorService</code>ä½¿ç”¨æ–¹å¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CallableTask</span> <span style="color:#66d9ef">implements</span> Callable<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">call</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>20000<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">()</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: finish job&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">()</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: done&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ExecutorServiceTest</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        ExecutorService es <span style="color:#f92672">=</span> Executors<span style="color:#f92672">.</span><span style="color:#a6e22e">newCacheThreadPool</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ExecutorService es = Executors.newFixedThreadPool(5);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        Callable<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> task <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> CallableTask<span style="color:#f92672">();</span> <span style="color:#75715e">// å»ºç«‹Callableå¯¦ä½œç‰©ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        Future<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> future <span style="color:#f92672">=</span> es<span style="color:#f92672">.</span><span style="color:#a6e22e">submit</span><span style="color:#f92672">(</span>task<span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// è®“esåˆ†æ´¾åŸ·è¡Œç·’é€²è¡ŒCallableå¯¦ä½œç‰©ä»¶å®šç¾©çš„å·¥ä½œå…§å®¹ï¼Œä¸¦å–å¾—è™Ÿç¢¼ç‰ŒFutureç‰©ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>  <span style="color:#75715e">// line 17
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            String result <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">();</span> 
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>result<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            ex<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#75715e">// ln17 ~ 22è‹¥å‘¼å«get()æ–¹æ³•æ™‚å·¥ä½œå°šæœªçµæŸï¼Œå°±æœƒé€²å…¥ç­‰å¾…ç‹€æ…‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        es<span style="color:#f92672">.</span><span style="color:#a6e22e">shutdown</span><span style="color:#f92672">();</span> <span style="color:#75715e">// shutdown()åœ¨æ‰€æœ‰åŸ·è¡Œç·’å·¥ä½œçµæŸå¾Œï¼Œæ‰é—œé–‰è‡ªå·±
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Date<span style="color:#f92672">()</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: service shutdown&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            es<span style="color:#f92672">.</span><span style="color:#a6e22e">awaitTermination</span><span style="color:#f92672">(</span>5<span style="color:#f92672">,</span> TimeUnit<span style="color:#f92672">.</span><span style="color:#a6e22e">SECONDS</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* è‹¥å·²åŸ·è¡Œshutdown()ï¼Œä½†æ‰€æœ‰åŸ·è¡Œç·’å·¥ä½œçµæŸå¾Œé‚„æ˜¯ç„¡æ³•é—œé–‰ï¼Œå‰‡å¯ä»¥ä½¿ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">               awaitTermination(5,TimeUnit.SECONDS) æ–¹æ³•å‚³å…¥ç­‰å¾…æ™‚é–“ï¼Œæ™‚é–“åˆ°å¾Œå¼·åˆ¶é—œé–‰*/</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Stopped waiting early&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="executorservice-é€²éšç¯„ä¾‹"><code>ExecutorService</code> é€²éšç¯„ä¾‹</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/lXaXD7Y.png"
        data-srcset="https://i.imgur.com/lXaXD7Y.png, https://i.imgur.com/lXaXD7Y.png 1.5x, https://i.imgur.com/lXaXD7Y.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/lXaXD7Y.png"
        title="image-20221221144232769" /></p>
<ul>
<li>Java Socket ç¨‹å¼æ¶æ§‹æä¾›ç¶²è·¯ä¸–ç•Œå…©å°ç¨ç«‹ä¸»æ©Ÿä¸Šçš„ Java ç¨‹å¼äº’ç›¸é€£ç·šçš„æ©Ÿåˆ¶ï¼Œä¸€èˆ¬åˆ†ç‚º
<ol>
<li><strong>ä¸»æ©Ÿç«¯</strong>ï¼ˆserverï¼‰ï¼šæä¾›ç¶²è·¯é€£ç·šçš„ç¨‹å¼</li>
<li><strong>ç”¨æˆ¶ç«¯</strong>ï¼ˆclientï¼‰ï¼šè¦æ±‚ç¶²è·¯é€£ç·šçš„ç¨‹å¼</li>
</ol>
</li>
<li>æˆåŠŸå»ºç«‹é€£ç·šæœ‰ä»¥ä¸‹æ¢ä»¶ï¼š
<ol>
<li>ä¸»æ©Ÿç«¯å¿…é ˆæä¾›ä¸€å€‹å›ºå®šä½ç½®ï¼ˆåŒ…å« IPã€port è™Ÿï¼‰ï¼Œç”¨æˆ¶ç«¯è¦é€£æ¥çš„è©±éœ€è¦å…ˆçŸ¥é“é€™å€‹ä½ç½®
<ul>
<li><strong>IP</strong> : ç¶²è·¯ä¸–ç•Œçš„ä½å€ï¼Œå¯å¹«åŠ©ç”¨æˆ¶ç«¯åœ¨ç¶²éš›ç¶²è·¯è£¡æ‰¾åˆ°å–®ä¸€ä¸»æ©Ÿ</li>
<li><strong>Port</strong> :
<ul>
<li>ä¸»æ©Ÿè£¡å¯èƒ½æœ‰è«¸å¤šæ­£åœ¨åŸ·è¡Œçš„ç¨‹å¼ï¼Œå¯ç”¨ post</li>
<li>å¯ä»¥æ˜¯ 0-65535 ä¹‹é–“çš„ä»»ä¸€æ•´æ•¸ï¼Œ0-1024çš„portè™Ÿå·²è¢«ä½œæ¥­ç³»çµ±ä¿ç•™</li>
<li>å…¶å®ƒç¨‹å¼é€šå¸¸é¸æ“‡1024ä¹‹å¾Œçš„ç·¨è™Ÿä½œç‚ºè‡ªå·±ç¨‹å¼çš„ port è™Ÿ</li>
</ul>
</li>
</ul>
</li>
<li>Java çš„ Socket ä¸»è¦ä½¿ç”¨ <code>ServerSocket</code> ä»¥åŠ <code>Socket</code> å…©å€‹é¡åˆ¥
<ul>
<li>ä¸»æ©Ÿç«¯ç”¨ <code>ServerSocket</code> ç‰©ä»¶çš„ <strong>listen()</strong> æ–¹æ³•ç›£è½ä¾†è‡ªç”¨æˆ¶ç«¯çš„é€£ç·šè«‹æ±‚</li>
<li>ç”¨æˆ¶ç«¯ç”¨ <code>Socket</code> ç‰©ä»¶å’Œä¸»æ©Ÿç«¯åšé€£æ¥</li>
<li>ä¸»æ©Ÿç«¯ç”¨ <code>ServerSocket</code> ç‰©ä»¶çš„ <strong>accept()</strong> æ–¹æ³•ä¾†ä¸²æ¥ç”¨æˆ¶ç«¯çš„ <code>Socket</code> ç‰©ä»¶</li>
</ul>
</li>
<li>ä¸»æ©Ÿç«¯å’Œç”¨æˆ¶ç«¯é€£æ¥ä¹‹å¾Œï¼Œå°±å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•ä¾†å‚³è¼¸è³‡æ–™
<ul>
<li><code>Socket</code> ç‰©ä»¶çš„ <code>getInputStream()</code></li>
<li><code>Socket</code> ç‰©ä»¶çš„ <code>getOutputStream()</code></li>
</ul>
</li>
<li>è³‡æ–™å‚³è¼¸å®Œæˆå¾Œï¼Œè¨˜å¾—å‘¼å« <code>Socket</code> ç‰©ä»¶çš„ <code>close()</code> æ–¹æ³•çµæŸç›¸é—œè³‡æº</li>
</ol>
</li>
</ul>
<h4 id="ç¯„ä¾‹ä¸€socketserversstartupjava-æ‰®æ¼”ä¸»æ©Ÿç«¯ç¨‹å¼çš„è§’è‰²">ç¯„ä¾‹ä¸€ï¼š<code>SocketServersStartup.java</code> æ‰®æ¼”ä¸»æ©Ÿç«¯ç¨‹å¼çš„è§’è‰²</h4>
<ul>
<li>
<p>å•Ÿå‹•äº”å€‹åŸ·è¡Œç·’ï¼Œåˆ†åˆ¥ä½¿ç”¨ port# 10000 - 10004 æ‰®æ¼”ä¸»æ©Ÿç«¯è§’è‰²ï¼Œç­‰å¾…/å‚¾è½ç”¨æˆ¶ç«¯é€£ç·šçš„è¦æ±‚</p>
</li>
<li>
<p>å¦‚æœç”¨æˆ¶ç«¯é€£ç·šæˆåŠŸï¼Œä¸»æ©Ÿç«¯åœ¨åœé “äº”ç§’å¾Œï¼Œå°‡è¼¸å‡º <code>feedback_from_port è™Ÿ</code> çš„è¨Šæ¯çµ¦å®¢æˆ¶ç«¯</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SocketServerStartup</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> 10000<span style="color:#f92672">;</span> port <span style="color:#f92672">&lt;</span> 10005<span style="color:#f92672">;</span> port<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> Thread<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> MySocketServer<span style="color:#f92672">(</span>port<span style="color:#f92672">)).</span><span style="color:#a6e22e">start</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MySocketServer</span> <span style="color:#66d9ef">implements</span> Runnable <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> port<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    MySocketServer<span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> port<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> port<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Server &#34;</span> <span style="color:#f92672">+</span> port <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: Listening...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// è†è½ port æ˜¯å¦è¢«å‘¼å«
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                ServerSocket serverSock <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ServerSocket<span style="color:#f92672">(</span>port<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// å–å¾— Socket é€£ç·š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                Socket clientSock <span style="color:#f92672">=</span> serverSock<span style="color:#f92672">.</span><span style="color:#a6e22e">accept</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// æš«åœ 5 ç§’
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>5000<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// è¼¸å‡ºè¨Šæ¯çµ¦ Socket çš„ç”¨æˆ¶ç«¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                PrintWriter pw <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PrintWriter<span style="color:#f92672">(</span>clientSock<span style="color:#f92672">.</span><span style="color:#a6e22e">getOutputStream</span><span style="color:#f92672">(),</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                pw<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;feedback_from_&#34;</span> <span style="color:#f92672">+</span> port<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// é—œé–‰ Socket ç¶²è·¯é€£ç·š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                serverSock<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>                clientSock<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="ç¯„ä¾‹äºŒ--å»ºç«‹é¡åˆ¥-singlethreadtest-é©—è­‰ä½¿ç”¨å–®ä¸€åŸ·è¡Œç·’ä¾åºè¨ªå•äº”å€‹-socket-ä¸»æ©Ÿ">ç¯„ä¾‹äºŒ : å»ºç«‹é¡åˆ¥ <code>SingleThreadTest</code> é©—è­‰ä½¿ç”¨å–®ä¸€åŸ·è¡Œç·’ä¾åºè¨ªå•äº”å€‹ Socket ä¸»æ©Ÿ</h4>
<ul>
<li>ä½¿ç”¨å–®ä¸€åŸ·è¡Œç·’é€ port é€£ç·šä¸»æ©Ÿçš„çµæœï¼Œå¿…é ˆä½¿ç”¨ <code>5sec * 5 = 25sec</code> çš„æ™‚é–“</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;SingleThread starts at: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    String host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;localhost&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> 10000<span style="color:#f92672">;</span> port <span style="color:#f92672">&lt;</span> 10005<span style="color:#f92672">;</span> port<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>Socket sock <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Socket<span style="color:#f92672">(</span>host<span style="color:#f92672">,</span> port<span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>               Scanner scanner <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Scanner<span style="color:#f92672">(</span>sock<span style="color:#f92672">.</span><span style="color:#a6e22e">getInputStream</span><span style="color:#f92672">());)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            String feedback <span style="color:#f92672">=</span> scanner<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Call &#34;</span> <span style="color:#f92672">+</span> host <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span> port <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#e6db74">&#34;, and get: &#34;</span> <span style="color:#f92672">+</span> feedback <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; at &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>NoSuchElementException <span style="color:#f92672">|</span> IOException ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            out<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Error talking to &#34;</span> <span style="color:#f92672">+</span> host <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span> port<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="ç¯„ä¾‹ä¸‰--å»ºç«‹é¡åˆ¥-socketclientcallable-å¯¦ä½œ-callable-ä»‹é¢">ç¯„ä¾‹ä¸‰ : å»ºç«‹é¡åˆ¥ <code>SocketClientCallable</code> å¯¦ä½œ <code>Callable</code> ä»‹é¢</h4>
<ul>
<li>ç”¨ä»¥å®šç¾©å¤šåŸ·è¡Œç·’è¨ªå• <code>Socket</code> ä¸»æ©Ÿçš„å·¥ä½œå…§å®¹</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SocketClientCallable</span> <span style="color:#66d9ef">implements</span> Callable<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String host<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> port<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">SocketClientCallable</span><span style="color:#f92672">(</span>String host<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> port<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">host</span> <span style="color:#f92672">=</span> host<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> port<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">call</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>Socket sock <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Socket<span style="color:#f92672">(</span>host<span style="color:#f92672">,</span> port<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>              Scanner scanner <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Scanner<span style="color:#f92672">(</span>sock<span style="color:#f92672">.</span><span style="color:#a6e22e">getInputStream</span><span style="color:#f92672">());</span> <span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            String feedback <span style="color:#f92672">=</span> scanner<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> feedback<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="ç¯„ä¾‹å››--å»ºç«‹é¡åˆ¥-multithreadtest-é©—è­‰ä½¿ç”¨å¤šåŸ·è¡Œç·’è¨ªå•-5-å€‹-socket-ä¸»æ©Ÿçš„æƒ…æ³">ç¯„ä¾‹å›› : å»ºç«‹é¡åˆ¥ <code>MultiThreadTest</code> é©—è­‰ä½¿ç”¨å¤šåŸ·è¡Œç·’è¨ªå• 5 å€‹ Socket ä¸»æ©Ÿçš„æƒ…æ³</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MultiThreadTest</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;MultiThreadTest starts at: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>        ExecutorService es <span style="color:#f92672">=</span> Executors<span style="color:#f92672">.</span><span style="color:#a6e22e">newCachedThreadPool</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        String host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;localhost&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        Map<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> Future<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;&gt;</span> callables <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ä¾ä¸åŒ port è™Ÿé€å‡ºcallableå·¥ä½œçµ¦åŸ·è¡Œç·’æ± åŸ·è¡Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> prot <span style="color:#f92672">=</span> 10000<span style="color:#f92672">;</span> port <span style="color:#f92672">&lt;</span> 10005<span style="color:#f92672">;</span> port<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            SockeClientCallable callable <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SocketClientCallable<span style="color:#f92672">(</span>host<span style="color:#f92672">,</span> port<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            Future<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> future <span style="color:#f92672">=</span> es<span style="color:#f92672">.</span><span style="color:#a6e22e">submit</span><span style="color:#f92672">(</span>callable<span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// å®šç¾©futureç‰©ä»¶æ‰¿æ¥åŸ·è¡Œçµæœ,ä½†å…ˆä¸å‘¼å«get()æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            callables<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span>port<span style="color:#f92672">,</span> future<span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// å°‡futureç‰©ä»¶å…ˆå­˜åœ¨callablesï¼Œä»¥Integerå‹åˆ¥çš„portä½œç‚ºéµå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// é—œé–‰ ExecutorService
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        es<span style="color:#f92672">.</span><span style="color:#a6e22e">shutdown</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            es<span style="color:#f92672">.</span><span style="color:#a6e22e">awaitTermination</span><span style="color:#f92672">(</span>5<span style="color:#f92672">,</span> TimeUnit<span style="color:#f92672">.</span><span style="color:#a6e22e">SECONDS</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Stopped waiting &#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å–å›çµæœ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Integer port <span style="color:#f92672">:</span> callables<span style="color:#f92672">.</span><span style="color:#a6e22e">keySet</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>  <span style="color:#75715e">// ln 26
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            Future<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> future <span style="color:#f92672">=</span> callables<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>port<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                String feedback <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Call &#34;</span> <span style="color:#f92672">+</span> host <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>                    port <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, and get: &#34;</span> <span style="color:#f92672">+</span> feedback <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; at &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>ExecutionException <span style="color:#f92672">|</span> InterruptedException ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Error talking to &#34;</span> <span style="color:#f92672">+</span> host <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span> port<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#75715e">// ln 26~: åœ¨callablesä¸­æ‰¾å‡ºæ‰€æœ‰Futureç‰©ä»¶ï¼Œä¸¦å‘¼å«get()å–å›çµæœ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>&hellip;</p>
<h2 id="ä½¿ç”¨-fork-join-æ¡†æ¶åŒæ™‚åŸ·è¡Œå¤šæ¨£å·¥ä½œ">ä½¿ç”¨ Fork-Join æ¡†æ¶åŒæ™‚åŸ·è¡Œå¤šæ¨£å·¥ä½œ</h2>
<h3 id="å¹³è¡Œè™•ç†çš„ç­–ç•¥">å¹³è¡Œè™•ç†çš„ç­–ç•¥</h3>
<ul>
<li>
<p>ç‚ºäº†ä½¿å¤šå€‹CPUé‹ç®—æ•ˆèƒ½æœ€ä½³åŒ–ï¼Œå¯ä»¥è®“ç¨‹å¼åŒæ™‚åŸ·è¡Œå·¥ä½œï¼Œã€Œå¹³è¡Œè™•ç†ï¼ˆ<code>parallelism</code>ï¼‰ã€ç­–ç•¥å¾ˆé‡è¦</p>
<ol>
<li>
<p>å°‡å·¥ä½œåˆ†åˆ‡æˆå°æ®µï¼Œå„è‡ªå®Œæˆå¾Œå·¥ä½œå°±å¯ä»¥è§£æ±º</p>
<ul>
<li>ç¨±ç‚º <code>divide and conquer</code> è™•ç†ç­–ç•¥</li>
<li>ä½¿ç”¨å‰éœ€ç¢ºèªé€™äº›å°æ®µå·¥ä½œå¯ä»¥å¹³è¡Œè™•ç†</li>
</ul>
</li>
<li>
<p>åˆ†å‰²æ™‚æ³¨æ„ç¡¬é«”æ•ˆèƒ½å•é¡Œï¼Œåˆ‡å‰²å¤ªç´°å¯èƒ½æœ‰åæ•ˆæœ</p>
<ul>
<li>
<p>å¦‚æœå·¥ä½œå…§å®¹éœ€è¦å¤§é‡ CPU è¨ˆç®—è€Œé I/O å­˜å–ï¼Œéœ€è€ƒæ…® CPU æ•¸é‡</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> Runtime<span style="color:#f92672">.</span><span style="color:#a6e22e">getRuntime</span><span style="color:#f92672">().</span><span style="color:#a6e22e">availableProcessors</span><span style="color:#f92672">();</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ol>
<blockquote>
<p>å¹³è¡Œè™•ç†ç­–ç•¥ç¬¬ä¸€æ­¥ï¼šåˆ‡å‰²è³‡æ–™è®“å¤šåŸ·è¡Œç·’å¯ä»¥å¹³è¡ŒåŸ·è¡Œ</p>
<p>å¦‚ä½•åˆ‡å‰²ï¼Ÿ</p>
<p>æœ€ç†æƒ³æƒ…æ³ï¼šè®“æ‰€æœ‰ CPU å¯ä»¥å……åˆ†è¢«æ‰€æœ‰åŸ·è¡Œç·’åˆ©ç”¨ï¼Œç›´åˆ°å·¥ä½œçµæŸ</p>
</blockquote>
</li>
</ul>
<h4 id="ä½¿ç”¨å¹³å‡åˆ†é…æ–¹å¼ç™¼æ®-cpu-è¨ˆç®—é‡èƒ½">ä½¿ç”¨ã€Œå¹³å‡åˆ†é…ã€æ–¹å¼ç™¼æ® CPU è¨ˆç®—é‡èƒ½</h4>
<ul>
<li>è®“æ¯ä¸€å€‹åŸ·è¡Œç·’å„è‡ªå ç”¨ä¸åŒçš„ CPU è™•ç†ç›¸åŒåˆ†é‡çš„å·¥ä½œï¼Œå®¹æ˜“å› ç‚ºä»¥ä¸‹åŸå› å°è‡´ç„¡æ³•ç™¼æ®ç¡¬é«”æœ€é«˜æ€§èƒ½
<ol>
<li>æ¯ä¸€å€‹ CPU å¯èƒ½æ•ˆç‡ä¸åŒ</li>
<li>æŸäº› CPU å¯èƒ½ä¹Ÿåœ¨åŸ·è¡Œå…¶å®ƒç¨‹å¼</li>
</ol>
</li>
<li>è®“åä½åŒå­¸æ‰“æƒç›¸åŒé¢ç©çš„ç©ºåœ°ï¼Œå› ç‚ºæ¯å€‹äººæ•ˆç‡ä¸åŒï¼Œä¸æœƒåŒæ™‚å®Œæˆ</li>
</ul>
<h4 id="ä½¿ç”¨å·¥ä½œç«Šå–æ–¹å¼ç™¼æ®-cpu-è¨ˆç®—é‡èƒ½">ä½¿ç”¨ã€Œå·¥ä½œç«Šå–ã€æ–¹å¼ç™¼æ® CPU è¨ˆç®—é‡èƒ½</h4>
<ul>
<li>ç¨±ç‚ºã€Œå·¥ä½œç«Šå–ã€çš„å¹³è¡Œé‹ç®—æ¶æ§‹ï¼šå¹³å‡åˆ‡å‰²å·¥ä½œï¼Œä½†æ•¸é‡é å¤šæ–¼åŸ·è¡Œç·’å€‹æ•¸
<ol>
<li>å·¥ä½œä¸æœƒé¦¬ä¸Šå®Œæˆï¼Œæ¯ä¸€å€‹åŸ·è¡Œç·’æœƒæœ‰å¾ˆå¤šå¾…è¾¦å·¥ä½œåœ¨è‡ªå·±çš„ä½‡åˆ—</li>
<li>è‹¥æŸåŸ·è¡Œç·’å·²å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œå¯ä»¥ç«Šå–å…¶å®ƒäººçš„å·¥ä½œ</li>
<li>åˆé©çš„åˆ‡å‰²ä»½é‡ä¸å®¹æ˜“é”æˆ
<ul>
<li>åˆ‡å¤ªå¤šï¼šåˆ‡å‰²æœ¬èº«å³æ˜¯è² æ“”</li>
<li>åˆ‡å¤ªå°‘ï¼šç„¡æ³•å……åˆ†åˆ©ç”¨ CPU è³‡æº</li>
</ul>
</li>
<li>èƒ½è€…å¤šå‹ç†å¿µçš„å¯¦è¸ â€” Java 7 æ¨å‡º <code>Fork-Join</code>æ¡†æ¶</li>
</ol>
</li>
</ul>
<h3 id="å¥—ç”¨-fork-join-æ¡†æ¶">å¥—ç”¨ <code>Fork-Join</code> æ¡†æ¶</h3>
<h4 id="ç¯„ä¾‹ä¸€ä½¿ç”¨å–®ä¸€åŸ·è¡Œç·’è™•ç†">ç¯„ä¾‹ä¸€ï¼šä½¿ç”¨å–®ä¸€åŸ·è¡Œç·’è™•ç†</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SingleThreadTest</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">maind</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> bigData <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[</span>1024 <span style="color:#f92672">*</span> 1024 <span style="color:#f92672">*</span> 256<span style="color:#f92672">];</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> bigData<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            bigData<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> ThreadLocalRandom<span style="color:#f92672">.</span><span style="color:#a6e22e">current</span><span style="color:#f92672">().</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> max <span style="color:#f92672">=</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">MIN_VALUE</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> value <span style="color:#f92672">:</span> bigData<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>value <span style="color:#f92672">&gt;</span> max<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                max <span style="color:#f92672">=</span> value<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Found max value: &#34;</span> <span style="color:#f92672">+</span> max<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="ç¯„ä¾‹äºŒä½¿ç”¨-fork-join-æ¡†æ¶å¹³è¡Œè™•ç†">ç¯„ä¾‹äºŒï¼šä½¿ç”¨ <code>Fork-Join</code> æ¡†æ¶å¹³è¡Œè™•ç†</h4>
<ul>
<li>
<p><code>ExecutorService</code>ä½¿ç”¨ cached thread pool æˆ– fixed thread pool åŸ·è¡Œ <code>Callable</code> ä»‹é¢å®šç¾©çš„å·¥ä½œå…§å®¹</p>
</li>
<li>
<p><code>Fork-Join</code> æ¡†æ¶å‰‡å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>ExecutorService</code> ç‰¹åŒ–çš„å­é¡åˆ¥ <code>java.util.concurrent.ForkJoinPool</code> åŸ·è¡ŒæŠ½è±¡é¡åˆ¥ <code>java.util.concurrent.ForkJoinTask&lt;V&gt;</code> å®šç¾©çš„å·¥ä½œå…§å®¹</p>
<ol>
<li>
<p><code>ForkJoinTask</code>ç‰©ä»¶ä»£è¡¨éœ€è¦åŸ·è¡Œçš„å·¥ä½œï¼Œå¯è§£é‡‹ç‚ºåˆ†é€²åˆæ“Š</p>
<ul>
<li>ä¸€é–‹å§‹åˆ†é ­é€²è¡Œï¼Œé€æ¼¸æœƒå¸«åˆä½µçµæœ</li>
</ul>
</li>
<li>
<p><code>ForkJoinTask</code>ç‰©ä»¶åŒ…å«è¦è™•ç†çš„è³‡æ–™å’Œè™•ç†æ–¹å¼ï¼Œé¡ä¼¼ <code>Runnable</code> ä»¥åŠ <code>Callable</code></p>
</li>
<li>
<p>å·¨å¤§é‡å·¥ä½œå¯ä»¥ç”± Fork-Join pool å…§å°‘æ•¸åŸ·è¡Œç·’è™•ç†</p>
<ul>
<li>æ¯å€‹åŸ·è¡Œç·’æœƒå·¥ä½œæ»¿æª”ï¼Œå¯ä»¥ç™¼æ®ç¡¬é«”çš„æ¥µè‡´æ€§èƒ½</li>
</ul>
</li>
<li>
<p>é–‹ç™¼è€…é€šå¸¸ç¹¼æ‰¿ <code>ForkJoinTask</code>å­é¡åˆ¥ï¼Œå†å¯¦ä½œ <code>compute()</code> æ–¹æ³•</p>
<ul>
<li>
<p><code>RecursiveAction</code> çš„ <em>compute()</em> æ–¹æ³•æ²’æœ‰å›å‚³çµæœ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RecursiveAction</span> <span style="color:#66d9ef">extends</span> ForkJoinTask<span style="color:#f92672">&lt;</span>Void<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">compute</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
<li>
<p><code>RecursiveTask</code> çš„ <em>compute()</em> æ–¹æ³•éœ€è¦å›å‚³çµæœ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RecursiveTask</span><span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> ForkJoinTask<span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">abstract</span> V <span style="color:#a6e22e">compute</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="æ–¹æ³•-compute-çš„è™•ç†é‚è¼¯">æ–¹æ³• <code>compute()</code> çš„è™•ç†é‚è¼¯</h4>
<ul>
<li>
<p>å»ºç«‹é¡åˆ¥ <code>FindMaxTask</code> ç¹¼æ‰¿ <code>RecursiveTask</code>ï¼Œä½¿ç”¨ <code>Fork-Join</code> æ¡†æ¶åœ¨ <code>1G</code> çš„ <code>int</code> é™£åˆ—è£¡æ‰¾å‡ºæœ€å¤§çš„æ•¸å­—</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">protected</span> RESULT <span style="color:#a6e22e">compute</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>    <span style="color:#75715e">// pseudocode
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>DATA_SMALL_ENOUGH<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        PROCESS_DATA
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> RESULT<span style="color:#f92672">;</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        SPLIT_DATA_INTO_LEFT_AND_RIGHT_PARTS
</span></span><span style="display:flex;"><span>        TASK t1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TASK<span style="color:#f92672">(</span>LEFT_DATA<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å»ºç«‹ä¸€å€‹ç¨±ç‚ºt1çš„ForkJoinTaskè™•ç†å·¦åŠéƒ¨å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        t1<span style="color:#f92672">.</span><span style="color:#a6e22e">fork</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å‘¼å« t1.fork() åšéåŒæ­¥è™•ç†ï¼ˆåˆ†é€²ã€åˆ†é ­è¡Œäº‹ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        TASK t2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TASK<span style="color:#f92672">(</span>RIGHT_DATA<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å»ºç«‹å¦ä¸€å€‹ç¨±ç‚ºt2çš„ForkJoinTaskè™•ç†å³åŠéƒ¨å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> COMBINE<span style="color:#f92672">(</span>t2<span style="color:#f92672">.</span><span style="color:#a6e22e">compute</span><span style="color:#f92672">(),</span> t1<span style="color:#f92672">.</span><span style="color:#a6e22e">join</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div></li>
</ul>
<h5 id="åœ–è§£åˆ†é€²åˆæ“Š">åœ–è§£åˆ†é€²åˆæ“Š</h5>
<ol>
<li>
<p>åŸå§‹è³‡æ–™è™•ç†é‡å¤ªå¤§ï¼Œåˆ†å…©éƒ¨åˆ†æ´¾çµ¦ <code>t1</code>ã€<code>t2</code>å…©å€‹ <code>ForkJoinTask</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/kCNCU6i.png"
        data-srcset="https://i.imgur.com/kCNCU6i.png, https://i.imgur.com/kCNCU6i.png 1.5x, https://i.imgur.com/kCNCU6i.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/kCNCU6i.png"
        title="image-20221222102832964" /></p>
</li>
<li>
<p>å‘¼å«æ–¹æ³•ï¼š</p>
<ul>
<li>
<p><strong>åˆ†é€²</strong> : å‘¼å« <code>t1.fork()</code> æ–¹æ³•èª¿ç”¨ä¸€å€‹åŸ·è¡Œç·’è™•ç†è³‡æ–™</p>
<p><strong>åˆæ“Š</strong> : å‘¼å« <code>join()</code> æ™‚å–å›çµæœ
â†’ ç›®å‰ç´¯è¨ˆä¸€å€‹è¨ˆç®—çµæœæœªå–å›</p>
</li>
<li>
<p>å‘¼å« <code>t2.compute()</code>æ™‚å€™ï¼Œè‹¥è³‡æ–™è™•ç†é‡ä»å¤ªå¤§ï¼ŒæŒçºŒé€²è¡Œåˆ‡å‰²å·¥ä½œ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/U9RbOV0.png"
        data-srcset="https://i.imgur.com/U9RbOV0.png, https://i.imgur.com/U9RbOV0.png 1.5x, https://i.imgur.com/U9RbOV0.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/U9RbOV0.png"
        title="image-20221222102858500" /></p>
</li>
</ul>
</li>
<li>
<p>ç´¯è¨ˆ 2 å€‹è¨ˆç®—çµæœæœªå–å›</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/ySLWUCM.png"
        data-srcset="https://i.imgur.com/ySLWUCM.png, https://i.imgur.com/ySLWUCM.png 1.5x, https://i.imgur.com/ySLWUCM.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/ySLWUCM.png"
        title="image-20221222102925858" /></p>
</li>
<li>
<p>æ¯æ¬¡åˆ‡å‰²å‡ºå»çš„å·¦åŠéƒ¨è³‡æ–™è™•ç†çµæœï¼ˆç´¯è¨ˆ 3 å€‹æœªå–å›ï¼‰</p>
<ul>
<li>ä¸”å³å´è³‡æ–™å·²ç¶“å¤ å°‘ï¼Œå°‡å‘¼å« <code>t2.compute()</code>ä¸å†åˆ‡å‰²ï¼Œç›´æ¥è¨ˆç®—å¾—åˆ°ä¸€å€‹çµæœ</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/GIRMKac.png"
        data-srcset="https://i.imgur.com/GIRMKac.png, https://i.imgur.com/GIRMKac.png 1.5x, https://i.imgur.com/GIRMKac.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/GIRMKac.png"
        title="image-20221222103013124" /></p>
</li>
<li>
<p>é–‹å§‹å°‡è™•ç†çµæœåˆä½µ</p>
<ul>
<li>
<p>è¦å–å¾—å·¦åŠéƒ¨è³‡æ–™è™•ç†çµæœï¼Œéœ€è¦å‘¼å« <code>t1.join()</code> æ–¹æ³•</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/hcA97yC.png"
        data-srcset="https://i.imgur.com/hcA97yC.png, https://i.imgur.com/hcA97yC.png 1.5x, https://i.imgur.com/hcA97yC.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/hcA97yC.png"
        title="image-20221222104039589" /></p>
</li>
</ul>
</li>
<li>
<p>æ‰¿ä¸Šæ­¥é©Ÿï¼Œç¹¼çºŒåˆä½µçµæœ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/6VVcebU.png"
        data-srcset="https://i.imgur.com/6VVcebU.png, https://i.imgur.com/6VVcebU.png 1.5x, https://i.imgur.com/6VVcebU.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/6VVcebU.png"
        title="image-20221222104024864" /></p>
</li>
<li>
<p>å®Œå…¨åˆä½µå¾Œï¼Œå¾—åˆ°çµæœ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://i.imgur.com/OgdMxoQ.png"
        data-srcset="https://i.imgur.com/OgdMxoQ.png, https://i.imgur.com/OgdMxoQ.png 1.5x, https://i.imgur.com/OgdMxoQ.png 2x"
        data-sizes="auto"
        alt="https://i.imgur.com/OgdMxoQ.png"
        title="image-20221222103938211" /></p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FindMaxTask</span> <span style="color:#66d9ef">extends</span> RecursiveTask<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> counter <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">long</span> serialVersionUID <span style="color:#f92672">=</span> 1L<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> threshold<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> data<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> begin<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> end<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">FindMaxTask</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> data<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> begin<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> end<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> threshold<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> data<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">begin</span> <span style="color:#f92672">=</span> begin<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">end</span> <span style="color:#f92672">=</span> end<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">threshold</span> <span style="color:#f92672">=</span> threshold<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">protected</span> Integer <span style="color:#a6e22e">compute</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>end <span style="color:#f92672">-</span> begin <span style="color:#f92672">&lt;</span> threshold<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">printf</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;%02d&#34;</span><span style="color:#f92672">,</span> <span style="color:#f92672">++</span>counter<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>			System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;: &#34;</span> <span style="color:#f92672">+</span> Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">currentThread</span><span style="color:#f92672">().</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>			System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34; |Range: &#34;</span> <span style="color:#f92672">+</span> begin <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; ~ &#34;</span> <span style="color:#f92672">+</span> end<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">// é¡¯ç¤ºç›®å‰æ˜¯ç¬¬Nå€‹é€²è¡Œçš„é‹ç®—,ç”±å“ªå€‹åŸ·è¡Œç·’åŸ·è¡Œ,æœ¬ä¾‹åˆ‡ç‚º16ç­‰åˆ†,N&lt;=16
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">int</span> max <span style="color:#f92672">=</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">MIN_VALUE</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> begin<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;=</span> end<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> data<span style="color:#f92672">[</span>i<span style="color:#f92672">];</span>
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">&gt;</span> max<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>					max <span style="color:#f92672">=</span> n<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>				<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">}</span> <span style="color:#75715e">// è¨ˆç®—è³‡æ–™é™£åˆ—è£¡æœ€å¤§å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>			<span style="color:#66d9ef">return</span> max<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">int</span> mid <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>end <span style="color:#f92672">-</span> begin<span style="color:#f92672">)</span> <span style="color:#f92672">/</span> 2 <span style="color:#f92672">+</span> begin<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>			FindMaxTask a1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FindMaxTask<span style="color:#f92672">(</span>data<span style="color:#f92672">,</span> begin<span style="color:#f92672">,</span> mid<span style="color:#f92672">,</span> threshold<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>			a1<span style="color:#f92672">.</span><span style="color:#a6e22e">fork</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>			FindMaxTask a2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FindMaxTask<span style="color:#f92672">(</span>data<span style="color:#f92672">,</span> mid <span style="color:#f92672">+</span> 1<span style="color:#f92672">,</span> end<span style="color:#f92672">,</span> threshold<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> Math<span style="color:#f92672">.</span><span style="color:#a6e22e">max</span><span style="color:#f92672">(</span>a2<span style="color:#f92672">.</span><span style="color:#a6e22e">compute</span><span style="color:#f92672">(),</span> a1<span style="color:#f92672">.</span><span style="color:#a6e22e">join</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">// ä¸æ–·åˆ‡å‰²è³‡æ–™åˆ°é–€æª»å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ForkJoinMultiThreadTest</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		Date begin <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// è£½ä½œè³‡æ–™é™£åˆ—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> bigData <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[</span>1024 <span style="color:#f92672">*</span> 1024 <span style="color:#f92672">*</span> 256<span style="color:#f92672">];</span> <span style="color:#75715e">// 1G
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> bigData<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>			bigData<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> ThreadLocalRandom<span style="color:#f92672">.</span><span style="color:#a6e22e">current</span><span style="color:#f92672">().</span><span style="color:#a6e22e">nextInt</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">/* ä½¿ç”¨fork-joinæ¡†æ¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">		   å»ºç«‹Fork-Joinæ¡†æ¶çš„å·¥ä½œå…§å®¹ç‰©ä»¶FindMaxTaskï¼Œä¸”è³‡æ–™é™£åˆ—æœƒåˆ‡å‰²ç‚º16ç­‰åˆ†ï¼Œæ‰é€²è¡Œé‹ç®— */</span>
</span></span><span style="display:flex;"><span>		FindMaxTask task <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FindMaxTask<span style="color:#f92672">(</span>bigData<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> bigData<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> 1<span style="color:#f92672">,</span> bigData<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span> <span style="color:#f92672">/</span> 16<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		ForkJoinPool pool <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ForkJoinPool<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		Integer max <span style="color:#f92672">=</span> pool<span style="color:#f92672">.</span><span style="color:#a6e22e">invoke</span><span style="color:#f92672">(</span>task<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// ä½¿ç”¨forkJoinPoolçš„invoke()æ–¹æ³•å‚³å…¥è¦åŸ·è¡Œçš„å·¥ä½œï¼Œè©²æ–¹æ³•æœƒå‘¼å«FindMaxTaskçš„compute()æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\nMax value found:&#34;</span> <span style="color:#f92672">+</span> max<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// è¨ˆæ™‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#66d9ef">long</span> t <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">().</span><span style="color:#a6e22e">getTime</span><span style="color:#f92672">()</span> <span style="color:#f92672">-</span> begin<span style="color:#f92672">.</span><span style="color:#a6e22e">getTime</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Complete task within &#34;</span> <span style="color:#f92672">+</span> t <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; milliseconds&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>&hellip;</p>
<h3 id="fork-join-æ¡†æ¶çš„ä½¿ç”¨å»ºè­°"><code>Fork-Join</code> æ¡†æ¶çš„ä½¿ç”¨å»ºè­°</h3>
<p>Fork-Join æ¡†æ¶å¹¾å€‹éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<ol>
<li>é è¨­æ¯æ ¸ CPU æœƒå»ºç«‹ä¸€å€‹å°æ‡‰çš„åŸ·è¡Œç·’åŸ·è¡Œå·¥ä½œ</li>
<li>ä½¿ç”¨æ™‚æ‡‰è©²å…ˆæ’é™¤ <code>I/O</code> æˆ–æ˜¯å…¶å®ƒå¯èƒ½å¡ä½åŸ·è¡Œç·’å·¥ä½œçš„ç“¶é ¸</li>
<li>äº†è§£è‡ªå·±çš„ç¡¬é«”
<ul>
<li><strong>å–®å€‹ CPU æ™‚ï¼Œä½¿ç”¨ Fork-Join æ¡†æ¶åè€Œæœƒæ¯”è¼ƒæ…¢</strong></li>
<li>æœ‰äº› CPU åªä½¿ç”¨å–®æ ¸æ™‚ï¼Œæœƒæ¯”ä½¿ç”¨å¤šæ ¸å¿«ï¼Œå› æ­¤ä½¿ç”¨ Fork-Join æ¡†æ¶çš„æˆæ•ˆæ„Ÿè¦ºæ›´å°‘</li>
</ul>
</li>
<li>ç›¸è¼ƒæ–¼å–®ä¸€åŸ·è¡Œç·’çš„å¾ªåºåŸ·è¡Œï¼Œ<strong>å¹³è¡ŒåŸ·è¡Œæœƒæœ‰å…ˆåˆ‡å‰²å·¥ä½œçš„é¡å¤–è² æ“”ï¼Œå»¶é•·åŸ·è¡Œæ™‚é–“</strong></li>
</ol>
<hr>
<h1 id="07-ä½¿ç”¨-jdbc-å»ºç«‹è³‡æ–™åº«é€£ç·š">07 ä½¿ç”¨ JDBC å»ºç«‹è³‡æ–™åº«é€£ç·š</h1>
<h2 id="äº†è§£-databasedbms-å’Œ-sql">äº†è§£ Databaseã€DBMS å’Œ SQL</h2>
<p>Java è£¡ä¿å­˜è³‡æ–™ : ç‰©ä»¶åºåˆ—åŒ–æŠ€è¡“ã€ä½¿ç”¨ I/O å°‡è³‡æ–™å„²å­˜æ–¼æª”æ¡ˆä¸­ã€å„²å­˜æ–¼è³‡æ–™åº«ä¸­</p>
<h4 id="åŸºæœ¬åè©ä»‹ç´¹">åŸºæœ¬åè©ä»‹ç´¹</h4>
<h3 id="ä½¿ç”¨sqlå­˜å–è³‡æ–™åº«">ä½¿ç”¨<code>SQL</code>å­˜å–è³‡æ–™åº«</h3>
<h3 id="derby-è³‡æ–™åº«ä»‹ç´¹">Derby è³‡æ–™åº«ä»‹ç´¹</h3>
<h3 id="æ“ä½œ-derby-è³‡æ–™åº«">æ“ä½œ Derby è³‡æ–™åº«</h3>
<h3 id="heading"></h3>
<h2 id="eclipse-é€£ç·šä¸¦å­˜å–è³‡æ–™åº«">Eclipse é€£ç·šä¸¦å­˜å–è³‡æ–™åº«</h2>
<h3 id="é€£ç·šè³‡æ–™åº«">é€£ç·šè³‡æ–™åº«</h3>
<h3 id="å­˜å–è³‡æ–™è¡¨">å­˜å–è³‡æ–™è¡¨</h3>
<h2 id="ä½¿ç”¨-jdbc">ä½¿ç”¨ JDBC</h2>
<h3 id="jdbc-api--æ¦‚è§€">JDBC API  æ¦‚è§€</h3>
<h3 id="å°ˆæ¡ˆå¼•ç”¨è³‡æ–™åº«é©…å‹•å‡½å¼åº«">å°ˆæ¡ˆå¼•ç”¨è³‡æ–™åº«é©…å‹•å‡½å¼åº«</h3>
<h3 id="èªè­˜-jdbc-é©…å‹•å‡½å¼åº«-jar-çš„çµ„æˆ">èªè­˜ JDBC é©…å‹•å‡½å¼åº« JAR çš„çµ„æˆ</h3>
<h4 id="1-jdbc-40-ä¹‹å‰">1. JDBC 4.0 ä¹‹å‰</h4>
<h4 id="2-jdbc-40-ä¹‹å¾Œ">2. JDBC 4.0 ä¹‹å¾Œ</h4>
<blockquote>
<p>ğŸªâ˜• <strong>Little Tips:</strong> Derby è³‡æ–™åº«å†ç‰ˆæœ¬ 10.14.2.0 èˆ‡ 10.15.2.0 çš„å·®åˆ¥</p>
<table>
<thead>
<tr>
<th>Derby è³‡æ–™åº«ç‰ˆæœ¬ 10.14.2.0</th>
<th>Derby è³‡æ–™åº«ç‰ˆæœ¬ 10.15.2.0</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ”¯æ´ Java 8</td>
<td>å»ºè­° Java 9 ä»¥ä¸Šï¼ˆä½¿ç”¨æ¨¡çµ„åŒ–æŠ€è¡“ï¼‰</td>
</tr>
<tr>
<td>ç‰ˆæœ¬é©…å‹•ç¨‹å¼å…¥å£é¡åˆ¥<!-- raw HTML omitted --><code>org.apache.derby.jdbc.ClientDriver</code></td>
<td>å¾Œä¾†æ˜¯ <!-- raw HTML omitted --><code>org.apache.derby.client.ClientAutoloadedDriver</code></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</blockquote>
<h2 id="jdbc-é€²è¡Œäº¤æ˜“">JDBC é€²è¡Œäº¤æ˜“</h2>
<h2 id="ä½¿ç”¨-jdbc-41-çš„-rowsetprovider-å’Œ-rowsetfactory">ä½¿ç”¨ JDBC 4.1 çš„ RowSetProvider å’Œ RowSetFactory</h2>
<hr>
<h1 id="08-java-çš„å€åŸŸåŒ–-localization">08 Java çš„å€åŸŸåŒ– <em>Localization</em></h1>
<h2 id="äº†è§£-java-çš„è»Ÿé«”å€åŸŸåŒ–ä½œæ³•">äº†è§£ Java çš„è»Ÿé«”å€åŸŸåŒ–ä½œæ³•</h2>
<h2 id="ä½¿ç”¨-dateformat-é¡åˆ¥æä¾›æ—¥æœŸçš„å€åŸŸåŒ–é¡¯ç¤º">ä½¿ç”¨ DateFormat é¡åˆ¥æä¾›æ—¥æœŸçš„å€åŸŸåŒ–é¡¯ç¤º</h2>
<h2 id="ä½¿ç”¨-numberformat-é¡åˆ¥æä¾›å¹£åˆ¥å€åŸŸåŒ–é¡¯ç¤º">ä½¿ç”¨ NumberFormat é¡åˆ¥æä¾›å¹£åˆ¥å€åŸŸåŒ–é¡¯ç¤º</h2>
<hr>
<h1 id="09-lambda-è¡¨ç¤ºå¼çš„æ‡‰ç”¨">09 Lambda è¡¨ç¤ºå¼çš„æ‡‰ç”¨</h1>
<h2 id="ä½¿ç”¨-lambda-è¡¨ç¤ºå¼">ä½¿ç”¨ Lambda è¡¨ç¤ºå¼</h2>
<h2 id="ä½¿ç”¨å…§å»ºçš„åŠŸèƒ½æ€§ä»‹é¢">ä½¿ç”¨å…§å»ºçš„åŠŸèƒ½æ€§ä»‹é¢</h2>
<h2 id="åœ¨æ³›å‹å…§ä½¿ç”¨è¬ç”¨å­—å…ƒ">åœ¨æ³›å‹å…§ä½¿ç”¨è¬ç”¨å­—å…ƒ</h2>
<h2 id="ä½¿ç”¨å…¶å®ƒå…§å»ºçš„åŠŸèƒ½æ€§ä»‹é¢">ä½¿ç”¨å…¶å®ƒå…§å»ºçš„åŠŸèƒ½æ€§ä»‹é¢</h2>
<h2 id="ä½¿ç”¨æ–¹æ³•åƒç…§">ä½¿ç”¨æ–¹æ³•åƒç…§</h2>
<hr>
<h1 id="10-ä½¿ç”¨-stream-api">10 ä½¿ç”¨ <code>Stream API</code></h1>
<h2 id="å»ºæ§‹è€…è¨­è¨ˆæ¨¡å¼å’Œæ–¹æ³•éˆçµ">å»ºæ§‹è€…è¨­è¨ˆæ¨¡å¼å’Œæ–¹æ³•éˆçµ</h2>
<h2 id="ä½¿ç”¨-optional-é¡åˆ¥">ä½¿ç”¨ Optional é¡åˆ¥</h2>
<h2 id="stream-api-ä»‹ç´¹">Stream API ä»‹ç´¹</h2>
<h2 id="stream-api-æ“ä½œ">Stream API æ“ä½œ</h2>
<h2 id="stream-api-å’Œ-nio2">Stream API å’Œ NIO.2</h2>
<h2 id="stream-api-æ“ä½œå¹³è¡ŒåŒ–">Stream API æ“ä½œå¹³è¡ŒåŒ–</h2>
<hr>
<h1 id="11-datetime-api">11 Date/Time API</h1>
<h2 id="date--time-ç›¸é—œé¡åˆ¥çš„æ¼”é€²">Date &amp; Time ç›¸é—œé¡åˆ¥çš„æ¼”é€²</h2>
<h2 id="ç•¶åœ°æ—¥æœŸèˆ‡æ™‚é–“">ç•¶åœ°æ—¥æœŸèˆ‡æ™‚é–“</h2>
<h2 id="æ™‚å€å’Œæ—¥å…‰ç¯€ç´„æ™‚é–“">æ™‚å€å’Œæ—¥å…‰ç¯€ç´„æ™‚é–“</h2>
<h2 id="æè¿°æ—¥æœŸèˆ‡æ™‚é–“çš„æ•¸é‡">æè¿°æ—¥æœŸèˆ‡æ™‚é–“çš„æ•¸é‡</h2>
<hr>
<h1 id="12-æ¨™è¨»å‹åˆ¥-annotation">12 æ¨™è¨»å‹åˆ¥ <em>Annotation</em></h1>
<h2 id="èªè­˜æ¨™è¨»å‹åˆ¥">èªè­˜æ¨™è¨»å‹åˆ¥</h2>
<h2 id="å»ºç«‹è‡ªå®šç¾©æ¨™è¨»å‹åˆ¥">å»ºç«‹è‡ªå®šç¾©æ¨™è¨»å‹åˆ¥</h2>
<h2 id="æ¨™è¨»å‹åˆ¥çš„æ‡‰ç”¨">æ¨™è¨»å‹åˆ¥çš„æ‡‰ç”¨</h2>
<h2 id="è‡ªå®šç¾©æ¨™è¨»å‹åˆ¥æ™‚ä½¿ç”¨çš„å…§å»ºæ¨™è¨»å‹åˆ¥">è‡ªå®šç¾©æ¨™è¨»å‹åˆ¥æ™‚ä½¿ç”¨çš„å…§å»ºæ¨™è¨»å‹åˆ¥</h2>
<h2 id="é–‹ç™¼ä¸€èˆ¬ç¨‹å¼ç¢¼ç¶“å¸¸ä½¿ç”¨çš„å…§å»ºæ¨™è¨»å‹åˆ¥">é–‹ç™¼ä¸€èˆ¬ç¨‹å¼ç¢¼ç¶“å¸¸ä½¿ç”¨çš„å…§å»ºæ¨™è¨»å‹åˆ¥</h2>
<hr>
<h1 id="13-java-å¹³å°æ¨¡çµ„ç³»çµ±">13 Java å¹³å°æ¨¡çµ„ç³»çµ±</h1>
<h2 id="èªè­˜-java-æ¨¡çµ„åŒ–">èªè­˜ Java æ¨¡çµ„åŒ–</h2>
<h2 id="å»ºç«‹å’ŒåŸ·è¡Œæ¨¡çµ„åŒ–ç¨‹å¼">å»ºç«‹å’ŒåŸ·è¡Œæ¨¡çµ„åŒ–ç¨‹å¼</h2>
<h2 id="å»ºç«‹ç›¸ä¾æ¨¡çµ„ç¨‹å¼">å»ºç«‹ç›¸ä¾æ¨¡çµ„ç¨‹å¼</h2>
<h2 id="èªè­˜-module-infojava-çš„å®£å‘Šé—œéµå­—">èªè­˜ <code>module-info.java</code> çš„å®£å‘Šé—œéµå­—</h2>
<h2 id="åœ¨å‘½ä»¤åˆ—-command-line-ä½¿ç”¨æ¨¡çµ„æŒ‡ä»¤é¸é …">åœ¨å‘½ä»¤åˆ— <code>command line</code> ä½¿ç”¨æ¨¡çµ„æŒ‡ä»¤é¸é …</h2>
<hr>
<h1 id="14-æ¨¡çµ„åŒ–æ‡‰ç”¨ç¨‹å¼">14 æ¨¡çµ„åŒ–æ‡‰ç”¨ç¨‹å¼</h1>
<h2 id="å›é¡§æ¨¡çµ„æŒ‡ä»¤">å›é¡§æ¨¡çµ„æŒ‡ä»¤</h2>
<h2 id="æ¯”è¼ƒæ¨¡çµ„é¡å‹">æ¯”è¼ƒæ¨¡çµ„é¡å‹</h2>
<h2 id="åˆ†æ-jdk-ä¾è³´é—œä¿‚">åˆ†æ JDK ä¾è³´é—œä¿‚</h2>
<h2 id="æ¨¡çµ„åŒ–æ—¢æœ‰æ‡‰ç”¨ç¨‹å¼">æ¨¡çµ„åŒ–æ—¢æœ‰æ‡‰ç”¨ç¨‹å¼</h2>
<h2 id="æ¨¡çµ„åŒ–-java-æœå‹™çµæ§‹">æ¨¡çµ„åŒ– Java æœå‹™çµæ§‹</h2>
<hr>
<h1 id="15-é–‹ç™¼å®‰å…¨çš„-java-ç¨‹å¼">15 é–‹ç™¼å®‰å…¨çš„ Java ç¨‹å¼</h1>
<h2 id="è¨­è¨ˆå®‰å…¨ç‰©ä»¶">è¨­è¨ˆå®‰å…¨ç‰©ä»¶</h2>
<h2 id="æ³¨å…¥-injection-æ”»æ“Šèˆ‡è¼¸å…¥-input-é©—è­‰">æ³¨å…¥ <em>injection</em> æ”»æ“Šèˆ‡è¼¸å…¥ <em>input</em> é©—è­‰</h2>
<h2 id="è™•ç†æ©Ÿæ•è³‡è¨Š">è™•ç†æ©Ÿæ•è³‡è¨Š</h2>
<h2 id="åºåˆ—åŒ–èˆ‡ååºåˆ—åŒ–ç‰©ä»¶">åºåˆ—åŒ–èˆ‡ååºåˆ—åŒ–ç‰©ä»¶</h2>
<h2 id="å»ºç«‹ä¿è­·æ©Ÿæ•è³‡æ–™çš„å®‰å…¨ç‰©ä»¶">å»ºç«‹ä¿è­·æ©Ÿæ•è³‡æ–™çš„å®‰å…¨ç‰©ä»¶</h2>
<h2 id="é¿å…æœå‹™é˜»æ–·-denial-of-service-æ”»æ“Š">é¿å…æœå‹™é˜»æ–· <em>denial of service</em> æ”»æ“Š</h2>
<hr>
<h1 id="16-mock-exam--analysis">16 Mock exam &amp; analysis</h1>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2022-12-18</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://wysiwyz.github.io/posts/ocpjp_11_2/" data-title="1Z0-819 æ›¾å¸«ç­†è¨˜ (2/duology)" data-via="cel_yi" data-hashtags="Java,1Z0-819"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://wysiwyz.github.io/posts/ocpjp_11_2/" data-hashtag="Java"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://wysiwyz.github.io/posts/ocpjp_11_2/" data-title="1Z0-819 æ›¾å¸«ç­†è¨˜ (2/duology)"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://wysiwyz.github.io/posts/ocpjp_11_2/" data-title="1Z0-819 æ›¾å¸«ç­†è¨˜ (2/duology)"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on å¾®åš" data-sharer="weibo" data-url="http://wysiwyz.github.io/posts/ocpjp_11_2/" data-title="1Z0-819 æ›¾å¸«ç­†è¨˜ (2/duology)"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/java/">Java</a>,&nbsp;<a href="/tags/1z0-819/">1Z0-819</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/ocpjp_11/" class="prev" rel="prev" title="1Z0-819 æ›¾å¸«ç­†è¨˜ (1/duology)"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>1Z0-819 æ›¾å¸«ç­†è¨˜ (1/duology)</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">strict with yourself; lenient with others.</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-CCS3QPVY5N', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-CCS3QPVY5N" async></script></body>
</html>
