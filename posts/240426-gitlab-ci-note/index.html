<!DOCTYPE html>
<html lang="en-us">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>åˆæ¢GitLab CI/CD - å¦‚ä½•æ’°å¯«.gitlab-ci.yml - Ich bin yiwen.</title><meta name="Description" content="An ordinary space for storing and groups pieces of articles."><meta property="og:url" content="http://localhost:1313/posts/240426-gitlab-ci-note/">
  <meta property="og:site_name" content="Ich bin yiwen.">
  <meta property="og:title" content="åˆæ¢GitLab CI/CD - å¦‚ä½•æ’°å¯«.gitlab-ci.yml">
  <meta property="og:description" content="ä½¿ç”¨ CI/CD å»ºæ§‹æ‡‰ç”¨ç¨‹å¼ é–‹å§‹ CI/CD æ˜¯è»Ÿé«”é–‹ç™¼å…¶ä¸­ä¸€å€‹continuous methodï¼Œä½ å¯ä»¥åœ¨é€™æ–¹æ³•ä¸­æŒçºŒçš„å»ºæ§‹ã€æ¸¬è©¦ã€éƒ¨ç½²ã€ç›£æ¸¬è¿­ä»£çš„ç¨‹å¼ç¢¼ç•°å‹•ã€‚
é€™ç¨®æ–¹å¼æœ‰åŠ©æ–¼é™ä½åœ¨æœ‰èª¤çš„å‰ä¸€å€‹ç‰ˆæœ¬ä¸­é–‹ç™¼æ–°ç¨‹å¼ï¼ŒGitLab CI/CDåœ¨é–‹ç™¼æ—©æœŸéšæ®µå°±èƒ½æŠ“éŒ¯ï¼Œç¢ºä¿éƒ¨ç½²åˆ°æ­£å¼ç’°å¢ƒçš„ç¨‹å¼ç¢¼ç¬¦åˆæ‰€å»ºç«‹çš„ç¨‹å¼ç¢¼æ¨™æº–ï¼Œè€Œé€™å€‹ç¨‹åºæ˜¯æ›´å¤§çš„workflowä¹‹ä¸­çš„ä¸€å€‹ç’°ç¯€:
Plan Create Verify Secure Release Monitor Manage your organization Learn Git Use CI/CD to build your app Secure your app Deploy and release your app Monitor app performance Organize work with projects Manage your code Manage infrastructure Monitor GitLab Runner usage Plan and track work Analyze GitLab usage 1. é¦–å…ˆå»ºç«‹.gitlab-ci.yml åœ¨projectæ ¹ç›®éŒ„å»ºç«‹ .gitlab-ci.ymlï¼Œå®šç¾©åœ¨CI/CD pipelineä¸­æ‰€è¦åŸ·è¡Œçš„ stages, jobs, scriptã€‚
å¦å¤–ä¹Ÿæœƒå®šç¾©variablesï¼Œä¸åŒjobsä¹‹é–“çš„ä¾è³´é—œä¿‚ï¼Œä¸¦ä¸”æŒ‡å®šæ¯å€‹jobä»€éº¼æ™‚å€™æœƒè¢«åŸ·è¡Œï¼Œæ‡‰è©²å¦‚ä½•è¢«åŸ·è¡Œã€‚
æ²’æœ‰ç¡¬æ€§è¦å®šè¦æ€éº¼å‘½åï¼Œä½†.gitlab-ci.ymlæ˜¯é€™å€‹ CI/CD configuration file æœ€å¸¸è¦‹çš„åå­—ã€‚">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-26T21:38:35+08:00">
    <meta property="article:modified_time" content="2024-04-26T21:38:35+08:00">
    <meta property="article:tag" content="CI/CD Yaml Syntax">
    <meta property="article:tag" content="Pipeline">
    <meta property="article:tag" content="Job">
    <meta property="article:tag" content="CI/CD Components">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="åˆæ¢GitLab CI/CD - å¦‚ä½•æ’°å¯«.gitlab-ci.yml">
  <meta name="twitter:description" content="ä½¿ç”¨ CI/CD å»ºæ§‹æ‡‰ç”¨ç¨‹å¼ é–‹å§‹ CI/CD æ˜¯è»Ÿé«”é–‹ç™¼å…¶ä¸­ä¸€å€‹continuous methodï¼Œä½ å¯ä»¥åœ¨é€™æ–¹æ³•ä¸­æŒçºŒçš„å»ºæ§‹ã€æ¸¬è©¦ã€éƒ¨ç½²ã€ç›£æ¸¬è¿­ä»£çš„ç¨‹å¼ç¢¼ç•°å‹•ã€‚
é€™ç¨®æ–¹å¼æœ‰åŠ©æ–¼é™ä½åœ¨æœ‰èª¤çš„å‰ä¸€å€‹ç‰ˆæœ¬ä¸­é–‹ç™¼æ–°ç¨‹å¼ï¼ŒGitLab CI/CDåœ¨é–‹ç™¼æ—©æœŸéšæ®µå°±èƒ½æŠ“éŒ¯ï¼Œç¢ºä¿éƒ¨ç½²åˆ°æ­£å¼ç’°å¢ƒçš„ç¨‹å¼ç¢¼ç¬¦åˆæ‰€å»ºç«‹çš„ç¨‹å¼ç¢¼æ¨™æº–ï¼Œè€Œé€™å€‹ç¨‹åºæ˜¯æ›´å¤§çš„workflowä¹‹ä¸­çš„ä¸€å€‹ç’°ç¯€:
Plan Create Verify Secure Release Monitor Manage your organization Learn Git Use CI/CD to build your app Secure your app Deploy and release your app Monitor app performance Organize work with projects Manage your code Manage infrastructure Monitor GitLab Runner usage Plan and track work Analyze GitLab usage 1. é¦–å…ˆå»ºç«‹.gitlab-ci.yml åœ¨projectæ ¹ç›®éŒ„å»ºç«‹ .gitlab-ci.ymlï¼Œå®šç¾©åœ¨CI/CD pipelineä¸­æ‰€è¦åŸ·è¡Œçš„ stages, jobs, scriptã€‚
å¦å¤–ä¹Ÿæœƒå®šç¾©variablesï¼Œä¸åŒjobsä¹‹é–“çš„ä¾è³´é—œä¿‚ï¼Œä¸¦ä¸”æŒ‡å®šæ¯å€‹jobä»€éº¼æ™‚å€™æœƒè¢«åŸ·è¡Œï¼Œæ‡‰è©²å¦‚ä½•è¢«åŸ·è¡Œã€‚
æ²’æœ‰ç¡¬æ€§è¦å®šè¦æ€éº¼å‘½åï¼Œä½†.gitlab-ci.ymlæ˜¯é€™å€‹ CI/CD configuration file æœ€å¸¸è¦‹çš„åå­—ã€‚">
<meta name="application-name" content="Ich bin yiwen.">
<meta name="apple-mobile-web-app-title" content="Ich bin yiwen."><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/moon_icon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/posts/240426-gitlab-ci-note/" /><link rel="prev" href="http://localhost:1313/posts/s_nginx/" /><link rel="next" href="http://localhost:1313/posts/240503-non-blocking-jdbc/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "åˆæ¢GitLab CI/CD - å¦‚ä½•æ’°å¯«.gitlab-ci.yml",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/posts\/240426-gitlab-ci-note\/"
        },"genre": "posts","keywords": "CI\/CD yaml syntax, pipeline, job, CI\/CD components","wordcount":  2336 ,
        "url": "http:\/\/localhost:1313\/posts\/240426-gitlab-ci-note\/","datePublished": "2024-04-26T21:38:35+08:00","dateModified": "2024-04-26T21:38:35+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "celine"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Ich bin yiwen.">Ich bin yiwen.</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Ich bin yiwen.">Ich bin yiwen.</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">åˆæ¢GitLab CI/CD - å¦‚ä½•æ’°å¯«.gitlab-ci.yml</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>celine</a></span>&nbsp;<span class="post-category">included in <a href="/categories/studynote/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>StudyNote</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-04-26">2024-04-26</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2336 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;11 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#ä½¿ç”¨-cicd-å»ºæ§‹æ‡‰ç”¨ç¨‹å¼">ä½¿ç”¨ CI/CD å»ºæ§‹æ‡‰ç”¨ç¨‹å¼</a>
      <ul>
        <li><a href="#é–‹å§‹">é–‹å§‹</a></li>
        <li><a href="#cicd-yaml-å¥æ³•åƒè€ƒ">CI/CD YAML å¥æ³•åƒè€ƒ</a></li>
        <li><a href="#pipelines">Pipelines</a></li>
        <li><a href="#jobs">Jobs</a></li>
        <li><a href="#cicd-components">CI/CD components</a></li>
        <li><a href="#variables">Variables</a></li>
        <li><a href="#pipeline-security">Pipeline security</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="ä½¿ç”¨-cicd-å»ºæ§‹æ‡‰ç”¨ç¨‹å¼">ä½¿ç”¨ CI/CD å»ºæ§‹æ‡‰ç”¨ç¨‹å¼</h2>
<h3 id="é–‹å§‹">é–‹å§‹</h3>
<p>CI/CD æ˜¯è»Ÿé«”é–‹ç™¼å…¶ä¸­ä¸€å€‹continuous methodï¼Œä½ å¯ä»¥åœ¨é€™æ–¹æ³•ä¸­æŒçºŒçš„å»ºæ§‹ã€æ¸¬è©¦ã€éƒ¨ç½²ã€ç›£æ¸¬è¿­ä»£çš„ç¨‹å¼ç¢¼ç•°å‹•ã€‚</p>
<p>é€™ç¨®æ–¹å¼æœ‰åŠ©æ–¼é™ä½åœ¨æœ‰èª¤çš„å‰ä¸€å€‹ç‰ˆæœ¬ä¸­é–‹ç™¼æ–°ç¨‹å¼ï¼ŒGitLab CI/CDåœ¨é–‹ç™¼æ—©æœŸéšæ®µå°±èƒ½æŠ“éŒ¯ï¼Œç¢ºä¿éƒ¨ç½²åˆ°æ­£å¼ç’°å¢ƒçš„ç¨‹å¼ç¢¼ç¬¦åˆæ‰€å»ºç«‹çš„ç¨‹å¼ç¢¼æ¨™æº–ï¼Œè€Œé€™å€‹ç¨‹åºæ˜¯æ›´å¤§çš„workflowä¹‹ä¸­çš„ä¸€å€‹ç’°ç¯€:</p>
<table>
<thead>
<tr>
<th>Plan</th>
<th>Create</th>
<th>Verify</th>
<th>Secure</th>
<th>Release</th>
<th>Monitor</th>
</tr>
</thead>
<tbody>
<tr>
<td>Manage your organization</td>
<td>Learn Git</td>
<td><strong>Use CI/CD to build your app</strong></td>
<td>Secure your app</td>
<td>Deploy and release your app</td>
<td>Monitor app performance</td>
</tr>
<tr>
<td>Organize work with projects</td>
<td>Manage your code</td>
<td></td>
<td></td>
<td>Manage infrastructure</td>
<td>Monitor GitLab Runner usage</td>
</tr>
<tr>
<td>Plan and track work</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Analyze GitLab usage</td>
</tr>
</tbody>
</table>
<h5 id="1-é¦–å…ˆå»ºç«‹gitlab-ciyml">1. é¦–å…ˆå»ºç«‹<code>.gitlab-ci.yml</code></h5>
<p>åœ¨projectæ ¹ç›®éŒ„å»ºç«‹ <code>.gitlab-ci.yml</code>ï¼Œå®šç¾©åœ¨CI/CD pipelineä¸­æ‰€è¦åŸ·è¡Œçš„ stages, jobs, scriptã€‚</p>
<p>å¦å¤–ä¹Ÿæœƒå®šç¾©variablesï¼Œä¸åŒjobsä¹‹é–“çš„ä¾è³´é—œä¿‚ï¼Œä¸¦ä¸”æŒ‡å®šæ¯å€‹jobä»€éº¼æ™‚å€™æœƒè¢«åŸ·è¡Œï¼Œæ‡‰è©²å¦‚ä½•è¢«åŸ·è¡Œã€‚</p>
<p>æ²’æœ‰ç¡¬æ€§è¦å®šè¦æ€éº¼å‘½åï¼Œä½†<code>.gitlab-ci.yml</code>æ˜¯é€™å€‹ CI/CD configuration file æœ€å¸¸è¦‹çš„åå­—ã€‚</p>
<h5 id="2-æ¥è‘—å°‹æ‰¾æˆ–æ–°å»º-runners">2. æ¥è‘—å°‹æ‰¾æˆ–æ–°å»º runners</h5>
<p>Runners æ˜¯æ›¿ä½ åŸ·è¡Œ jobs çš„ agentsï¼Œå¯ä»¥åœ¨å¯¦é«”æ©Ÿæˆ–è€…è™›æ“¬instancesä¸Šrun jobsã€‚åœ¨ yml æª”å¯ä»¥æŒ‡å®šä½ run jobsçš„æ™‚å€™ï¼Œè¦æŒ‡å®šä½¿ç”¨çš„container imageã€‚RunneræœƒæŠŠimageè¼‰ä¸‹ä¾†ï¼Œcloneä½ çš„projectï¼Œä¸¦ä¸”åœ¨æœ¬åœ°æˆ–è€…containerè£¡é¢ run the job</p>
<p>å¦‚æœä½¿ç”¨çš„æ˜¯ GitLab.comï¼Œé‚£å°±å·²ç¶“å¯ä»¥ä½¿ç”¨ runners on Linux, Windows and macOSï¼Œä¹Ÿå¯ä»¥åœ¨GitLab.comè¨»å†Šä½ è‡ªå·±çš„runnersã€‚</p>
<p>å¦‚æœä¸æ˜¯ä½¿ç”¨ GitLab.comï¼Œé‚£å¯ä»¥:
(1) åœ¨è‡ªå·±ç®¡ç†çš„instanceï¼Œä½¿ç”¨å·²ç¶“è¨»å†Šçš„runneræˆ–è€…è¨»å†Šä¸€å€‹runner
(2) åœ¨æœ¬æ©Ÿæ–°å»ºä¸€å€‹runner</p>
<h5 id="3-å®šç¾©ä½ çš„-pipelines">3. å®šç¾©ä½ çš„ pipelines</h5>
<p>pipeline å°±æ˜¯å®šç¾©åœ¨ yml æª”çš„æ±è¥¿ï¼Œå³æª”æ¡ˆå…§å®¹åœ¨ runner ä¸ŠåŸ·è¡Œæ™‚æœƒç™¼ç”Ÿçš„äº‹æƒ…ï¼Œæ˜¯ç”± jobs è·Ÿ stages çµ„æˆ:</p>
<ul>
<li>Stages å®šç¾©åŸ·è¡Œçš„é †åºï¼Œé€šå¸¸åŒ…å«<code>build</code>, <code>test</code>, <code>deploy</code></li>
<li>Jobs æŒ‡å®šåœ¨æ¯å€‹ stage æ‰€è¦åŸ·è¡Œçš„ tasksï¼Œä¾‹å¦‚ç·¨è­¯æˆ–æ¸¬è©¦ç¨‹å¼çš„ job</li>
</ul>
<p>pipeline å¯ä»¥è—‰ç”±ä¸åŒé¡å‹çš„äº‹ä»¶è§¸ç™¼ï¼Œä¾‹å¦‚ commits, merges æˆ–è€…ä¾æ’ç¨‹åŸ·è¡Œ</p>
<h5 id="4-ä½¿ç”¨cicd-variableä½œç‚º-jobs-å…¶ä¸­ä¸€éƒ¨åˆ†">4. ä½¿ç”¨CI/CD variableä½œç‚º jobs å…¶ä¸­ä¸€éƒ¨åˆ†</h5>
<p>GitLab CI/CD variable éµå€¼å°æ‡‰ï¼Œæ˜¯ç”¨ä¾†å„²å­˜ã€é…ç½®è¨­å®šä»¥åŠæ©Ÿæ•è³‡è¨Šã€(ä¾‹å¦‚pcodeæˆ–è€…API keys)ï¼Œä¸¦ä¸”å‚³é€² pipeline jobs</p>
<p>æœ‰å…©ç¨® variables: custom variable è·Ÿ predefined variable</p>
<ul>
<li>Custom variable: ç”± user å®šç¾©ï¼Œåœ¨ yml æª”ã€GitLab UIæˆ–è€…APIå»ºç«‹/ç®¡ç†</li>
<li>Predefined variable: ç”± GitLab è‡ªå‹•è¨­å®šï¼Œæä¾›äº†é—œæ–¼ç•¶å‰jobã€pipelineä»¥åŠenviromentç›¸é—œçš„è³‡è¨Š</li>
</ul>
<h5 id="5-ä½¿ç”¨-cicd-components">5. ä½¿ç”¨ CI/CD components</h5>
<p>CI/CD component å¯ä»¥é‡è¤‡ä½¿ç”¨çš„ pipeline é…ç½®å–®ä½ï¼Œä¸€å€‹ pipeline å¯ä»¥ç”±ä¸€å€‹ç”šè‡³å¤šå€‹CI/CD componentçµ„å»ºè€Œæˆã€‚</p>
<p>å¯ä»¥ç”¨<code>include:component</code>é—œéµå­—ä¾†æŠŠ CI/CD component åŠ é€² pipeline è¨­å®šæª”ã€‚</p>
<p>å„ªé»: å¯ä»¥æ¸›å°‘é‡è¤‡ï¼Œæ”¹å–„ç¶­è­·æ€§ï¼Œä½¿æ•´å€‹projectæœ‰æ›´å¥½çš„ä¸€è‡´æ€§</p>
<h4 id="æ¯”è¼ƒè¤‡é›œçš„-pipeline">æ¯”è¼ƒè¤‡é›œçš„ pipeline</h4>
<p>é€™ä¸€å€‹TUTORIALæŒºä¸éŒ¯çš„ï¼Œè·Ÿè‘—åšæœƒå¾—åˆ°ä¸€å€‹ç”¨Docusaurusç”¢å‡ºçš„ç¶²ç«™
<a href="https://docs.gitlab.com/ee/ci/quick_start/tutorial.html" target="_blank" rel="noopener noreffer ">é€£çµåœ¨é€™è£¡</a>
è‡ªå·±çš„ github æ˜¯ç”¨ hugoï¼Œä½† gitlab + docusaurus æ˜¯å‰å…¬å¸å…±ç­†çš„åšæ³•ï¼Œå¾ˆå¥½å¥‡ï¼Œæ‰¾å¤©ä¾†åšçœ‹çœ‹</p>
<ul>
<li><code>image</code>: å‘Šè¨´ runner é€™å€‹ job è¦ä»¥å“ªä¸€å€‹ image çš„ docker container ä¾† runï¼Œé€™è£¡ runner è² è²¬:
<ol>
<li>ä¸‹è¼‰ container image ä¸¦ä¸”å•Ÿå‹•å®ƒ</li>
<li>æŠŠä½ çš„ GitLab project CLONE é€² running container</li>
<li>åŸ·è¡Œ <code>script</code> è£¡é¢åˆ—çš„å‘½ä»¤ (ä¸€æ¬¡ä¸€è¡Œ)</li>
</ol>
</li>
<li><code>artifacts</code>: jobså„è‡ªç¨ç«‹ï¼Œä¸æœƒè·Ÿå…¶ä»– jobs å…±äº«è³‡æºï¼Œå¦‚æœè¦è®“æŸå€‹ job ç”¢å‡ºçš„æª”æ¡ˆèƒ½å¤ ç‚ºå¾ŒçºŒçš„ jobs æ‰€ç”¨ï¼Œå¿…é ˆè¦æŠŠå®ƒå¦å­˜æˆ artifactsï¼Œé€™æ¨£å¾ŒçºŒçš„ jobs å°±èƒ½æ¥æ”¶åˆ° artifacts ä¸¦ä½¿ç”¨ç”¢å‡ºçš„æª”æ¡ˆ
<pre tabindex="0"><code class="language-yml=" data-lang="yml=">build-job:
  image: node
  script:
    - npm install
    - npm run build
  artifacts:
    paths:
      - &#34;build/&#34;
</code></pre></li>
<li><code>allow_failure</code>: æœƒæ–·æ–·çºŒçºŒå¤±æ•—ï¼Œæˆ–è€…é æœŸæœƒå¤±æ•—çš„ job å¯èƒ½æœƒé™ä½ç”Ÿç”¢åŠ›æˆ–è€…é›£ä»¥æ’é™¤éŒ¯èª¤ã€‚ä½¿ç”¨é€™å€‹é—œéµå­—å¯ä»¥è®“ job å¤±æ•—æ™‚ä¸è‡³æ–¼é€ æˆ pipeline åŸ·è¡Œçš„åœæ“º
<ul>
<li><code>allow_failure: true</code></li>
</ul>
</li>
<li><code>dependencies</code>: è—‰ç”±åˆ—å‡º artifacts çš„å–å¾—ä¾†æº jobsï¼Œä¾†ç®¡æ§å€‹åˆ¥çš„ jobs è¦ä¸‹è¼‰çš„ artifacts
<ul>
<li>don&rsquo;t fetch any artifacts: <code>dependencis: []</code></li>
<li>fetch artifacts from dependencies list:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="w">  </span><span class="nt">dependencies</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">build-job</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li><code>rules</code>: åœ¨æ¯å€‹jobsè£¡é¢åŠ ä¸Šrulesï¼Œä»¥é…ç½®é€™äº›jobsæ‡‰è©²åœ¨é‚£äº› pipeline åŸ·è¡Œï¼Œä¾‹å¦‚ merge request pipelineã€scheduled pipelinesã€‚Rulesæ˜¯ç”±é«˜åˆ°ä½ä¾†è©•ä¼°ï¼Œå¦‚æœå…¶ä¸­ä¸€å€‹è¦å‰‡ rules å»åˆï¼Œé€™ job å°±æœƒè¢«åŠ é€² pipeline
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">build-job</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l">build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">node</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">npm install</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">npm run build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">paths</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;build/&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l">$CI_PIPELINE_SOURCE == &#39;merge_request_event&#39;  </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Run for all changes to a merge request&#39;s source branch</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l">$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH       </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Run for all changes to the default branch</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="è¦åŠƒé·ç§»åˆ°-gitlab-cicd">è¦åŠƒé·ç§»åˆ° GitLab CI/CD</h4>
<p>from Bamboo, GitHub actions, Jenkins, a maven build from Jenkins, CircleCI &hellip;</p>
<h4 id="cicd-ç¯„ä¾‹">CI/CD ç¯„ä¾‹</h4>
<p>ä½¿ç”¨ Dpléƒ¨ç½², end-to-end, npm, php</p>
<h3 id="cicd-yaml-å¥æ³•åƒè€ƒ">CI/CD YAML å¥æ³•åƒè€ƒ</h3>
<p>é—œéµå­—åˆ†æˆä¸‰ç¨®é¡å‹: Global keyword, Header keyword, Job keyword (å¦å¤–æœ‰ Deprecated keyword)
<a href="https://docs.gitlab.com/ee/ci/yaml/" target="_blank" rel="noopener noreffer ">CI/CD configuration file syntax reference</a></p>
<p>GitLab Runner é€™æ‡‰ç”¨ç¨‹å¼è·Ÿ GitLab CI/CD å”ä½œåœ¨pipeline run jobsï¼Œæœ‰å…©ç¨® runners:</p>
<ol>
<li>GitLab-hosted runners</li>
</ol>
<p>æ‰€æœ‰ GitLab.com æˆ– GitLab Dedicated ä¸Šé¢å»ºç«‹çš„ project é è¨­éƒ½æœ‰å•Ÿç”¨é€™å€‹ ï¼Œå¦‚æœæœ‰ownerè§’è‰²çš„è©±ï¼Œå¯ä»¥<a href="https://docs.gitlab.com/ee/ci/runners/runners_scope.html#disable-shared-runners" target="_blank" rel="noopener noreffer ">åœç”¨ runners</a></p>
<ol start="3">
<li>Self-managed runners</li>
</ol>
<p>å¦‚æœè¦å»ºè‡ªæœ‰çš„runnerï¼Œé¦–å…ˆè¦å®‰è£GitLab Runnerï¼Œå†åˆ°GitLab.comè¨»å†Šè‡ªæœ‰çš„runner</p>
<p>è‹¥æ˜¯ä½ çš„çµ„ç¹”æœ‰ä¸€æ•´çµ„ runnersï¼Œæ“´å¢ç¸®æ¸›çš„ç›£æ§èª¿æ ¡æ–¹å¼å¯ä»¥<a href="https://docs.gitlab.com/runner/fleet_scaling/index.html" target="_blank" rel="noopener noreffer ">åƒè€ƒé€™è£¡</a></p>
<h4 id="gitlab-runner-tags">GitLab Runner TAGS</h4>
<p>è¨»å†Šå®Œ runner ä¹‹å¾Œï¼Œå¯ä»¥åŠ ä¸Š tagsã€‚é€™å€‹ tag æœƒæ˜ å°„åˆ°æ¯å€‹ jobs è¨­å®š<code>tags:</code>åº•ä¸‹çš„å…§å®¹</p>
<p>Example: ä»¥ä¸‹çš„ job åŸ·è¡Œæ™‚æœƒä½¿ç”¨æ›<code>ruby</code> tagçš„ runner</p>
<pre tabindex="0"><code>job:
  tags:
    - ruby
</code></pre><ul>
<li>ä½¿ç”¨ <code>config.toml</code> è¨­å®š runnerï¼Œé€™æª”æ¡ˆæ˜¯åœ¨ runner installation çš„æ™‚å€™å°±è¼‰ä¸‹ä¾†çš„ã€‚å¯ä»¥ç”¨ä¾†èª¿æ•´å€‹åˆ¥æŒ‡å®šrunneræˆ–è€…æ‰€æœ‰runnersçš„è¨­å®šã€‚å¯ä»¥èª¿ logging, cache, concurrency, memory, CPU limits ç­‰å…¶å®ƒè¨­å®š</li>
<li>ä½¿ç”¨ Prometheus ç›£æ§ runnersï¼Œå¯ä»¥æª¢è¦–ç•¶å‰é‹è¡Œä¸­ jobs çš„æ•¸é‡ï¼Œä»¥åŠé€™äº› runners ç”¨äº†å¤šå°‘ CPU</li>
</ul>
<h4 id="runner-execution-flow">Runner execution flow</h4>
<p>ä»¥ä¸‹æ–‡ç« è§£é‡‹ GitLab, GitLabRunner é‚„æœ‰ Executor ä¹‹é–“çš„é—œä¿‚å¾ˆæ˜“æ‡‚ï¼Œå°±ä¸åœ¨æ­¤è´…è¿°äº†</p>
<ul>
<li><a href="https://chengweichen.com/2021/03/gitlab-ci-executor.html" target="_blank" rel="noopener noreffer ">è‰¦é•·ä½ æœ‰äº‹å— é—œæ–¼Runnerçš„Executor</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLBd8JGCAcUAEwyH2kT1wW2BUmcSPQzGcu" target="_blank" rel="noopener noreffer ">ç‚ºä½ è‡ªå·±å­¸ci/cd</a></li>
</ul>
<h3 id="pipelines">Pipelines</h3>
<p>Pipeline æ˜¯æŒçºŒæ•´åˆã€æŒçºŒäº¤ä»˜ã€æŒçºŒéƒ¨ç½²ä¹‹ä¸­ï¼Œæœ€é«˜å±¤ç´šçš„component</p>
<p>Pipeline åŒ…æ‹¬äº†:</p>
<ul>
<li>Jobs: å®šç¾©äº†è¦åšä»€éº¼äº‹æƒ…ï¼Œä¾‹å¦‚ç·¨è­¯codeçš„jobã€æ¸¬è©¦codeçš„job</li>
<li>Stages: å®šç¾©ä»€éº¼æ™‚å€™è¦runé€™äº›jobsï¼Œä¾‹å¦‚åœ¨compile stageä¹‹å¾Œæ‰åˆ°run tests stage</li>
</ul>
<p>Job æ˜¯ç”± runners åŸ·è¡Œï¼Œå¦‚æœconcurrent runneræ•¸é‡è¶³å¤ çš„è©±ï¼ŒåŒä¸€å€‹stageçš„å¤šå€‹jobsæœƒè¢«å¹³è¡Œè™•ç†ã€‚</p>
<p>å¦‚æœä¸€å€‹stageçš„æ‰€æœ‰jobséƒ½åŸ·è¡ŒæˆåŠŸï¼Œpipelineæ‰æœƒåŸ·è¡Œåˆ°ä¸‹ä¸€å€‹stageã€‚</p>
<p>å¦‚æœä¸€å€‹stageæœ‰ä»»ä½•ä¸€å€‹job failsï¼Œé€šå¸¸ä¸æœƒåŸ·è¡Œä¸‹å€‹stageï¼Œpipelineæœƒæå‰çµæŸã€‚</p>
<p>é€šå¸¸ pipelineæœƒè‡ªå‹•åŸ·è¡Œï¼Œä¸€æ—¦å»ºç«‹äº†å°±ä¸éœ€è¦å…¶å®ƒçš„ä»‹å…¥ã€‚ä½†æœ‰æ™‚å€™ä½ ä¹Ÿå¯ä»¥æ‰‹å‹•è·Ÿpipelineåšäº¤äº’ã€‚</p>
<p>å…¸å‹çš„pipelineæœƒåŒ…å«å››å€‹stagesï¼Œä¾åºä»¥ä¸‹åˆ—çš„é †åºåŸ·è¡Œ:</p>
<ul>
<li><code>build</code> stage: åŒ…å«ä¸€å€‹<code>compile</code>job</li>
<li><code>test</code> stage: é€šå¸¸æœƒæœ‰ä¸€è‡³å¤šå€‹test jobs</li>
<li><code>staging</code> stage: åŒ…å«ä¸€å€‹åç‚º<code>deploy-to-stage</code>çš„jobåç¨±</li>
<li><code>production</code> stage: åŒ…å«ä¸€å€‹åç‚º<code>deploy-to-prod</code>çš„jobåç¨±</li>
</ul>
<p>å¯ä»¥ç”¨å¤šç¨®ä¸åŒæ–¹å¼ä¾†é…ç½®pipelines</p>
<ul>
<li>
<p>basic pipelines: åœ¨æ¯å€‹stageä¸­ï¼Œä¸¦è¡ŒåŸ·è¡Œæ‰€æœ‰çš„jobsï¼Œå¾Œæ¥ä¸‹å€‹stage</p>
</li>
<li>
<p>directed acyclic graph pipeline (DAG): æ ¹æ“šjobä¹‹é–“é—œä¿‚ï¼Œrunçš„é€Ÿåº¦é€šå¸¸æ¯”basic pipelinesé‚„è¦å¿« (å¯ä»¥é¿å…ä¸å¿…è¦çš„ç­‰å¾…)</p>
</li>
<li>
<p>merge request pipelines: åªæœ‰ merge request åŸ·è¡Œæ™‚æ‰æœƒç”¨çš„ pipeline</p>
</li>
<li>
<p>merged result pipelines: åœ¨å¯¦éš›åˆä½µåˆ†æ”¯ä¹‹å‰æ¸¬è©¦åˆä½µä¹‹å¾Œçš„çµæœ</p>
</li>
<li>
<p>merge trains: åˆ©ç”¨ merged results pipelinesï¼Œè®“mergesçš„å‹•ä½œä¸€å€‹æ¥è‘—ä¸€å€‹åŸ·è¡Œ</p>
</li>
<li>
<p>parent-child pipelines: å°‡è¤‡é›œçš„pipelineæ‹†è§£æˆä¸€å€‹parent pipelineï¼Œé€™å€‹parent pipelineå¯ä»¥è§¸ç™¼å¤šå€‹ child sub-pipelinesï¼Œparent &amp; children éƒ½runåœ¨ç›¸åŒä¸€å€‹projectï¼Œä½¿ç”¨ä¸€æ¨£çš„SHAï¼Œé€™ç¨®é¡å‹çš„pipelineæ¶æ§‹å¸¸å¸¸å‡ºç¾åœ¨ mono-repos</p>
</li>
<li>
<p>multi-project pipelines: å°‡è² è²¬ä¸åŒprojectsçš„pipelinesåˆä½µèµ·ä¾†</p>
</li>
</ul>
<p><a href="https://docs.gitlab.com/ee/ci/pipelines/pipeline_architectures.html#basic-pipelines" target="_blank" rel="noopener noreffer ">pipeline architecture</a></p>
<h4 id="pipelineé…ç½®è¨­å®š">pipelineé…ç½®è¨­å®š</h4>
<p>å¯ä»¥ç”¨ CI/CD yaml é…ç½® jobs ä»¥åŠ stagesï¼Œä¹Ÿå¯ä»¥ç”¨ GitLab UI é…ç½®ç‰¹å®šå±¤é¢çš„ pipelines</p>
<p>å¦‚æœæ˜¯ç”¨VS Codeç·¨è¼¯GitLab CI/CDé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å®‰è£GitLab Workflow VS code extensionå¹«åŠ©ä½ é©—è­‰configurationä¸¦æª¢è¦–pipeline status</p>
<h5 id="åœ¨manual-pipelineé å…ˆå¡«è®Šæ•¸">åœ¨manual pipelineé å…ˆå¡«è®Šæ•¸</h5>
<p>å¯ä»¥ä½¿ç”¨<code>description</code>èˆ‡<code>value</code>é—œéµå­—ä¾†å®šç¾© pipeline-level(global)çš„è®Šæ•¸ï¼Œé€™äº›è®Šæ•¸åœ¨æ‰‹å‹•run pipelineæ™‚å¯ä»¥é å¡«å…§å®¹ã€‚description ä¸»è¦æ˜¯ç”¨ä¾†è§£é‡‹é€™å€‹variableç”¨ä¾†åšä»€éº¼ï¼Œå…è¨±çš„å€¼æ˜¯ä»€éº¼ã€‚</p>
<p>job-level variable ç„¡æ³•å¡«é è¨­å…§å®¹ã€‚</p>
<p>å¦‚æœconfigurationæª”æ¡ˆçš„pipeline-level variableæœ‰åˆ—descriptionï¼Œä½†æ²’æœ‰å®šç¾©valueçš„è©±ï¼Œå°±æœƒæ˜¯ç©ºç™½å€¼(blank value)ï¼Œä¾‹å¦‚:</p>
<pre tabindex="0"><code class="language-yaml=" data-lang="yaml=">variables:
  DEPLOY_CREDENTIALS:
    description: &#34;The deployment credentials.&#34;
  DEPLOY_ENVIRONMENT:
    description: &#34;Select the deployment target. Valid options are: &#39;canary&#39;, &#39;staging&#39;, &#39;production&#39;, or a stable branch of your choice.&#34;
    value: &#34;canary&#34;
</code></pre><ul>
<li><code>DEPLOY_CREDENTIALS</code> æ²’æœ‰é å…ˆå¡«valueï¼Œæ‰€ä»¥æ¯æ¬¡æ‰‹å‹•run pipelineçš„æ™‚å€™éƒ½è¦å®šç¾©å€¼</li>
<li><code>DEPLOY_ENVIRONMENT</code> é è¨­å€¼æ˜¯ canaryï¼Œåœ¨descriptionå€å¡Šè§£é‡‹äº†å…¶å®ƒå¯ç”¨çš„é¸é …</li>
</ul>
<h5 id="é…ç½®ä¸€å€‹å¯æ“‡çš„é å¡«è®Šæ•¸æ¸…å–®">é…ç½®ä¸€å€‹å¯æ“‡çš„é å¡«è®Šæ•¸æ¸…å–®</h5>
<p>åœ¨æ‰‹å‹•run pipelineæ™‚ï¼Œä¹Ÿå¯ä»¥å®šç¾©ä¸€å€‹é™£åˆ—è®“åŸ·è¡Œpipelineçš„useråšé¸æ“‡ï¼Œç”¨<code>options</code>é—œéµå­—åˆ—æ¸…å–®ï¼Œ<code>value</code>é—œéµå­—åˆ—é è¨­é¸é …ã€‚æ³¨æ„æ”¾åœ¨ value çš„å­—ä¸²ä¹Ÿå¿…é ˆåŒ…å«åœ¨ options æ¸…å–®ä¸­ï¼Œé€™å€‹æ¸…å–®åœ¨Run pipeline UIé æœƒè®Šæˆä¸€å€‹ä¸‹æ‹‰é¸å–®ã€‚</p>
<pre tabindex="0"><code class="language-yaml=" data-lang="yaml=">variables:
  DEPLOYMENT_ENVIRONMENT:
    value: &#34;staging&#34;
    option:
      - &#34;production&#34;
      - &#34;staging&#34;
      - &#34;canary&#34;
    description: &#34;The deployment target, Set to &#39;staging&#39; env by default.&#34;
</code></pre><h5 id="run-a-pipeline-by-url-query-string">run a pipeline by URL query string</h5>
<p>å¯ä»¥ä½¿ç”¨ä¸€å€‹æŸ¥è©¢å­—ä¸²ä¾†é å¡« Run Pipelineé ï¼Œä¾‹å¦‚:</p>
<ul>
<li><code>.../pipelines/new?ref=my_branch&amp;var[foo]=bar&amp;file_var[file_foo]=file_bar</code>
<ul>
<li>Run for field: <code>my_branch</code>
<ul>
<li>æŒ‡æ˜è¦ç”¨å“ªä¸€å€‹branchä¾†é å¡« <strong>Run for</strong> field</li>
</ul>
</li>
<li>Variables:
<ul>
<li>variable:
<ul>
<li>æŒ‡æ˜<code>Variable</code>é¡å‹variable</li>
<li>Key: <code>foo</code></li>
<li>Value: <code>bar</code></li>
</ul>
</li>
<li>file:
<ul>
<li>æŒ‡æ˜<code>File</code>é¡å‹çš„variable</li>
<li>Key: <code>file_foo</code></li>
<li>Value: <code>file_bar</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="add-manual-interaction">Add manual interaction</h5>
<ul>
<li><a href="https://docs.gitlab.com/ee/ci/jobs/job_control.html#create-a-job-that-must-be-run-manually" target="_blank" rel="noopener noreffer ">Manual jobs</a>:
<ul>
<li>å®šç¾©: é™¤éuserå•Ÿå‹•ä¹‹ï¼Œå¦å‰‡é€™å€‹jobæ°¸é ä¸æœƒrunï¼Œé€šå¸¸ç”¨åœ¨ deploy to production çš„æƒ…å¢ƒä¸­</li>
<li>è¨­å®š: åœ¨é€™å€‹jobä¹‹ä¸‹åŠ ä¸Šé—œéµå­—<code>when: manual</code>ï¼Œé€™æ¨£pipelineå•Ÿå‹•æ™‚å°±æœƒè¢«skippedæ‰</li>
</ul>
</li>
</ul>
<h6 id="start-all-manual-jobs-in-a-stage">Start all manual jobs in a stage</h6>
<ul>
<li>å¦‚æœæŸä¸€å€‹stageè£¡é¢å…¨éƒ¨éƒ½æ˜¯manual jobsï¼Œå¯ä»¥é€é<code>Run all manual</code> ä¾†åŒæ™‚å•Ÿå‹•æ‰€æœ‰jobs (ä½†å¦‚æœé€™stageæœ‰åŒ…å«non-manual jobå°±ä¸æœƒé¡¯ç¤ºæ­¤æŒ‰éˆ•)</li>
</ul>
<h5 id="skip-a-pipeline">Skip a pipeline</h5>
<ul>
<li>å¦‚æœè¦commitä½†ä¸æƒ³è¦è§¸ç™¼pipelineï¼Œå‰‡åœ¨commit messageåŠ ä¸Š<code>ci skip</code>æˆ–è€…<code>skip ci</code> (å¤§å°å¯«ä¸åˆ†)</li>
<li>å¦å¤–ï¼Œåœ¨ Git 2.10 æˆ–æ›´å¾ŒæœŸçš„ç‰ˆæœ¬ï¼Œä½¿ç”¨ <code>ci.skip</code> ä½œç‚º git push çš„é¸é …ï¼Œé€šå¸¸ä¸¦ä¸æœƒè·³è„«ä¸åŸ·è¡Œmerge request pipeline
<pre tabindex="0"><code>git push -o ci.skip 
# 
</code></pre><ul>
<li><code>-o</code>: é€™è£¡æŒ‡çš„æ˜¯ &ndash;push-option</li>
<li>ä½¿æœ€è¿‘çš„ä¸€ç­†pushä¸æœƒç”¢ç”Ÿä¸€å€‹CI/CD pipeline (åªæœƒskip branch pipelineï¼Œmerge request pipelineå¦‚æœæœ‰çš„è©±é‚„æ˜¯æœƒåŸ·è¡Œ)</li>
<li>å¦å¤–é€™å€‹commandä¹Ÿä¸æœƒè·³éCI/CDæ•´åˆç›¸é—œçš„ pipeline (ä¾‹å¦‚Jenkins)</li>
</ul>
</li>
</ul>
<h5 id="delete-a-pipeline">Delete a pipeline</h5>
<p>æ“æœ‰è©² project çš„ Owner è§’è‰²çš„ user æœ‰æ¬Šé™åˆªé™¤ pipelineï¼Œä½†åˆªé™¤ä¸€å€‹pipelineä¸¦ä¸æœƒè‡ªå‹•åˆªæ‰å®ƒçš„child pipelines</p>
<p>åˆªé™¤ä¸€å€‹ pipeline æœƒä½¿æ‰€æœ‰ pipeline caches é€¾æœŸï¼Œä¸¦ä¸”ç«‹åˆ»åˆªé™¤æ‰€æœ‰ç›¸é—œç‰©ä»¶ï¼Œä¾‹å¦‚jobs, logs, artifacts, triggers (åˆªé™¤å¾Œå°±ç„¡æ³•å¾©åŸäº†)</p>
<h5 id="pipeline-security-on-a-protected-branches">Pipeline security on a protected branches</h5>
<ul>
<li>
<p>protected branch</p>
<ul>
<li>å¯ä»¥è¨­å®šå“ªäº›userå¯ä»¥merge, å“ªäº›userå¯ä»¥pushï¼Œé‚£äº›èƒ½å¤ force push, é‚£äº›userèƒ½é€é <a href="https://docs.gitlab.com/ee/api/commits.html" target="_blank" rel="noopener noreffer ">Commits API</a> ä¿®æ”¹branch</li>
<li>å¦‚æœpipelineåœ¨é€™é¡branchåŸ·è¡Œï¼Œæœƒå¯¦è¡Œåš´æ ¼çš„ security model</li>
</ul>
</li>
<li>
<p>å¦‚æœæŸ user æœ‰æ¬Šé™ merge æˆ– push é€²é€™å€‹ branchï¼Œå°±å¯ä»¥</p>
<ul>
<li>ä½¿ç”¨ Web UI æˆ– pipelines APIï¼Œrun manual pipeline</li>
<li>run æœ‰æ’ç¨‹çš„ pipeline</li>
<li>è§¸ç™¼ pipeline</li>
<li>è·‘å‹•æ…‹æ‡‰ç”¨ç¨‹å¼å®‰å…¨æ¸¬è©¦(DAST, as dynamic application security test)</li>
<li>åœ¨æ—¢æœ‰çš„ pipeline è§¸ç™¼æ‰‹å‹•çš„action</li>
<li>ä½¿ç”¨ Web UI æˆ– pipelines APIï¼Œé‡è©¦æˆ–å–æ¶ˆæ—¢æœ‰çš„jobs</li>
</ul>
</li>
<li>
<p>protected variable:</p>
<ul>
<li>åªæœ‰ç•¶userå­˜å–æ©Ÿæ•è³‡æ–™ (ä¾‹å¦‚ deployment credentials, deployment token) çš„æ¬Šé™ï¼Œæ‰é©åˆåˆ†é… merge code to protected branches çš„æ¬Šé™çµ¦æ­¤ user</li>
<li>protected branchesçš„pipelineï¼Œå…¶ä¸‹çš„jobså¯ä»¥å­˜å–protected variables</li>
</ul>
</li>
<li>
<p>protected runner:</p>
<ul>
<li>å—ä¿è­·çš„runneråªèƒ½åœ¨å—ä¿è­·çš„åˆ†æ”¯run jobsï¼Œä»¥é¿å…æœªå—ä¿¡ä»»çš„ç¨‹å¼ç¢¼åœ¨å—ä¿è­·çš„runnerä¸ŠåŸ·è¡Œï¼Œä¹Ÿé¿å…éƒ¨ç½²ç›¸é—œçš„æ©Ÿæ•è³‡æ–™è¢«æ„å¤–å–å¾—</li>
<li>ç‚ºäº†ç¢ºä¿è¦åœ¨å—ä¿è­·çš„runneråŸ·è¡Œçš„jobsä¸åœ¨regularæ™®é€šrunnersåŸ·è¡Œï¼Œé€™äº›jobséœ€è¦åŠ ä¸Šé—œéµå­— <code>&lt;job_name&gt;: tags:</code> <a href="https://docs.gitlab.com/ee/ci/yaml/index.html#tags" target="_blank" rel="noopener noreffer ">reference job tags</a></li>
</ul>
</li>
</ul>
<h4 id="æª¢è¦–pipeline">æª¢è¦–pipeline</h4>
<ul>
<li>å¯ä»¥ç”¨ä¾†éæ¿¾pipeline listçš„æ¢ä»¶æœ‰: trigger author, branch name, status, tag, source</li>
</ul>
<h5 id="ä½¿ç”¨-stage-æˆ–è€…-needs-é…ç½®ä¾†åˆ†çµ„-jobs">ä½¿ç”¨ stage æˆ–è€… <code>needs</code> é…ç½®ä¾†åˆ†çµ„ jobs</h5>
<p>å¦‚æœç”¨<code>needs</code>é—œéµå­—é…ç½®jobsï¼Œå‰‡æœƒæœ‰å…©ç¨®åœ¨pipelineæ˜ç´°é åˆ†çµ„jobsçš„é¸é …ï¼š<code>group jobs by stage</code>, <code>group jobs by Job dependencies</code></p>
<ul>
<li><code>needs: []</code> : ä¸ä¾è³´æ–¼ä»»ä½•å…¶å®ƒjobs</li>
</ul>
<p>è¨­å®šä¾è³´çš„æ–¹å¼:</p>
<ol>
<li>åœ¨jobs ymlè¨­å®šæª”è£¡é¢åŠ  <code>needs: [&quot;&lt;the_job_name_to_depend_on&gt;&quot;]</code>
<ul>
<li>jobs array ä¸Šé™æ•¸é‡50å€‹</li>
<li>è¨­ç‚º empty arrayï¼Œå‰‡é€™å€‹ job åœ¨æ­¤ pipeline å‰µå»ºæ™‚å°±æœƒé–‹å§‹ä½œæ¥­äº†</li>
<li>å…¶å®ƒ <a href="https://docs.gitlab.com/ee/ci/yaml/index.html#needs" target="_blank" rel="noopener noreffer ">needs syntax</a></li>
</ul>
</li>
<li>å¯ä»¥åœ¨UIæª¢è¦–ä¾è³´é—œä¿‚: Group jobs by Job dependencies -&gt; æ‰“é–‹ show dependencies</li>
</ol>
<h4 id="pipeline-success-and-duration-charts">pipeline success and duration charts</h4>
<p>é»é¸è¦æŸ¥çœ‹çš„ project -&gt; å·¦å´é¸å–® -&gt; Analyze -&gt; CI/CD å°±å¯ä»¥çœ‹åˆ°</p>
<p>Note: DORA æŒ‡æ¨™(DevOps Research and Assessment)
<a href="https://docs.gitlab.com/ee/user/analytics/ci_cd_analytics.html#view-dora-deployment-frequency-chart" target="_blank" rel="noopener noreffer ">Reference: éƒ¨ç½²é »ç‡,ç•°å‹•äº¤ä»˜æœŸé–“,æœå‹™æ¢å¾©æ™‚é–“,æ›´æ”¹å¤±æ•—ç‡</a></p>
<h3 id="jobs">Jobs</h3>
<p>Jobsæ˜¯GitLabçš„CI/CD pipelineä¸­ï¼Œæœ€åŸºæœ¬çš„å…ƒç´ ï¼Œåœ¨<code>.gitlab-ci.yml</code>ç”¨ commandæ¸…å–®ä¾†é…ç½®jobsï¼Œä»¥é”æˆå»ºæ§‹ã€æ¸¬è©¦ã€éƒ¨ç½²ç¨‹å¼ç¢¼çš„ç›®çš„ã€‚</p>
<blockquote>
<p>åŸºæœ¬ä¸Šæ˜¯<code>export=</code>å„²å­˜è®Šæ•¸ï¼Œç¬¦åˆæŸæ¢ä»¶æ™‚<code>if[...]; then ...; fi</code>å„²å­˜è®Šæ•¸ï¼Œ<code>cd</code> ç§»å‹•åˆ°æŸè³‡æ–™å¤¾ï¼Œ<code>docker build</code>&hellip;ï¼Œ<code>docker push</code> &hellip;ï¼Œ<code>./gradlew</code>&hellip;ï¼ŒæŸ¥çœ‹<code>java --version</code>ï¼Œæˆ–è€…<code>aws ecr</code>æŒ‡ä»¤æ“ä½œ</p>
</blockquote>
<p>Jobs:</p>
<ul>
<li>å®šç¾©åœ¨ç¬¦åˆå“ªäº›æ¢ä»¶ä¸‹ï¼Œæ‡‰è©²åŸ·è¡Œå“ªäº›ä½œæ¥­</li>
<li>æ˜¯ top-level å…ƒç´ ï¼Œä»»æ„å‘½å(arbitary name)ï¼Œè‡³å°‘å¿…é ˆåŒ…å«<code>script</code>å­å¥</li>
<li>å¯ä»¥å®šç¾©çš„jobsæ•¸é‡æ²’æœ‰ä¸Šé™</li>
</ul>
<p>Job ç”± runners æ”¶é›†ï¼Œåœ¨ runner environement åŸ·è¡Œï¼Œæ¯å€‹ jobs çš„é‹è¡Œéƒ½å„è‡ªç¨ç«‹æ–¼å…¶å®ƒçš„ jobsã€‚</p>
<h4 id="åœ¨-pipeline-ä¸­æª¢è¦–-jobs">åœ¨ pipeline ä¸­æª¢è¦– jobs</h4>
<p>å¯ä»¥åœ¨pipelineæŸ¥çœ‹å…¶ä¸­çš„jobsï¼Œé»é¸å€‹åˆ¥çš„jobå¯ä»¥æŸ¥çœ‹é€™å€‹job logï¼Œå¦å¤–å¯ä»¥:</p>
<ul>
<li>å–æ¶ˆé€™å€‹job</li>
<li>å¦‚æœå¤±æ•—ï¼Œé‡è©¦é€™å€‹job</li>
<li>å¦‚æœé€šéï¼Œå†è·‘ä¸€æ¬¡é€™å€‹job</li>
<li>æ¸…é™¤é€™å€‹job log</li>
</ul>
<h4 id="æŸ¥çœ‹-job-failed-å¤±æ•—åŸå› ">æŸ¥çœ‹ job failed å¤±æ•—åŸå› </h4>
<p>å¯ä»¥ç”¨æ»‘é¼  hover åˆ° pipeline graph(åœ¨pipeline detailsæª¢è¦–é ), pipeline widgets(åœ¨ merge requests&amp;commité é¢) æˆ–è€… job views æŸ¥çœ‹å¤±æ•—åŸå› </p>
<h4 id="pipeline-è£¡é¢çš„-job-order">pipeline è£¡é¢çš„ job order</h4>
<p>è¦–pipeline graphçš„é¡å‹ä¸åŒï¼Œæœ‰ä¸åŒçš„jobé †åº</p>
<ul>
<li><code>full pipeline graph</code>(è©³ç´°å¤§åœ–): ä»¥nameæ’åº</li>
<li><code>pipeline mini graph</code>(): å…ˆä»¥statusæ’åºã€‚å†ä»¥nameæ’åº</li>
</ul>
<p>Job status order:</p>
<ul>
<li><code>failed</code> red x</li>
<li><code>warning</code> yellow !</li>
<li><code>pending</code> grey circle</li>
<li><code>running</code> blue two-thirds sector</li>
<li><code>manual</code> black gear</li>
<li><code>scheduled</code> ?</li>
<li><code>canceled</code> white \</li>
<li><code>success</code> green v</li>
<li><code>skipped</code> gray &raquo;</li>
<li><code>created</code> ?</li>
</ul>
<h4 id="job-å‘½åé™åˆ¶">job å‘½åé™åˆ¶</h4>
<ul>
<li>
<p>jobåç¨±å¿…é ˆå°æ–¼æˆ–ç­‰æ–¼255å­—å…ƒï¼Œå¦‚æœä¸€å€‹æª”æ¡ˆæœ‰å¤šå€‹ç›¸åŒåç¨±çš„jobsï¼Œåªæœ‰ä¸€å€‹æœƒè¢«åŠ é€²pipelineï¼Œè€Œä¸”ç„¡æ³•é åˆ¤æ˜¯å“ªä¸€å€‹è¢«åŠ é€²pipeline</p>
</li>
<li>
<p>å¦‚æœè¢«includedçš„jobåŒåï¼Œå…¶åƒæ•¸æœƒè¢«merging</p>
</li>
<li>
<p>ä»¥ä¸‹çš„é—œéµå­—ä¸èƒ½ç•¶ä½œjobåç¨±:
image | services | stages | types
before_script | after_script | variables
cache | include | true | false | nil
pages:deploy (configured for a <code>deploy</code> stage)</p>
</li>
</ul>
<h4 id="åœ¨-pipeline-è£¡é¢æ›¿-jobs-åšåˆ†çµ„">åœ¨ pipeline è£¡é¢æ›¿ jobs åšåˆ†çµ„</h4>
<p>å¦‚æœä½ æœ‰å¾ˆå¤šé¡ä¼¼çš„ jobsï¼Œå‘ˆç¾çš„ pipeline graph å°±æœƒå¤ªé•·é›£ä»¥é–±è®€</p>
<p>å¦‚æœ job names æ˜¯ä»¥ç‰¹å®šæ ¼å¼å‘½å‹ï¼Œå°±å¯ä»¥è‡ªå‹•å°‡ç›¸ä¼¼çš„ jobs åšåˆ†çµ„ï¼Œåœ¨ regular pipeline å°±æœƒè¢«æ‘ºç–Šæˆå–®ä¸€çš„çµ„åˆ¥</p>
<p>åœ¨<code>.gitlab-ci.yml</code>å°‡å¤šå€‹jobså¯«æˆä¸€çµ„ï¼Œå¯ä»¥ç”¨æ•¸å­—ä»¥åŠä»¥ä¸‹ç¬¦è™Ÿæ“‡ä¸€ï¼š</p>
<ul>
<li>Slash æ­£æ–œç·š: <code>slash-test 1/3</code>, <code>slash-test 2/3</code>, <code>slash-test 3/3</code></li>
<li>Colon å†’è™Ÿ: <code>slash-test 1:3</code>, <code>slash-test 2:3</code>, <code>slash-test 3:3</code></li>
<li>Space ç©ºæ ¼: <code>slash-test 0 3</code>, <code>slash-test 1 3</code>, <code>slash-test 2 3</code></li>
</ul>
<h4 id="éš±è—-hidden-jobs">éš±è— hidden jobs</h4>
<p>å¯ä»¥ç”¨ comment out (åŠ #,CTRL+L) æˆ–è€…job_nameå‰é¢æ‰“å¥é»</p>
<p>å‰é¢æ‰“å¥é»çš„ job å¯ä»¥ç”¨ä¾†ä½œç‚ºç¯„æœ¬çµ¦å…¶å®ƒ jobs åšé‡è¤‡ä½¿ç”¨çš„é…ç½®ï¼Œä½¿ç”¨æ–¹å¼æœ‰äºŒ:</p>
<ul>
<li><code>extends</code> é—œéµå­—</li>
<li><a href="https://docs.gitlab.com/ee/ci/yaml/yaml_optimization.html#anchors" target="_blank" rel="noopener noreffer ">YAML anchors</a>ï¼Œå³<code>&amp;</code>,<code>&lt;&lt;</code>,<code>*</code></li>
</ul>
<h4 id="æ§åˆ¶-default-keyword-ä»¥åŠ-global-variable-çš„ç¹¼æ‰¿">æ§åˆ¶ default keyword ä»¥åŠ global variable çš„ç¹¼æ‰¿</h4>
<p>å¯ä»¥ç”¨<code>inherit:default</code> ç®¡æ§ <code>default keywords</code> çš„ç¹¼æ‰¿
å¯ä»¥ç”¨<code>inherit:variables</code> ç®¡æ§ <code>global variables</code> çš„ç¹¼æ‰¿</p>
<pre tabindex="0"><code class="language-yaml=" data-lang="yaml=">default:
  image:
  before_script:

variables:
  DOMAIN: ywc.wednes.com
  WEBHOOK_URL: https:/wysiwyz.io

job_name_taht_inherits_all:
  inherit:
    default: true
    variables: true
  script: bundle exec inheriting all
  
job_that_doesnt_inherit_anything:
  inherit:
    default: false
    variables: false
  script: bundle exec inheriting nothing
  
job_that_doesnt_require_before_script_and_domain:
  inherit:
    default: [image]
    variables: [WEBHOOK_URL]
  script: echo this job does not inherit before script and domain
    
</code></pre><h4 id="run-manual-jobsçš„æ™‚å€™æŒ‡å®švariables">run manual jobsçš„æ™‚å€™æŒ‡å®švariables</h4>
<p>åœ¨ pipeline view é»æ“Šè¦æ‰‹å‹•åŸ·è¡Œçš„ job çš„åç¨±ï¼Œä¸è¦é» Run â–¶ æŒ‰éˆ•</p>
<p>å¯ä»¥çœ‹åˆ° Variables æœ‰ key è·Ÿ value çš„æ¬„ä½å¯è¼¸å…¥å…§å®¹</p>
<p>å¦‚æœè¼¸å…¥çš„ key å·²ç¶“å®šç¾©åœ¨ CI/CD settings æˆ–è€… <code>.gitlab-ci.yml</code> æª”ï¼Œé‚£é€™å€‹æ‰‹å‹•åŠ å…¥çš„è®Šæ•¸æœƒè¦†å¯«åŸæœ‰çš„å€¼ï¼Œæ–°çš„å€¼ä¸æœƒè¢«éš±ç¢¼ï¼Œæœƒè¢«expandedï¼ˆ<a href="https://docs.gitlab.com/ee/ci/variables/index.html#prevent-cicd-variable-expansion" target="_blank" rel="noopener noreffer ">åŠ ä¸Š$åƒç…§åˆ°å…¶å®ƒvariable</a>ï¼‰</p>
<h4 id="å»¶å¾Œä¸€å€‹jobçš„åŸ·è¡Œ">å»¶å¾Œä¸€å€‹jobçš„åŸ·è¡Œ</h4>
<p>ç•¶ä½ ä¸æƒ³è¦ç«‹åˆ»åŸ·è¡Œjobï¼Œå¯ä»¥ä½¿ç”¨<code>when:delayed</code>é—œéµå­—ä¾†ä½¿å»¶é² job execution ä¸€æ®µæ™‚é–“</p>
<p>roll out æ–°ç¨‹å¼ç¢¼çš„æ™‚å€™ï¼Œtimed incremental rollout å°¤å…¶æœ‰åˆ©æ–¼é€æ­¥éƒ¨ç½²ç¨‹å¼ç¢¼åˆ°ç”Ÿç”¢ç’°å¢ƒ</p>
<p>ä¾‹å¦‚èªªï¼Œå¦‚æœä½ è¦é–‹å§‹éƒ¨ç½²æ–°ç¨‹å¼ç¢¼:</p>
<ul>
<li>User æ²’æœ‰é‡åˆ°å›°é›£ï¼ŒGitLab å¯ä»¥è‡ªå‹•åœ°å¾0~100% å®Œæˆéƒ¨ç½²</li>
<li>User åœ¨æ–°ç¨‹å¼ç¢¼é‡åˆ°ç–‘é›£çš„è©±ï¼Œå¯ä»¥è—‰ç”±å–æ¶ˆpipelineä¸¦å€’å›åˆ°ä¸Šä¸€å€‹ç©©å®šç‰ˆæœ¬ï¼Œä¾†åœæ­¢ timed incremental rollout</li>
</ul>
<h4 id="å±•é–‹æˆ–æŠ˜ç–Š-job-log-sections">å±•é–‹æˆ–æŠ˜ç–Š job log sections</h4>
<p>Job log å¯å€åˆ†ç‚ºä¸åŒ sectionsï¼Œæ¯å€‹sectionå¯ä»¥è¢«æŠ˜ç–Šæˆ–å±•é–‹ï¼Œæ¯å€‹sectionæœƒé¡¯ç¤ºé€™æœŸé–“çš„ç›¸é—œè¨Šæ¯
é»æ“Š <code>&gt;</code> å¯ä»¥å±•é–‹ sectionï¼›é»æ“Š <code>v</code> å¯ä»¥æŠ˜ç–Š section</p>
<h5 id="å®¢åˆ¶åŒ–å¯æŠ˜ç–Šçš„section">å®¢åˆ¶åŒ–å¯æŠ˜ç–Šçš„section</h5>
<p>å¯ä»¥ç”¨ manual output special codes (é€™æ˜¯GitLabç”¨ä¾†åˆ¤æ–·å“ªä¸€å€‹sectionè¦æ‘ºç–Šçš„ç¨‹å¼ç¢¼)ï¼Œåœ¨ job logs è£¡é¢å»ºç«‹ collapsible section:</p>
<ul>
<li>Marker: Sectionèµ·å§‹è™•
<code>\e[0Ksection_start:UNIX_TIMESTAMP:SECTION_NAME\r\e[0K</code> + <code>TEXT_OF_SECTION_HEADER</code></li>
<li>Marker: SectionçµæŸçš„åœ°æ–¹
<code>\e[0Ksection_end:UNIX_TIMESTAMP:SECTION_NAME\r\e[0K</code></li>
</ul>
<p>é€™å…©æ®µmarkeréƒ½æ˜¯åŠ åœ¨ CI configuration çš„è…³æœ¬å€å¡Šï¼Œä½¿ç”¨ <code>echo -e </code>&ldquo;starting_marker&rdquo;ã€<code>echo -e </code>&ldquo;ending_marker&rdquo;</p>
<p>å¦‚æœä½¿ç”¨çš„æ˜¯ Zsh shellï¼Œæœƒéœ€è¦è·³è„«å­—å…ƒï¼Œä¾‹å¦‚<code>\e</code>â†’<code>\\e</code>ä»¥åŠ<code>\r</code> â†’ <code>\\r</code></p>
<ul>
<li>UNIX_TIMESTAMP: ä¾‹å¦‚<code>data+%s</code>ï¼Œæ˜¯Unix timestamp</li>
<li>SECTION_NAME: é€™å€‹sectionçš„åç¨±ï¼Œåªèƒ½ç”±è‹±æ•¸å­—ä»¥åŠ<code>_</code>,<code>.</code>,<code>-</code>é€™ä¸‰ç¨®ç¬¦è™Ÿæ§‹æˆ</li>
<li><code>\r\e[0K</code>: ç”¨ä¾†é¿å…å°‡section markersé¡¯ç¤ºåœ¨æ¸²æŸ“å‡ºä¾†çš„job logè£¡é¢ (åœ¨raw job logä»ç„¶çœ‹çš„åˆ°)ï¼Œåˆ‡æ›åˆ° raw job log å¯ä»¥é» job log å³ä¸Šè§’ï¼Œé¸æ“‡<strong>show complete raw</strong> (æ–‡ä»¶icon)
<ul>
<li><code>\r</code>: carriage return</li>
<li><code>\e[0K</code>: æ¸…é™¤ line ANSI escape sequence (ä¸€å®šè¦åŠ 0ï¼Œ<code>\e[K</code>ç„¡æ•ˆ)</li>
</ul>
</li>
</ul>
<p>å¦å¤–ä¹Ÿå¯ä»¥ <a href="https://docs.gitlab.com/ee/ci/jobs/#use-a-script-to-improve-display-of-collapsible-sections" target="_blank" rel="noopener noreffer ">ç”¨è…³æœ¬æ”¹å–„å¯æŠ˜ç–Šçš„section display</a></p>
<h4 id="deployment-jobs-éƒ¨ç½²ä½œæ¥­">deployment jobs éƒ¨ç½²ä½œæ¥­</h4>
<p>ä»»ä½•ä½¿ç”¨ <code>environment</code> é—œéµå­—ï¼Œä»¥åŠ<code>action:start</code> çš„jobï¼Œå°±ç¨±ä¹‹ç‚ºDeployment jobsï¼Œç”¨é€”æ˜¯éƒ¨å±¬ç¨‹å¼ç¢¼åˆ°ç’°å¢ƒä¸­</p>
<p>Deployment jobs ä¸å¿…é ˆåœ¨ deploy stage</p>
<pre tabindex="0"><code class="language-yaml=" data-lang="yaml=">deploy_job_this_is:
  script:
    - deploy-to-cats.sh
  environment:
    name: production
    url: https://this-is-a-simple-url.com
    action: start
</code></pre><h3 id="cicd-components">CI/CD components</h3>
<p>CI/CD component æ˜¯å¯ä»¥é‡è¤‡ä½¿ç”¨çš„å–®ä¸€çš„ pipeline é…ç½®å–®ä½ã€‚component å¯ä»¥å»ºç«‹æˆä¸€å€‹å¤§å‹ pipeline çš„å…¶ä¸­ä¸€å°éƒ¨åˆ†ï¼Œç”šè‡³å¯ä»¥æ§‹æˆå®Œæ•´çš„ pipeline configurationã€‚</p>
<p>componentå¯ä»¥ç”¨<a href="https://docs.gitlab.com/ee/ci/yaml/inputs.html" target="_blank" rel="noopener noreffer ">å‚³å…¥åƒæ•¸</a>çš„é…ç½®ä¾†å‹•æ…‹èª¿æ•´è¡Œç‚ºã€‚</p>
<p>CI/CD components é¡ä¼¼æ–¼ç”¨<code>include</code>é—œéµå­—åŠ å…¥å…¶å®ƒçš„configuration yml file (åƒè€ƒ<a href="https://docs.gitlab.com/ee/ci/yaml/includes.html" target="_blank" rel="noopener noreffer ">å®˜æ–¹Docs</a>) ï¼Œä½†ä½¿ç”¨componentsæœ‰ä»¥ä¸‹ä¸å°‘å„ªå‹¢ï¼š</p>
<ul>
<li>å¯ä»¥å°‡ components åˆ—åœ¨ <a href="https://docs.gitlab.com/ee/ci/components/#cicd-catalog" target="_blank" rel="noopener noreffer ">CI/CD catalog</a> ä¹‹ä¸­
(å•: é€™æ‡‰è©²æ˜¯æœ‰Ownerè§’è‰²çš„ä½¿ç”¨è€…æ‰èƒ½çœ‹åˆ°ï¼Œå› ç‚ºæˆ‘éƒ½çœ‹ä¸åˆ°ğŸ˜…)</li>
<li>å¯ä»¥ç™¼è¡Œ component ä¸¦æŒ‡æ˜ä½¿ç”¨ç‰¹å®šä¸€å€‹ç‰ˆæœ¬</li>
<li>å¤šå€‹ component å¯ä»¥å®šç¾©åœ¨åŒä¸€å€‹ project ä¸¦ä¸”ä¸€èµ·å®šç¾©ç‰ˆæœ¬ç·¨è™Ÿ</li>
</ul>
<p>é™¤äº†å‰µå»ºè‡ªæœ‰çš„ componentsï¼Œä¹Ÿå¯ä»¥åœ¨CI/CD catalog æœå°‹ç¾æˆä¸”ç¬¦åˆæ‰€éœ€åŠŸèƒ½çš„å·²ç™¼å¸ƒ components</p>
<ul>
<li>å¯ä»¥åƒè€ƒä»¥ä¸‹çš„å½±ç‰‡ &amp; Betaç‰ˆçš„
<ul>
<li><a href="https://www.youtube.com/watch?v=-yvfSFKAgbA" target="_blank" rel="noopener noreffer ">ä»¥å¯é‡è¤‡ä½¿ç”¨çš„ component å»ºç«‹æœ‰æ•ˆç‡çš„ DevSecOps workflow</a></li>
<li><a href="https://gitlab.navattic.com/cicd-catalog" target="_blank" rel="noopener noreffer ">Beta CI/CD Catalog Product Tour</a></li>
</ul>
</li>
</ul>
<h4 id="component-project">Component project</h4>
<p>component project æ˜¯ä¸€å€‹ GitLab projectï¼ŒåŒ…å« å€‹ repositoryï¼Œhosting ä¸€è‡³å¤šå€‹ componentsã€‚é€™å€‹ project ä¹‹ä¸­çš„å¤šå€‹ components éƒ½ä¸€åŒç·¨ç‰ˆæœ¬è™Ÿï¼Œä¸€å€‹ project ä¸Šé™æœ€å¤šå¯ä»¥æœ‰ 30 å€‹ componentsã€‚</p>
<p>å¦‚æœå…¶ä¸­æŸä¸€å€‹ component è¦æ±‚è·Ÿå…¶å®ƒ components ä¸ä¸€æ¨£çš„ç‰ˆæœ¬ç·¨è™Ÿï¼Œé‚£é€™å€‹ component æ‡‰è©²è¢«æ¬åˆ°å¦å¤–ä¸€å€‹å°ˆç”¨çš„ projectã€‚</p>
<h4 id="å»ºç«‹ä¸€å€‹-component-project">å»ºç«‹ä¸€å€‹ component project</h4>
<ol>
<li>New project with README.md (å¦‚è¦ç™¼å¸ƒåˆ° CI/CD catalog çš„è©±ï¼Œé¡¯ç¤ºé€™å€‹componentæ‘˜è¦çš„æ™‚å€™ï¼Œæœƒç”¨åˆ° description &amp; project avatar)</li>
<li>ä¾ç…§ä»¥ä¸‹çš„ required directory structureï¼Œæ›¿æ¯ä¸€å€‹ component åŠ ä¸Š YAML é…ç½®æª”æ¡ˆ
<a href="https://docs.gitlab.com/ee/ci/components/#directory-structure" target="_blank" rel="noopener noreffer ">éœ€æ±‚ç›®éŒ„æ¶æ§‹</a>
<pre tabindex="0"><code class="language-yaml=" data-lang="yaml=">spec:
  inputs:
    stage:
      default: test
---
component-job:
  script: echo job 1
  stage: $[[ inputs.stage ]]
</code></pre></li>
</ol>
<p>é€™æ¨£å°±å¯ä»¥ç«‹åˆ»é–‹å§‹ä½¿ç”¨componentäº†ï¼Œä½¿ç”¨ include é—œéµå­—ï¼Œcomponent åƒç…§çš„æ ¼å¼:</p>
<blockquote>
<p><code>&lt;fully-qualified-domain-name&gt;/&lt;project-path&gt;/&lt;component-name&gt;@&lt;specific-version&gt;</code>:</p>
</blockquote>
<pre tabindex="0"><code class="language-yaml=" data-lang="yaml=">include: 
  - component: gitlab.example.com/yws-org/security-components/secret-detection@1.0.0
    inputs:
      stage: build
</code></pre><ul>
<li><code>secret-detection</code> æŒ‡çš„å¯èƒ½æ˜¯ <code>secret-detection.yml</code> æª”åï¼Œä¹Ÿå¯èƒ½æ˜¯æŒ‡æŸä¸€å€‹ç›®éŒ„ï¼Œç›®éŒ„è£¡é¢çš„<code>template.yml</code></li>
<li></li>
</ul>
<p><a href="https://docs.gitlab.com/ee/ci/components/#use-a-component" target="_blank" rel="noopener noreffer ">åƒè€ƒdocsé€£çµåœ¨é€™è£¡</a></p>
<h4 id="component-project-çš„ç›®éŒ„æ¶æ§‹">component project çš„ç›®éŒ„æ¶æ§‹</h4>
<ul>
<li>
<p>å¦‚æœåªæœ‰å–®ä¸€ä¸€å€‹component</p>
<pre tabindex="0"><code>â”œâ”€â”€ templates/
â”‚   â””â”€â”€ my-component.yml
â”œâ”€â”€ LICENSE.md
â”œâ”€â”€ README.md
â””â”€â”€ .gitlab-ci.yml
</code></pre><ul>
<li>é€™è£¡çš„<code>gitlab-ci.yml</code>ä½œç”¨æ˜¯ç”¨ä¾†<a href="https://docs.gitlab.com/ee/ci/components/#test-the-component" target="_blank" rel="noopener noreffer ">å¯«jobæ¸¬è©¦ my-component</a>ï¼Œä¸¦ä¸”<a href="https://docs.gitlab.com/ee/ci/components/#publish-a-new-release" target="_blank" rel="noopener noreffer ">ç™¼å¸ƒæ–°ç‰ˆæœ¬</a>ç”¨çš„</li>
<li>componentéƒ½æ”¾åœ¨æœ€é«˜å±¤çš„<code>templates/</code>ç›®éŒ„åº•ä¸‹</li>
<li>æ¯ä¸€å€‹componentsä¹Ÿå¯ä»¥æ·»åŠ è‡ªå·±çš„<code>README.md</code>æ–‡ä»¶ï¼Œå†é€£å‘ä¸Šå±¤çš„ top-level <code>README.md</code> æ–‡ä»¶</li>
<li><code>LICENSE.md</code>ï¼Œé¸æ“‡åƒæ˜¯ The MIT License from open source initiative æˆ–è€… Apache License, ver.2.0
<blockquote>
<p>é€™å€‹LICENSEæ˜¯é–‹æºè¨±å¯è­‰ï¼Œç”¨ä¾†å®šç¾©ä½¿ç”¨ã€è¤‡è£½ã€ä¿®æ”¹ç¨‹å¼ç¢¼çš„æ¢æ¬¾èˆ‡æ¢ä»¶ï¼ŒApache License 2.0 é©åˆæ¶‰åŠå°ˆåˆ©ä¿è­·ç›¸é¤¨çš„è€ƒé‡ï¼Œè€Œ The MIT License æ¯”è¼ƒç°¡å–®éˆæ´»ï¼Œæ²’æœ‰å°ˆåˆ©æ¢æ¬¾é™åˆ¶ï¼Œåªè¦æ±‚ä¿ç•™ç‰ˆæ¬Šè²æ˜å’Œè¨±å¯è­‰</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>å¦‚æœæœ‰å¤šå€‹components</p>
<pre tabindex="0"><code>â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ my-simple-component.yml
â”‚   â””â”€â”€ my-complex-component/
â”‚       â”œâ”€â”€ template.yml
â”‚       â”œâ”€â”€ Dockerfile
â”‚       â”œâ”€â”€ test.sh
â”‚       â””â”€â”€ README.md
â”œâ”€â”€ LICENSE.md
â”œâ”€â”€ README.md
â””â”€â”€ .gitlab-ci.yml
</code></pre></li>
</ul>
<h4 id="component-versions">Component versions:</h4>
<p>ä»¥æœ€é«˜å„ªå…ˆæ¬Šæ’åºï¼Œcomponent versionå¯ä»¥æ˜¯:</p>
<ol>
<li>commit SHA codeï¼Œä¾‹å¦‚ <code>439e77c88be865fa99afeed0ecd4ee3b17ae4af7</code></li>
<li>tag
<ul>
<li>ä¾‹å¦‚ <code>1.0.0</code></li>
<li>å¦‚æœä¸€å€‹nameæœ‰tagè·Ÿcommit SHAåŒæ™‚å­˜åœ¨ï¼Œå‰‡ä»¥commit SHAå„ªå…ˆ</li>
<li>ç™¼ä½ˆåˆ° CI/CD çš„ component æ‡‰è©²ä¾ç…§ <a href="https://docs.gitlab.com/ee/ci/components/#semantic-versioning" target="_blank" rel="noopener noreffer ">semantic versioning</a> çš„æ¨™æº–åŠ ä¸Š tag
<ul>
<li>semantic version æ˜¯å®šç¾©è©²ç•°å‹•ç‚º major, minor, patch æˆ–å…¶ä»–é¡å‹ç•°å‹•çš„æ¨™æº–</li>
<li><code>1.0.0</code>ã€<code>2.3.4</code>ã€<code>1.0.0-alpha</code> é€™äº›éƒ½æ˜¯æœ‰æ•ˆ semantic versions</li>
</ul>
</li>
</ul>
</li>
<li>branch nameåˆ†æ”¯åç¨±ï¼Œ<code>main</code>ï¼Œå¦‚æœ tag è·Ÿ branch çš†å­˜åœ¨ï¼Œä»¥ tag ç‚ºå„ªå…ˆ</li>
<li><code>~latest</code>ï¼Œæ°¸é æŒ‡å‘CI/CD catalogä¸Šé¢æœ€æ–°ç™¼è¡Œçš„ semantic version</li>
</ol>
<p>å»ºè­°ä½¿ç”¨æœ‰ç™¼å¸ƒè‡³ CI/CD catalog çš„ç‰ˆæœ¬ï¼Œç”¨ commit SHA æˆ–è€… branch åç¨±åƒç…§çš„ç‰ˆæœ¬å¯èƒ½å°šæœªç™¼å¸ƒåˆ° catalogï¼Œæ˜¯ä¾›æ¸¬è©¦ç”¨ã€‚</p>
<h5 id="é¿å…ä½¿ç”¨-global-keywords-é—œéµå­—">é¿å…ä½¿ç”¨ global keywords é—œéµå­—</h5>
<p>é¿å…ä½¿ç”¨æœƒå½±éŸ¿åˆ°æ•´å€‹pipelineè£¡é¢æ‰€æœ‰jobsåŸ·è¡Œçš„æ‰€æœ‰componentsï¼ŒåŒ…æ‹¬å®šç¾©åœ¨ main <code>.gitlab-ci.yml</code> æˆ–è€…å…¶ä»– included components çš„ jobs</p>
<p>Global keywords:</p>
<ul>
<li>default: å¦‚æœjobæ²’æœ‰å®šç¾©é€™äº›keywordï¼Œå°±æœƒç”¨åˆ°defaultå€çš„keywordï¼Œ
<ul>
<li>subkey åŒ…å« <code>image</code>, <code>retry</code>, <code>script</code>, <code>services</code>, <code>interruptible</code>, <code>tags</code>, <code>timeout</code>, <code>cache</code>, <code>hooks</code>,<code>id_tokens</code>, <code>artifiacts</code>, <code>before_script</code>, <code>after_script</code> etc.</li>
</ul>
</li>
<li>include: ç”¨ä¾†å®šç¾©å¤–éƒ¨å¼•å…¥çš„ yaml æª”ï¼ŒæŠŠä¸»è¦çš„<code>.gitlab-ci.yml</code>æ‹†æˆå¤šå€‹æª”æ¡ˆå¢åŠ å¯è®€æ€§æˆ–æ¸›å°‘é‡è¤‡ç¨‹å¼ç¢¼
<ul>
<li>subkey åŒ…å« <code>component</code>, <code>local</code>, <code>project</code>, <code>remote</code>, <code>template</code>, <code>inputs</code>, <code>rules</code></li>
</ul>
</li>
<li>stages: å®šç¾©åœ¨æŸå€‹æˆ–æŸäº›stagesæ‰€è¦åŸ·è¡Œçš„jobs
<ul>
<li>subkey åŒ…å« <code>.pre</code>, <code>build</code>, <code>test</code>, <code>deploy</code>, <code>.post</code></li>
</ul>
</li>
<li>workflow: ç”¨ä¾†æ§åˆ¶ pipeline è¡Œç‚º
<ul>
<li>subkey åŒ…å« <code>auto_cancel:on_new_commit</code>, <code>auto_cancel:on_job_failure</code>, <code>name</code>, <code>rules</code>, etc.</li>
</ul>
</li>
</ul>
<p>é¿å…ä½¿ç”¨global keywordçš„æ›¿ä»£æ–¹æ¡ˆ:</p>
<ul>
<li>Not_recommand:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">default</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">ruby:3.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rspec-1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">bundle exec rspec dir2/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rspec-2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">bundle exec rspec dir2/</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>Solution_1: ç›´æ¥åœ¨æ¯å€‹ jobs è£¡é¢åŠ  configuration
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">rspec-1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">ruby:3.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">bundle exec rspec dir2/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rspec-2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">ruby:3.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">bundle exec rspec dir2/</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>åœ¨ component ä¹‹ä¸­ä½¿ç”¨ <code>extends</code> é—œéµå­—ï¼Œä½¿ç”¨ç¨ç‰¹å­—ä»¥æ¸›å°‘ component åœ¨ merged é€² configuration çš„æ™‚å€™å¯èƒ½é€ æˆçš„é‡è¤‡å‘½åé¢¨éšª
<code>.rspec-image</code> is hidden job, as template for reducing and extending duplicate configuration.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">.rspec-image</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">ruby:3.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rspec-1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">extends</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">.rspec-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">bundle exec rspec dir2/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rspec-2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">ruby:3.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">bundle exec rspec dir2/</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h5 id="ç”¨-inputs-å–ä»£-hardcoded-å€¼">ç”¨ <code>inputs</code> å–ä»£ hardcoded å€¼</h5>
<p>é¿å…åœ¨ CI/CD component è£¡é¢å¯«æ­»è³‡æ–™ï¼Œé€ æˆå¾ŒçºŒä½¿ç”¨è€…è¦å¯©æ ¸componentå…§éƒ¨ç´°ç¯€ä¹‹å¾Œæ‰èƒ½ä½¿ç”¨ä¹‹</p>
<p>hard-codedå¯«æ­»ç›¸é—œçš„å•é¡Œå¸¸å¸¸ç™¼ç”Ÿåœ¨<code>stage</code>é—œéµå­—é€™å€ï¼Œå¦‚æœä¸€å€‹component jobçš„stageå¯«æ­»ï¼Œæ‰€æœ‰ä½¿ç”¨é€™å€‹componentçš„pipelineéƒ½å¿…é ˆå®šç¾©å®Œå…¨ç›¸åŒçš„stgeï¼Œæˆ–è€…<a href="https://docs.gitlab.com/ee/ci/yaml/includes.html#override-included-configuration-values" target="_blank" rel="noopener noreffer ">è¦†å¯«configuration</a>ï¼Œç”¨ merging method é‡æ–°å®šç¾©è®Šæ•¸çš„å€¼ã€‚</p>
<p>æ¯”è¼ƒå¥½çš„æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨<code>input</code>é—œéµå­—ä¾†åšå‹•æ…‹componenté…ç½®ï¼Œè®“componentä½¿ç”¨è€…å¯ä»¥è‡ªè¡ŒæŒ‡å®šæ‰€éœ€çš„å€¼ã€‚</p>
<p>Example: åœ¨ component ä½¿ç”¨ <code>inputs.stage</code> ç•¶åƒæ•¸ï¼Œä½¿ç”¨<code>$[[</code><em>{è¦å‹•æ…‹å‚³å…¥çš„åƒæ•¸}</em><code>]]</code>åƒç…§å‚³å…¥åƒæ•¸åç¨±</p>
<ul>
<li>
<p>ä»¥ä¸‹æ˜¯<code>component</code>é…ç½®æ–‡ä»¶:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">stage</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l">test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">unit-test</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l">$[[ inputs.stage ]]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">echo unit tests</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">integration-test</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l">$[[ inputs.stage ]]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">echo integration tests</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ä¸Šè¿°componentçš„project:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">stages</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">verify, deploy]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">include</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l">$CI_SERVER_FQDN/ywsorg/ruby/test@1.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l">verify</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h5 id="ç”¨-inputs-å–ä»£å®¢è£½çš„-cicd-variables">ç”¨ <code>inputs</code> å–ä»£å®¢è£½çš„ CI/CD variables</h5>
<p>å¦‚æœè¦åœ¨componentä½¿ç”¨CI/CD variableï¼Œå¯ä»¥å…ˆè©•ä¼°å¯å¦æ”¹ç”¨<code>inputs</code>é—œéµå­—ã€‚å¦‚æœ<code>inputs</code>æ˜¯è¼ƒä½³è§£ï¼Œæ‡‰è©²é¿å…è¦æ±‚userå»å®šç¾©custom variableä¾†é…ç½®componentã€‚</p>
<p>é€šå¸¸inputsæ˜¯æ˜ç¢ºå®šç¾©åœ¨componentsçš„<code>spec</code>å€å¡Šï¼Œæ¯”variableæœ‰æ›´å¥½çš„é©—è­‰æ€§(æª¢æŸ¥æ ¼å¼ã€å¯ç¶­è­·æ€§ã€æ–‡æª”åŒ–ï¼Œæœ‰åŠ©æ–¼é æœŸpipelineçš„å¯é æ€§å’Œç©©å®šæ€§)</p>
<p>Example:</p>
<ul>
<li>component å®£å‘Š inputs.scanner-output è¦å‚³å…¥è®Šæ•¸ (é»˜èªæ˜¯ json):
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">scanner-output</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l">json</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">my-scanner</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">my-scan --output $[[ inputs.scanner-output ]]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>åƒç…§åˆ°é€™å€‹componentçš„project (æŒ‡å®šç”¨ yaml)
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">include</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l">$CI_SERVER_FQDN/path/to/project/my-scanner@1.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">scanner-output</span><span class="p">:</span><span class="w"> </span><span class="l">yaml</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>ä½†æœ‰äº›æƒ…æ³ï¼Œä½¿ç”¨CI/CD variableæœƒæ¯”ä½¿ç”¨inputsæ›´é©åˆï¼Œä¾‹å¦‚:</p>
<ul>
<li>ä½¿ç”¨<a href="https://docs.gitlab.com/ee/ci/variables/predefined_variables.html" target="_blank" rel="noopener noreffer ">é å®šç¾©çš„è®Šæ•¸</a>ï¼Œè‡ªå‹•é…ç½®componentä»¥ç¬¦åˆuser&rsquo;s project</li>
<li>è¦æ±‚userç”¨é®ç¢¼æˆ–å—ä¿è­·çš„CI/CD variableå„²å­˜æ©Ÿæ•è³‡è¨Š</li>
</ul>
<h3 id="variables">Variables</h3>
<p>CI/CD variable å¯ä»¥ç”¨ä¾†ï¼š</p>
<ul>
<li>æ§åˆ¶ job èˆ‡ pipelines çš„è¡Œç‚º</li>
<li>å„²å­˜æƒ³è¦é‡è¤‡ä½¿ç”¨çš„æ•¸å€¼</li>
<li>é¿å…åœ¨ <code>.gitlab-ci.yml</code> hardcode æ•¸å€¼</li>
</ul>
<p>å¯ä»¥åœ¨<a href="https://docs.gitlab.com/ee/ci/jobs/index.html#specifying-variables-when-running-manual-jobs" target="_blank" rel="noopener noreffer ">run manual jobsçš„æ™‚å€™å¹«æŸå€‹ç‰¹å®š pipeline è¦†å¯«è®Šæ•¸çš„å€¼</a>ï¼Œæˆ–è€…åœ¨ <a href="https://docs.gitlab.com/ee/ci/pipelines/index.html#prefill-variables-in-manual-pipelines" target="_blank" rel="noopener noreffer ">manual pipeline é å¡«è®Šæ•¸</a></p>
<p>å¦‚æœè¦åœ¨ <code>.gitlab-ci.yml</code> æª”æ¡ˆè£¡é¢å»ºç«‹ä¸€å€‹ CI/CD è®Šæ•¸ï¼Œéœ€è¦ç”¨ variables é—œéµå­—ï¼š</p>
<pre tabindex="0"><code class="language-yaml=" data-lang="yaml=">variables:
  GLOBAL_JEN: &#34;A global variable&#34;
  
job1:
  variables:
    JOB_GEM: &#34;A Job1 variable&#34;
  script:
    - echo &#34;Variables are &#39;$GLOBAL_JEN&#39; and &#39;$JOB_GEM&#39;&#34;
    
job2:
  script:
    - echo &#34;Variables are &#39;$GLOBAL_JEN&#39; and &#39;$JOB_GEM&#39;&#34;
</code></pre><ul>
<li>å¦‚æœå®šç¾©åœ¨æª”æ¡ˆæœ€ä¸Šæ–¹ï¼Œé‚£é€™å€‹æª”æ¡ˆè£¡é¢æ‰€æœ‰jobséƒ½èƒ½å¤ ä½¿ç”¨</li>
<li>å¦‚æœå®šç¾©åœ¨jobè£¡é¢ï¼Œé‚£å°±åªæœ‰é€™ä¸€å€‹jobæ‰èƒ½ä½¿ç”¨</li>
<li>å°±ä»¥ä¸Šä¾‹å­ä¾†çœ‹:
<ul>
<li><code>job1</code> æœƒå°å‡º <code>'Variables are 'A global variable' and 'A Job1 variable'</code></li>
<li><code>job2</code> æœƒå°å‡º <code>'Variables are 'A global variable' and ''</code></li>
</ul>
</li>
</ul>
<h5 id="å¦‚ä½•åœ¨å–®ä¸€å€‹single-jobè£¡é¢-skipæ‰ä¸ç”¨å…¨åŸŸè®Šæ•¸">å¦‚ä½•åœ¨å–®ä¸€å€‹single jobè£¡é¢ skipæ‰ä¸ç”¨å…¨åŸŸè®Šæ•¸</h5>
<p>å¦‚æœè¦åœ¨æŸä¸€å€‹ job è£¡é¢ block æ‰ä¸ç”¨å…¨åŸŸè®Šæ•¸çš„è©±ï¼Œçµ¦ variables è¨­å®š<code>{}</code></p>
<pre tabindex="0"><code class="language-yml=" data-lang="yml=">variables:
  NOSY_GLOBAL_VAR: &#34;helloIamJennie&#34;

job1:
  variables: {}
  script:
    - echo This job does not need any global variables
</code></pre><p>æ©Ÿæ•è³‡æ–™çš„ç’°å¢ƒè®Šæ•¸ä¸é©åˆæ”¾åœ¨ yml æª”ï¼Œè¦é€é UI è¨­å®šï¼Œä¹Ÿå¯ä»¥é€é API endpoint æ–°å¢é€™äº›è®Šæ•¸ï¼Œä¾‹å¦‚:</p>
<table>
<thead>
<tr>
<th></th>
<th><a href="https://docs.gitlab.com/ee/api/project_level_variables.html" target="_blank" rel="noopener noreffer ">project-level</a></th>
<th><a href="https://docs.gitlab.com/ee/api/group_level_variables.html" target="_blank" rel="noopener noreffer ">group-level</a></th>
<th><a href="https://docs.gitlab.com/ee/api/instance_level_ci_variables.html" target="_blank" rel="noopener noreffer ">instance-level</a></th>
</tr>
</thead>
<tbody>
<tr>
<td>create</td>
<td>/project/:id/variables</td>
<td>/group/:id/variables</td>
<td>/admin/ci/variables</td>
</tr>
</tbody>
</table>
<p>é è¨­è€Œè¨€ï¼Œforkedå‡ºä¾†çš„å°ˆæ¡ˆç„¡æ³•å­˜å–çˆ¶å°ˆæ¡ˆçš„ CI/CD variablesã€‚</p>
<h5 id="cicd-variable-security">CI/CD variable security</h5>
<p>æœ‰ä»»ä½•ç•°å‹•åˆ°<code>.gitlab-ci.yml</code>æª”çš„ merge requestï¼Œåœ¨åšä»¥ä¸‹å‹•ä½œä¹‹å‰éƒ½è¦å…ˆä»”ç´°å¯©æ ¸ï¼š</p>
<ul>
<li>before merging the changes</li>
<li>ç‚ºäº†å¾forked projectæäº¤çš„ merge requestï¼Œåœ¨parent project run pipeline</li>
</ul>
<p>åƒæ˜¯åœ¨ job script è£¡é¢å¼•ç”¨åˆ° USER, PASSWORD, SECRET_VARIABLE é€™é¡ variable å°±æœƒé€ æˆæ©Ÿæ•è³‡è¨Šæš´éœ²</p>
<p>é é˜²å°ç­–:</p>
<ol>
<li>job logsä¸­ï¼Œæ©Ÿæ•è¨Šæ¯çš„variableè¨­å®šéƒ½è¦åœ¨mask variable checkboxæ‰“å‹¾ï¼Œå†update variable</li>
<li>é™åˆ¶æŸäº›å—ä¿è­·çš„branchesæˆ–è€…å—ä¿è­·çš„tagsæ‰èƒ½ä½¿ç”¨æ©Ÿæ•çš„variables (protect variable checkbox)</li>
<li>æˆ–è€…ç”¨ 3rd party secret management provider å„²å­˜å–å¾—æ©Ÿæ•è³‡è¨Š</li>
</ol>
<h5 id="ä»€éº¼æ˜¯-variable-type-variable-ä»€éº¼æ˜¯-file-type-variable">ä»€éº¼æ˜¯ variable type variable, ä»€éº¼æ˜¯ file type variable</h5>
<p>Variable type variableå®šç¾©:</p>
<ul>
<li>ä¸€å€‹key-valueå°</li>
<li>å¯ä»¥ä½œç‚ºjobè£¡é¢çš„ç’°å¢ƒè®Šæ•¸</li>
</ul>
<p>é€šå¸¸project, group, instanceçš„CI/CD variableé è¨­ç‚º<code>variable type</code>(variable_type of <code>env_var</code>)ï¼Œä½†ä¹Ÿå¯ä»¥è¨­å®šæˆ<code>file type</code>(variable_type of <code>file</code>)</p>
<p>File type variableå®šç¾©:</p>
<ul>
<li>åŒ…å«ä¸€å€‹key, value ä»¥åŠ file</li>
<li>ä¹Ÿå¯ä¾ç•¶ä½œjobè£¡é¢çš„ç’°å¢ƒè®Šæ•¸ï¼Œå¦‚ä¸‹ä½œç”¨
<ul>
<li>key: ç’°å¢ƒè®Šæ•¸åç¨±</li>
<li>value: è¦å­˜åœ¨æŸä¸€å€‹æš«å­˜æª”çš„å€¼ï¼Œä»£è¡¨æ–‡ä»¶çš„å…§å®¹</li>
<li>path to the temporary file: æš«å­˜æ–‡ä»¶çš„è·¯å¾‘ç•¶ä½œç’°å¢ƒè®Šæ•¸çš„å€¼</li>
</ul>
</li>
</ul>
<blockquote>
<p>è¦æ³¨æ„ï¼Œåœ¨ GitLab 15.6 æˆ–æ›´æ—©ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæ–‡ä»¶çš„å…§å®¹ç•¶ä½œvalueï¼Œè€Œä¸æ˜¯æª”æ¡ˆè·¯å¾‘ç•¶ä½œvalue</p>
</blockquote>
<p>ä¸èƒ½å°‡å®šç¾©åœ¨ <code>.gitlab-ci.yml</code> æª”çš„ CI/CD variable è¨­ç½®ç‚ºæª”æ¡ˆé¡å‹çš„è®Šæ•¸ï¼Œæœ‰ç¹éçš„æ–¹æ³•:</p>
<ol>
<li>å…ˆåœ¨ variables è¨­ç½® variable type variable</li>
<li>æ¥è‘—åœ¨ job script(CICDä½œæ¥­)ä¸­ï¼ŒæŠŠé€™å€‹ variable çš„å€¼å¯«å…¥ä¸€å€‹æª”æ¡ˆ <code>echo &quot;$VAR_TYPE_VAR_URL&quot; &gt; &quot;transformed_file.txt&quot;</code></li>
<li>é€™æ¨£éœ€è¦æª”æ¡ˆè·¯å¾‘çš„æŒ‡ä»¤åˆ—å·¥å…·(mytool)å°±èƒ½ä½¿ç”¨äº†</li>
</ol>
<h5 id="åœ¨-job-scripts-ä½¿ç”¨-cicd-variables">åœ¨ job scripts ä½¿ç”¨ CI/CD variables</h5>
<ul>
<li>Bash, sh æˆ–é¡ä¼¼çš„ shells: <code>$</code>{KEY}</li>
<li>PowerShell: <code>$</code>{KEY} æˆ–è€… <code>$env:</code>{KEY}
<ul>
<li>æœ‰äº›æƒ…æ³éœ€è¦åŠ quotesï¼Œå¦‚ä¸‹
<code>&quot;-DsosposDailyUsr=$env:SOSPOS_DAILY_USR&quot;</code></li>
</ul>
</li>
<li>Windows Batch*: <code>%</code>{KEY}<code>%</code>
<ul>
<li>å¦‚æœæ˜¯åœ¨ windows ç’°å¢ƒä¸­è·‘ CI/CD pipeline</li>
<li>é€™é¡å‹çš„è…³æœ¬é™„æª”åç‚º<code>.bat</code>æˆ–<code>.cmd</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>å¦å¤–æœ‰å…¶ä»–ä»¥ä¸‹åŠŸèƒ½</p>
<ol>
<li>å°‡job_Aå»ºç«‹çš„variableå‚³éçµ¦å¾ŒçºŒçš„job_B (å­˜åœ¨å‰¯æª”åç‚º .env çš„æª”æ¡ˆ)</li>
<li>æ§åˆ¶å“ªäº›jobsä¸éœ€è¦ä½¿ç”¨<code>.env</code>(<code>dotenv</code>)è£¡é¢çš„ç’°å¢ƒè®Šæ•¸</li>
<li>è®Šæ•¸çš„valueè¨­å®šå¤šå€‹å­—ä¸²ï¼Œä»¥ç©ºæ ¼éš”é–‹ï¼Œå†ç”¨scriptçš„è¿´åœˆé”åˆ°ä¸€å€‹è®Šæ•¸å¤šå€‹å€¼(array)çš„æ•ˆæœ</li>
<li>å¦å¤–é‚„æœ‰è¦†å¯«variableï¼Œé™åˆ¶å“ªäº›äººæ‰èƒ½è¤‡å¯«
&hellip; å…¶å®ƒåƒè€ƒç¶²å€ğŸ‘‰ <a href="https://docs.gitlab.com/ee/ci/variables/#pass-an-environment-variable-to-another-job" target="_blank" rel="noopener noreffer ">Doc</a></li>
</ol>
</blockquote>
<h4 id="predefined-cicd-variables">predefined CICD variables</h4>
<p>æ¯å€‹ GitLab CI/CD pipeline éƒ½å¯ä»¥ä½¿ç”¨é å®šç¾©çš„è®Šæ•¸ã€‚</p>
<p>åœ¨å…©å€‹ä¸åŒpipelineåŸ·è¡Œéšæ®µï¼Œå¯ä»¥ä½¿ç”¨é å®šç¾©çš„è®Šæ•¸ï¼Œæœ‰äº›æ˜¯åœ¨ GitLab å‰µå»º pipeline æ™‚æœ‰æ•ˆï¼Œå¯ä»¥åœ¨ job scripts è£¡é¢ä½¿ç”¨ï¼Œæˆ–è€…å¯ä»¥ç”¨ä¾†åš pipeline é…ç½®ã€‚å¦å¤–ä¸€äº›å‰‡æ˜¯åœ¨ runners run job çš„æ™‚å€™æ‰æœ‰æ•ˆï¼Œåªèƒ½åœ¨ job scripts ä½¿ç”¨ã€‚</p>
<p>åœ¨ runner éšæ®µæ‰æœ‰æ•ˆçš„é å®šç¾©è®Šæ•¸ï¼Œç„¡æ³•åœ¨ trigger-jobs æˆ–è€…ä»¥ä¸‹ä¸‰å€‹é—œéµå­—å…§ä½¿ç”¨ï¼š</p>
<ul>
<li><code>workflow</code>, <code>include</code>, <code>rules</code></li>
<li><a href="https://docs.gitlab.com/ee/ci/pipelines/downstream_pipelines.html#trigger-a-downstream-pipeline-from-a-job-in-the-gitlab-ciyml-file" target="_blank" rel="noopener noreffer ">trigger-jobs</a></li>
</ul>
<h4 id="where-variables-can-be-used">where variables can be used</h4>
<p>å¯ä»¥æ”¾åœ¨å…©å€‹åœ°æ–¹:</p>
<ol>
<li>GitLab ç«¯ï¼Œæ”¾åœ¨ <code>.gitlab-ci.yml</code> æª”è£¡</li>
<li>GitLab Runner ç«¯ï¼Œ<code>config.toml</code></li>
</ol>
<p>GitLab å…§éƒ¨è®Šæ•¸çš„ expansion æ©Ÿåˆ¶</p>
<p>è¦å¯«æˆ <code>$variable</code>, <code>${variable}</code>, æˆ–è€…<code>%variable%</code> é€™æ¨£çš„æ ¼å¼</p>
<h3 id="pipeline-security">Pipeline security</h3>
<p>secret å®šç¾©ï¼špassword, SSH keys, access token æˆ–å…¶ä»–é©—è­‰èº«åˆ†ç”¨çš„è³‡æ–™</p>
<h4 id="secrets-storage">secrets storage</h4>
<p>åˆ†æˆå…©ç¨®</p>
<ul>
<li>Secrets management providers</li>
</ul>
<p>å­˜åœ¨ GitLab instance ä»¥å¤–çš„ç©ºé–“ï¼Œä¾‹å¦‚ HashiCorp Vaultã€Azure Key Vaultã€Google Cloud Secret Manager
å¯¦ä½œç´°ç¯€å¯åƒè€ƒï¼š<a href="https://docs.gitlab.com/ee/ci/secrets/index.html#" target="_blank" rel="noopener noreffer ">Using external secrets in CI</a></p>
<ul>
<li>CI/CD variables</li>
</ul>
<p>è¦åœ¨ CICD pipeline å„²å­˜é‡è¤‡ä½¿ç”¨ data çš„è©±ï¼Œ<a href="https://docs.gitlab.com/ee/ci/variables/index.html" target="_blank" rel="noopener noreffer ">CI/CD variables</a>æ˜¯å¾ˆæ–¹ä¾¿çš„é¸é …ï¼Œä½†ç›¸è¼ƒæ–¼å‰è€… secrets management providers ä¸å®‰å…¨</p>
<ul>
<li>
<p>variables å­˜åœ¨ project, group, instances çš„<code>settings</code>ï¼Œæœ‰æ¬Šé™å­˜å– settings çš„ user å°±èƒ½è¨ªå• variables</p>
<blockquote>
<p>[è·¯å¾‘] Repository / Settings / CI/CD / Variables</p>
</blockquote>
</li>
<li>
<p>variables å¯ä»¥è¢«è¦†å¯«ï¼ˆé€™æ¨£å°±å¾ˆé›£è­˜åˆ¥å“ªè£¡çš„è®Šæ•¸è¢«ç”¨åˆ°</p>
</li>
<li>
<p>å¦‚æœ pipeline ä¸å°å¿ƒé…ç½®éŒ¯èª¤çš„è©±ï¼Œå¯èƒ½æœƒæ„å¤–æš´éœ² variable</p>
</li>
</ul>
<p>é©åˆå­˜åœ¨ variables çš„è³‡è¨Šæ‡‰è©²æ˜¯éæ©Ÿæ•è³‡æ–™ï¼ˆä¸ç”¨æ“”å¿ƒè³‡æ–™æš´éœ²ï¼‰ï¼Œå¦‚æœæœ‰æ©Ÿæ•å±¤ç´šæ¯”è¼ƒä½çš„è³‡æ–™è¦å­˜åœ¨ Variablesï¼Œæ‡‰è©²è¦é®è”½ï¼ˆmask variable checkbox æ‰“å‹¾ï¼‰æˆ–ä¿è­·ä¹‹ï¼ˆprotect variable checkbox æ‰“å‹¾ï¼Œå†update variableï¼‰</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-04-26</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/240426-gitlab-ci-note/" data-hashtag="CI/CD yaml syntax"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://localhost:1313/posts/240426-gitlab-ci-note/" data-title="åˆæ¢GitLab CI/CD - å¦‚ä½•æ’°å¯«.gitlab-ci.yml"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/ci/cd-yaml-syntax/">CI/CD Yaml Syntax</a>,&nbsp;<a href="/tags/pipeline/">Pipeline</a>,&nbsp;<a href="/tags/job/">Job</a>,&nbsp;<a href="/tags/ci/cd-components/">CI/CD Components</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/s_nginx/" class="prev" rel="prev" title="Engine X æ˜¯ä»€éº¼"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Engine X æ˜¯ä»€éº¼</a>
            <a href="/posts/240503-non-blocking-jdbc/" class="next" rel="next" title="éé˜»å¡å¼ğŸŒŒ Non Blocking Jdbc">éé˜»å¡å¼ğŸŒŒ Non Blocking Jdbc<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">strict with yourself; lenient with others.</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/twemoji/twemoji.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
